<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Adding SSL and a domain name to Jupyter Hub - Python for Undergraduate Engineers</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

/*some stuff for output/input prompts*/
div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
@media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
div.prompt:empty{padding-top:0;padding-bottom:0}
div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
div.inner_cell{width:90%;}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
div.output_prompt{color:darkred;}

a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
/* end stuff for output/input prompts*/


.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}

div.collapseheader {
    width=100%;
    padding: 2px;
    cursor: pointer;
    font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
}

</style>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'center', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
    <link href="/extra/favicon.ico" rel="icon">

<link rel="canonical" href="/drafts/add-ssl-and-domain-name-to-jupyterhub.html">

        <meta name="author" content="Peter D. Kazarinoff" />
        <meta name="keywords" content="jupyter,jupyter hub,jupyter notebooks,python" />
        <meta name="description" content="This is the fifth part of a multi-part series that shows how to set up Jupyter Hub for a college class. In this post, we are going to link a domain name to our server IP address, add SSL security and configure nginx to run as a proxy in between users and jupyterhub. Then we&#39;ll run jupyterhub over https using the SSL security we created." />

        <meta property="og:site_name" content="Python for Undergraduate Engineers" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Adding SSL and a domain name to Jupyter Hub"/>
        <meta property="og:url" content="/drafts/add-ssl-and-domain-name-to-jupyterhub.html"/>
        <meta property="og:description" content="This is the fifth part of a multi-part series that shows how to set up Jupyter Hub for a college class. In this post, we are going to link a domain name to our server IP address, add SSL security and configure nginx to run as a proxy in between users and jupyterhub. Then we&#39;ll run jupyterhub over https using the SSL security we created."/>
        <meta property="article:published_time" content="2018-05-16" />
            <meta property="article:section" content="jupyter" />
            <meta property="article:tag" content="jupyter" />
            <meta property="article:tag" content="jupyter hub" />
            <meta property="article:tag" content="jupyter notebooks" />
            <meta property="article:tag" content="python" />
            <meta property="article:author" content="Peter D. Kazarinoff" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link href="/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
        <link href="/static/css/custom.css" rel="stylesheet">





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
Python for Undergraduate Engineers            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="/pages/about.html">
                             About
                          </a></li>
                         <li><a href="/pages/book.html">
                             Book
                          </a></li>
                         <li><a href="/pages/now.html">
                             Now
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="" title="Python for Undergraduate Engineers"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="/category/jupyter.html" title="jupyter">jupyter</a></li>
                <li class="active">Adding SSL and a domain name to Jupyter Hub</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/drafts/add-ssl-and-domain-name-to-jupyterhub.html"
                       rel="bookmark"
                       title="Permalink to Adding SSL and a domain name to Jupyter Hub">
                        Adding SSL and a domain name to Jupyter Hub
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-05-16T12:40:00-07:00"> Wed 16 May 2018</time>
    </span>

            <span class="label label-default">Series</span>
            Part <built-in method index of str object at 0x0000025E21839470> of 




<span class="label label-default">Tags</span>
	<a href="/tag/jupyter.html">jupyter</a>
        /
	<a href="/tag/jupyter-hub.html">jupyter hub</a>
        /
	<a href="/tag/jupyter-notebooks.html">jupyter notebooks</a>
        /
	<a href="/tag/python.html">python</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>This is the fifth part of a multi-part series that shows how to set up Jupyter Hub for a college class. In this post, we are going to link a domain name to our server IP address, add SSL security and configure nginx to run as a proxy in between users and jupyterhub. Then we'll run jupyterhub over https using the SSL security we created.</p>
<h3>Posts in this series</h3>
<ol>
<li><a href="/why-jupyter-hub.html">Why Jupyter Hub?</a> </li>
<li><a href="/drafts/ssh-keys-with-putty.html">Create ssh key, save to documents/ssh-keys</a></li>
<li><a href="/drafts/new-digital-ocean-droplet.html">Create a new Digital Ocean Droplet with a non-root sudo user</a></li>
<li><a href="/drafts/installing-jupyter-hub.html">Install Jupyter Hub on the server</a></li>
<li><strong>Apply SSL, link a domain name to the server and configure nginx</strong> (this post)</li>
<li>Connect OAuth to Jupyter Hub</li>
<li>Connect to Jupyter Hub as student</li>
</ol>
<h3>Last time</h3>
<p>In the last post, we installed <strong>Anaconda</strong> on the server using a shell script. Then we installed some extra <strong>Python</strong> packages such as <strong>pint</strong>, <strong>pyserial</strong> and <strong>schemdraw</strong> to our base conda environment. Next we installed <strong>jupyterhub</strong>, opened up port 8000 and ran jupyterhub for the first time! And remember <strong>we shut down jupyter hub very quickly</strong> because we ran it without any SSL security.</p>
<h3>Steps in this post:</h3>
<ol>
<li>Link domain name to server IP address</li>
<li>Install nginx</li>
<li>Use cirtbox to generate SSL certificates</li>
<li>Create jupyterhub_config.py and modify</li>
<li>modify nginx_conf</li>
<li>Start restart nginx and start jupyterhub. See if we can log in.</li>
<li>Create another system user on the server. Restart jupyterhub and log in as new user.</li>
</ol>
<h3>1. Link domain name to server IP address</h3>
<p>When we started Jupyter Hub in the previous post, it ran, we could log in, and we could run Python code. What's not to like, right? Well, security is the big problem. </p>
<p>In the initial setup, Jupyter Hub was running under regular http, not https. With a web application that has usernames and passwords, like Jupyter Hub, having https and SSL security is best. In order to use https, we need to get an SSL certificate. And that SSL certificate should correspond to the domain name linked to our server. So the first step is getting the domain name and pointing it at Digital Ocean. The next step is linking the domain name to our Jupyter Hub server.</p>
<h4>Google Domains</h4>
<p>I purchased the domain <em>problemsolvingwithpython.com</em> from <a href="https://domains.google.com">google domains</a>. It costs $12/year which seems pretty reasonable and was easy to set up. After purchasing the domain, I added the Digital Ocean DNS servers as a set of custom name servers to my domain options on google domains.</p>
<p><img alt="Google Domains Dashboard" src="/posts/jupyterhub/google_domains_list.png"></p>
<p>To add a set of custom name servers, click the the button with the two bars under the DNS header. This will bring up a page where you can enter in the Digital Ocean DNS servers. The name servers to add are:</p>
<div class="highlight"><pre><span></span>ns1.digitalocean.com
ns2.digitalocean.com
ns3.digitalocean.com
</pre></div>


<p><img alt="Google Domains Dashboard" src="/posts/jupyterhub/google_domains_dns_routing.png"></p>
<p>Make sure to click the radio button [Use custom name servers]</p>
<h4>Digital Ocean DNS</h4>
<p>Now we are going to set our domain <em>problemsolvingwithpython.com</em> to link to the IP address of our server on Digital Ocean. Log into Digital Ocean and in the upper right select [Create] --&gt; [Domains/DNS]</p>
<p><img alt="DO Domains/DNS" src="/posts/jupyterhub/DO_manage_domains.png"></p>
<p>In the [Add a domain] field, type in the domain name without http, but including .com (or .edu/.org/.net) then click [Add Domain].</p>
<p><img alt="DO Domains/DNS" src="/posts/jupyterhub/DO_add_domain.png"></p>
<p>This will bring us to a panel you can add a DNS record. I want the notebook server to have the web address <em>https://notebooks.problemsovlingwithpython.com</em>, so I entered <code>notebooks</code> in the text field. Then select the droplet (server) that you want the web address to route to.</p>
<p><img alt="DO Domains/DNS" src="/posts/jupyterhub/DO_sub_domain.png"></p>
<p>After completing this step, there will be a number of new DNS records. The ones I set up are below:</p>
<p><img alt="DO Domains/DNS" src="/posts/jupyterhub/DO_domains_routed.png"></p>
<p>It takes a couple minutes of waiting for the DNS switchover to register. <a href="https://www.whatsmydns.net">https://www.whatsmydns.net</a> can be used to check the NS and A records of your domain and see if your domain name is getting through. The first time I set the DNS up on Digital Ocean, I had added the custom DNS servers to google domains but neglected to select the custom DNS servers radio box. So it looked like the domain was routing to Digital Ocean, but actually it was just staying with google. Once I clicked the radio box and waited a couple minutes, the change over happened. It did take a bit of time though. Not hours, but a few minutes.</p>
<h3>2. Install nginx and modify ufw and nginx_conf</h3>
<p>Now that the domain is set up, let's up something up on our server that a web browser can see. The next step is to install and configure nginx, an open source web server that can handle many connections all at the same time. Following <a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-16-04">this tutorial</a> from Digital Ocean</p>
<p>Install nginx</p>
<div class="highlight"><pre><span></span>$ sudo apt-get update
$ sudo apt-get install nginx
</pre></div>


<p>Check out which apps the ufw firewall is working with. </p>
<div class="highlight"><pre><span></span>$ sudo ufw app list
</pre></div>


<p>We see a list of available ufw configurations to work with nginx. </p>
<div class="highlight"><pre><span></span>Available applications:
  Nginx Full
  Nginx HTTP
  Nginx HTTPS
  OpenSSH
</pre></div>


<p>We want to allow in both http and https requests. Once a http request comes in, we will use nginx to convert it to an https connection. Select nginx full. Note the Capitalization in the command:</p>
<div class="highlight"><pre><span></span>$ sudo ufw allow <span class="s1">&#39;Nginx Full&#39;</span>
</pre></div>


<p>We can check out which ports ufw is allowing through with:</p>
<div class="highlight"><pre><span></span>$ sudo ufw status
</pre></div>


<p>Note in the output how ufw is allowing nginx full and requests over port 8000. We opened port 8000 earlier, so we could see how jupyterhub works without a domain name or SSL.  Once we get nginx running and hooked up to jupyterhub, we need to remember to close off port 8000 in ufw.</p>
<div class="highlight"><pre><span></span><span class="n">Status</span><span class="o">:</span> <span class="n">active</span>

<span class="n">To</span>                         <span class="n">Action</span>      <span class="n">From</span>
<span class="o">--</span>                         <span class="o">------</span>      <span class="o">----</span>
<span class="mi">22</span>                         <span class="n">LIMIT</span>       <span class="n">Anywhere</span>
<span class="mi">2375</span><span class="o">/</span><span class="n">tcp</span>                   <span class="n">ALLOW</span>       <span class="n">Anywhere</span>
<span class="mi">2376</span><span class="o">/</span><span class="n">tcp</span>                   <span class="n">ALLOW</span>       <span class="n">Anywhere</span>
<span class="mi">8000</span>                       <span class="n">ALLOW</span>       <span class="n">Anywhere</span>
<span class="n">Nginx</span> <span class="n">Full</span>                 <span class="n">ALLOW</span>       <span class="n">Anywhere</span>
<span class="mi">22</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>                    <span class="n">LIMIT</span>       <span class="n">Anywhere</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>
<span class="mi">2375</span><span class="o">/</span><span class="n">tcp</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>              <span class="n">ALLOW</span>       <span class="n">Anywhere</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>
<span class="mi">2376</span><span class="o">/</span><span class="n">tcp</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>              <span class="n">ALLOW</span>       <span class="n">Anywhere</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>
<span class="mi">8000</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>                  <span class="n">ALLOW</span>       <span class="n">Anywhere</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>
<span class="n">Nginx</span> <span class="n">Full</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>            <span class="n">ALLOW</span>       <span class="n">Anywhere</span> <span class="o">(</span><span class="n">v6</span><span class="o">)</span>
</pre></div>


<p>nginx will start running as soon at it is installed. We can see the status with:</p>
<div class="highlight"><pre><span></span>$ sudo systemctl status nginx
</pre></div>


<p>In the output, we can see something like below. This mean nginx is running.</p>
<div class="highlight"><pre><span></span> <span class="nt">Active</span><span class="o">:</span> <span class="nt">active</span> <span class="o">(</span><span class="nt">running</span><span class="o">)</span> <span class="nt">since</span> <span class="nt">Thu</span> <span class="nt">2018-05-17</span> <span class="nt">04</span><span class="p">:</span><span class="nd">51</span><span class="p">:</span><span class="nd">16</span> <span class="nt">UTC</span><span class="o">;</span> <span class="nt">15min</span> <span class="nt">ago</span>
 <span class="nt">Main</span> <span class="nt">PID</span><span class="o">:</span> <span class="nt">17126</span> <span class="o">(</span><span class="nt">nginx</span><span class="o">)</span>
   <span class="nt">CGroup</span><span class="o">:</span> <span class="o">/</span><span class="nt">system</span><span class="p">.</span><span class="nc">slice</span><span class="o">/</span><span class="nt">nginx</span><span class="p">.</span><span class="nc">service</span>
           <span class="err">├─</span><span class="nt">17126</span> <span class="nt">nginx</span><span class="o">:</span> <span class="nt">master</span> <span class="nt">process</span> <span class="o">/</span><span class="nt">usr</span><span class="o">/</span><span class="nt">sbin</span><span class="o">/</span><span class="nt">nginx</span> <span class="nt">-g</span> <span class="nt">daemon</span> <span class="nt">on</span><span class="o">;</span> <span class="nt">master_pr</span>
           <span class="err">└─</span><span class="nt">17127</span> <span class="nt">nginx</span><span class="o">:</span> <span class="nt">worker</span> <span class="nt">process</span>
</pre></div>


<p>So we can browse over to the domain name (the domain we set up with Digital Ocean and google domains) and we should see the nginx start page.</p>
<p><img alt="nginx welcome page" src="/posts/jupyterhub/welcome_to_nginx.png"></p>
<h3>3. Obtain ssl certificates with certbot</h3>
<p>From <a href="https://www.slideshare.net/willingc/jupyterhub-tutorial-at-jupytercon">this presentation</a></p>
<p>Install certbot</p>
<div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~
$ mkdir certbot
$ <span class="nb">cd</span> certbot
$ wget https://dl.eff.org/certbot-auto
$ chmod a+x certbot-auto
</pre></div>


<p>Before we can run certbot, we need to turn off nginx. When I first tried to run certbot, I got an error that read:</p>
<div class="highlight"><pre><span></span>Problem binding to port 80: Could not bind to IPv4 or IPv6.
</pre></div>


<p>Since we installed nginx earlier, and we confirmed that it's running, that means that port 80 is currently in use by nginx. We need to open up port 80 to certbot by temporarily shutting down nginx. Once nginx is stopped, we can run cirtbot and get our SSL certificate. We'll have to restart nginx, but that can wait until we change the nginx configuration file.</p>
<div class="highlight"><pre><span></span>$ sudo systemctl stop nginx
$ sudo systemctl status nginx
<span class="c1"># [Ctrl] + [c] to exit</span>
$ ./certbot-auto certonly --standalone -d notebooks.problemsolvingwithpython.com
</pre></div>


<p>If it worked and we got our SSL certificate, the output will be something like:</p>
<div class="highlight"><pre><span></span>IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/notebooks.problemsolvingwithpython.com/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/notebooks.problemsolvingwithpython.com/privkey.pem
   Your cert will expire on 2018-08-15. 
</pre></div>


<p>Note the location of the <code>fullchain.pem</code> and <code>privkey.pem</code> files. We'll need to put these locations into the nginx configuration.</p>
<h3>4. Generate jupyterhub_config.py and modify</h3>
<div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~
$ jupyterhub --generate-config
</pre></div>


<h3>5. Modify nginx config</h3>
<h3>6. Restart nginx and start jupyterhub, see if we can login</h3>
<h3>7. Create an new user and restart jupyterhub. See if new user can log in.</h3>
<h3>Summary</h3>
<h3>Next Steps</h3>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="/why-jupyter-hub.html">Why Jupyter Hub?</a></li>
        <li><a href="/diffusion-problem-python-pint.html">Diffusion Calculation with Python and Pint</a></li>
        <li><a href="/opening-a-jupyter-notebook-on-windows.html">Opening a Jupyter Notebook on Windows</a></li>
        <li><a href="/plotting-sin-cos-with-matplotlib.html">Plotting sine and cosine with matplotlib and Python</a></li>
        <li><a href="/unit-conversions-with-pint.html">Unit conversions with Python and Pint</a></li>
    </ul>
</section>
<section class="well" id="related-posts">
    <h4>Article <built-in method index of str object at 0x0000025E21839470> of the  series</h4>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="/extra/gear-wrench-icon-512-278694.png"/>
        </p>
    <p>
      <strong>About Peter Kazarinoff</strong><br/>
        I teach engineering at a community college in the Pacific Northwest. I am interested in programming and how to help students. Here I mostly blog about Python, MATLAB and how programing can be incorporated into engineering education.
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="/why-jupyter-hub.html">Why Jupyter Hub?</a></li>
    <li class="list-group-item"><a href="/diffusion-problem-python-pint.html">Diffusion Calculation with Python and Pint</a></li>
    <li class="list-group-item"><a href="/opening-a-jupyter-notebook-on-windows.html">Opening a Jupyter Notebook on Windows</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-3">
      <a href="/tag/anaconda.html">anaconda</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/blog.html">blog</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/engineering.html">engineering</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/esp8266.html">esp8266</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/jupyter.html">jupyter</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/matplotlib.html">matplotlib</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/microcontroller.html">microcontroller</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/micropython.html">micropython</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/pelican.html">pelican</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="/tag/python.html">python</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Series -->
<li class="list-group-item">
  <h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Series</span></h4>
  <ul class="list-group">
  </ul>
</li>
<!-- End Sidebar/Series -->


<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
  <a href="https://github.com/professorkazarinoff">@professorkazarinoff</a> on GitHub
</li>
<!-- End Sidebar/Github -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Peter Kazarinoff
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>

    <script src="/static/js/custom.js"></script>


<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = '/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'professorkazarinoff',
    count: 5,
    skip_forks: true,
    target: '#gh_repos'
  });
});
</script>
<script src="/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-116330557-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
        });
    });
});
});
</script>
</body>
</html>