var tipuesearch = {"pages":[{"title":"About","text":"I started this blog after teaching a course on Engineering Programming at Portland Community College (ENGR114). In the course, we used MATLAB. But MATLAB cost students $49 for a student version. As we strive to move towards open education resources, I wanted to reduce the cost for students to take the course. This led me to Python. My goal is to help reduce student cost and investigate how Python can be used in engineering undergraduate courses. I earned my PhD in Material Science and Engineering from the University of Washington. Currently, I work as a Professor of Engineering and Engineering Technology at Portland Community College in Portland, OR. Teaching at a community college is my dream job. I have two inquisitive daughters and a wonderful and supportive wife. Coding downstairs in the den after the kids go to bed would not be possible without the my wife's gracious support. Before Covid-19 I played soccer. Now I try to run twice a week. See what I'm doing NOW . See what GEAR I'm using.","tags":"pages","url":"pages/about.html","loc":"pages/about.html"},{"title":"Book","text":"Problem Solving with Python My book Problem Solving with Python 3.7 Edition was published Fall 2019. Pick it up here: Link to Amazon This book is for undergraduate engineers and problem solvers learning programming. It is focused on using Python and programming to solve engineering problems. The book is written at an introductory level for people who want to get started using Python. The book starts with what is Python and how to install Python on your computer. Then it teaches you about the Python REPL and Jupyter Notebooks. Some specific Python libraries covered later in the book are: NumPy - numeric computing library Matplotlib - 2D and 3D plotting SymPy - Symbolic math functions PySerial - Communication with external hardware MicroPython - Run Python on a microcontroller. Chapter List Preface Chapter 1: Orientation Chapter 2: Jupyter Notebooks Chapter 3: The Python REPL Chapter 4: Data Types and Variables Chapter 5: NumPy and Arrays Chapter 6: Plotting with Matplotlib Chapter 7: Functions and Modules Chapter 8: If Else Try Except Chapter 9: Loops Chapter 10: Symbolic Math Chapter 11: Python and External Hardware Chapter 12: MicroPython Appendix","tags":"pages","url":"pages/book.html","loc":"pages/book.html"},{"title":"Gear","text":"Want to see what gear I use to write and run Python code? You're in the right place. NOTE (FULL DISCLOSURE): If you purchase any of the items below using the Amazon Affiliate links, it provides me a small referral fee , and there is no additional cost for you Computer I built my desktop computer out of the components below: Processor: Ryzen 3400G (4 Core 8 Thread) APU Motherboard: MSI B450I Mini-ITX Gaming Plus AC Ram: Corsair Vengeance DDR4 3000 MHz 16GB (2x8GB) Storage: Crucial P1 1TB M.2 NVMe SSD Power Supply: Corsair CX Series 450 Watt 80 Plus Bronze Certified Modular Power Supply Case: SilverStone Technology SST-SG13B-V2 Ultra Compact Mini-ITX Computer Case with Mesh Front Panel, Black Fan: Noctua NF-P14s redux-1500 PWM High Performance Cooling Fan Monitor: Lenovo ThinkVision S22e-19 21.5-Inch LED Backlit LCD Monitor HDMI Cable: Amazon Basics Braided HDMI Cable - 3 Foot Mouse: Wireless Vertical Mouse Jelly Comb Keyboard: Logitech K350 Wireless Wave Keyboard Audio The audio gear I use to record live streams (as well as remote classes) is below: Microphone: Audio Technica AT2100 USB Dynamic Microphone - no longer available, try the Audio-Technica ATR2100x-USB Cardioid Dynamic Microphone instead Headphones: Sony MDR7506 Professional Large Diaphragm Headphone Microphone Boom Arm: RODE PSA 1 Swivel Mount Studio Microphone Boom Arm Shock Mount: Knox Microphone Shock Mount for Audio-Technica ATR2100-USB and Samson Q2U Pop Filter: On-Stage Foam Ball-Type Microphone Windscreen, Black Microphone Case: Hard Case Compatible with Audio-Technica ATR2100 USB Microphone Webcam: Logitech HD Webcam C310 Standing Desk My standing desk setup was a real game changer. My neck and back ached at night if I sat at my old sitting desk all day long. See below for links to my new standing desk setup: Standing Desk: Hadulcet Mobile Standing Desk Laptop: Dell Latitude 5410 14\" Laptop - Intel Core i7-8665u - 256GB SSD - 8GB DDR4 SDRAM Monitor: Lenovo ThinkVision S22e-19 21.5-Inch LED Backlit LCD Monitor Monitor Stand: Laptop Monitor Mount Stand with Keyboard Tray, Adjustable Notebook Desk Mount with Clamp and Grommet Mounting Base for 13 to 27 Inch LCD Computer Screens Keyboard: Logitech K350 Wireless Wave Keyboard Wrist Rest: Belkin F8E263-BLK WaveRest Gel Wrist Pad for Keyboards Mouse: Wireless Vertical Mouse Jelly Comb Mouse Pad: Amazon Basics Gel Computer Mouse Pad with Wrist Support Rest","tags":"gear","url":"pages/gear.html","loc":"pages/gear.html"},{"title":"Now","text":"(what's this page about?) Learning Adobe Audition Jupyter Book Reading Kill Switch: The Rise of the Modern Senate and the Crippling of American Democracy by Adam Jentleson A Promised Land by Barack Obama Listening Music Can't Stop the Feelings - from the movie Trolls (Pandora channel) Podcasts Talk Python to Me Python Bytes Podcast. init Test and Code Django Chat Watching Youtube Tom Buck Think Media Podcastage Netflix Nothing right now - don't have time for TV","tags":"pages","url":"pages/now.html","loc":"pages/now.html"},{"title":"How to add an Inset Curve with Matplotlib and Python","text":"In this post, you'll see how to add an inset curve to a Matplotlib plot. An inset curve is a small plot laid on top of a main larger plot. The inset curve is smaller than the main plot and typically shows a \"zoomed in\" region of the main plot. This is the second post in a series of posts on how to plot stress-strain curves with Python and Matplotlib. In the previous post in the series we built a stress-strain curve from the data in two .xls data files. The plot built in the previous post included two lines, axes labels, a title, and legend. The data in the plot came from two .xls excel files and was from a tensile test of two metal samples. We are going to build upon that plot by adding an inset curve to it. Pre-requisits In order to build an inset curve with Matplotlib, you'll need to have a couple of things in place: Computer Python Matplotlib, NumPy, and Pandas Jupyter notebook (optional) Data Computer - to recreate the inset curve in this post, you'll need a computer. A laptop or desktop computer will both work. While it's possible to create the inset curve with a Chromebook, tablet, or phone - that's a bit more complicated and beyond the scope of this post. Python - You need to have Python installed on your computer. I recommend installing the Anaconda Distribution of Python. See this post to see how to install Anaconda on your computer. Matplotlib, NumPy, and Pandas - We'll build our inset curve using a Python plotting library called Matplotlib . Matplotlib is one of the most popular Python plotting libraries. If you installed Anaconda, Matplotlib is already installed. If you installed Python from somewhere else, you'll need to install Matplotlib. NumPy is a Python library for numeric computation. We'll use NumPy to make a few calculations. Pandas , a Python library for working with tabular data, will help us bring the data into our Python program. You can install Matplotlib, NumPy, and Pandas with the Anaconda Prompt using the commands below: > conda install matplotlib numpy pandas Alternatively, you can use a terminal and the Python package manager pip to install Matplotlib, NumPy, and Pandas. $ pip install matplotlib numpy pandas Jupyter notebook - This is optional, but you can enter the code in this post into a Jupyter notebook and see the plot produced in the same Jupyter notebook. Alternatively, you can enter the code into a .py file and run the .py file to produce the plot. As long as the Anaconda distribution of Python is installed on your computer, you use a Jupyter notebook. See how to open Jupyter notebook in this post . Data - The data we are going to plot is from two .xls data files. You can download these files using the links below: aluminum6061.xls steel1045.xls Move these .xls data files into the same folder on your computer as your Jupyter notebook or .py file that contains your code. Once these pre-requisites are in place, it's time to start building our inset curve! Build the main plot The type of plot we are building is called a stress-strain curve. Stress-strain curves are used by engineers to demonstrate how a material deforms under stress. We are going to add an inset curve on top of our stress-strain curve that highlights the linear elastic region. An inset curve is a small plot that is placed on top of the main plot. Inset curves usually show a zoomed-in view of a larger plot. On our stress-strain curve, the inset curve will show a zoomed-in view of the linear elastic region on the plot. To build our inset curve, we will use Python and Matplotlib's object-oriented interface. The plot from a previous post , was constructed using Matplotlib's pyplot interface. For a simple plot, the pyplot interface above is sufficient. But our plot with an inset curve is more complicated than just a plot with two lines- we are going to add an inset curve. Matplotlib's object-oriented interface allows us to access individual components of the plot, like axes, and set specific attributes on these components. Imports To build our plot with an inset curve, first, we need to import a couple of packages: NumPy, Pandas, and Matplotlib. These three Python packages have common import aliases: np , pd , and plt . The line %matplotlib inline is a Jupyter notebook magic command that results in plots produced within the same Jupyter notebook (as opposed to the plot popping out in a new window). If you are coding your inset curve in a .py file, leave %matplotlib inline out, as it is not valid Python code. In [1]: import numpy as np import pandas as pd import matplotlib.pyplot as plt % matplotlib inline Print Python and package version numbers The next few lines of code are not required, but can be helpful to others who might use our code again. The lines of code below print out to version of Python and the versions of the packages we imported above. In [2]: import sys import matplotlib print ( f \"Python Version: {sys.version} \" ) print ( f \"NumPy Version: {np.__version__} \" ) print ( f \"Pandas Version: {pd.__version__} \" ) print ( f \"Matplotlib Version: {matplotlib.__version__} \" ) Python Version: 3.8.5 (default, Sep 3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)] NumPy Version: 1.20.3 Pandas Version: 1.3.1 Matplotlib Version: 3.4.2 Ensure the two .xls data files are in the same folder as our code The two external files that contain the data we are going to plot are linked below: aluminum6061.xls steel1045.xls If you are following along and building an inset curve yourself, make sure to download the .xls data files and place these data files in the same directory as your Jupyter notebook or Python script. A convenient Jupyter notebook magic command, %ls , lists the contents of the current directory (the directory where the notebook is saved). Make sure you can see the two .xls data files in this directory. The %ls command is not valid Python code, so if you are building your plot in a .py file, make sure to leave %ls out. In [3]: % ls Volume in drive C is OS Volume Serial Number is 1236-A93E Directory of C:\\Users\\peter.kazarinoff\\Documents\\staticsite\\content\\code\\matplotlib_plots\\stress_strain_curves 11/02/2021 09:39 AM <DIR> . 11/02/2021 09:39 AM <DIR> .. 03/21/2021 06:54 PM <DIR> .ipynb_checkpoints 12/28/2020 01:47 PM 36,864 aluminum6061.xls 12/28/2020 01:47 PM <DIR> images 12/28/2020 01:47 PM 38,912 steel1045.xls 11/02/2021 09:37 AM 39,284 stress_strain_curve_with_inset.png 11/02/2021 09:39 AM 126,300 stress_strain_curve_with_inset_elastic_region.ipynb 12/28/2020 01:47 PM 88,263 stress_strain_curve_with_python.ipynb 12/28/2020 01:47 PM 113,352 stress-strain_curve.png 6 File(s) 442,975 bytes 4 Dir(s) 40,949,649,408 bytes free We can see the two data files aluminum6061.xls and steel1045.xls in the same folder as our Jupyter notebook stress_strain_curve_with_inset_elastic_region.ipynb Next, we need to bring in the data from the two external .xls files into variables in our script. Read the data with Pandas Next, we'll bring the two .xls data files into our Python script using Panda's pd.read_excel() function. The result is two Pandas data frames called steel_df and al_df which contain the data from our two .xls files. In [4]: al_df = pd . read_excel ( \"aluminum6061.xls\" ) steel_df = pd . read_excel ( \"steel1045.xls\" ) WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero We can use Panda's df.head() method to view the first five rows of each dataframe. In [5]: steel_df . head () Out[5]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } TESTNUM POINTNUM TIME POSIT FORCE EXT CH5 CH6 CH7 CH8 0 762 1 5.969 0.01284 201.030792 0.001572 -0.007133 NaN NaN NaN 1 762 2 6.242 0.01392 215.235886 0.000009 -0.014581 NaN NaN NaN 2 762 3 6.936 0.01646 246.816742 -0.000832 0.006942 NaN NaN NaN 3 762 4 8.632 0.02340 371.870361 0.002203 0.000776 NaN NaN NaN 4 762 5 10.533 0.03110 502.501862 0.001481 0.018102 NaN NaN NaN In [6]: al_df . head () Out[6]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } TESTNUM POINTNUM TIME POSIT FORCE EXT CH5 CH6 CH7 CH8 0 761 1 6.532 0.01524 201.158508 0.018893 -0.023081 NaN NaN NaN 1 761 2 6.702 0.01600 205.978119 0.000265 -0.013024 NaN NaN NaN 2 761 3 7.098 0.01720 219.295441 -0.000877 -0.024879 NaN NaN NaN 3 761 4 8.697 0.02350 268.505890 0.001453 -0.006798 NaN NaN NaN 4 761 5 10.196 0.03004 322.028168 0.001865 0.012563 NaN NaN NaN We see a couple of columns in each data frame. The columns we are interested in are below: FORCE Force measurements from the load cell in pounds (lb) EXT Extension measurements from the mechanical extensometer in percent (%), strain in percent CH5 Extension readings from the laser extensometer in percent (%), strain in percent We will use these columns from the data frames in the following ways: FORCE will be converted to stress using the cross-sectional area of our test samples $$ \\sigma = \\frac{F}{A_0} $$ EXT (mechanical extensometer readings) will be converted into strain on our inset curve $$ \\epsilon_{unitless} = \\epsilon_{\\%} \\times 0.01 $$ CH5 (laser extensometer readings) will be converted into strain on the overall, large stress-strain curve $$ \\epsilon_{unitless} = \\epsilon_{\\%} \\times 0.01 $$ In [7]: strain_al_plastic = al_df [ 'CH5' ] * 0.01 strain_al_elastic = al_df [ 'EXT' ] * 0.01 d_al = 0.506 stress_al = ( al_df [ 'FORCE' ] * 0.001 ) / ( np . pi * (( d_al / 2 ) ** 2 )) strain_steel_plastic = steel_df [ 'CH5' ] * 0.01 strain_steel_elastic = steel_df [ 'EXT' ] * 0.01 d_steel = 0.506 stress_steel = ( steel_df [ 'FORCE' ] * 0.001 ) / ( np . pi * (( d_steel / 2 ) ** 2 )) Build a simple plot Now that we have the data in 6 panda's series, we can build a simple plot. We'll use Matplotlib's object-oriented interface to create two objects, a figure object called fig and an axes object ax1 . Then we can run the .plot() method on our ax1 object and pass in two sets of series. The command plt.show() shows the plot. In [8]: fig , ax1 = plt . subplots () ax1 . plot ( strain_al_plastic , stress_al , strain_steel_plastic , stress_steel ) plt . show () We see a plot (a stress-strain curve) with two lines. Right now, the plot looks pretty bare. We can spruce it up a bit with axis labels, a title, and a legend. Add axis labels, a title, and a legend Next, let's use Matplotlib's object-oriented interface to add axis labels and titles. Below is a chart that relates how to use Matplotlib's plt approach, compared to the object-oriented approach that we'll use. plot component plt approach object-oriented approach x-axis label plt.xlabel('strain') ax.set_xlabel('strain') y-axis label plt.ylabel('stress') ax.set_ylabel('stress') title plt.title('stress-strain curve') ax.set_title('stress-strain curve') legend plt.legend(['Al6061','Steel1045']) ax.legend(['Al6061','Steel1045']) In [9]: fig , ax1 = plt . subplots () fig . set_size_inches ([ 9 , 9 ]) ax1 . plot ( strain_al_plastic , stress_al , strain_steel_plastic , stress_steel ) ax1 . legend ([ 'Al6061' , 'Steel1045' ]) ax1 . set_xlabel ( 'Strain (in/in)' ) ax1 . set_ylabel ( 'Stress (ksi)' ) ax1 . set_title ( 'Stress-Strain Curve of Al6061 and Steel1045 in Tension' ) plt . show () We see a plot with two lines, axis labels, a title, and a legend. Now, onto adding the inset curve! Add the inset curve Next, let's add our inset curve. Our inset curve is a zoomed-in view of the linear elastic region (the far left, almost vertical portion of the stress-strain curves). To create a plot on top of another plot (our inset curve), we'll use Matplotlib's fig.add_axes([ ]) method. This method outputs a new axis object ax2 . ax2 will be the axes that we plot the inset curve on. We can set attributes like .set_xlabel() on our ax2 object to add labels to the axis, a title, and limit the x and y-axis so we only show the left-most portion of the curve. In [10]: fig , ax1 = plt . subplots () fig . set_size_inches ([ 9 , 9 ]) ax1 . plot ( strain_al_plastic , stress_al , strain_steel_plastic , stress_steel ) ax1 . legend ([ 'Al6061' , 'Steel1045' ]) ax1 . set_xlabel ( 'Strain (in/in)' ) ax1 . set_ylabel ( 'Stress (ksi)' ) ax1 . set_title ( 'Stress-Strain Curve of Al6061 and Steel1045 in Tension \\n with inset curve of elastic region' ) left , bottom , width , height = [ 0.5 , 0.5 , 0.25 , 0.25 ] ax2 = fig . add_axes ([ left , bottom , width , height ]) ax2 . plot ( strain_al_elastic , stress_al , strain_steel_elastic , stress_steel ) ax2 . set_xlabel ( 'Strain (in/in)' ) ax2 . set_ylabel ( 'Stress (ksi)' ) ax2 . set_title ( 'Inset of Elastic Region' ) ax2 . set_xlim ([ 0 , 0.008 ]) ax2 . set_ylim ([ 0 , 100 ]) fig . savefig ( 'stress_strain_curve_with_inset.png' ) plt . show () We see a plot that contains an inset curve. The inset curve has two lines, just like the large plot. The inset curve has axis labels and a title. The same colors in the main plot are used in the inset plot. The inset curve shows a zoomed-in view of the larger plot. Note how the x-axis and y-axis limits of the main plot and the inset curve are different. Summary In this post, we plotted a stress-strain curve with Python and Matplotlib then added an inset curve on top of our main plot. We used Matplotlib's object-oriented interface to create the inset curve. The code to remember if you want to add an inset curve on top of a Matplotlib plot is below: fig , ax1 = plt . subplots () ax1 . plot ( x , y ) left , bottom , width , height = [ 0.5 , 0.5 , 0.25 , 0.25 ] # modify to move the inset curve and change its size ax2 = fig . add_axes ([ left , bottom , width , height ]) ax2 . plot ( x , y ) ax2 . set_xlim ([ lower , upper ]) ax2 . set_ylim ([ lower , upper ]) plt . show () Support Want to learn about building more plots with Matplotlib? Check out my book Problem Solving with Python on Amazon ( Affiliate Link ):","tags":"matplotlib","url":"add-inset-curve-to-matplotlib-plot.html","loc":"add-inset-curve-to-matplotlib-plot.html"},{"title":"Crank and Rocker Motion with Python and Matplotlib","text":"Crank and rocker motion is one of the classic types of motion that belongs to a category of 4-bar motion. Crank and rocker motion is the type of motion that a pumpjack goes through when pumping a fluid. In this post, you'll learn how to create an animation of crank and rocker motion using Python and Matplotlib. Set up a Python virtual environment To start this process, we will set up a Python virtual environment. Real Python has a good introduction to virtual environments and why to use them. I use the Anaconda distribution of Python. The Anaconda distribution of Python comes with the very useful Anaconda Prompt. Virtual environments can be created using the Anaconda Prompt. Open the Anaconda Prompt from the Windows Start menu and enter the following commands to create a new virtual environment. > conda create -n piston_motion python=3.8 Now that we have a new clean virtual environment with Python 3.8 installed, we need to install the necessary packages. Note that our virtual environment (piston_motion) is active and shown in parenthesis before the prompt. > conda activate piston_motion (piston_motion) > conda install numpy (piston_motion) > conda install matplotlib (piston_motion) > conda list ... matplotlib==2.0.2 numpy==3.4.2 ... Open a text editor or code editor and create a new Python file called piston_motion.py . A good code editor to use is Visual Studio Code . Visual Studio Code is free and open source. If you installed the Anaconda distribution of Python, you had the option of installing Visual Studio Code. Import NumPy and Matplotlib We will start our crank_and_rocker_motion.py script by importing the necessary packages. # crank_and_rocker_motion.py # import necessary packages import numpy as np from numpy import pi , sin , cos , sqrt , absolute , arccos , arctan , sign import matplotlib.pyplot as plt import matplotlib.animation as animation Define the input parameters To model crank and rocker motion, we need three moving parts. One is the rotating crankshaft. The crankshaft rotates around a central axis with a constant radius. We'll model crankshaft rotation with a line of constant length, one end fixed at the origin and the other rotating in a circle like a hand on a clock. To model this line, we just need two points, the origin at x=0 and y=0 and the end of the line at the point x1 and y1 . We also need to define a crank radius and define the connecting rod length. We'll define the crank radius and connecting rod length constants at the top of our code. Let's also define a fixed number of rotations. Without a fixed number of rotations, our animation will run around and around indefinitely. The rotation increment defines how fine the 'ticks' are when our crankshaft arm rotates. A 'tick' increment of 0.1 results in a smooth animation. # input parameters r = 0.395 # crank radius l = 4.27 # connecting rod length rr = 1.15 # rocker radius d = 4.03 # center-to-center distance rot_num = 6 # number of crank rotations increment = 0.1 # angle incremement over = 1 # if over = 1 --> mechanism is on top, If over = -1, mechanism on bottom s = over / absolute ( over ) Create an array of crankshaft angles Next, we'll create an array of crankshaft rotation angles. As the crankshaft rotates in our animation, each one of these angles will be 'ticked though'. # create the angle array, where the last angle is the number of rotations*2*pi angle_minus_last = np . arange ( 0 , rot_num * 2 * pi , increment ) R_Angles = np . append ( angle_minus_last , rot_num * 2 * pi ) Define the fixed points of the animation Now we need to define a couple of fixed points. The first fixed point is the center of the crankshaft, we'll define this point at the origin x=0,y=0 . The second fixed point is the center of the rocker arm. The center of the rocker arm will have the coordinates x4 and y4 . We'll define the center of the rocker arm at x4 = d (where d is the center-to-center distance between the crank and the rocker) and y4 = 0 . # coordinates of the crank center point : Point 1 x1 = 0 y1 = 0 # Coordinates of the rocker center point: Point 4 x4 = d y4 = 0 Create arrays to save the crankshaft and rocker shaft endpoints Now that the fixed points are defined, we need to create a set of empty arrays which will contain the moving points in our animation. These moving points are: crankshaft x-position crankshaft y-position rocker arm angles rocker arm x-position rocker arm y-position X2 = np . zeros ( len ( R_Angles )) # array of crank x-positions: Point 2 Y2 = np . zeros ( len ( R_Angles )) # array of crank y-positions: Point 2 RR_Angle = np . zeros ( len ( R_Angles )) # array of rocker arm angles X3 = np . zeros ( len ( R_Angles )) # array of rocker x-positions: Point 3 Y3 = np . zeros ( len ( R_Angles )) # array of rocker y-positions: Point 3 Calculate the crankshaft and rocker shaft endpoints Now for the calculations. We have our constants and empty arrays set up. We will loop over each crankshaft angle according to our 'tick' increment. For each crankshaft angle, we calculate the corresponding crankshaft endpoint and the corresponding rocker arm endpoint. These two endpoints are saved in the arrays X2,Y2 and X3,Y3 . # find the crank and connecting rod positions for each angle for index , R_Angle in enumerate ( R_Angles , start = 0 ): theta1 = R_Angle x2 = r * cos ( theta1 ) # x-cooridnate of the crank: Point 2 y2 = r * sin ( theta1 ) # y-cooridnate of the crank: Point 2 e = sqrt (( x2 - d ) ** 2 + ( y2 ** 2 )) phi2 = arccos (( e ** 2 + rr ** 2 - l ** 2 ) / ( 2 * e * rr )) phi1 = arctan ( y2 / ( x2 - d )) + ( 1 - sign ( x2 - d )) * pi / 2 theta3 = phi1 - s * phi2 RR_Angle [ index ] = theta3 x3 = rr * cos ( theta3 ) + d # x cooridnate of the rocker moving point: Point 3 y3 = rr * sin ( theta3 ) # y cooridnate of the rocker moving point: Point 3 theta2 = arctan (( y3 - y2 ) / ( x3 - x2 )) + ( 1 - sign ( x3 - x2 )) * pi / 2 X2 [ index ] = x2 # grab the crankshaft x-position Y2 [ index ] = y2 # grab the crankshaft y-position X3 [ index ] = x3 # grab the connecting rod x-position Y3 [ index ] = y3 # grab the connecting rod y-position Now that our constants and calculations are complete, we can work on setting up the animation. Set up the Matplotlib figure Next, we'll set up our Matplotlib figure. Note that we set aspect=equal . This parameter sets the aspect ratio of our plot as 1-to-1. Without the aspect ratio defined as 1-to-1, the crankshaft will look like an oval and the animation looks quite strange. # set up the figure and subplot fig = plt . figure () ax = fig . add_subplot ( 111 , aspect = \"equal\" , autoscale_on = False , xlim = ( - 2 , 6 ), ylim = ( - 2 , 3 ) ) # add grid lines, title and take out the axis tick labels ax . grid ( alpha = 0.5 ) ax . set_title ( \"Crank and Rocker Motion\" ) ax . set_xticklabels ([]) ax . set_yticklabels ([]) ( line , ) = ax . plot ( [], [], \"o-\" , lw = 5 , color = \"#2b8cbe\" ) # color from: http://colorbrewer2.org/ Create an initialization function and animation function Next, we'll create two functions. The first function init() is an initialization function and will be called at the start of our animation. The second function animate() is the animation function. This is the function that produces the animation. # initialization function def init (): line . set_data ([], []) return ( line ,) # animation function def animate ( i ): x_points = [ x1 , X2 [ i ], X3 [ i ], x4 ] y_points = [ y1 , Y2 [ i ], Y3 [ i ], y4 ] line . set_data ( x_points , y_points ) return ( line ,) Call the animation and show the plot The last part of the code is to call the animation function and show the plot. These two lines of code are the final two lines needed to make our crank and rocker animation work. # call the animation ani = animation . FuncAnimation ( fig , animate , init_func = init , frames = len ( X2 ), interval = 40 , blit = True , repeat = False ) ## to save animation, uncomment the line below. Ensure ffmpeg is installed: ## ani.save('crank_and_rocker_motion_animation.mp4', fps=30, extra_args=['-vcodec', 'libx264']) # show the animation plt . show () Save the final changes to crank_and_rocker_motion.py . We can run our Python script from the Anaconda Prompt. Run the animation Run the animation by calling the crank_and_rocker_motion.py script with the Anaconda Prompt. Make sure you activate in the (piston_motion) virtual environment it is not already active. (piston_motion) > dir crank_and_rocker_motion.py (piston_motion) > python crank_and_rocker_motion.py When the animation runs you will see an example of crank and rocker motion like the video below: Summary In this post, we reviewed how to produce an animation of crank and rocker motion using Python and Matplotlib. First, we created a virtual environment and installed NumPy and Matplotlib into the virtual environment. Then we constructed a crank_and_rocker_motion.py script section by section. Once the crank_and_rocker_motion.py script was complete, we ran the script from the Anaconda Prompt.","tags":"matplotlib","url":"crank-and-rocker-motion-with-python-and-matplotlib.html","loc":"crank-and-rocker-motion-with-python-and-matplotlib.html"},{"title":"What is Ansible?","text":"Ansible is an orchestration tool that can be used to configure cloud servers. This post is about what Ansible is, what Ansible is not, and demystify the vocabulary used to describe what Ansible does. Ansible is an IT Orchestration Tool Ansible is a tool to automate IT orchestration. What does IT orchestration mean? Concerning a personal project: Automating a JupyerHub Deployment- Ansible is a tool to automate setting up the cloud server that runs JupyerHub. So my IT orchestration is setting up JupyerHub to run on a cloud server with all my custom configuration and settings. JupyterHub can be set up by typing all of the commands into an SSH shell and copying over files with FTP. But if JupyterHub gets deployed each quarter, and these commands are the same each quarter, then why not automate the process? Ansible is a run-time that executes automation tasks Ansible is a program that runs on a desktop, laptop, or cloud server that executes automation tasks. The Ansible run-time executes the actions specified by a set of user-defined rules. Ansible is a language used to automate IT tasks The steps Ansible goes through to create, configure and customize cloud servers are specified by valid Ansible syntax. The files a user creates and runs using Ansible must conform to this syntax or they will not be executed. What does Ansible run on? Ansible runs on MacOS, Ubuntu or other Linux distros. Ansible can be run on a local desktop or laptop and also run on a cloud server. It's my understanding that Ansible does not have to be installed on the cloud server that Ansible is configuring. In my case, that means that Ansible does not run on the JupyterHub server. Ansible runs on a laptop, desktop, or cloud server that configures the JupyterHub server. Ansible does not run on Windows. I tried to install Ansible using both pip and conda on a Windows 10 machine. The result was unsuccessful. (ansible) C:\\Users\\student\\staticsite>pip install ansible (ansible) C:\\Users\\student\\staticsite>ansible --version Traceback (most recent call last): File \"C:\\Users\\student\\AppData\\Local\\conda\\conda\\envs\\ansible\\Scripts\\ansible-script.py\", line 44, in <module> from ansible.utils.display import Display File \"C:\\Users\\student\\AppData\\Local\\conda\\conda\\envs\\ansible\\lib\\site-packages\\ansible\\utils\\display.py\", line 21, in <module> import fcntl ImportError: No module named fcntl However, I did get Ansible to successfully install on WSL (Windows Subsystem for Linux). The installation proceeded error-free using the following commands. sudo apt-get update $ sudo apt update $ sudo apt install software-properties-common $ sudo apt-add-repository --yes --update ppa:ansible/ansible $ sudo apt install ansible After Ansible was installed on WSL, the --version attribute returned the output below: peter@DESKTOP-TJDVNOC:~$ ansible --version ansible 2.5.1 config file = /etc/ansible/ansible.cfg configured module search path = [u'/home/peter/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules'] ansible python module location = /usr/lib/python2.7/dist-packages/ansible executable location = /usr/bin/ansible python version = 2.7.15+ (default, Oct 7 2019, 17:39:04) [GCC 7.4.0] Ansible Vocabulary There are a number of words that mean specific things when applied to Ansible. These words include: control node managed node playbook play module task handler inventory Control node A control node is a computer with Ansible installed on it that runs Ansible playbooks and orchestrates cloud servers. In my case, the control node is a laptop or desktop running Windows10 and Windows Subsystem for Linux or a cloud server that sets up a separate JupyterHub cloud server. The control node needs to have Ansible installed on it and it must have access to the internet. Managed node A managed node , or host, is a cloud server that is created, configured, and customized by a control node and a set of pre-defined rules. In my case, the managed node is the cloud server running JupyterHub. In the past, I have run Digital Ocean Cloud servers, so that's probably what I'll use working with Ansible. Playbooks An Ansible playbook is a yaml file that contains human and machine-readable commands to run IT orchestration tasks. Playbooks are saved and run on control nodes. Playbooks are kind of like .py files that run Python code. They are usually more than 5 lines long and less than 200 lines long. A long playbook can be broken up into several smaller playbooks. Play A play is a run of an Ansible playbook or a run of part of a playbook. Running a play is sort of like executing a .py file. Usually, Ansible plays end up changing the state of a cloud server. Tasks Tasks are groups of commands in a playbook. A playbook can contain one or many tasks. Tasks in a play run sequentially. Tasks are a way to break up a playbook into smaller chunks. Modules Tasks contain modules . A module is one command or function the performs one specific action. Ansible modules are comparable to Python functions. Ansible modules can accept extra arguments like some Python functions. There are Ansible modules for installing software, copying files, creating users, starting services, creating files and directories, setting permissions, and a whole host of other tasks. Handlers Handlers are triggered by tasks and are run once at the end of a playbook. A completed play can have one handler or many handlers. Playbook Play1 Task1 Module1 Module2 → Handler Play2 Task1 Module1 Task2 Module1 Module1 → Handler Inventory An inventory is a list of servers (a list of managed nodes) that Ansible is going to set up and configure. The inventory can contain one server or many servers. In my case, the inventory just contains one server, the Digital Ocean cloud server running JupyterHub. Summary of Ansible Vocabulary How about a couple of sentences to bring all these words together: Ansible runs playbooks on a control node that configures managed nodes in your inventory. Playbooks are made up of tasks. Tasks contain modules. Modules complete one specific function on a managed node like install a package or copy a file. Summary In this post, we reviewed what Ansible is: a software package used to set up, configure, and manage cloud servers. We reviewed some Ansible-specific vocabulary like control nodes, managed nodes, playbooks, tasks, and modules. Support Do you find value in blog posts like this? Click the button below to Buy me a Coffee and support the work I do.","tags":"Python","url":"what-is-ansible.html","loc":"what-is-ansible.html"},{"title":"How to change a GitHub repo from master to main","text":"This post is for anyone who wants to change their GitHub repos from master to main . GitHub changed the default repo branch name to main . I want to change all my GitHub repo's default branch from master to main. The short version If you are comfortable with git and the command line, use the commands below. If you need some help and explanation, read on. git branch -m master main git push -u origin main git symbolic-ref refs/remotes/origin/HEAD refs/remotes/origin/main # change default branch on GitHub git push origin --delete master Why does it matter if I use main? The reason to use the name main as the default branch on Github and in your local git repos is that it's the right thing to do. Language in programming, like master , that supports symbols of racism has no place. That's the main reason. In addition, the name main just makes more sense. Is the master branch in charge of anything? Are other branches subservient to it? And a very practical reason is that since GitHub moved to use main as the default branch, you have to remember when to use git push origin main and when to use git push origin master on a repo-to-repo basis. This is confusing and leads to creating new branches that you don't want. So change all of your GitHub repo names to main. Step 1 Create a new main branch locally, taking the history from master The first step is to create a new branch locally (on your computer) called main . You can see which branch you are on using the command below: git branch -a If you are on a branch called master, the output will look something like below: * master remotes/origin/master Next, run the command below to create a new branch called main and copy all the history from the master branch into the new main branch. The -m flag stands for --move , which means move the entire history onto the new branch main from the old branch master . git branch -m master main After you create the new main branch, you can run the git branch -a command again and you should see output similar to below. * main remotes/origin/master Step 2. Push the new main branch up to Github Next, we need to push the new main branch up to Github. If you look at GitHub now, you can see under the branch dropdown menu that master is the default branch. Run the command below to push the main branch up to GitHub. git push -u origin main You may see a message like the one below in your terminal as a result. * [new branch] main -> main Branch 'main' set up to track remote branch 'main' from 'origin'. If you type git branch -a again, now you should see two remote branches, one called main and one called master . * main remotes / origin / main remotes / origin / master If you go back to GitHub and look at the branch name dropdown (you may have to refresh the webpage), you should now see there are two branches main and master . Step 3. Switch HEAD to the main branch Next, we are going to switch the HEAD of our git repo onto the main branch (from the master branch). HEAD is currently attached to master so if we make any changes to the main branch, we'll be ahead of the head . That's not good and leads to git problems that I don't know how to deal with. Type the command below to switch HEAD to the main branch. git symbolic-ref refs/remotes/origin/HEAD refs/remotes/origin/main There won't be any output after running the command. But if you type git branch -a you should see output like below: * main remotes/origin/HEAD -> origin/main remotes/origin/main remotes/origin/master Step 4. Change the default branch on GitHub to main You need to do this on GitHub, not on your local computer. If you go to the main repo page on GitHub and select the branches dropdown menu, you will see two branches listed and a checkmark next to master . We are going to change it so the default repo and the checkmark are next to the main branch. On the main page for your repo, click on settings. Then on the lefthand menu, click on branches Next, click the arrows to change the default branch Accept the warning After the default branch change, you can go back to the main repo page and see that main is now the default branch. Nice job! One more step to get, we just need to get rid of the master branch so that the main branch is the only branch. Step 5. Delete the master branch on Github. Now that we have a main branch on our local computer, a main branch up on GitHub, and the default branch on GitHub is the main branch. The next step is to delete the master branch on GitHub. Right now, if you type the git branch -a command, you'll see output like below: * main remotes/origin/HEAD -> origin/main remotes/origin/main remotes/origin/master We are going to delete remotes/origin/master This can be accomplished by entering the command below. git push origin --delete master As a result, you'll see output similar to below: To github.com:user-name/repo-name.git - [deleted] master If you go back to Github, refresh the page, and select the branch dropdown menu, you should see that the only branch listed is the main branch. Now your master branch has been converted to main . If you run the command git status , you should see output like below. On branch main Your branch is up to date with 'origin/main'. The output indicates that you are on the main branch and from now on you can use git push origin main and git pull origin main for this repo. That's it! You're done. You have successfully moved your GitHub repo from master to main . Bonus What to default to main every time you create a new Git repo locally? Make sure you are on Git version 2.28 or above and use the command below. git --version # git version 2.28.0 or above git config --global init.defaultBranch main Support Thanks for reading! If you want to support the open source work I do (like this blog), consider becoming one of my GitHub sponsors:","tags":"git","url":"how-to-change-a-github-repo-from-master-to-main.html","loc":"how-to-change-a-github-repo-from-master-to-main.html"},{"title":"Git and GitHub for Undergrad Engineers","text":"This post is for first-time users of git. Git is a command-line version control system that allows programmers and engineers to manage file versions and share code. Git can be tricky to use. This post contains solutions to some of the most common problems you may encounter when using Git. What is git ? Git is one of the standard version-control systems used by programmers to save code and work on code collaboratively as a team. Git is a program run on the command line or Anaconda Prompt . If you use Windows, you can download the gitbash program at git-scm.com/downloads . gitbash on Windows allows you to use the same git commands as MacOS and Linux users. Git was created by Linus Torvalds, who also designed the Linux operating system. How do I install git ? Git is installed with the Anaconda distribution of Python. Once Anaconda is installed Anaconda.com/downloads , you can run git from the Anaconda Prompt. Git can also be run on Windows using the gitbash program. Gitbash can be downloaded from git-scm.com/downloads . What is GitHub? GitHub.com (now owned by Microsoft) is a website and service used by programmers and open source projects to share code and allow contributors to propose changes to existing code. GitHub is free if you are willing to share your code publicly. git and GitHub terminology Before using git and GitHub.com, it is helpful to understand a couple of terms: git - a command-line program used to track file changes and collaborate on code with others. Command Line a programming terminal where commands are entered as text. repo - short name for \"repository\". A repo is a directory and its contents that git knows about. local repo - a directory and its contents on your computer that git knows about. Local repos are folders and the contents in those folders. remote repo - a directory and its contents stored in the cloud that git knows about. GitHub.com is a site where remote repos are stored. Common git commands A selection of useful git commands are summarized below: git clone https://github.com/user/repo.git copy a remote repo from GitHub.com into a local directory git init create a new local repo in the current folder git remote add origin https://github.com/user/repo.git link a local repo to a remote repo on GitHub.com git add . add all files and changes to the local repo git commit -m \"commit message\" commit the changes in the local repo with the message \"commit message\" git push origin main push local changes up to the remote repo* git pull origin main pull down the version in the remote repo into the local repo* GitHub, as part of their move to use more inclusive language, re-named the default branch to main for any new repo. You can read about the change here How do I copy the contents of a repo on GitHub? A common task is to accomplish with git is to copy a repo from GitHub.com onto your local computer. In this example, we are going to copy all the files in the piston_motion repo on GitHub.com onto our local computer. Go to this link on Github: https://github.com/ProfessorKazarinoff/piston_motion You see the Piston Motion repo on GitHub.com. The Piston Motion repo contains a couple of files: LICENSE README.md piston_motion.md piston_motion.mp4 piston_motion.py If you want to use the code in Piston Motion remote repo stored on GitHub.com, you can click on piston_motion.py and copy all of the code into a new file and then save the file. You could also click on README.md and copy all of the code into a new file and then save the file. Then click on piston_motion.md and copy all the code into a new file and then save the file... That is a lot of copying and pasting. Kind of a pain. An easier way to accomplish the same task is to use the git clone command. Open the Anaconda Prompt, or gitbash and type the following command, then press [Enter]. git clone https://github.com/ProfessorKazarinoff/piston_motion This command copies the repo named piston_motion to your local computer. Now you have a new piston_motion folder on your computer. If you open the piston_motion folder in a file browser, you will see the following files. piston_motion/ ├── LICENSE ├── README.md ├── piston_motion.md ├── piston_motion.mp4 └── piston_motion.py How do I clone a repo into a specific folder? What if you want all the code from the piston_motion repo, but you don't want that code to end up in a folder called piston_motion ? Running git clone creates a new folder with the repo contents inside it. git clone does not copy the contents of the repo into the current folder (it creates a new folder that contains the repo contents). But, you can make the folder that the repo contents get copied into any name you want. Say you want to copy the piston_motion repo into a folder called github_examples . The command below copies the contents of the piston_motion repo on GitHub.com into a folder on your local computer called github_examples . git clone https://github.com/ProfessorKazarinoff/piston_motion.git github_examples If you open the folder github_examples , you see the same code you downloaded into the piston_motion folder. github_examples/ ├── LICENSE ├── README.md ├── piston_motion.md ├── piston_motion.mp4 └── piston_motion.py Creating and synching a remote repo on GitHub.com with a local repo Another common task to complete with git is to synch a remote repo on GitHub.com with a local repo on your local computer. This is useful when you want to keep the files in a particular project synced across multiple computers. Synched remote and local repos are also useful for a group of problem solvers working on the same project. Each team member has access to the same remote repo on GitHub.com and each team member has the same local repo on their computer. Create a remote repo on GitHub.com First, go to GitHub.com/join and create a new account. Log in and create a new repo. It is a good idea to include a license and a .gitignore file. For a Python project, the .gitignore file for Python is a good start. Two common licenses for open source projects (projects you are willing to share with others) are the GNU General Public License v3.0 and the MIT License . Make a new local repo and link the local repo to the remote repo on GitHub.com Second, create a local directory and cd into it. Initialize a git repo locally in that directory. Then sync the local folder with the remote repo on GitHub.com. $ mkdir newproject $ cd newproject $ git init $ git remote add origin https://github.com/user/repo.git $ git checkout main $ git pull origin main Add, commit and push changes up to Github.com Third, work on the project locally. For example, you could edit one of the files in the directory newproject or create a new file in the directory newproject . Finally, save your work and commit the changes you made with git . Push those changes up to the remote repo on GitHub.com $ git add . $ git commit -m \"commit message\" $ git push origin main Pull the most recent version from GitHub.com before each work session If using git and GitHub.com, remember to pull the most recent version of the repo down from GitHub.com before you make any changes locally. If changes are made locally before the version of the repo on GitHub.com is synched, the local repo and remote repo will be out of synch. $ git pull origin main After local changes are made, save the changes and push them to GitHub.com $ git add . $ git commit -m \"commit message\" $ git push origin main What is .gitignore and why do I need it? The .gitignore file contains a list of files and folders that git will \"ignore\". This means the files and folders specified in the .gitignore files will not be copied up to GitHub.com. This is useful for a couple of reasons. One reason is that Python creates some files automatically when a program runs. These files don't need to be saved as part of the GitHub.com repo. Another reason to add a fit to the .gitignore file is that you might have files in your local git repo that you don't want to share publicly. A file that contains usernames, passwords, or API keys should never be stored on GitHub.com. You can add a file that contains private information to .gitignore then the file won't be saved up on GitHub where anyone on the internet can see it. Support Thanks for reading! If you want to support the open source work I do (like this blog), consider becoming one of my GitHub sponsors:","tags":"git","url":"git-and-github-for-undergrad-engineers.html","loc":"git-and-github-for-undergrad-engineers.html"},{"title":"How to make animated plots with Matplotlib and Python","text":"Python and Matplotlib can be used to create static 2D plots. But it Matplotlib can also be used to create dynamic auto-updating animated plots . In this post, you learn how to create a live auto-updating animated plot using Python and Matplotlib. Table of contents: Pre-requisits Set up a Python virtual environment Install Python packages Create a static line plot Import packages Create an animated line plot Build a live plot based on user input Build a live plot using data from the web Build a live plot using data from a sensor Hardware Hookup Arduino Code Python Code Summary Support Pre-requisits To follow along with this tutorial, a couple of pre-requisites need to be in place: Python needs to be installed on your computer. I recommend installing the Anaconda Distribution of Python. You are running a version of Python 3.6 or above. Python version 3.7 or 3.8 are more up-to-date and recommended. You know how to open the Anaconda Prompt on Windows10 or know how to open a terminal on MacOS or Linux. You have a general idea of what Python packages are and have installed a Python package before using conda or pip . You know how to create a text file in an editor or an IDE (integrated development environment) such as Visual Studio Code , PyCharm, Sublime Text, vim, emacs, etc. I will be using Visual Studio Code (also called VS Code) in this post, but any regular code editor will work. You know how to run a Python program (execute a .py file) using a terminal prompt, like the Anaconda Prompt, or know how to run a Python program using your IDE. You have a general understanding of how files are organized on your computer into directories and sub-directories. You have some familiarity with navigating through directories and files using a terminal or the Anaconda Prompt with commands like cd , cd .. , dir or ls , and mdkir . Now that the pre-requisites are out of the way, let's start coding! Set up a Python virtual environment To start the coding process, we will set up a new Python virtual environment. Real Python has a good introduction to virtual environments and why to use them. I recommend undergraduate engineers use the Anaconda distribution of Python which comes with the Anaconda Prompt . You can create a new virtual environment by opening the Anaconda Prompt and typing: Using the Anaconda Prompt: > mkdir live_plot > cd live_plot > conda create -y -n live_plot python=3.7 Alternatively, on MacOS or Linux, a virtual environment can be set up with a terminal prompt and pip (the Python package manager). Using a terminal on MacOS or Linux: $ mkdir live_plot $ cd live_plot $ python3 -m venv venv Install Python packages Now that we have a new clean virtual environment with Python 3 installed, we need to install the necessary packages that we'll use to create our plots. Using the Anaconda Prompt, activate the live_plot virtual environment and use conda to install the following Python packages. Ensure the virtual environment you created above is activate when the packages are installed. > conda activate live_plot (live_plot)> conda install -y matplotlib requests pyserial Alternatively, if you are using MacOS or Linux, the packages can be installed with a terminal pip : $ source venv/bin/activate (venv) $ pip install matplotlib (venv) $ pip install requests (venv) $ pip install pyserial Create a static line plot Before we create a live animated auto-updating plot, let's first create simpler static, non-moving line plot. Our live plots will look a lot like this first static plot, except in the live plot, the line on the plot will move. Coding a simpler plot first gives us some practice and a structure to build upon when we create the more complex live plots. Open a text editor or IDE (I like to use VS Code ) and create a new Python file called static_plot.py Import packages Let's start our static_plot.py script by importing the packages we'll use later in the script. Matplotlib's pyplot module is imported using the standard alias plt . # static_plot.py # import necessary packages import matplotlib.pyplot as plt We need some data to plot. For this first static plot, we'll plot the temperature in Portland, OR in degrees Fahrenheit over seven days. We'll save the temperatures in a Python list called data_lst . # data data_lst = [ 60 , 59 , 49 , 51 , 49 , 52 , 53 ] Next, we'll create a figure object fig and an axis object ax using Matplotlib's plt.subplots() method. # create the figure and axis objects fig , ax = plt . subplots () Now we can plot the temperature data on the axis object ax and customize the plot. Let's include plot title and axis labels. # plot the data and customize ax . plot ( data_lst ) ax . set_xlabel ( 'Day Number' ) ax . set_ylabel ( 'Temperature (*F)' ) ax . set_title ( 'Temperature in Portland, OR over 7 days' ) Finally, we can show and save the plot. Make sure that the fig.savefig() line is before the plt.show() line. # save and show the plot fig . savefig ( 'static_plot.png' ) plt . show () That's it for this first script. Pretty simple right? Run the static_plot.py script using the Anaconda Prompt of a terminal. Ensure the virtual environment (live_plot) is active when the script is run. (live_plot)> python static_plot.py The plot should look something like the image below: The complete script is below: # static_plot.py # import necessary packages import matplotlib.pyplot as plt # data data_lst = [ 60 , 59 , 49 , 51 , 49 , 52 , 53 ] # create the figure and axis objects fig , ax = plt . subplots () # plot the data and customize ax . plot ( data_lst ) ax . set_xlabel ( 'Day Number' ) ax . set_ylabel ( 'Temperature (*F)' ) ax . set_title ( 'Temperature in Portland, OR over 7 days' ) # save and show the plot fig . savefig ( 'static_plot.png' ) plt . show () Next, we'll build an animated line plot with Matplotlib. Create an animated line plot The previous plot we just built was a static line plot. We are going to build upon that static line plot and create an animated line plot. The data for the animated line plot will be generated randomly using Python's randint() function from the random module in the Standard Library. Python's randint() function accepts a lower limit and upper limit. We will set a lower limit of 1 and an upper limit of 9 . The script to build the animated line plot starts almost the same way as our simple line plot, the difference is that we need to import Matplotlib's FuncAnimation class from the matplotlib.animation library. The FuncAnimation class will be used to create the animated plot. # animated_line_plot.py from random import randint import matplotlib.pyplot as plt from matplotlib.animation import FuncAnimation # create empty lists for the x and y data x = [] y = [] # create the figure and axes objects fig , ax = plt . subplots () In our first static line plot, we started the plot at this point, but for the animated line plot, we need to build the plot in a function . At a minimum, the function that builds the plot needs to accept one argument that corresponds to the frame number in the animation. This frame number argument can be given a simple parameter like i . That parameter does not have to be used in the function that draws the plot. It just has to be included in the function definition. Note the line ax.clear() in the middle of the function. This line clears the figure window so that the next frame of the animation can be drawn. ax.clear() needs to be included before the data is plotted with the ax.plot() method. Also, note that plt.show() is not part of the function. plt.show() will be called outside the function at the end of the script. # function that draws each frame of the animation def animate ( i ): pt = randint ( 1 , 9 ) # grab a random integer to be the next y-value in the animation x . append ( i ) y . append ( pt ) ax . clear () ax . plot ( x , y ) ax . set_xlim ([ 0 , 20 ]) ax . set_ylim ([ 0 , 10 ]) OK- our animate() function is defined, now we need to call the animation. Matplotlib's FuncAnimation class can accept several input arguments. At a minimum, we need to pass in the figure object fig , and our animation function that draws the plot animate to the FuncAnimation class. We'll also add a frames= keyword argument that sets many times the plot is re-drawn meaning how many times the animation function is called. interval=500 specifies the time between frames (time between animate() function calls) in milliseconds. interval=500 means 500 milliseconds between each frame, which is half a second. repeat=False means that after all the frames are drawn, the animation will not repeat. Note how the plt.show() line is called after the FuncAnimation line. # run the animation ani = FuncAnimation ( fig , animate , frames = 20 , interval = 500 , repeat = False ) plt . show () You can run the animated_line_plot.py script using the Anaconda Prompt or a terminal. (live_plot)> animated_line_plot.py An example of the plot animated line plot produced is below. Next, we'll build a live auto-updating plot based on user input. Build a live plot based on user input Create a new Python file called live_plot_user_input.py using a code editor or IDE. In the file live_plot_user_input.py , add the same imports we used in our previous plot: Matplotlib's pyplot library is imported as plt and Matplotlib's FuncAnimation class is imported from the matplotlib.animation library. Like the previous plot, we'll use the FuncAnimation class to build our live auto-updating plot and create an animation() function to draw the plot. # live_plot_user_input.py # import necessary packages import matplotlib.pyplot as plt from matplotlib.animation import FuncAnimation Next, we'll pre-populate a list called data with a couple of data points. This will gives our plot a couple of points to start off with. When our script runs, we'll include functionality to add more points. # initial data data = [ 3 , 6 , 2 , 1 , 8 ] # create figure and axes objects fig , ax = plt . subplots () Now we'll build an animate() function that will read in values from a text file and plot them with Matplotlib. Note the line ax.clear() . This line of code clears the current axis so that the plot can be redrawn. The line ax.plot(data[-5:]) pulls the last 5 data points out of the list data and plots them. # animation function def animate ( i ): with open ( 'data.txt' , 'r' ) as f : for line in f : data . append ( int ( line . strip ())) ax . clear () ax . plot ( data [ - 5 :]) # plot the last 5 data points The last section of code in the live_plot_user_input.py script calls the FuncAnimation class. When we instantiate an instance of this class, we pass in a couple of arguments: fig - the figure object we created with the plt.subplots() method animate - the function we wrote above that pulls lines out of a data.txt file and plots 5 points at a time. interval=1000 - the time interval in milliseconds (1000 milliseconds = 1 second) between frames or between animate() function calls. # call the animation ani = FuncAnimation ( fig , animate , interval = 1000 ) # show the plot plt . show () Before you run the script, create a new file in the live_plot directory alongside our live_plot_user_input.py script called data.txt . Inside the file add a couple of numbers, each number on one line. 5 9 3 10 12 Save data.txt and leave the file open. This is the file that we will add numbers to and watch our live plot update. Save live_plot_user_input.py and run it. You should see a plot pop up. Now add a number to the bottom of the data.txt on a new line. Save data.txt . The plot should update with a new data point. I added the number 16 to data.txt and saw the line on the plot go upwards. Add another number at the end of data.txt . Save data.txt and watch the plot update. Great! We built a live-updating plot based on user input! Next, let's build a live auto-updating plot using data pulled from the web. Build a live plot using data from the web The third plot we are going to build is a plot that pulls data from the web. The basic structure of the script is the same as the last two animated plots. We need to create figure and axis objects, write an animation function and create the animation with FuncAnimation . https://qrng.anu.edu.au/API/api-demo.php The website notes: This website offers true random numbers to anyone on the internet. The random numbers are generated in real-time in our lab by measuring the quantum fluctuations of the vacuum. Having true random numbers for an animated plot isn't absolutely necessary. The reason I picked this web API is that the random numbers can be polled every second, and since you can specify an 8-bit integer, the random numbers have a fixed range between 0 and 255. The code below calls the web API for one 8-bit random integer. A little function converts the web API's JSON response into a float. The raw JSON that comes back from the API looks like below: { \"type\" : \"uint8\" , \"length\" : 1 , \"data\" :[ 53 ], \"success\" : true } Once the JSON is converted to a Python dictionary, we can pull the random number out (in this case 53 ) with the following Python code. json_dict [ \"data\" ][ 0 ] The entire script is below. # plot_web_api_realtime.py \"\"\" A live auto-updating plot of random numbers pulled from a web API \"\"\" import time import datetime as dt import requests import matplotlib.pyplot as plt import matplotlib.animation as animation url = \"https://qrng.anu.edu.au/API/jsonI.php?length=1&type=uint8\" # function to pull out a float from the requests response object def pull_float ( response ): jsonr = response . json () strr = jsonr [ \"data\" ][ 0 ] if strr : fltr = round ( float ( strr ), 2 ) return fltr else : return None # Create figure for plotting fig , ax = plt . subplots () xs = [] ys = [] def animate ( i , xs : list , ys : list ): # grab the data from thingspeak.com response = requests . get ( url ) flt = pull_float ( response ) # Add x and y to lists xs . append ( dt . datetime . now () . strftime ( '%H:%M:%S' )) ys . append ( flt ) # Limit x and y lists to 10 items xs = xs [ - 10 :] ys = ys [ - 10 :] # Draw x and y lists ax . clear () ax . plot ( xs , ys ) # Format plot ax . set_ylim ([ 0 , 255 ]) plt . xticks ( rotation = 45 , ha = 'right' ) plt . subplots_adjust ( bottom = 0.20 ) ax . set_title ( 'Plot of random numbers from https://qrng.anu.edu.au' ) ax . set_xlabel ( 'Date Time (hour:minute:second)' ) ax . set_ylabel ( 'Random Number' ) # Set up plot to call animate() function every 1000 milliseconds ani = animation . FuncAnimation ( fig , animate , fargs = ( xs , ys ), interval = 1000 ) plt . show () An example of the resulting plot is below. Next, we will build a live plot from sensor data Build a live plot using data from a sensor The final live auto-updating animated plot we are going to build will show sensor data streaming in from an Arduino. Since this post is about live plots, I will not go into detail about how to connect the sensor to the Arduino or how an Arduino works. For more details on Arduinos, see this post on: Using Python and an Arduino to Read a Sensor Very briefly, the sensor we are using in this example is a little blue potentiometer. A potentiometer is a dial that you can turn back and forth. When the dial of a potentiometer is turned, the resistance of the potentiometer changes. Hardware Hookup Hook up a potentiometer up to an Arduino based on the diagram below. Arduino Code After the little blue potentiometer is hooked up, Upload the following code on the Arduino. This code reads the potentiometer value and sends the measured value over the serial line. // potentiometer.ino // reads a potentiometer and sends value over serial int sensorPin = A0; // The potentiometer is connected to analog pin 0 int ledPin = 13; // The LED is connected to digital pin 13 int sensorValue; // an integer variable to store the potentiometer reading void setup() // this function runs once when the sketch starts { // make the LED pin (pin 13) an output pin pinMode(ledPin, OUTPUT); // initialize serial communication at 9600 baud Serial.begin(9600); } void loop() // this function runs repeatedly after setup() finishes { sensorValue = analogRead(sensorPin); // read the voltage at pin A0 Serial.println(sensorValue); // Output voltage value to Serial Monitor if (sensorValue < 500) { // if sensor output is less than 500, digitalWrite(ledPin, LOW); } // Turn the LED off else { // if sensor output is greater than 500 digitalWrite(ledPin, HIGH); } // Keep the LED on delay(100); // Pause 100 milliseconds before next reading } Python Code The PySerial library needs to be installed before we can use PySerial to read the sensor data the Arduino spits out over the serial line. Install PySerial with the command below. Make sure you activated the (live_plot) virtual environment when the install command is entered. (live_plot)> conda install -y pyserial or (venv)$ pip install pyserial At the top of the Python script, we import the necessary libraries: # live_plot_sensor.py import time import serial import matplotlib.pyplot as plt import matplotlib.animation as animation Next, we need to build an animate() function like we did above when we build our live plot from a data file and our live plot from a web API. # animation function def animate ( i , data_lst , ser ): # ser is the serial object b = ser . readline () string_n = b . decode () string = string_n . rstrip () flt = float ( string ) data_lst . append ( flt ) # Add x and y to lists data_lst . append ( flt ) # Limit the data list to 100 values data_lst = data_lst [ - 100 :] # clear the last frame and draw the next frame ax . clear () ax . plot ( data_lst ) # Format plot ax . set_ylim ([ 0 , 1050 ]) ax . set_title ( 'Potentiometer Reading Live Plot' ) ax . set_ylabel ( 'Potentiometer Reading' ) Now we need to create our data_lst , fig and ax objects, as well as instantiate the serial object ser . Note that the COM# will may be different for you based on which COM port the Arduino is connected to. On MacOS or Linux, the com port will be something like /dev/ttyUSB0 instead of COM7 . If you are using MacOS or Linux, you may need to modify the permissions of the com port before the script will run. The command sudo chown root:peter /dev/ttyUSB0 changes the group corresponding to ttyUSB0 to peter . You will have to modify this command based on your MacOS or Linux username and port number. # create empty list to store data # create figure and axes objects data_lst = [] fig , ax = plt . subplots () # set up the serial line ser = serial . Serial ( 'COM7' , 9600 ) # change COM# if necessary time . sleep ( 2 ) print ( ser . name ) Then we need to call our animation using Matplotlib's FuncAnimate class. After the animation is finished, we should close the serial line # run the animation and show the figure ani = animation . FuncAnimation ( fig , animate , frames = 100 , fargs = ( data_lst , ser ), interval = 200 ) plt . show () # after the window is closed, close the serial line ser . close () print ( \"Serial line closed\" ) The entire Python script is below: # live_plot_sensor.py import time import serial import matplotlib.pyplot as plt import matplotlib.animation as animation # animation function def animate ( i , data_lst , ser ): # ser is the serial object b = ser . readline () string_n = b . decode () string = string_n . rstrip () try : flt = float ( string ) data_lst . append ( flt ) data_lst . append ( flt ) except : pass # Add x and y to lists # Limit the data list to 100 values data_lst = data_lst [ - 100 :] # clear the last frame and draw the next frame ax . clear () ax . plot ( data_lst ) # Format plot ax . set_ylim ([ 0 , 1050 ]) ax . set_title ( \"Potentiometer Reading Live Plot\" ) ax . set_ylabel ( \"Potentiometer Reading\" ) # create empty list to store data # create figure and axes objects data_lst = [] fig , ax = plt . subplots () # set up the serial line ser = serial . Serial ( \"/dev/ttyUSB0\" , 9600 ) # change COM# if necessary time . sleep ( 2 ) print ( ser . name ) # run the animation and show the figure ani = animation . FuncAnimation ( fig , animate , frames = 100 , fargs = ( data_lst , ser ), interval = 100 ) plt . show () # after the window is closed, close the serial line ser . close () print ( \"Serial line closed\" ) Run the script using the Anaconda Prompt or a terminal: (live_plot)> python live_plot_sensor.py Twist the little blue potentiometer while the script is running and watch the animated line on the plot update. Summary In this post, we created a couple of live auto-updating animated line plots with Matplotlib. The key to building animated plots with Matplotlib is to define the plot in an animation function and then call your animation function with Matplotlib's FuncAnimation class. Support What to learn about building other types of plots with Matplotlib? Check out my book Problem Solving with Python on Amazon ( Affiliate Link ):","tags":"matplotlib","url":"live-plotting-with-matplotlib.html","loc":"live-plotting-with-matplotlib.html"},{"title":"Calculating Vacancy Concentration with Python","text":"In this post, we will complete a problem that might come up in an introductory Materials Science and Engineering class. We'll calculate the number of vacancy defects in a material using Python. The following is a calculation of the number of vacancy defects in a material. All crystalline and poly-crystalline materials at temperatures above absolute zero contain vacancy defects. We can calculate the number of vacancies present in a material using the vacancy concentration equation below: $$ \\frac{n_v}{n} = e&#94;{\\frac{-Q_v}{RT}} $$ Where $n_v$ is the number of vacancies, $n$ is the number of potential vacancy sites, $e$ is Euler's Number (the mathematical constant $e$), $Q_v$ is the activation energy of vacancy formation, $R$ is the universal gas constant and $T$ is the temperature (in Kelvin). The problem we are going to solve using the vacancy concentration equation is shown below. Given: A sample of 1 m 3 of Cu (copper) is at 1000 °C Density $\\rho$ = 8.4 g/cm 3 Activation energy of vacancy formation $Q_v$ = 86.7 kJ/mol Molar mass of Cu $A$ = 63.5 g/mol Avagodro's Number $N_a$ = 6.02 × 10 23 atoms/mol Universal Gas Constant $R$ = 8.31 J/mol K Find: Find the equalibrium number of vacancies in 1 m 3 of Cu at 1000 °C. Solution: Let's begin our solution by looking at the vacancy concentration equation. $$ \\frac{n_v}{n} = e&#94;{\\frac{-Q_v}{RT}} $$ We can use the vacancy concentration equation to solve for the number of vacancies $n_v$. $$ n_v = ne&#94;{\\frac{-Q_v}{RT}} $$ We have values for: $Q_v$, $R$ and $T$. But we still need to calculate $n$, the number of potential defect sites. After we calculate $n$, we can use the equation above to calculate $n_v$. We'll start our first bit of Python code by including imports. Imports We are going to have to use Python's exp function, which raises $e$ to a power, to solve this problem. The exp function is part of Python's math module and is included in the Python Standard Library. In Python programs, the common convention is to list imports at the top of the script. The line below imports the exp function from the math module. In [1]: from math import exp Find the number of copper atoms in 1 m 3 of copper In order to find the number of copper atoms in 1 m 3 of copper, we need to make an assumption. Let's assume that $n$, the number of potential defect sites, is approximately equal to the number of copper atoms in the sample total. This assumption could turn out to be problematic. Copper at room temperature does contain defects, so the number of atoms isn't exactly the same as the number of potential defect sites. However, our given parameters only have 2 or 3significant figures. If the number of copper atoms and the number of potential defect sites is equivalent within 2 or 3 significant figures, our assumption will hold for this problem. In order to find $n$ the number of copper atoms in 1 m 3 of copper we need to convert 1 m 3 of copper into the number of cm 3 of copper using the conversion factor 1 m = 100 cm. Next, we can calculate the number of grams of copper using the density of copper, $\\rho$, given in the problem. After that, we can use the molar mass of copper, $A$, given in the problem, to calculate the number of moles of copper. Finally, we can calculate the number of atoms of copper $n$, using Avagadro's Number, $Na$. The calculation is completed below in Python. In [2]: # find the number of atoms of copper using the volume of copper, molar mass of copper the density and avagadros number v_Cu_m3 = 1 # volume of Cu in m&#94;3 v_Cu_cm3 = v_Cu_m3 * ( 100 ** 3 / 1 ** 3 ) # volume of Cu in cm&#94;3 p = 8.4 # density of Cu in g/cm3 m_Cu_g = v_Cu_cm3 * ( p ) # mass of Cu in g A = 63.5 # g/mol molar mass of Cu from the periodic table mol_Cu = m_Cu_g / A # mol of Cu Na = 6.02 * 10 ** 23 # Avagadros Number, atoms/mol atoms_Cu = mol_Cu * Na # number of atoms Cu n = atoms_Cu # number of potential defect sites is the number of Cu atoms print ( n ) 7.963464566929133e+28 This means the number of potential defect sites in 1 m 3 of copper is 7.963464566929133e+28 . That's a lot of potential sites for defects. Find the number of vacancy defects in 1 m 3 of copper Now we have all of the values we need to calculate the number of vacancy defects in 1 m 3 of copper using the equation below: $$ n_v = ne&#94;{\\frac{-Q_v}{RT}} $$ We just need to be careful with units. In the Given portion of this problem, $Q_v$ the activation energy of vacancy formation, has units of kJ/mol. The Universal Gas constant $R$, given in the problem has units of J/mol K. And the temperature $T$ given in the problem is in units of °C. In order for the expression below (which is the exponent of the equation above) to end up unitless: $$ \\frac{-Q_v}{RT} $$ We need to convert $Q_v$ into units of J/mol K and convert $T$ into units of Kelvin. Then we can plug the values into the vacancy concentration equation and make our final calculation. In [3]: # find the number of vacancies, n_v using number of atoms n, Qv, R, and T # n_v = ne&#94;(-Qv/RT) Qv_kJpermol = 86.7 # activation energy of vacancy formation in kJ/mol Qv = Qv_kJpermol * 1000 # activation energy of vacancy formation in J/mol R = 8.31 # Universal Gas Constant in J/mol K T_C = 1000 # Temperature in *C T = T_C + 273 # Temperature in K n_v = n * exp ( - Qv / ( R * T )) # number of vacancies, unitless print ( n_v ) 2.1964692178195925e+25 Great! The number of vacancies in 1 m 3 of copper is 2.1964692178195925e+25 . That's a pretty big number, but it is three orders of magnitude less than the number of potential defect sites. We are almost done. All we need to do now is round our answer to the proper number of significant figures and print it out. Round to the proper number of significant figures and print out the final answer The last thing we need to do is round the final answer to the proper number of significant figures (sig figs). If we look back at the given values in our problem, we can determine the number of significant figures in each known parameter: Temperature $T$ = 1000 °C - 1,2,3 or 4 sig figs Density $\\rho$ = 8.4 g/cm 3 - 2 sig figs Activation energy of vacancy formation $Q_v$ = 86.7 kJ/mol - 3 sig figs Molar mass of Cu $A$ = 63.5 g/mol - 3 sig figs Avagodro's Number $N_a$ = 6.02 × 10 23 atoms/mol - 3 sig figs Universal Gas Constant $R$ = 8.31 J/mol K - 3 sig figs The minimum number of significant figures is in the Density $\\rho$ = 8.4 g/cm 3 - 2 sig figs. Therefore, we will round our final answer to 2 significant figures. We can print out our final answer using a Python f-string. Note how the character f' ' is added before the quotation marks. A little trick in the code below is in the expression: {n_v:.1e} Since the expression is inside a set of curly braces of an f-string, the value of the variable n_v will be printed out. The :.1e after the variable is a bit of string formating. It specifies one number after the decimal point ( .1 ) and scientific notation e . The result is our final answer printed to 2 significant figures. In [4]: print ( f 'The number of vacancies in 1 m&#94;3 of Cu at 1000*C is: {n_v:.1e} ' ) The number of vacancies in 1 m&#94;3 of Cu at 1000*C is: 2.2e+25 Conclusion In this problem, we calculated the equilibrium number of vacancies in 1 m 3 of copper at 1000 °C. We completed the problem by first calculating the number of atoms in 1 m 3 of copper using density and molar mass. Then we assumed the number of atoms in 1 m 3 is approximately equal to the number of potential atomic vacancy sites in 1 m 3 . Finally, we used the number of potential defect sites to calculate the number of vacancies in 1 m 3 of copper using the vacancy concentration equation.","tags":"material science","url":"calculating-vacancy-concentration-with-python.html","loc":"calculating-vacancy-concentration-with-python.html"},{"title":"Offset Piston Motion with Python and Matplotlib","text":"Offset piston motion is one of the classic types of engineering dynamics motion that belong to a category of 4-bar motion. Piston motion is the type of motion that the piston in a cylinder of a car engine goes through as the crankshaft rotates. Offset piston motion has the same type of motion, but the centerline of the piston is not in line with the center of the crankshaft. This type of offset piston/crankshaft geometry is sometimes used in automobile engines. For example, some Toyota automobile engines have an offset piston geometry. Table of contents: Set up a Python virtual environment Windows 10 MacOS or Linux Install Python packages Windows 10 MacOS and Linux Start the script with imports Initial Parameters Create arrays of angles and points Loop through angles Create the Matplotlib figure and plot Initialization function Animation function Call the animation and show the plot Run the script The resulting animation The complete code Set up a Python virtual environment To start this process, we will set up a Python virtual environment. Real Python has a good introduction to virtual environments and why to use them. Windows 10 I use Windows 10 and the Anaconda distribution of Python . Virtual environments can be created on Windows 10 using the Anaconda Prompt Type into the Anaconda Prompt on Windows: > conda create -y -n offset_piston_motion python=3.7 MacOS or Linux If you are using MacOS or Linux, a terminal can be used to create a Python virtual environment. Type into a terminal on MacOS or Linux: $ mkdir offset_piston_motion $ cd offset_piston_motion $ python3 -m venv venv Install Python packages Now that we have a new clean virtual environment with Python 3 installed, we need to install a couple of Python packages: Matplotlib and NumPy. Before the Python packages are installed, we have to make sure that the virtual environment we just created is active . The active virtual environment is the virtual environment the packages will be installed into. Windows 10 On Windows 10, where the virtual environment was created with conda and the Anaconda Prompt , type the commands below to install the necessary packages. > conda activate offset_piston_motion (offset_piston_motion) > conda install -y numpy matplotlib MacOS and Linux On MacOS or Linux, the command to activate the virtual environment is a little different. Also, on MacOS and Linux, you can use the Python package manager pip to install the Python packages (on Windows, I recommend using conda to install packages) $ source venv/bin/activate (venv) $ pip install numpy matplotlib Start the script with imports Open a text editor (like VS Code or PyCharm ) and create a new Python file called offset_piston_motion.py At the top of the offset_piston_motion.py script, we'll start by importing the necessary modules. In this section of code, we import NumPy as np and also import a couple of trig functions from NumPy. We will use NumPy's trig functions (instead of the trig functions in Python's Standard Library math module) because the trig functions need to operate on arrays of numbers. From Matplotlib, a Python plotting library, we'll import the pyplot and animation modules. # import the necessary packages import numpy as np from numpy import pi , sin , cos , sqrt import matplotlib.pyplot as plt import matplotlib.animation as animation Initial Parameters To model offset piston motion we need to have two moving parts: a crankshaft and a connecting rod. The crankshaft rotates around a central axis with a constant radius. We'll model this rotation with a line of constant length, one end fixed at the origin and the other rotating in a circle like a hand on a clock. To model this crankshaft line, we just need two points, the origin at x=0 and y=0 and the end of the line at the point x1 and y1 . We also need to define a crank radius and a connecting rode length. To ensure the animation does not run indefinitely, we will set a fixed number of rotations. The rotation increment defines how fine the 'ticks' there are as our crankshaft arm rotates. A rotation increment of 0.1 works to make our animation run smoothly enough. For offset piston motion (compared to regular piston motion), one last parameter we need to define is the offset distance. The offset distance is the horizontal distance between the vertical line that goes through the center of the crankshaft and the vertical line that goes through the end of the connecting rod. In regular piston motion, the offset distance is zero. In offset piston motion, this offset distance is non-negative. # input parameters r = 1.0 # crank radius l = 4.0 # connecting rod length d = 0.5 # offset distance rot_num = 6 # number of crank rotations increment = 0.1 # angle incremement Create arrays of angles and points Next, we will create a couple of arrays of angles and points. NumPy's np.arange() optionally accepts three arguments (start,stop,step) . Note that the stop value is not included in the array, so we append our stop value onto the end of the angles array with NumPy's np.append() function. After the angles are defined, we create a couple of arrays that contain zeros (the zeros are just place holders) and are the same length as the angles array. # create the angle array, where the last angle is the number of rotations*2*pi angle_minus_last = np . arange ( 0 , rot_num * 2 * pi , increment ) angles = np . append ( angle_minus_last , rot_num * 2 * pi ) X1 = np . zeros ( len ( angles )) # crank x-positions: Point 1 Y1 = np . zeros ( len ( angles )) # crank y-positions: Point 1 X2 = np . zeros ( len ( angles )) # connecting rod x-positions: Point 2 Y2 = np . zeros ( len ( angles )) # connecting rod y-positions: Point 2 Loop through angles After the angles array is defined, we can loop through the angles and define points that define the location of the end of the crankshaft and the end of the connecting rod. To keep track of the number of times through the loop, we'll use Python's enumerate() function. Note that enumerate() can output two values, the index and the iterable (in this case the iterable is the angle theta from the `angles array). # calculate the crank and connecting rod positions for each angle for index , theta in enumerate ( angles , start = 0 ): x1 = r * cos ( theta ) # x-cooridnate of the crank: Point 1 y1 = r * sin ( theta ) # y-cooridnate of the crank: Point 1 x2 = d # x-coordinate of the rod: Point 2 y2 = r * sin ( theta ) + sqrt ( l ** 2 - ( r * cos ( theta ) - d ) ** 2 ) # y-coordinate of the rod: Point 2 X1 [ index ] = x1 # crankshaft x-position Y1 [ index ] = y1 # crankshaft y-position X2 [ index ] = x2 # connecting rod x-position Y2 [ index ] = y2 # connecting rod y-position Create the Matplotlib figure and plot Now that the point arrays are all defined, we can set up our Matplotlib figure window and add a subplot to it. Note how the aspect='equal' is supplied as an input argument. If aspect='equal' is not set, the crankshaft will look like it rotates around in an oval. # set up the figure and subplot fig = plt . figure () fig . canvas . set_window_title ( 'Matplotlib Animation' ) ax = fig . add_subplot ( 111 , aspect = 'equal' , autoscale_on = False , xlim = ( - 4 , 4 ), ylim = ( - 2 , 6 )) ax . grid () ax . set_title ( 'Offset Piston Motion Animation' ) ax . axes . xaxis . set_ticklabels ([]) ax . axes . yaxis . set_ticklabels ([]) line , = ax . plot ([], [], 'o-' , lw = 5 , color = '#de2d26' ) Initialization function Next, we'll define an initialization function. An initialization function is needed to make the animation work. # initialization function def init (): line . set_data ([], []) return line , Animation function A second function we need to define is an animation function. # animation function def animate ( i ): x_points = [ 0 , X1 [ i ], X2 [ i ]] y_points = [ 0 , Y1 [ i ], Y2 [ i ]] line . set_data ( x_points , y_points ) return line , Call the animation and show the plot The offset_piston_motion.py script is almost finished. All have left to do is call our animation and show the plot. # call the animation ani = animation . FuncAnimation ( fig , animate , init_func = init , frames = len ( X1 ), interval = 40 , blit = True , repeat = False ) ## to save animation, uncomment the line below: ## ani.save('offset_piston_motion_animation.mp4', fps=30, extra_args=['-vcodec', 'libx264']) # show the animation plt . show () Run the script After the offset_piston_motion.py script is complete and saved, the script can be run from the Anaconda Prompt (on Windows 10) or a terminal (On MacOS or Linux). Make sure the virtual environment we created earlier is active before running the script. > python offset_piston_motion.py The resulting animation A video of the resulting animation is shown below: The complete code The complete offset_piston_motion.py script is shown below. You can also find the code on GitHub here # offset_piston_motion.py \"\"\" Offset Piston Motion Animation using Matplotlib Author: Peter D. Kazarinoff, 2021 MIT License \"\"\" # import the necessary packages import numpy as np from numpy import pi , sin , cos , sqrt import matplotlib.pyplot as plt import matplotlib.animation as animation # input parameters r = 1.0 # crank radius l = 4.0 # connecting rod length d = 0.5 # offset distance rot_num = 6 # number of crank rotations increment = 0.1 # angle incremement # create the angle array, where the last angle is the number of rotations*2*pi angle_minus_last = np . arange ( 0 , rot_num * 2 * pi , increment ) angles = np . append ( angle_minus_last , rot_num * 2 * pi ) X1 = np . zeros ( len ( angles )) # crank x-positions: Point 1 Y1 = np . zeros ( len ( angles )) # crank y-positions: Point 1 X2 = np . zeros ( len ( angles )) # connecting rod x-positions: Point 2 Y2 = np . zeros ( len ( angles )) # connecting rod y-positions: Point 2 # calculate the crank and connecting rod positions for each angle for index , theta in enumerate ( angles , start = 0 ): x1 = r * cos ( theta ) # x-cooridnate of the crank: Point 1 y1 = r * sin ( theta ) # y-cooridnate of the crank: Point 1 x2 = d # x-coordinate of the rod: Point 2 y2 = r * sin ( theta ) + sqrt ( l ** 2 - ( r * cos ( theta ) - d ) ** 2 ) # y-coordinate of the rod: Point 2 X1 [ index ] = x1 # crankshaft x-position Y1 [ index ] = y1 # crankshaft y-position X2 [ index ] = x2 # connecting rod x-position Y2 [ index ] = y2 # connecting rod y-position # set up the figure and subplot fig = plt . figure () fig . canvas . set_window_title ( 'Matplotlib Animation' ) ax = fig . add_subplot ( 111 , aspect = 'equal' , autoscale_on = False , xlim = ( - 4 , 4 ), ylim = ( - 2 , 6 )) ax . grid () ax . set_title ( 'Offset Piston Motion Animation' ) ax . axes . xaxis . set_ticklabels ([]) ax . axes . yaxis . set_ticklabels ([]) line , = ax . plot ([], [], 'o-' , lw = 5 , color = '#de2d26' ) # initialization function def init (): line . set_data ([], []) return line , # animation function def animate ( i ): x_points = [ 0 , X1 [ i ], X2 [ i ]] y_points = [ 0 , Y1 [ i ], Y2 [ i ]] line . set_data ( x_points , y_points ) return line , # call the animation ani = animation . FuncAnimation ( fig , animate , init_func = init , frames = len ( X1 ), interval = 40 , blit = True , repeat = False ) ## to save animation, uncomment the line below: ## ani.save('offset_piston_motion_animation.mp4', fps=30, extra_args=['-vcodec', 'libx264']) # show the animation plt . show ()","tags":"matplotlib","url":"offset-piston-motion-animation-matplotlib.html","loc":"offset-piston-motion-animation-matplotlib.html"},{"title":"My Linux PC Build","text":"In this post, I am going to describe my PC build. This is the computer that I use for a lot of programming work as well as some live streams. The computer I built runs Linux (Ubuntu 20.04). Table of contents: Why am I building a new Linux PC? Parts List AMD Ryzen 5 2400G MSI B450I Mini-ITX Gaming Plus AC Crucial P1 1TB M.2 NVMe SSD Corsair Vengeance DDR4 3000 MHz 16GB (2x8GB) Power Supply Case Fan Build Mount the CPU on the motherboard Mount the RAM on the motherboard Add the CPU cooler Attach the M.2 SSD drive Attach the motherboard power and CPU power. Start-Up Update the motherboard BIOS Check the system specs in the BIOS Install Linux Try it out! Put the system in the case Summary Why am I building a new Linux PC? I use a couple of different computers to write this blog, write my book , and work on Python projects . Below is a partial list: Windows 10 desktop at work (back when we were were in person. Ah.. those were the days) Windows 10 laptop at home MacBook Air at home Linux desktop at home The computer that is on the fritz right now is the Linux desktop in my home office. I use this computer for writing, editing, and general Python programming. In particular, I use the Linux desktop to build software, such as building custom MicroPython firmware or building Python from source. It is useful to have a Linux system for these sorts of tasks. I have also streamed from this Linux desktop PC as it is the only PC in the house that is connected using hard-wired ethernet. Parts List Below is a table of the parts used in the PC build. Please note that the links below are Amazon Affiliate links. If you purchase one of these items, I receive a small commission. There is no additional cost to you. Processor: AMD Ryzen 2400G (4 Core 8 Thread) APU Cooler: Stock AMD Cooler the comes with the 2400G Motherboard: MSI B450I Mini-ITX Gaming Plus AC Storage: Crucial P1 1TB M.2 NVMe SSD Ram: Corsair Vengeance DDR4 3000 MHz 16GB (2x8GB) Power Supply: Corsair CX Series 450 Watt 80 Plus Bronze Semi-Modular Power Supply Case: SilverStone SST-SG13B-V2 Mini-ITX Computer Case with Mesh Front Panel Fan: Noctua NF-P14s redux-1500 PWM Cooling Fan The following is an overview of each component. AMD Ryzen 5 2400G The AMD Ryzen 5 2400G is an integrated CPU and GPU in one package (called an APU). I like this processor for the price, the integrated GPU, thread count, and speed. My old processor was a couple of generations old Intel Core i3 that only had two cores. The Ryzen 5 2400G is a nice step up. I chose a Ryzen 5 APU because I did not want to buy a stand-alone graphics card. This Linux PC will not be used for gaming or heavy video editing, so I don't need a lot of graphics power. What I do want is a simple build (fewer components), reasonably fast, and low cost. The Ryzen 5 APU fits these requirements nicely. I will only need one CPU cooler and one CPU power supply cable to hook the processor up to the motherboard. Fewer fans, less cable management, fewer components in a small case. I think the Ryzen 5 2400G is a win. MSI B450I Mini-ITX Gaming Plus AC The motherboard I choose is the MSI B450I Mini-ITX Gaming Plus AC. This motherboard has an AM4 CPU socket for the Ryzen 5 processor I chose. I like the newer B450 chipset, and I hopefully won't need to use an older Ryzen first-gen processor to get the system started, which might be required if an older motherboard was employed. The MSI B450I Mini-ITX motherboard has an M.2 slot for an SSD and an HDMI port for monitor output. Since I'm using the Ryzen 5 2400G (without a discrete graphics card), I needed to make sure that the motherboard has an AM4 socket and has an HDMI out. This motherboard fits the bill. Crucial P1 1TB M.2 NVMe SSD I picked the Crucial P1 1TB M.2 NVMe SSD for this Linux PC build. The SSD was a component I had trouble deciding on. My old system had a 60GB SSD and a 1TB spinning rust hard drive. This was a cheap way to equip the system. The problem was the system had two SATA data cables, and two SATA power cables, plus two drives were mounted in the case. I want to keep this build simple and clutter-free. M.2 drives plug directly into the motherboard and do not require any cables. The Crucial P1 drive I selected is 80 mm long, which is the most common M.2 length. The MSI motherboard I picked has one M.2 slot on the back that the drive plugs into. I choose 1GB of capacity. I just feel like you always need more storage . The old system started out with only a 60GB SSD about 8 years ago. Then I added a 1TB spinning hard disk because I ran out of storage space. I want this PC build to last at least 5 years, so I splurged on extra SSD capacity. I also went with a drive that runs the super fast NMV3e PCIe communication standard. An NVMe SSD drive probably won't have any practical performance benefits compared to a SATA SSD for the things I use the new PC for. I guess I just like to know that I have fast storage. Plus, long boot times bug me. Corsair Vengeance DDR4 3000 MHz 16GB (2x8GB) I choose 16 GB of DDR4 RAM for my new system. The Corsair Vengeance DDR4 3000 MHz kit I bought includes 2 x 8 GB DIMMs. I don't know if my system will be able to take advantage of the 3000 MHz maximum clock speed. It's simply 16 GB of standard DDR4 memory. Power Supply The power supply I went with this the Corsair CX Series 450 Watt 80 Plus Bronze Semi-Modular Power Supply. For this build, I am only going to need a 24-pin cable for the motherboard power and supplemental CPU power. The power supply I bought is semi-modular which means some of the cables are permanently attached and some of the cables are removable. The cables I need for the build are cables that are permanently attached. I don't need any of the detachable cables. This means that I save a little money compared to a fully modular power supply (all detachable cables), but still get the benefits of as few cables as possible. Case I put all the components inside the Silverstone SG13B-V2 Mini ITX case. This case accepts mini ITX motherboards and can accommodate standard ATX power supplies (as well as smaller SFX power supplies). It isn't fancy, but it is inexpensive and gets the job done. Fan I bought a fan for the SilverStone case because it doesn't come with one. I mounted the fan in the front of the case. One thing I think I would do differently is to buy a 120 mm fan (which is a more common size), rather than the larger 140 mmm fan I bought (which is a less common size). The Silverstone case fits a 120 mm fan just fine and the 140 mm fan mount only has three screw locations. That's all the parts. Below is a description of the build and installation process. Build I built the PC in a couple of steps. First I built the PC on top of the motherboard box outside of the case to make sure all the components worked together. Before I started building, I plugged in the power supply (power off) and attached an ESD wrist strap to the grounded power supply case with the alligator clip. I don't know if this is necessary, but I have an ESD wrist strap, so I thought I'd use it. Mount the CPU on the motherboard Next, I installed the CPU on the motherboard. Make sure to line up the little triangle on the corner of the CPU with the little corner on the CPU socket on the motherboard. You don't need to push the processor into the socket. The little lever on the side of the socket seats the CPU with the right amount of pressure. Mount the RAM on the motherboard Next, I attached the RAM to the motherboard. There are two clips on the side of the RAM slots of the motherboard. Then I pushed the RAM in until it \"clicked\". The RAM only fits into the RAM slots in one orientation. Add the CPU cooler The Ryzen 5 2400G CPU comes with a CPU cooler included in the box. The included cooler has thermal paste pre-applied, so no thermal paste needs to be added to the top of the processor before the cooler is mounted. There are two plastic brackets, one on each side of the processor that need to be removed from the motherboard before the CPU cooler is attached. When the plastic brackets come off, the plate on the back of the motherboard falls off. I've heard you can hold the plate on the back of the motherboard with painter's tape. I just had to re-align the metal backplate after I took the plastic brackets off. I put the cooler on top of the processor and just seated the screws before I tightened it down. I used a cross pattern to tighten each screw about a turn at a time until the cooler was screwed down tight. Attach the M.2 SSD drive Next, I flipped the motherboard over and attached the M.2 SSD. The baggie of screw that came with the motherboard contained a tiny M.2 standoff and a tiny M.2 screw. The standoff goes \"below\" the M.2 drive and the little screw goes \"above\" the M.2 drive. I slid the drive into the M.2 slot at about a 30-degree angle, then pushed it down till hit was horizontal and tightened down the end of the M.2 SSD to the standoff with the tiny screw. When I first got the motherboard out of the box I couldn't figure out where an M.2 drive goes. There didn't seem to be any on the top of the motherboard. The trick was the M.2 drive mount is on the back of the motherboard. Attach the motherboard power and CPU power. Finally, I attached the big 24-pin motherboard power cable from the power supply and the 6-pin supplemental CPU power cable from the power supply to the motherboard. I don't need any other power cables because the SSD is powered by the M.2 slot and the \"graphics card\" is integrated into the CPU. All these steps were accomplished outside the case. Start-Up After the system was fully assembled, I plugged a monitor into the HDMI port and plugged a mouse and keyboard into USB ports. I also plugged in an ethernet cable. I could use the motherboard's onboard WiFi, but the wired ethernet is faster and won't require any setup. I started the system for the first time by shorting the POWER pins on the motherboard with a screwdriver. After the power turned on, I hit the DELETE key rapidly to bring up the motherboard BIOS. Update the motherboard BIOS I downloaded the latest firmware for my motherboard from the MSI website. The download from MSI was a zip file, and I unzipped it onto a USB thumb drive. Within the motherboard BIOS, there is the option to update the BIOS firmware. I selected that option and my USB thumb drive that contained the firmware file. Then the system re-started and I went into the BIOS again. Check the system specs in the BIOS Next, I checked my new system's specs in the BIOS. I wanted to make sure the CPU and SSD were recognized. I didn't overclock the CPU or the RAM. I would like to see if the XMP profile for the RAM will run on my setup. For the first start-up, I left the RAM at stock speed. Install Linux With the system still outside the case and the motherboard sitting on top of the motherboard box, I installed Ubuntu 20.04 from a USB drive. From the BIOS, I powered down the system and inserted a thumb drive with the Linux (Ubuntu 20.04) .iso image into the motherboard. I selected the newest version of Ubuntu. I hope that the newest version of Ubuntu will play nice with my newish Ryzen 5 APU. When I turned the power back on, I pushed F11 over and over to bring up the boot menu. I selected the USB thumb drive with the Linux .iso image on it and started the system for the first time. The Ubuntu installer takes a while to complete and downloads a bunch of stuff during the installation. The total install time was around 20 minutes. Try it out! After Ubuntu was set up, I tried the new system out. It worked great! Firefox opens quickly and YouTube videos stream no problem. I also entered those standard Linux command-line update commands: sudo apt-get update sudo apt-get upgrade Put the system in the case Finally, I put my new system in the case. The motherboard gets screwed into the four motherboard standoffs at the bottom of the case. A problem I ran into is that the AMD Wraith CPU cooler bumps into a hard drive caddy on my case. I took the hard drive caddy off to provide room for the AMD CPU cooler. I love the fact the system only contains one fan and two power cables. The inside of the case is clean and uncluttered. I initially messed up how I hooked up the power, reset buttons to the motherboard header. When I first pushed the power button on the case, nothing happened. It turned out I just messed up the way these leads were supposed to be connected. Summary In this post, I reviewed how I built my Linux Desktop PC from individual components. The build was relatively free of hiccups. The hardest part was removing the hard drive caddy in the case so that the CPU cooler would fit. I do have some upgrades in mind for this system... A fancier case would be nice. If I end up overclocking the system, a new CPU cooler might be in order. And there is always the possibility to add a discrete graphics card, more RAM, and a more powerful CPU.","tags":"DIY","url":"my-linux-pc-build.html","loc":"my-linux-pc-build.html"},{"title":"How to install pytesseract","text":"In this post, you'll see how to install pytesseract. You can use pytesseract to convert images into text. Pytesseract is a Python package that works with tesseract , which is a command-line optical character recognition (OCR) program. It's a super cool package that can read the text contained in pictures. Let's get to it. Prerequisites Before you can install pytesseract, you need to have a couple of things in place: A computer with an internet connection Anaconda distribution of Python You are going to need a computer with an internet connection. If you are reading this post, there is a good chance there is a computer in front of you right now. As far as I know, you can't install pytesseract on a phone, tablet, or Chromebook. You are also going to need the Anaconda distribution of Python. Why Anaconda? Why Anaconda? You might be wondering, why do I need Anaconda to install Pytesseract? Well, you don't have to use the Anaconda distribution of Python when you install pytesseract, but I think it's a lot easier than other installation methods. You can install Python packages, but also non-Python packages with the Anaconda Prompt. Since tesseract is non-Python package needed to use pytesseract, I think the Anaconda distribution of Python and the conda package manager is the way to go. What is pytesseract? Pytesseract is a Python package that allows you to extract text from images. If you have a picture that has some text in it, pytesseract can pull out the text into a Python program. That's pretty cool. Pytesseract is a wrapper around a program from Google called tesseract . It's tesseract that extracts the text from pictures. Pytesseract is there to help you use tesseract in your Python programs. What is tesseract? Tesseract is a command-line application created by Google that can be used to pull text out of pictures. It is an example of an OCR application, which stands for O ptical C haracter R ecognition. Which is just a fancy way of saying using a computer to read text. Tesseract is capable of reading text in many different languages. It works best with computer-generated text like text in PDFs or pictures of receipts and invoices. It has a tougher time with images that contain handwritten words. Before we get started with installation, we need to do something else first: create a virtual environment. Create a virtual environment Next, we are going to create a virtual environment to install pytesseract into. It's a good idea to create a new virtual environment for each Python project. Open up the Anaconda Prompt from the Windows Start Menu and type the command below. You do not need to type > . The > is shown to indicate the prompt, not a character to type. > conda create -y -n tesseract python=3.8 Now we have a new virtual environment called (tesseract) . Before we can install packages into this environment, it needs to be activated. Activate the (tesseract) environment with the command below: > conda activate tesseract (tesseract) > You know the (tesseract) virtual environment is active when you see the environment name (tesseract) before the prompt. In the next few steps, we are going to install packages into our (tesseract) environment. Make sure the environment is active when you run any conda install commands. Install pytesseract Now we are going to install pytesseract into our virtual environment. Make sure the (tesseract) environment is active. You can install pytesseract from PyPI, the Python package index using pip . But I suggest installing pytesseract with conda . Conda can manage non-Python dependencies and we want to be sure that pytesseract plays well with the other packages we install. conda can install Python and non-Python packages. This makes it a great tool to install tesseract and pytesseract. Use the command below to install pytesseract. Note the -c conda-forge portion of the command. This means we are installing pytesseract from the conda-forge channel. If you don't specify the channel, the installation will fail. > conda install -c conda-forge pytesseract You can confirm that pytesseract is installed in your virtual environment by hopping into the Python REPL and trying to import it. > python >>> import pytesseract >>> help(pytesseract) Help on package pytesseract: NAME pytesseract - # flake8: noqa: F401 ... >>> exit() pytesseract is installed. Great! But before we can use it, we need to install the tesseract application. Install tesseract Now that pytesseract is installed, there are two more things we need to do before we can use it. install tesseract figure out where the tesseract executable is located We can install tesseract using conda at the Anaconda Prompt, just like we installed pytesseract. Again, make sure the (tesseract) virtual environment is active before you run the conda install command. Type the command below to install tesseract. > conda install -c conda-forge tesseract You can confirm that tesseract is installed in your virtual environment by running the command below. The command calls up the tesseract help screen. > tesseract -h OK - one more step before we can use pytesseract, we need to figure out where our tesseract executable is installed. The tesseract executable location is needed for pytesseract to work properly. Determine the location of your tesseract executable The next step is to determine where the tesseract program is located on our computer. We need this location when we use pytesseract in a Python program. Typing the where <executable> command into the Anaconda Prompt shows the location of that <exectable> . where on Windows is sort of like the which command in MacOS and Linux. > where tesseract C:\\Users\\Peter\\Anaconda3\\envs\\tesseract\\Library\\bin\\tesseract.exe Make note of this file path. We need the file path to use pytesseract in our Python program. Point pytesseract at your tesseract installation Create a Python script (a .py-file), or start up a Jupyter notebook. At the top of the file, import pytesseract , then point pytesseract at the tesseract installation you discovered in the previous step. Note the r' ' at the start of the string that defines the file location. The r indicates the string is a raw string. Raw strings don't include escape characters like \\n for a new line. Therefore, we don't have to use double \\\\ backslashes in the Windows file path. # test_pytesseract.py try : from PIL import Image except ImportError : import Image import pytesseract pytesseract . pytesseract . tesseract_cmd = r 'C:\\Users\\Peter\\Anaconda3\\envs\\tesseract\\Library\\bin\\tesseract.exe' Now we can use pytesseract to extract some text from a picture. Use pytesseract OK! Now it's time to pull text out of a picture. You are going to need a picture to pull text out of. The picture I'm using can be found here and is shown below. Make sure test_image.png is in the same folder as your Python program. # test_pytesseract.py try : from PIL import Image except ImportError : import Image import pytesseract pytesseract . pytesseract . tesseract_cmd = r 'C:\\Users\\Peter\\Anaconda3\\envs\\tesseract\\Library\\bin\\tesseract.exe' text_from_image = pytesseract . image_to_string ( Image . open ( 'test_image.png' )) print ( text_from_image ) Run the Python program or Jupyter notebook code cell and see the output. The output produced should look something like below: This is a lot of 12 point text to test the ocr code and see if it works on all types of file format. The quick brown dog jumped over the lazy fox. The quick brown dog jumped over the lazy fox. The quick brown dog jumped over the lazy fox. The quick brown dog jumped over the lazy fox. ♀ Going Further Now that pytesseract is installed what are you going to build? There are so many possibilities for projects: Use pytesseract to read different languages Run pytesseract on a stack of pdf's Try to see if pytesseract can read your handwriting See if pytesseract can read junk mail Incorporate pytesseract into a web application Happy coding!","tags":"python","url":"how-to-install-pytesseract.html","loc":"how-to-install-pytesseract.html"},{"title":"How to install MicroPython on an ESP32 microcontroller","text":"In this post, you'll learn how to install MicroPython on an ESP32 microcontroller. Micropython is a port, or version of Python designed to run on small, inexpensive, low-power microcontrollers. Examples of microcontrollers that MicroPython can run on include the pyboard , the WiPy and ESP8266-based boards like the Adafruit Feather Huzzah . Also, MicroPython can be installed on ESP32-based microcontrollers - and that's what this post is about. If you want to know more about MicroPython, you can read about it in this post and check out the MicroPython Main Page and the MicroPython Documentation Table of contents: Prerequisites Download the firmware Create a virtual environment and install esptool Install the SiLabs driver for the CP210x chip Connect ESP32 microcontroller to computer Confirm the ESP32 is connected in the Windows Device Manager and determine the COM Port Install MicroPython with esptool Download and install PuTTY, a serial monitor Use PuTTY to send commands to the ESP32 Run a few commands to turn the built-in LED on and off Going Further Prerequisites Before you can install MicroPython on an ESP32 microcontroller, there are a couple of prerequisites: a computer with a USB port and internet connection an ESP32 microcontroller a USB cable to connect the ESP32 microcontroller to your computer the Anaconda Distribution of Python installed on your computer We will install MicroPython on our ESP32 microcontroller with our computer. This computer can be Windows10, MacOS, or Linux. These instructions are written assuming you have a Windows 10 computer, but the same general steps can be used on other operating systems. Your computer needs to be connected to the internet. You'll need an ESP32-based microcontroller. There are a couple of different varients. Boards you could use include the Adafruit HUZZAH32 – ESP32 Feather Board and the HiLetgo ESP-WROOM-32 ESP32 ESP-32S Development Board found on Amazon. This tutorial assumes you have one of these development boards that has a USB port on it. You also need a USB cable to connect your ESP32 microcontroller to your computer. Both the Adafruit Feather Huzzah 32 board and the HiLetgo ESP32 board board use a micro-USB connector. Therefore, you need a micro-USB to USB-A (regular USB) cable. The cable needs to be a USB data cable and not just a USB charging cable. Make sure the micro-USB cable is a data cable. If the ESP32 isn't recognized by your computer (and the SiLabs driver is installed) try a different USB cable. This type of cable is common to many older Android phones and tablets. If you don't have a micro-USB to USB-A cable, you can buy one at Adafruit or Amazon . Python needs to be installed on your computer so that you can use a command-line program called esptool . I suggest you download and install the Anaconda Distribution of Python. You can also download Python onto your computer from Python.org . See this post to learn how to install the Anaconda distribution of Python on Windows. Now that we have our prerequisites setup, it's time to download the MicroPython firmware for our ESP32 microcontroller. Download the firmware The first step to installing MicroPython on an ESP32 microcontroller is to download the MicroPython firmware from micropython.org . Click on the DOWNLOAD link at the top of the page. On the downloads page, scroll down the page until you get to the Espressif ESP-based boards section. Select the Generic ESP32 module . This brings you to the page containing Firmware for Generic ESP32 module Scroll down and select the most recent .bin file. In the picture below, that is esp32-20210312-unstable-v1.14-108-ge98ff3f08.bin . Click on the link to the .bin file. Save the file to your Downloads folder. After the .bin file downloads, you should be able to see it in your Downloads folder. Great! We've got the ESP32 firmware .bin file saved on our computer. Next, we need to install a Python package called esptool so that we can move the firmware onto our ESP32 microcontroller. Create a virtual environment and install esptool Now that the .bin file is download, the next thing we need to do is install a command-line tool called esptool . esptool is a Python package that we can run from the Anaconda Prompt or a terminal to flash our firmware onto our ESP32 microcontroller. Before we install esptool, let's first create a virtual environment for our ESP32 work. The commands below assume you are using the Anaconda distribution of Python and the Anaconda Prompt for your terminal. Using the MacOS or Linux terminal and Python's venv module is another option. Go to the Windows Start Menu and type Anaconda Open the Anaconda Prompt and type the command below to create a new virtual environment called esp32 . Note that the > prompt character doesn't need to be typed. > is included to represent the terminal prompt, not as a character to type. > conda create -y -n esp32 python=3.8 After the virtual environment is created, it needs to be activated before we install esptool. Activate the esp32 virtual environment we just created with the command below. Note that after the activation command is entered, (esp32) appears before the prompt. This means the esp32 virtual environment is active. > conda activate esp32 Once the esp32 environment is activated (you can see (esp32) before the prompt), use the command below to install esptool. > python -m pip install esptool You can confirm the installation of esptool by typing the command below. The result should be the version of esptool that you installed. > esptool version esptool.py v3.0 3.0 Now that esptool is installed, we need to install a driver to make sure our computer recognizes our ESP32 microcontroller when we connect it. Install the SiLabs driver for the CP210x chip Before we can connect our ESP32 microcontroller to our computer, we need a specific driver installed. For my Windows 10 laptop to see my ESP32, the CP210x USB to UART Bridge VCP driver needs to be downloaded from SiLabs and installed. This is quick and easy but does require admin privileges. Now, we can connect our ESP32 microcontroller to our computer. Connect ESP32 microcontroller to computer Let's review the steps we have completed so far: downloaded the firmware .bin file into our downloads folder created a virtual environment using the Anaconda Prompt installed esptool using the Anaconda Prompt installed the SiLabs CP210x drivers The next step is to connect the ESP8266 microcontroller to the computer. Connect one end of the USB cable to the microcontroller and connect the other end of the cable to a USB port on your computer. Note that it does make a difference which way is up for both sides of the USB cable. Now we need to make sure that our computer can \"see\" our ESP32. Confirm the ESP32 is connected in the Windows Device Manager and determine the COM Port You should be able to see the ESP8266 in the Windows Device Manager when the ESP32 is connected to your computer. You can open the Windows Device Manager from the Windows Start Menu. In the Windows Device Manager, look in the Ports (COM & LPT) section. You should see something like Silicon Labs CP201x USB to UART Bridge (COM4) . Make note of which COM# is in parenthesis after UART Bridge. We'll need this COM# in the next step. If you can't see the Silicon Labs CP201x USB to UART Bridge (COM4) entry in the Windows Device Manager, make sure the SiLabs driver is installed and try a different USB cable. After the ESP32 is connected to your computer and you know which COM# it corresponds to, you can close the Windows Device Manager and move back to the Anaconda Prompt. It's time to install MicroPython on our ESP32! Install MicroPython with esptool Everything should now be in place. Let's review our steps so far: Downloaded .bin firmware file from the MicroPython downloads page Confirmed the .bin file is in our Downloads folder Created a virtual environment using the Anaconda Prompt Activated the virtual environment Installed esptool (into the virtual environment) Confirmed esptool was installed with esptool version Installed the SiLabs CP210x driver Attached the ESP32 to the computer with a USB cable Confirmed the ESP8266 was connected in the Windows Device Manager Determined which COM# Port corresponds to the ESP32 Now the only steps left are to install MicroPython on our ESP32 and confirm that MicroPython works. We are almost there. Go back to the Anaconda Prompt and make sure the (esp32) virtual environment is active. Remember in the commands below, you do not need to type > . The > character is shown to indicate the Anaconda Prompt. Navigate the Downloads folder: > cd Downloads You can run the dir command in the Anaconda Prompt to see the contents of the Downloads directory. This will print out the directory name and list the directory contents. > dir On the MicroPython ESP32 firmware downloads page , we can see the commands we need to run to install MicroPython on our ESP32: Use the command below to erase the flash memory on the ESP32. Make sure to modify COM4 to correspond to the COM# from the Windows Device Manager. > esptool --chip esp32 --port COM4 erase_flash Now it's time to write the .bin firmware file to the flash memory on the board using the write_flash command. Make sure to use the exact .bin firmware file name you see in the Downloads directory. The port has to be set as the port you found in the Windows Device Manager. ---baud is the baud rate or upload speed. I found that --baud 460800 works just fine. Make sure the .bin firmware file name is correct. It is easy to mistype. The latest version may not be esp32-20210312-unstable-v1.14-108-ge98ff3f08.bin . You can start typing the .bin file name and then use the [TAB] key to auto-complete the rest of the filename. > esptool --chip esp32 --port COM4 --baud 460800 write_flash -z 0x1000 esp32-20210312-unstable-v1.14-108-ge98ff3f08.bin Congratulations! MicroPython should now be installed on your ESP32 microcontroller. To make sure the MicroPython installation was successful, we'll connect to our ESP32 using a tool called PuTTY . Download and install PuTTY, a serial monitor Now that Micropthon is installed on our ESP32 microcontroller, we can communicate with our ESP32 over a serial connection. Windows 10 doesn't have a built-in serial monitor (like screen on MacOS and Linux). So we need to download and install PuTTY . PuTTY is a lightweight SSH and serial client that works on Windows. PuTTY allows us to send and receive commands between our computer and our ESP32 microcontroller. PuTTY can be downloaded here . PuTTY is pretty lightweight. The download and installation are pretty quick. Use PuTTY to send commands to the ESP32 Ensure the ESP32 microcontroller is connected with a USB cable and make sure you can see the ESP32 in the Windows Device Manager. Then use PuTTY to connect to the board over serial. Search for PuTTY in the Windows Start Menu. You can't connect to the ESP32 over SSH. You need to select the Serial radio button below the header Connection type: near the top of the PuTTY window to connect to your ESP32. In the PuTTY window, make sure to specify the correct COM# port in the Serial line box and include 115200 baud in the Speed box. MicroPython runs at 115200 baud - other baud rates will lead to junk characters in the serial monitor. Now click [Open]. If you see >>> the MicroPython REPL (the MicroPython prompt) is running and the ESP32 is working! This version of Python isn't running on your computer, it's MicroPython running on the little ESP32 microcontroller! Sometimes you might have to type [Enter] or [Ctrl-D] to get the >>> REPL prompt to show up. A few times I needed to close PuTTY, unplug then replug the board and try PuTTY again. Many ESP32 microcontrollers have a tiny little black RESET button that can be pressed to restart the board. If you can't connect to the ESP32 with PuTTY, you can try pressing the RESET button. At the >>> MicroPython REPL prompt try the following commands: >>> print('MicroPython for Engineers!') MicroPython for Engineers >>> import sys >>> sys.platform 'esp32' Run a few commands to turn the built-in LED on and off Let's celebrate! Micropython is running on our ESP32 microcontroller! If the commands above worked, you can try and turn the built-in LED that's on many ESP32-based boards to turn on and off. On most ESP32 microcontrollers, the built-in LED is connected to Pin 2 At the MicroPython REPL (in the PuTTY window), try the commands below: >>> from machine import Pin >>> p2 = Pin(2, Pin.OUT) >>> p2.on() >>> p2.off() Going Further In this post, we installed MicroPython on an ESP32 microcontroller. After MicroPython is installed, you can use a tool like ampy to move .py-files onto the board. You can program your ESP32 to do a wide variety of things. Some project ideas are below: Connect an LED to the ESP32 and blink the LED on and off using a for loop Connect a sensor to the ESP32 and read the sensor using the ESP32's built-in analog-to-digital converter (ADC) Connect the ESP32 to your WiFi network and turn the ESP32 into a remote weather station I hope you had fun installing MicroPython on your ESP32. Now get out there and write some MicroPython code!","tags":"micropython","url":"how-to-install-micropython-on-an-esp32.html","loc":"how-to-install-micropython-on-an-esp32.html"},{"title":"Using Python and an Arduino to Read a Sensor","text":"In this post, you will see how to use Python to communicate with an Arduino and read a sensor . In particular, the sensor we'll use is a potentiometer . The potentiometer will connect to an Arduino microcontroller and the Arduino will communicate with a Python script using the PySerial package. Python running on our computer will read the sensor data, then we will use Matplotlib to plot the sensor output. This is going to be a fun project. Let's dive in! Table of contents: Collect the hardware Create a virtual environment and install PySerial Download the Arduino IDE Wire the potentiometer and an LED to the Arduino Connect the Arduino to the computer and check the COM port \"Blink\" the Arduino to confirm it is working Upload the potentiometer.ino sketch to the Arduino Twist the little blue potentiometer to turn the LED connected to the Arduino on and off Check if the LED turns on and off View the potentiometer reading in the Arduino Serial Monitor View the potentiometer reading in the Arduino Serial Plotter Use the Python REPL to read the potentiometer. Write a Python script to print out the potentiometer readings Write a Python script to record the potentiometer readings and plot the readings over time Summary Going further Collect the hardware In this project, we are going to use a couple of pieces of hardware. Below is the list of hardware needed to complete the project: Component Item and Link Arduino SparkFun RedBoard - Programmed with Arduino Potentiometer https://www.sparkfun.com/products/9806 Jumper Wires Jumper Wires Premium 6\" M/M Pack of 10 LED LED Rainbow Pack - 5mm PTH 330 Ohm Resistor Resistor 330 Ohm ⅙ Watt PTH - 20 pack Breadboard Breadboard - Self-Adhesive (White) USB cable SparkFun USB Mini-B Cable - 6 Foot Create a virtual environment and install PySerial To complete this Python project, it is best practice to use a virtual environment. I have the Anaconda distribution of Python installed on my Windows 10 machine (see this post on how to install Anaconda on Windows). In a previous post , we reviewed how to create a new virtual environment called (arduino) . We'll follow the same process here. Open the Anaconda Prompt and use the command below to create the virtual environment. > conda create -y -n arduino python=3.8 Before we start this project, we will activate the (arduino) virtual environment and ensure that the PySerial package is installed. > conda activate arduino You know you are in the arduino virtual environment when (arduino) is in parenthesis at the start of the prompt: (arduino) > To communicate with the Arduino using Python over a serial line, we need to have the PySerial package installed. Install PySerial from the Anaconda Prompt using the command conda install pyserial . (arduino) > conda install pyserial To confirm that PySerial is installed in the (arduino) virtual environment, enter the Python REPL and try to import the PySerial package. Then call the .__version__ attribute on the serial package. Note that even though the package is called PySerial the import command is import serial . (arduino) > python >>> import serial >>> serial.__version__ '3.4' >>> exit() (arduino) > Download the Arduino IDE We need to upload code to our Arduino in order to communicate with our Arduino using Python. Therefore, the next step is to dowload and install the Arduino IDE ( I ntgrated D evelopment E nvironment) As shown in a previous post , download and install the Arduino IDE found at the link below. https://www.arduino.cc/en/Main/Software If you are working on a company or school computer that won't allow you to install software, choose the Windows ZIP file for non-admin install option. Wire the potentiometer and an LED to the Arduino Take out the little blue potentiometer, an LED (any color), a 330 Ohm resistor, five jumper wires (2x red, 2x black, 1x yellow, 1x orange), the Arduino, and the white breadboard. Connect the potentiometer, LED, resistor, and colored jumper wires as shown below. Note the LED has two different sized \"legs.\" Ensure the LED is wired in the correct orientation. Current can only flow in one direction through an LED. It does not matter which outside leg of the potentiometer goes to 5V and which outside leg of the potentiometer goes to ground. However, the center leg of the potentiometer must be connected to pin A0 on the Arduino. outside potentiometer leg → 5V middle potentiometer leg → A0 on Arduino outside potentiometer leg → ground short LED leg → resistor → ground long LED leg → Pin 13 on Arduino Also see the SparkFun Inventor's kit online guide: https://learn.sparkfun.com/tutorials/sparkfun-inventors-kit-experiment-guide---v40/circuit-1b-potentiometer Connect the Arduino to the computer and check the COM port In this step, we are going to connect the Arduino to the computer and determine which COM port it is connected to. Connect the Arduino to the computer using a USB cable. On SparkFun Redboards (a type of Arduino), the cable needs to be a USB 2.0 type A to Mini-B cable. One end of the cable looks like a regular USB cable. Connect that end to the computer. The other end of the cable has a small connector that sort of looks like a phone charging cable, but a little different. Connect this smaller end of the cable to the Arduino. Now we need to determine which COM Port the Arduino is connected to. Later, when we upload code to the Arduino we will need to know which COM Port the Arduino is connected to. We can use the Windows Device Manager to determine which serial port the Arduino is connected to. On my Windows 10 laptop, the Arduino is usually connected to port COM15 . You can find the port number by looking in the Ports (COM & LPT) category of the Windows Device Manager. Look for something like USB Serial Port (COM15) in the Ports (COM & LPT) menu. It is the COM# that you are looking for. Remember, your COM# will probably not be COM15 . \"Blink\" the Arduino to confirm it is working In the next step, we are going to upload the Blink.ino sketch to the Arduino and make sure the sketch uploads and the Arduino blinks. A sketch is an Arduino program. Double-click the Arduino.exe program. Open the Arduino Blink.ino sketch by going to: File → Examples → 01.Basics → Blink Before we upload the blink.ino sketch to the Arduino, ensure that the Port and the Board type are set correctly in the Arduino IDE. In the Arduino IDE Tools menu, select the following: Tools → Port → COM4 (or whichever port the Arduino is connected to, found with the Windows Device Manager) Tools → Board → Arduino / Genuino Uno In the Arduino IDE Window that contains the Blink.ino sketch, click the checkmark to Verify then click the arrow to Upload. Once the upload is complete, the Arduino and LED should blink on and off. If you don't see the Arduino and LED blinking, you need to do some troubleshooting. Check the COM Port or try unplugging and re-plugging in the Arduino. Upload the potentiometer.ino sketch to the Arduino In this step, we are going to write a new Arduino sketch called potentiometer.ino and upload it to the Arduino. Use the Arduino IDE to create a new sketch by going to File → New. This opens up a new Arduino IDE window. Save the new sketch as potentiometer.ino by going to File → Save. Copy the code below into the potentiometer.ino sketch. Replace all of the text in the sketch with the code below. // potentiometer.ino // reads a potentiometer sensor and sends the reading over serial int sensorPin = A0; // the potentiometer is connected to analog pin 0 int ledPin = 13; // the LED is connected to digital pin 13 int sensorValue; // an integer variable to store the potentiometer reading void setup() { // this function runs once when the sketch starts up pinMode (ledPin, OUTPUT); // initialize serial communication : Serial.begin(9600); } void loop() { // this loop runs repeatedly after setup() finishes sensorValue = analogRead(sensorPin); // read the sensor Serial.println(sensorValue); // output reading to the serial line if (sensorValue < 500){ digitalWrite(ledPin , LOW );} // turn the LED off else { digitalWrite(ledPin , HIGH );} // keep the LED on delay (100); // Pause in milliseconds before next reading } The potentiometer.ino sketch above reads the value off of the potentiometer and sends the potentiometer reading over the serial line. In the next part of the sketch, the potentiometer reading is compared to 500. If the potentiometer reading is greater than 500, the LED turns on. If the potentiometer reading is less than 500, the LED turns off. After the potentiometer.ino sketch is saved, the sketch needs to be uploaded onto the Arduino. In the Arduino IDE window that contains the potentiometer potentiometer.ino sketch, click the checkmark to Verify then click the arrow to Upload. Twist the little blue potentiometer to turn the LED connected to the Arduino on and off We will now check that the Arduino sketch and potentiometer are functioning correctly. We can check in three different ways: The first check is to see if the LED turns on and off when the potentiometer is dialed back and forth. The second check is to see the potentiometer reading in the Arduino Serial Monitor. The third check is to see the potentiometer reading in the Arduino Serial Plotter. Check if the LED turns on and off After the potentiometer.ino sketch is uploaded on the Arduino, twist the small blue potentiometer dial back and forth and watch the LED turn on and off. The on/off point should be about halfway through the little blue potentiometer's rotation. If the LED does not turn on and off, double-check your wiring and try uploading the potentiometer.ino sketch again. View the potentiometer reading in the Arduino Serial Monitor In the Arduino IDE, open the Arduino Serial Monitor by selecting Tools \\(\\rightarrow\\) Serial Monitor. If the potentiometer.ino sketch is working properly, you will see numbers scrolling down the Arduino Serial Monitor. Twist the little blue potentiometer back and forth and watch the numbers scrolling down the Arduino Serial Monitor change. Now close the Serial Monitor. The Arduino Serial Monitor and Arduino Serial Plotter can not communicate with the Arduino at the same time. Be careful : The Arduino Serial Monitor and the Arduino Serial Plotter can't be open at the same time. View the potentiometer reading in the Arduino Serial Plotter In the Arduino IDE, open the Arduino Serial Plotter by selecting Tools → Serial Plotter. You should see a plot with a moving line in the Arduino Serial Plotter. Twist the little blue potentiometer back and forth and observe the line on the plot move up and down. Once you can successfully move the plotting line up and down in the Serial Plotter, close the Serial Plotter Window. If the Serial Plotter isn't working correctly, make sure the COM port is set correctly in the Arduino IDE. The Arduino Serial Monitor and Arduino Serial Plotter can not be open at the same time. Both the Arduino Serial Monitor and the Arduino Serial Plotter need to be closed before Python can communicate with the Arduino. The Arduino Serial Monitor and Arduino Serial Plotter both need to be closed before Python can communicate with the Arduino. After you can successfully: turn the Arduino LED on and off by twisting the little blue potentiometer see numbers change in the Arduino Serial Monitor when the potentiometer is twisted see the plot line move up and down in the Serial Plotter when the potentiometer is twisted It is time to use Python to read and record the potentiometer reading. Use the Python REPL to read the potentiometer. Open the Anaconda Prompt and activate the (arduino) virtual environment (if it is not currently active). Then start the Python REPL by typing python at the prompt. Type the following commands below to read the potentiometer connected to the Arduino. Note the arrow symbols > and >>> should not be typed. The arrow symbols > and >>> are just shown to indicate the prompt. Make sure to change the COM Port from 'COM4' to the Port number you found in the Windows Device Manager. The command ser.readline() reads the incoming data from the serial line. Note that the data looks kind of funny, not like the numbers we saw in the Arduino Serial Monitor. Twist the potentiometer and run ser.readline() again. Observe how the output changes. > conda activate arduino (arduino) > python Python 3.7.1 (default, Dec 10 2018, 22:54:23) [MSC v.1915 64 bit (AMD64)] :: Anaconda, Inc. on win32 Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. >>> import serial >>> ser = serial.Serial('COM4', 9800, timeout=1) >>> ser.readline() b'481\\r\\n' >>> ser.readline() b'589\\r\\n' >>> ser.close() >>> exit() (arduino) > After you take a couple of readings, make sure to close the serial port with the command ser.close() . If the serial port is not closed, there may be a problem the next time you try to open the port. This problem can usually be remedied by unplugging then replugging in the Arudino. If the serial port is not closed, there may be a problem the next time you try to open the port. If you have trouble, make sure the Arduino Serial Monitor is closed before you run the commands at the Anaconda Prompt. If the Arduino Serial Monitor is open, you can't communicate with the Arduino with the Anaconda Prompt. The data coming from the serial line looks kind of funny: b'481\\r\\n' Let's investigate what kind of data type is returned by the ser.readline() command. Use the Anaconda Prompt to open the Python REPL and try the following commands. Leave the Python REPL open after running the commands. Remember to change the COM Port from 'COM4' to the Port number you found in the Windows Device Manager. (arduino) > python Python 3.7.1 (default, Dec 10 2018, 22:54:23) [MSC v.1915 64 bit (AMD64)] :: Anaconda, Inc. on win32 Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. >>> import serial >>> ser = serial.Serial('COM4', 9800, timeout=1) >>> line = ser.readline() >>> type(line) <class 'bytes'> >>> ser.close() When we store the line coming in from the Arduino, we aren't storing an int, a float, or a string. The ser.readline() method returns a byte object. The \"byte object\" can be converted to a regular Python string using the .decode() method. >>> import serial >>> ser = serial.Serial('COM4', 9800, timeout=1) >>> line = ser.readline() >>> line b'481\\r\\n' >>> type(line) <class 'bytes'> >>> string = line.decode() >>> string '481\\r\\n' >>> type(string) <class 'str'> OK, now we have a Python string, but what about the \\r\\n at the end? These are the return and new line characters. \\r\\n are sent by the Arduino because the potentiometer.ino sketch used the Serial.println() function, which prints a new line each time the data is printed out. Not to worry, \\r\\n can be stripped off the string object with the Python's .strip() method. Then let's convert the \"stripped\" string to an integer, using Python's int() function. Make sure to close the serial line with the ser.close() method before you exit() the Python REPL. >>> string '481\\r\\n' >>> stripped_string = string.strip() >>> stripped_string '481' >>> num_int = int(stripped_string) >>> num_int 481 >>> type(num_int) <class 'int'> >>> ser.close() >>> exit() (arduino) > Let's sum up the data type conversions above. Starting from the data that comes in from the Arduino that is a byte to finally ending up with an integer : ser.readline() returns a byte string: b'481\\r\\n' .decode() converts the byte string to a Python string: '481\\r\\n' .strip() removes the \\r\\n characters from the end of the Python string: '481' int() converts the Python string to an integer: 481 Write a Python script to print out the potentiometer readings Now let's write a Python script that prints out the potentiometer readings. Create a new Python script called potentiometer.py . Include the code below in the script. Make sure to modify the COM# from 'COM4' to the Port you found in the Windows Device Manager. # potentiometer.py import serial import time # make sure the 'COM#' is set according the Windows Device Manager ser = serial . Serial ( 'COM4' , 9800 , timeout = 1 ) time . sleep ( 2 ) for i in range ( 50 ): line = ser . readline () # read a byte if line : string = line . decode () # convert the byte string to a unicode string num = int ( string ) # convert the unicode string to an int print ( num ) ser . close () Run the potentiometer.py script and twist the little blue potentiometer back and forth. You should see numbers running down the terminal. The numbers change as you dial the potentiometer back and forth. Write a Python script to record the potentiometer readings and plot the readings over time Now let's write a Python script that records the potentiometer readings and plots the potentiometer readings over time. We'll plot the potentiometer reading with Matplotlib . Matplotlib is a Python package used to build plots. Before we can use Matplotlib , Matplotlib needs to be installed into our (arduino) virtual environment. We'll use the Anaconda Prompt to install Matplotlib . Make sure you are in the (arduino) virtual environment when you run the install command. (arduino) > conda install matplotlib We can confirm that Matplotlib is installed using the Python REPL: (arduino) > python Python 3.7.1 (default, Dec 10 2018, 22:54:23) [MSC v.1915 64 bit (AMD64)] :: Anaconda, Inc. on win32 Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. >>> import matplotlib >>> matplotlib.__version__ '3.3.4' >>> exit() (arduino) > Now that Matplotlib is installed, create a new Python script called potentiometer_plot.py . Include the code below in the potentiometer_plot.py script. Again, remember to modify the COM# from 'COM4' to the Port you found in the Windows Device Manager. # potentiometer_plot.py import serial import time import matplotlib.pyplot as plt # make sure the 'COM#' is set according the Windows Device Manager ser = serial . Serial ( 'COM4' , 9800 , timeout = 1 ) time . sleep ( 2 ) data = [] for i in range ( 50 ): line = ser . readline () # read a byte string if line : string = line . decode () # convert the byte string to a unicode string num = int ( string ) # convert the unicode string to an int print ( num ) data . append ( num ) # add int to data list ser . close () # build the plot plt . plot ( data ) plt . xlabel ( 'Time' ) plt . ylabel ( 'Potentiometer Reading' ) plt . title ( 'Potentiometer Reading vs. Time' ) plt . show () Run the potentiometer.py script and turn the blue potentiometer back and forth. You will see numbers running down the screen and then a plot pops up that looks kind of like the plot below. Note the line on your plot will look different, but the title and axis labels should look the same. Fantastic! We used Python to read a sensor! When the Python script is run and the potentiometer is dialed back and forth, we see a plot of the potentiometer reading over time. Summary In this post, we used Python to read a potentiometer. We used a bunch of technologies to complete this project. Arduino Hardware: we wired a potentiometer and an LED to an Arduino using jumper wires, a resistor, and a breadboard. Arduino IDE: we used the Arduino IDE to upload code to the Arduino. Arduino sketches: we used a couple of Arduino sketches (Arduino programs). Arduino sketches end in the .ino file extension. Arduino Serial Monitor and Arduino Serial Plotter: we used the Arduino Serial Monitor and Arduino Serial Plotter to see if the potentiometer reading was sent over the serial line. Windows Device Manager: We used the Windows Device Manager to see which COM Port the Arduino was connected to. Anaconda Prompt: We used the Anaconda Prompt to create a virtual environment and install Python packages. Virtual Environments: We created a virtual environment with the Anaconda Prompt to house all the Python packages we used in the project. Python REPL: We used the Python REPL (the Python Prompt) to confirm Python packages were installed correctly and run quick commands to confirm Python could communicate with the Arduino. Python Scripts: We wrote a couple of Python scripts. Python scripts end in the .py file extension and contain Python code. The Python scripts recorded the potentiometer readings. PySerial: The PySerial Python package was used to read data coming from the Arduino. Matplotlib: The Matplotlib Python package was used to plot the data recorded by the Python script. Going further This project can be extended in several ways. For example, a different type of sensor could replace the potentiometer. A light sensor, temperature sensor, or pressure sensor could be used instead of a potentiometer. Two or three sensors could be connected to the Arduino at the same time as well. The plotting script can also be extended. The script could ask the user for the amount of time they wanted to record data. Or the script could produce an animated plot of the data mimicking the Arduino Serial Monitor. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var align = \"center\", indent = \"0em\", linebreak = \"false\"; if (false) { align = (screen.width < 768) ? \"left\" : align; indent = (screen.width < 768) ? \"0em\" : indent; linebreak = (screen.width < 768) ? 'true' : linebreak; } var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML'; var configscript = document.createElement('script'); configscript.type = 'text/x-mathjax-config'; configscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: '\"+ align +\"',\" + \" displayIndent: '\"+ indent +\"',\" + \" showMathMenu: true,\" + \" messageStyle: 'normal',\" + \" tex2jax: { \" + \" inlineMath: [ ['\\\\\\\\(','\\\\\\\\)'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" availableFonts: ['STIX', 'TeX'],\" + \" preferredFont: 'STIX',\" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} },\" + \" linebreaks: { automatic: \"+ linebreak +\", width: '90% container' },\" + \" }, \" + \"}); \" + \"if ('default' !== 'default') {\" + \"MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {\" + \"var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;\" + \"VARIANT['normal'].fonts.unshift('MathJax_default');\" + \"VARIANT['bold'].fonts.unshift('MathJax_default-bold');\" + \"VARIANT['italic'].fonts.unshift('MathJax_default-italic');\" + \"VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');\" + \"});\" + \"MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {\" + \"var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;\" + \"VARIANT['normal'].fonts.unshift('MathJax_default');\" + \"VARIANT['bold'].fonts.unshift('MathJax_default-bold');\" + \"VARIANT['italic'].fonts.unshift('MathJax_default-italic');\" + \"VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');\" + \"});\" + \"}\"; (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript); (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"python and arduino","url":"python-arduino-potentiometer.html","loc":"python-arduino-potentiometer.html"},{"title":"How to make y-y plots with Matplotlib","text":"In this post, you will learn how to create y-y plots with Python and Matplotlib. y-y plots are a type of line plot where one line corresponds to one y-axis and another line on the same plot corresponds to a different y-axis. y-y plots typically have one vertical y-axis on the left edge of the plot and one vertical y-axis on the right edge of the plot. Each one of these y-axes can have different scales and can correspond to different units. Install Python, Matplotlib, NumPy, and Jupyter We are going to build our y-y plot with Python and Matplotlib. Matplotlib is a popular plotting library for Python. Before we can build the plot, Python needs to be installed on our computer. See this post to review how to install Python. I recommend installing the Anaconda distribution of Python, rather than installing Python from Python.org . Matplotlib can be installed using the Anaconda Prompt or using the command line and pip , the package manager for Python. Matplotlib comes pre-installed with the Anaconda distribution of Python. If you are using the Anaconda distribution of Python, no further installation steps are necessary to use Matplotlib. Two other libraries we will use to build the plot are NumPy and Jupyter. Type the command below into the Anaconda Prompt to install Matplotlib, NumPy, and Jupyter. > conda install matplotlib numpy jupyter The same three libraries can also be installed using a terminal and pip : $ pip install matplotlib numpy jupyter We'll use a Jupyter notebook to build the y-y plot. A .py file could be used as well. The Python code is the same (except for the %matplotlib inline command). I like using Jupyter notebooks to build plots because of the quick feedback, in-line plotting, and ability to easily see which plot corresponds to a block of code. A new Jupyter notebook can be launched from the Anaconda Prompt or a terminal with the command: > jupyter notebook Imports At the top of our Jupyter notebook, we'll include a section for imports. These import lines are necessary so that we can use Matplotlib and NumPy functions later in the script. Matplotlib will be used to build the plot. We will also use NumPy, a Python library for dealing with arrays to create our data. In [1]: import numpy as np import matplotlib.pyplot as plt % matplotlib inline The versions of Python, NumPy, and Matplotlib can be printed out using the following code: In [2]: import matplotlib import sys print ( f 'Python version {sys.version} ' ) print ( f 'Matplotlib version {matplotlib.__version__} ' ) print ( f 'NumPy version {np.__version__} ' ) Python version 3.8.5 (default, Sep 3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)] Matplotlib version 3.3.4 NumPy version 1.19.2 Data We need data to include in our y-y plot. We'll start out by creating two NumPy arrays, one array for the sine function and one array for the exp function ($e&#94;x$). These functions are good examples to use in a y-y plot because the range of values sin(x) and exp(x) output is very different. In [3]: x = np . arange ( 0 , 8 * np . pi , 0.1 ) y1 = np . sin ( x ) y2 = np . exp ( x ) Plot the two functions Let's try and plot both of these functions. Each function can be plotted with Matplotlib's ax.plot() method. The two code cells below show a plot for each function in a separate figure window. In [4]: fig , ax = plt . subplots () ax . plot ( x , y1 ) ax . set_title ( 'sin(x)' ) plt . show () Above, we see a plot of the sine function. Note the y-values in the plot are all between -1 and 1 . We can build a line plot of the exp function using very similar code. In [5]: fig , ax = plt . subplots () ax . plot ( x , y2 ) ax . set_title ( 'exp(x)' ) plt . show () We see a plot of the exponential (exp) function. Note the y-values are between 0 and around 8e10 . The range of y-values in the exp plot is much larger in the exp(x) plot than the range of values in the sin(x) plot. Now let's try and plot these two functions on the same set of axes. The code below builds a plot with both functions on the same set of axes. In [6]: fig , ax = plt . subplots () ax . plot ( x , y1 ) ax . plot ( x , y2 ) ax . set_title ( 'sin(x) and exp(x)' ) ax . legend ([ 'sin(x)' , 'exp(x)' ]) plt . show () We see a plot with two lines. The blue line represents the sine function and the orange line represents the exp function. Notice how the blue line looks flat. We can't see the variations in the sine wave. A figure with two subplots One way we could view both functions at the same time is to use subplots. The code below builds a figure with two subplots, one function in each subplot. In [7]: fig , ( ax1 , ax2 ) = plt . subplots ( nrows = 1 , ncols = 2 , figsize = ( 12 , 4 )) ax1 . plot ( x , y1 ) ax1 . set_title ( 'sin(x)' ) ax2 . plot ( x , y2 , 'C1' ) ax2 . set_title ( 'exp(x)' ) plt . show () We see two plots side by side. Each plot shows a different function. The plot on the left shows the sine function, the plot on the right shows the exp function. y-y plot Now let's combine these two plots on the same set of axes, but with two different y-axes. The y-axis on the left will correspond to the sine function. The y-axis on the right will correspond to the exp function. The key line of code is ax2 = ax1.twinx() . This line of code creates a new axes object ax2 that shares the same x-axis with ax1 . The .twinx() method is what allows us to create a y-y plot. In [8]: fig , ax1 = plt . subplots () ax1 . plot ( x , y1 ) ax1 . set_title ( 'sin(x) and exp(x)' ) ax2 = ax1 . twinx () ax2 . plot ( x , y2 , 'C1' ) plt . show () We see a plot of our two functions. In the plot above, we can clearly see both the sine function and the exp function. The y-axis that corresponds to the sine function is on the left. The y-axis that corresponds to the exp function is on the right. Next, we'll color the axes and the axis labels to correspond to the line on the plot that it corresponds to. Color each y-axis It's nice to be able to see the shape of both functions. However, it isn't obvious which function (which color line) corresponds to which axis. We can color the axis, tick marks, and tick labels to clearly demonstrate which line on the plot corresponds to which one of the y-axes. Note that in the code below, we don't set the spines color to blue on ax1 even though ax1 contains the blue line. This is because after we plot on ax1 , the spines on ax2 \"overlap\" the spines on ax1 . There is no overlap of tick_params , so those can be set on ax1 . In [9]: fig , ax1 = plt . subplots () ax1 . plot ( x , y1 ) ax1 . set_ylabel ( 'sin(x)' , color = 'C0' ) ax1 . tick_params ( axis = 'y' , color = 'C0' , labelcolor = 'C0' ) ax1 . set_title ( 'sin(x) and exp(x)' ) ax2 = ax1 . twinx () ax2 . plot ( x , y2 , 'C1' ) ax2 . set_ylabel ( 'exp(x)' , color = 'C1' ) ax2 . tick_params ( axis = 'y' , color = 'C1' , labelcolor = 'C1' ) ax2 . spines [ 'right' ] . set_color ( 'C1' ) ax2 . spines [ 'left' ] . set_color ( 'C0' ) plt . show () We see a plot with colored y-axis lines and colored y-axis labels. The blue line corresponds to the blue left-hand axis and labels. The orange line corresponds to the orange right-hand axis and labels. Next, we'll add a legend to our plot. Add a legend to the y-y plot The color of the axis, tick marks, and tick labels correspond to the color of the line on our plot. But it would be nice to include a legend on the plot so that others could see which line corresponds to sine and which line corresponds to exp. The problem is that if we call ax.legend(['sin','exp']) we only end up with a legend with one entry. To get around this problem, we apply the legend to the entire figure object fig . The line fig.legend(['sin(x)','exp(x)'] creates the legend. bbox_to_anchor=(0.9, 0.8)) is added as a keyword argument to ensure the legend is within the space of the plot and not way off to the side. This is because we are applying the legend relative to the figure window and not relative to the axes. In [10]: fig , ax1 = plt . subplots () ax1 . plot ( x , y1 ) ax1 . set_ylabel ( 'sin(x)' , color = 'C0' ) ax1 . tick_params ( axis = 'y' , color = 'C0' , labelcolor = 'C0' ) ax1 . set_title ( 'sin(x) and exp(x)' ) ax2 = ax1 . twinx () ax2 . plot ( x , y2 , 'C1' ) ax2 . set_ylabel ( 'exp(x)' , color = 'C1' ) ax2 . tick_params ( axis = 'y' , color = 'C1' , labelcolor = 'C1' ) ax2 . spines [ 'right' ] . set_color ( 'C1' ) ax2 . spines [ 'left' ] . set_color ( 'C0' ) fig . legend ([ 'sin(x)' , 'exp(x)' ], bbox_to_anchor = ( 0.9 , 0.8 )) plt . show () We see a plot with two lines, two different color y-axes, and a legend. One more thing we can try is to create the legend in an alternate way. Alternative way to add a legend to a y-y plot An alternative way to add a legend to a y-y plot is to specify exactly which line objects should go into the legend. Usually, when the ax.plot() method is called, the output of it is not saved to a variable. But if we save the output of the ax.plot() method, we can feed it into our ax1.legend() call in order to specify which lines should be included in the legend. The key line in the code below is lines = line1 + line2 . Then we use the lines object when we call ax1.legend() . The code below creates a y-y plot with a legend in an alternate way. In [11]: fig , ax1 = plt . subplots () line1 = ax1 . plot ( x , y1 ) ax1 . set_ylabel ( 'sin(x)' , color = 'C0' ) ax1 . tick_params ( axis = 'y' , color = 'C0' , labelcolor = 'C0' ) ax1 . set_title ( 'sin(x) and exp(x)' ) ax2 = ax1 . twinx () line2 = ax2 . plot ( x , y2 , 'C1' ) ax2 . set_ylabel ( 'exp(x)' , color = 'C1' ) ax2 . tick_params ( axis = 'y' , color = 'C1' , labelcolor = 'C1' ) ax2 . spines [ 'right' ] . set_color ( 'C1' ) ax2 . spines [ 'left' ] . set_color ( 'C0' ) lines = line1 + line2 ax2 . legend ( lines , [ 'sin(x)' , 'exp(x)' ]) plt . show () We see a y-y plot with two colored y-axes and a legend in the upper-left corner. Summary In this post, we constructed a y-y plot with Matplotlib and Python. y-y plots are useful when you have two sets of data that are in different scales. Matplotlib's ax2 = ax1.twinx() method was used to create our y-y plots. We customized the plots with colored y-axes and included a legend on the plots in two different ways.","tags":"matplotlib","url":"how-to-make-y-y-plots-with-matplotlib.html","loc":"how-to-make-y-y-plots-with-matplotlib.html"},{"title":"Writing Tests for Scientific Code","text":"In a previous blog post , I wrote about how to incorporate a few software design principals into the code written by scientists. This post is a follow up on one specific software design principle that can be used by scientists: testing Below are some practical ideas about how to incorporate software tests into code written by scientists for data analysis and plotting. Keep in mind the steps and tests below don't correspond to every piece of scientific code. My ideas are not designed to revolutionize the ways scientists write code, or fix reproducibility problems in published scientific research, or be a strict TDD (Test-Driven Development) framework for scientific code. The ideas below are some things I came up with that I wanted to share. I hope this post is helpful and starts a few conversations about testing in scientific software. OK - with that disclaimer out of the way, let's get started. A sample notebook The example scientific code we will be working with in this post is made up of one long script. In the rest of this post, we are going to work on adding tests to this scientific script. Very often, scientific code includes a couple of common steps: Read in data Clean or reorganize data Run calculations on the data Create a figure or plot Below is a sample Jupyter notebook (that we'll use in the rest of this post) with Python code that reads in a .csv file of data, cleans up the data, runs a calculation, then produces a plot. The data in this example is from a mechanical test frame (a piece of equipment that tests the strength of materials), but the same testing ideas in this post could be applied to a script that analyzes data in another subject area. You can find the Jupyter notebook here: analysis.ipynb and the raw data here: raw_data.csv # analysis.ipynb import numpy as np import pandas as pd import matplotlib.pyplot as plt raw_data_df = pd . read_csv ( 'data/raw_data.csv' ) raw_data_array = np . array ( raw_data_df ) cleaned_data_array = raw_data_array [ 1 :,:] d = 0.506 A0 = np . pi * ( d / 2 ) ** 2 F = cleaned_data_array [:, 4 ] * 0.001 stress = F / A0 strain = cleaned_data_array [:, 5 ] * 0.01 ts = np . max ( stress ) te = np . max ( strain ) - np . min ( strain ) print ( f 'Tensile Strength={ts}' ) print ( f 'Total Extension={te}' ) fig , ax = plt . subplots () ax . plot ( strain , stress ) ax . set_xlabel ( \"Strain (mm/mm)\" ) ax . set_ylabel ( \"Stress (MPa)\" ) ax . set_title ( \"Stress Strain Curve\" ) plt . savefig ( \"plot.png\" ) plt . show () When the code is run, the plot produced looks like the plot below: In the code above, notice the line raw_data_df = pd.read_csv('data/raw_data.csv') This line shows the .csv data file isn't in the same directory as the script. The .csv file is in a sub-directory called data/ . In scientific code, it's a good idea to keep the data separate from the script that analyzes the data. How can we possibly write software tests for this script? Testing in Scientific Software is about Reproducibility The first idea isn't code or a specific test, it's the idea that testing scientific code is about ensuring reproducibility . It's my understanding that testing software in general (not scientist's code) is about ensuring the system runs error-free and accomplishes what the programmer intends. In a scientist's code, my argument is that testing should be more about making sure the code is reproducible by other researchers (or more likely useable to the scientist 6 months later or a new grad student) than ensuring the code runs error-free or produces the desired result. All scientists what their research to be reproducible, right? Use a .py-file instead of a Jupyter notebook The second idea is to write scientific code in a .py-file instead of writing the code in a Jupyter notebook. Now, I love Jupyter notebooks as much as the next Engineer. Jupyter notebooks are great for data exploration, plot creation, and presentation. But... Jupyter notebook cells can be run in any order. The execution order of a Jupyter notebook sometimes affects the output of the code. When code is in a .py-file, the execution order of the lines of Python code is set by your programming logic. So ideally, each time you run the .py-file, the output is the same. Therefore after initial data exploration, move code from a Jupyter notebook into a .py-file. After initial data exploration, move code from a Jupyter notebook into a .py-file Within the Jupyter notebook interface, you can select File → Download As and select Python (.py) as the file type. Move the downloaded analysis.py file to the main project directory where the data folder is, at the same level as analysis.ipynb . The top of analysis.py looks like the code below. Notice how Jupyter adds a shebang and encoding line at the top of the file. #!/usr/bin/env python # coding: utf-8 # In[1]: # analysis.ipynb import numpy as np import pandas as pd import matplotlib.pyplot as plt ... After the Jupyter notebook is saved as a .py-file, run the .py-file from the command line. > python analysis . py The output produced by the .py-file should be the same as the Jupyter notebook output. In the next section, we'll deal with Python versions and dependencies. Define Package Dependencies and Python Version After the scientific script is saved in a .py-file, the next step is to define the Python version and dependencies needed to run the script. This can be accomplished by creating a requirements.txt file that contains the specific versions of the packages your script is run with. These packages just need to be the high-level dependencies that are imported by your script. The contents of a sample requirements.txt file are below. Note that pytest is also included as a dependency. We are going to use pytest a little later to test our script. numpy==1.19.2 pandas==1.2.2 matplotlib==3.3.4 pytest==6.2.2 If you don't know what version of matplotlib you are using, open the Python REPL and type: >>> import matplotlib >>> matplotlib.__version__ '3.3.4' The .__version__ attribute is commonly defined for popular Python packages. In addition to the packages used by our script, we can also define which version of Python we're are using. The Python version can be stored in a file called runtime.txt . The contents of a runtime.txt file is below: python-3.8.5 If you don't know what version of Python you are using, it's easy to figure out. The Python version is shown when you enter the Python REPL. In a terminal type python and the version is printed out above the REPL prompt. > python Python 3.8.5 (default, Jul 2 2020, 17:30:36) [MSC v.1916 64 bit (AMD64)] :: Anaconda, Inc. on win32 Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. >>> At this point, we have converted an original Jupyter notebook into a Python script. We have also included a requirements.txt file and a runtime.txt file alongside our script. The directory structure of our growing project is shown below. project/ analysis.ipynb analysis.py requirements.txt runtime.txt plot.png data/ raw_data.csv Our dependencies and Python version are defined. Let's write our first tests! Test Dependency Versions and Python Version Now that we defined our package versions and Python version, we can write tests to confirm these are the same versions that run our script. If another researcher wants to run our script, they can confirm through our tests that they are using the same dependency versions we are. Test Dependencies Create a new directory called tests and inside the tests directory, create a new file called test_dependencies.py . Also, create a blank __init__.py file alongside the test_dependencies.py file. You can leave __init__.py empty. The file just has to have the name __init__.py . This tile defines the tests/ directory as a package. The directory structure of our project now looks like: project/ analysis.ipynb analysis.py requirements.txt runtime.txt plot.png data/ raw_data.csv tests/ __init__.py test_dependencies.py Inside the test_dependencies.py file, we can write tests that confirm the versions of the packages we say are necessary in our requirements.txt file. Examples of these tests are below. The tests are written using pytest , an excellent testing framework that is pretty easy to use. # tests/test_dependencies.py from pathlib import Path import matplotlib as mpl import numpy as np import pandas as pd fp = Path ( Path . cwd (), \"requirements.txt\" ) with open ( fp , \"r\" ) as f : v = f . readlines () d = {} for l in v : r = l . split ( \"==\" )[ 0 ] ver = l . split ( \"==\" )[ 1 ] . strip () d [ r ] = ver def test_numpy_version (): expected = d [ \"numpy\" ] actual = np . __version__ assert actual == expected def test_pandas_version (): expected = d [ \"pandas\" ] actual = pd . __version__ assert actual == expected def test_matplotlib_version (): expected = d [ \"matplotlib\" ] actual = mpl . __version__ assert actual == expected The code at the top of the file reads our requirements.txt file and parses our required packages and versions into a Python dictionary. Below are three tests, one test for each required package. We can run these tests from the command line as long as pytest is installed. If it isn't installed, pytest can be installed with pip > pip install pytest The command below runs the tests we defined in test_dependencies.py with pytest. > python -m pytest tests/test_dependencies.py The output should be something like below: ============================== test session starts =============================== platform linux -- Python 3.8.5, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 rootdir: /home/peter/Documents/testing-scientific-code collected 3 items tests/test_dependencies.py ... [100%] =============================== 3 passed in 0.25s ================================ If you want more information about the tests, use the -v flag. > python -m pytest -v tests/test_dependencies.py Using the -v flag provides additional information in the test output: collected 3 items tests/test_dependencies.py::test_numpy_version PASSED [ 33%] tests/test_dependencies.py::test_pandas_version PASSED [ 66%] tests/test_dependencies.py::test_matplotlib_version PASSED [100%] =============================== 3 passed in 0.25s ================================ Are you sure those are the package versions you are using? If all the tests pass, that means the packages running the code are installed and the same versions specified in requirements.txt Test Python Version We can also write a test for the version of Python we're using. Create a new file called test_python_version.py in the tests/ directory. Add the code below to test_python_version.py . The test below ensures Python version 3.8.5 is used. That's the version of Python we specified in runtime.txt . Make sure to import the platform module from the Python Standard Library at the top of test_python_version.py or the test won't work. # tests/test_python_version.py from pathlib import Path import platform def test_python_version (): rt_fp = Path ( Path . cwd (), \"runtime.txt\" ) with open ( rt_fp , \"r\" ) as f : v = f . readline () . strip () . split ( \"-\" )[ 1 ] expected = v actual = platform . python_version () assert actual == expected The new test can be run on the command line with pytest. > python -m pytest tests/test_python_version.py The output should look something like this: collected 1 item tests/test_python_version.py . [100%] =============================== 1 passed in 0.01s ================================ If the test passes, that means the Python version (running the code) is the same as the Python version we specified in runtime.txt . Test Character Encoding One more test we can write is to test what character encoding is used. On most computers, the character encoding is utf-8 . We can check for the character encoding by writing another test. Let's code this test in a file called test_system_encoding.py in the tests/ directory. The character encoding test below uses the sys module. Make sure to import the sys module at the top of the test_system_encoding.py file. # tests/test_system_encoding.py import sys def test_system_encoding (): expected = \"utf-8\" actual = sys . getfilesystemencoding () assert actual == expected We can run the test with pytest. python -m pytest tests/test_system_encoding.py If your computer is using the utf-8 character encoding, the test will pass: ============================== test session starts =============================== platform linux -- Python 3.8.5, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 rootdir: /home/peter/Documents/testing-scientific-code collected 1 item tests/test_system_encoding.py . [100%] =============================== 1 passed in 0.01s ================================ So far we have written tests in three different test files. Our project directory structure now looks like: project/ analysis.ipynb analysis.py requirements.txt runtime.txt plot.png data/ raw_data.csv tests/ __init__.py test_dependencies.py test_python_version.py test_system_encoding.py Our 5 tests are great right? Yes, yes they are great. But... How can we test the scientific code in the script analysis.py itself? Before we can test the script, we need to break the script up into functions. Break the script up into functions Next, we are going to break our analysis.py script up into functions. Let's use the four bullet points below to help guide us through how to break the long analysis.py script into 3 or 4 pieces. Read in data Clean or reorganize the data Run calculations Create a figure or plot The code below shows how each one of the steps can be encapsulated in a function. # analysis.py import numpy as np import pandas as pd import matplotlib.pyplot as plt def import_data (): raw_data_df = pd . read_csv ( 'data/raw_data.csv' ) raw_data_array = np . array ( raw_data_df ) return raw_data_array def clean_data ( raw_data_array ): cleaned_data_array = raw_data_array [ 1 :,:] return cleaned_data_array def get_stress_and_strain ( cleaned_data_array ): d = 0.506 A0 = np . pi * ( d / 2 ) ** 2 F = cleaned_data_array [:, 4 ] * 0.001 stress = F / A0 strain = cleaned_data_array [:, 5 ] * 0.01 return stress , strain def get_tensile_strength ( stress , strain ): return np . max ( stress ) . round ( 3 ) def get_total_extension ( stress , strain ): return np . max ( strain ) - np . min ( strain ) def plot ( x , y ): fig , ax = plt . subplots () ax . plot ( x , y ) ax . set_xlabel ( \"Strain (mm/mm)\" ) ax . set_ylabel ( \"Stress (MPa)\" ) ax . set_title ( \"Stress Strain Curve\" ) plt . show () Let's end the script by defining a main() function that calls the functions defined above in the proper order. Then we can call the main() function with an if __name__ == \"__main__\": line. def main (): raw_data_array = import_data () clean_data_array = clean_data ( raw_data_array ) stress , strain = get_stress_and_strain ( clean_data_array ) plot ( strain , stress ) ts = get_tensile_strength ( stress , strain ) te = get_total_extension ( stress , strain ) print ( f \"Tensile Strength: {ts}, Total Extension: {te}\" ) if __name__ == \"__main__\" : main () Run the script from the command line. > python analysis.py A plot should be produced and the output should be the same as when the script didn't contain any user-defined functions. Now that we've divided our script up into functions, we can make sure our script doesn't modify our raw data by writing another test. Test if the code modifies the data When our code runs, it should not modify, rename, rewrite or otherwise change our original data. Scientific code should not modify, rename or rewrite the original data Let's create a new test file in the tests/ directory called test_data_unchanged.py . The directory structure should now look like: project/ analysis.ipynb analysis.py requirements.txt runtime.txt plot.png data/ raw_data.csv tests/ __init__.py test_dependencies.py test_python_version.py test_system_encoding.py test_data_unchanged.py The test to make sure our script doesn't change the raw data file is below. All the attributes listed in the test from the os.stat object should be the same before the script runs and after the script runs. # tests/test_data_unchanged.py import os from pathlib import Path import analysis def test_data_is_unchanged (): fp1 = Path ( \"data/raw_data.csv\" ) d1 = os . stat ( fp1 ) analysis . main () fp2 = Path ( \"data/raw_data.csv\" ) d2 = os . stat ( fp2 ) assert ( d1 . st_mode == d2 . st_mode and d1 . st_ino == d2 . st_ino and d1 . st_dev == d2 . st_dev and d1 . st_nlink == d2 . st_nlink and d1 . st_uid == d2 . st_uid and d1 . st_gid == d2 . st_gid and d1 . st_size == d2 . st_size and d1 . st_mtime == d2 . st_mtime and d1 . st_ctime == d2 . st_ctime ) Run the data_is_unchanged() test from the command line. If the test passes, that means the data file raw_data.csv is not modified by our script. python -m pytest tests/test_data_unchanged.py ============================== test session starts =============================== platform linux -- Python 3.8.5, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 rootdir: /home/peter/Documents/testing-scientific-code collected 1 item tests/test_data_unchanged.py . [100%] ========================== 1 passed, 1 warning in 0.40s ========================== To test the functions in the script itself, it is helpful for each function in the script to accept input and produce output. Therefore, next, we'll modify the functions of our script and make sure each function includes inputs and outputs. Ensure each function accepts input and produces output Now that we know our script doesn't modify the data it uses, we are going to modify the functions of our script to be more testable. To make these functions more testable, we'll add inputs and output where possible. Is it clear what the input and output of our functions should be? For a function that produces a plot, assign the outputs as Matplotlib fig and ax objects. The code below includes modifications to our script analysis.py . # analysis.py from pathlib import Path import numpy as np import pandas as pd import matplotlib.pyplot as plt def import_data ( f_path ): df = pd . read_csv ( f_path ) np_raw_array = np . array ( df ) return np_raw_array def clean_data ( raw_np_array ): np_array = raw_np_array [ 1 :, :] return np_array def get_stress_and_strain ( cleaned_data_array ): d = 0.506 A0 = np . pi * ( d / 2 ) ** 2 F = cleaned_data_array [:, 4 ] * 0.001 stress = F / A0 strain = cleaned_data_array [:, 5 ] * 0.01 return stress , strain def plot ( x , y , title , x_label , y_label , f_name ): fig , ax = plt . subplots () ax . plot ( x , y ) ax . set_title ( title ) ax . set_xlabel ( x_label ) ax . set_ylabel ( y_label ) save_plot ( fig , f_name ) plt . show () return fig , ax def save_plot ( fig , fname ): fig . savefig ( fname ) return fig def get_tensile_strength ( stress , strain ): return np . max ( stress ) . round ( 3 ) def get_total_extension ( stress , strain ): return np . max ( strain ) - np . min ( strain ) Now we can modify the main() function and include a file path for our raw data and file name for our saved figure. def main (): raw_data_path = Path ( Path . cwd (), \"data\" , \"raw_data.csv\" ) raw_data_array = import_data ( raw_data_path ) clean_data_array = clean_data ( raw_data_array ) stress , strain = get_stress_and_strain ( clean_data_array ) title = \"Stress Strain Curve\" xlabel = \"Strain (mm/mm)\" ylabel = \"Stress (MPa)\" f_name = \"plot.png\" plot ( strain , stress , title , xlabel , ylabel , f_name ) ts = get_tensile_strength ( stress , strain ) te = get_total_extension ( stress , strain ) print ( f \"Tensile Strength: {ts}, Total Extension: {te}\" ) if __name__ == \"__main__\" : main () OK - our functions have inputs and outputs. Let's get to testing them with pytest. Test the analysis functions Now we are going to use pytest to test the analysis functions in our analysis.py script. Create a new file called test_analysis.py in the tests/ directory. The directory strucuture now looks like: project/ analysis.ipynb analysis.py requirements.txt runtime.txt data/ raw_data.csv output/ plot.png tests/ __init__.py test_analysis.py test_dependencies.py test_python_version.py test_data_unchanged.py test_system_encoding.py Create some sample data At the top of test_analysis.py let's add our imports and some sample data to test our functions with. # tests/test_analysis.py import numpy as np import analysis x = np . array ([ 1 , 2 , 3 ]) y = np . array ([ 6 , 7 , 10 ]) Below the imports and data, we can write a test for each one of our analysis functions. def test_tensile_strength (): expected = 10.0 actual = analysis . get_tensile_strength ( y , x ) assert round ( expected , 3 ) == round ( actual , 3 ) def test_total_extension (): expected = 3 - 1 actual = analysis . get_total_extension ( y , x ) assert round ( expected , 3 ) == round ( actual , 3 ) Our two analysis tests can be run from the command line with pytest. > python -m pytest tests/test_analysis.py Hopefully, both tests pass. ============================== test session starts =============================== platform linux -- Python 3.8.5, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 rootdir: /home/peter/Documents/testing-scientific-code collected 2 items tests/test_analysis.py .. [100%] =============================== 2 passed in 0.39s ================================ Next, we'll test our plot construction. Testing the plot is a little more complicated than our other tests. To test the plot, we'll use a great feature of pytest called fixtures . Test the plot Testing the construction of Matplotlib plots is a little more difficult than testing our analysis functions. We aren't going to test every last bit of plot construction, but we can test parts of the plot, like confirming the axis labels and titles are added correctly. To test the plot, it's useful to create a plot to test. Since each test needs this plot to be created, we'll create a pytest fixture that can be used in each of our plot tests. The fixture saves us from writing the same plot construction code in each test. We'll test the plot in a new test file called test_plot.py . There should be a total of six test files in our tests/ directory. The files in the tests/ directory are shown below. tests/ test_analysis.py test_data_unchanged.py test_dependencies.py test_plot.py test_python_version.py test_system_encoding.py At the top of test_plot.py we include our imports and define our fixture function called set_up_plot() . Notice the pytest @pytest.fixture decorator attached to the fixture function. # tests/test_plot.py from pathlib import Path import matplotlib import numpy as np import pytest import analysis @pytest.fixture def set_up_plot (): x = np . array ([ 1 , 2 , 3 ]) y = np . array ([ 6 , 7 , 10 ]) fig , ax = analysis . plot ( x , y , \"my_title\" , \"my_x_axis_label\" , \"my_y_axis_label\" , \"plot.png\" ) return ( fig , ax ) Below the fixture, we can add tests for the plot. We feed the fixture function into the test functions as an input argument. Within the body of the test functions, we can extract the outputs of our fixture function set_up_plot() and test against them. Note how our fixture function above returns a tuple. The first item in the tuple is a matplotlib figure object fig and the second item in the tuple is a matplotlib axes object ax . Calling set_up_plot[0] within a test definition returns fig and calling set_up_plot[1] returns ax . Five tests of the plot are below. def test_plot_x_axis_label ( set_up_plot ): assert set_up_plot [ 1 ] . xaxis . label . get_text () == \"my_x_axis_label\" def test_plot_y_axis_label ( set_up_plot ): assert set_up_plot [ 1 ] . yaxis . label . get_text () == \"my_y_axis_label\" def test_plot_title_label ( set_up_plot ): assert set_up_plot [ 1 ] . title . get_text () == \"my_title\" def test_figure_object ( set_up_plot ): assert type ( set_up_plot [ 0 ]) == matplotlib . figure . Figure def test_axes_object ( set_up_plot ): assert set_up_plot [ 0 ] == set_up_plot [ 1 ] . get_figure () Run the tests with pytest: > python -m pytest tests/test_plot.py The output should be similar to the output below: collected 5 items tests/test_plot.py::test_plot_x_axis_label PASSED [ 20%] tests/test_plot.py::test_plot_y_axis_label PASSED [ 40%] tests/test_plot.py::test_plot_title_label PASSED [ 60%] tests/test_plot.py::test_figure_object PASSED [ 80%] tests/test_plot.py::test_axes_object PASSED [100%] =============================== 5 passed in 2.63s ================================ Run all the tests We can run all the tests we have written, in all the test files at once by passing the whole tests/ directory to pytest > python -m pytest tests/ The output should be similar to: collected 13 items tests\\test_analysis.py .. [ 15%] tests\\test_data_unchanged.py . [ 23%] tests\\test_dependencies.py ... [ 46%] tests\\test_plot.py ..... [ 84%] tests\\test_python_version.py . [ 92%] tests\\test_system_encoding.py . [100%] =============================== 13 passed in 4.17s =============================== Nice! We wrote a total of 13 tests in 6 different test files and they all passed! Wrap-Up In this post, we tested a scientific script using pytest. We accomplished this in a couple of steps. convert Jupyter notebook to a .py-file divide .py-file up into functions test Python version, dependencies, and text encoding test the script doesn't change the data test the analysis functions test the plot Tests like the ones shown in this post could be written for scripts written by scientists that follow the same basic steps of data ingest and cleaning, analysis, and plotting. I hope you found this useful and can use some of these testing ideas in your code.","tags":"Python","url":"writing-tests-for-scientific-code.html","loc":"writing-tests-for-scientific-code.html"},{"title":"Thoughts on Software Design in Scientific Code","text":"I listened to a few podcasts (TalkPython, Test and Code) that had a theme of: \"How do we bring software design principles into science?\" This got me thinking... There are a couple of ways software design could be incorporated into science and the code scientists write. The science I'm thinking about deals with the collection and analysis of data (that's almost all science right?). A few practices that could be incorporated into computer programs written by scientists that analyze science data are below. The ideas below are not meant to \"fix\" scientific computing or solve the problem of reproducibility in science. The thoughts below are just a couple of topics running through my head when I thought about: How do we incorporate software design principles in science? Version Control Instead of naming files analysis-final.xlsx and analysis-final2.xlsx and analysis-final_v2_revisedpk.xlsx , use a version control system like git and GitHub.com. If this practice is adopted, scientists can add meaningful commit messages with each code change. Version control could also be used as part of the peer-review paper writing process. One commit could be the paper manuscript before peer review and another commit could be the paper revisions after peer review. Other scientists could look at the commit history on GitHub to see how the paper changed based on the feedback the author received from reviewers. Code Review When an analysis is completed, scientists could review their code with a partner. Have someone else in the lab review the code, have someone else in the lab run the same code on their computer and give structured feedback about it. Scientists have practice reviewing paper drafts and experiment design. They could use that experience to help review an analysis that includes code. Section Code into Modules and Functions Some scientific code is written in one or two long scripts. Another software design principle scientists could adopt is break code up into functions and modules (different files). A long 2000 line script can be broken up into different functions and these functions can be pulled out into different modules, or put into different files. Two rough guidelines: Each file should be able to fit on one screen Each function should be 10 lines or less These are not hard and fast rules, but something to aim for if a scientist doesn't know where to start. The last software design principle we'll talk about in this post is testing. Testing Testing is the last software design principle that could be brought into scientific code. Although data analysis and plotting don't particularly lend themselves to Test-driven Development (TDD). How do you know what the result should be until you find the result? The type of testing that does apply is scientific code testing for reproducibility . In this reproducibility testing mode, the things a scientist could test are: Which Python version is running the code? Which packages need to be installed? What versions of those packages need to be installed? Which character encoding is the code using (uft-8 anyone?) Conclusion To wrap up. Some scientific code is difficult to test. But there are things scientists can do to make the code more portable and incorporate the ideas of software design into scientific code. To help make a scientific script robust, consider trying the following: Use version control, like git and GitHub Participate in code review sessions with other researchers Break long scripts into functions and separate files Use testing to help ensure reproducibility I'm planning on writing a follow up post that shows some of these ideas in a practical example.","tags":"Python","url":"thoughts-on-software-design-in-scientific-code.html","loc":"thoughts-on-software-design-in-scientific-code.html"},{"title":"My first Twitch Stream: S01-E01 JupyterHub Intro and Tools","text":"I'm trying live streaming code . I did my first stream this week on Twitch. I'm going to try and stream on Tuesday at 8:30 pm-9:30 pm PST for the next 8 weeks. The link to my Twitch channel is below. https://www.twitch.tv/pkazarinoff I don't know how long Twitch will keep the video up. End of April 2020, the link below works to see the recorded stream. https://www.twitch.tv/videos/599019786 Watch S01:E01 JupyterHub Deployment Intro and Tools from pkazarinoff on www.twitch.tv","tags":"stream","url":"stream-S01-E01-jupyterhub-intro.html","loc":"stream-S01-E01-jupyterhub-intro.html"},{"title":"Hear my story about deploying JupyterHub on the Running in Production Podcast","text":"I was a guest on the Running in Production podcast with Nick Janetakis! We talked about how a Community College professor like me deployed JupyterHub online using a Digital Ocean cloud server. Check out the podcast episode here . If you want to see how I deployed JupyterHub for my students, see the link to the documentation I built of the process below: https://professorkazarinoff.github.io/jupyterhub-ENGR114-2019Q4/ I have been working on building some Ansible Playbooks to automate my JupyterHub deployments. Not ready for production, but you can see the Playbooks I've developed so far here: https://github.com/ProfessorKazarinoff/jupyterhub-ENGR114-2020Q1 Before we started recording, Nick and I chatted a bit and reviewed the Google Doc he sent me to prepare for the interview. Nick is a real pro. He made sure the audio quality was top-notch and assured me that he could edit out any trouble spots (like when I had to cough and take a drink of water during the recording). I recorded my audio hidden inside a closet in our basement surrounded by blankets. A couple of notes about being a podcast guest: Nick sent out a Google Doc with some talking points and how to set up audio recording with Audacity before we recorded. It was helpful to have some talking points to jog my mind during the interview. I set up to record in a closet and put my laptop on a folded towel. I used a USB microphone sitting on a different bin than the laptop and a set of headphones. Nick and I chatted over Zoom before we started recording. It was great to learn more about Nick and how he got into podcasting. Nick edited the audio after we recorded. Knowing that the recording could be modified was made it easier for me to speak freely. Because Running in Production episodes are edited and Nick has multiple guests lined up, the episode with me was posted a few weeks after we recorded. When the episode came out, I tweeted the episode link out (I also wrote this blog post). I listened to the episode while I was on a run. And honestly, it sounded great! Thank-you Nick and the Running in Production Podcast for helping me share my story with the software community!","tags":"podcasts","url":"jupyterhub-deployment-on-running-in-production.html","loc":"jupyterhub-deployment-on-running-in-production.html"},{"title":"Deploy a Jupyter Notebook Online with Voila and Heroku","text":"Jupyter notebooks are a great way to write and run Python code. Jupyter notebooks can produce text output, plots, and animations. Static Jupyter notebooks can be shared on GitHub.com and nbviewer . Another way to share Jupyter notebooks is a great Python package called Voila . Voila turns Jupyter notebooks into deployable web apps. In this post, you'll learn how to deploy a Jupyter notebook as a cloud-based web app with Voila and the cloud hosting service Heroku. Prerequisites This tutorial assumes you have Python installed on your local computer. I recommend installing the Anaconda distribution of Python Version 3.7, but you can also install Python from Python.org or the Windows Store. It is also assumed that you either have Windows Subsystem for Linux (WSL) installed or you are using MacOS or Linux itself. I recommend Ubuntu 18.04 LTS for your Linux distribution. You should also be able to bring up a terminal in your preferred operating system and be able to use some basic terminal commands such as cd to change directories, mkdir to make a new directory pwd to list the contents of a directory and cd .. to go back a directory. Table of contents: Prerequisites Voila Install Voila and Jupyter Create a Jupyter notebook with Widgets Test Voila locally Deploy Voila App on Heroku Create Three Files requirements.txt runtime.txt Procfile Install the Heroku CLI Create a git Repo Create repo on GitHub.com Add, commit and push local files to GitHub Pull the Repo down into WSL Push to Heroku View the Web App Online Summary Voila What is Voila? Voila is a Python package that turns Jupyter notebooks into working web sites. It is pretty amazing. Another Python package called Streamlit turns .py-files into websites. Voila does the same that Streamlit does to .py-files, except for Jupyter notebooks. Link to the Voila documentation: https://voila.readthedocs.io/en/stable/ Any Jupyter notebook can be turned into a website with Voila. Voila is specifically useful for turning Jupyter notebooks with embedded widgets into working websites. Install Voila and Jupyter Before we start writing any code, we need to install Voila and Jupyter. These packages can be installed using a terminal. In our example, we are also going to use NumPy and Matplotlib. The commands below show a virtual environment created with Python's built-in venv module. You could also create a virtual environment with conda if you are using the Anaconda distribution of Python. Note the command source venv/bin/activate will only work on MacOS, Linux, or WSL (Windows Subsystem for Linux). On Windows 10, use venv\\Scripts\\activate.bat instead. mkdir voila cd voila python -m venv venv source venv/bin/activate pip install voila pip install jupyter numpy matplotlib Next, open a Jupyter notebook. jupyter notebook Create a Jupyter notebook with Widgets Before we can deploy our Jupyter notebook as a cloud-based web app, we need to write a few cells in our Jupyter notebook. Any markdown cells in our Jupyter notebook will become text on our website. Any plots or widgets will also become part of the website. Code cells can be used on our website, but the code cells will not be seen by our website's visitors. Save the new Jupyter notebook as app.ipynb . Jupyter notebooks can be re-named by clicking on the notebook name in the upper left-hand corner. Note that you do not include the .ipynb file extension when renaming a Jupyter notebook. Our Jupyter notebook needs to start with a couple of import lines. Note that we don't need to import Volia into the notebook that will become the website. We just need to install Voila into the environment that will deploy the website. At the top of the Jupyter notebook, enter some header text into a markdown cell. # Voila Web App ## A website built out of a Jupyter notebook using Voila Below the markdown cell in the notebook, enter the import lines below into a code cell. These lines of code import NumPy, Matplotlib and Jupyter notebook widgets. import numpy as np import matplotlib.pyplot as plt from ipywidgets import interactive % matplotlib inline After the imports, enter the code below into a code cell. The code creates an interactive plot of the sine function using Jupyter notebook widgets, NumPy and Matplotlib. def plot_func ( a , f ): plt . figure ( 2 ) x = np . linspace ( 0 , 2 * np . pi , num = 1000 ) y = a * np . sin ( 1 / f * x ) plt . plot ( x , y ) plt . ylim ( - 1.1 , 1.1 ) plt . title ( 'a sin(f)' ) plt . show () interactive_plot = interactive ( plot_func , a = ( - 1 , 0 , 0.1 ), f = ( 0.1 , 1 )) output = interactive_plot . children [ - 1 ] output . layout . height = '300px' interactive_plot Run the code cell and play with the sliders and see the plot change. The sliders change the frequency and amplitude of the sine wave. Test Voila locally Next, we can test our website running on our local machine. Close the Jupyter notebook and make sure the environment where Voila was installed is activate. Type the command below into a terminal to run the app locally. Notice that we don't see the code in the code cells of our Jupyter notebook; we just see the markdown cells, sliders and plot. voila app.ipynb Great! The Voila app works locally and we can move the sliders and see the plot change, just like when we ran the code cell in the Jupyter notebook. So... next, we need to deploy this Voila app online so that other people can see it and interact with it too. Deploy Voila App on Heroku We are going to deploy our Voila web app on Heroku . Heroku is a service that hosts web apps and takes care of server administration for you. You can deploy Flask or Django webs apps on Heroku. We can also deploy our Voila app on Heroku. Luckily, Heroku has a free tier- you can try out deploying Voila online without having to pay any money. A couple of steps need to be completed before we deploy our Voila app on Heroku. Create Three Files The first step to deploy our Voila app on Heroku is to create three files that Heroku requires. The three required files are: requirements.txt runtime.txt Procfile requirements.txt Create the requirements.txt file with pip . The requirements.txt file tells Heroku which Python packages to install when it runs our web app. pip freeze > requirements.txt runtime.txt The runtime.txt file specifies the version of Python we want Heroku to use. Create a new file called runtime.txt . Inside the file, just one line of text is needed. Note the lowercase python and the dash - . python-3.7.6 Procfile The last required file for our Heroku deployment is a Procfile . This file includes the instructions for Heroku to deploy our Voila app. Create a new file named Procfile (no extension) and include the text below: web: voila --port=$PORT --no-browser app.ipynb Next, we'll use the Heroku command-line interface (CLI) to deploy our app. Install the Heroku CLI The Heroku CLI (command line interface) is the way we are going to deploy our Voila web app online. I had the most success installing the Heroku CLI on Linux, MacOS or WSL (Windows Subsystem for Linux). I had trouble installing the Heroku CLI on regular Windows 10. A link to instructions on how to install the Heroku CLI is below: https://devcenter.heroku.com/articles/heroku-cli After the Heroku CLI is installed, a couple more steps are needed before we can deploy our Voila app online. Create a git Repo I'm using Windows 10. And because we need to use WSL to use the Heroku CLI, we have to move the whole project into the proper WSL folder. You could move it over manually using the Windows file browser, but the way I did it was to save the project on GitHub.com and then pull the project down from GitHub.com in WSL using git . Create repo on GitHub.com Log into GitHub.com and create a new repo. I always add a readme, .gitignore , and a license. Make sure to copy the GitHub URL from the repo to make the next step easier. Add, commit and push local files to GitHub Next, back on your local machine, move into the main project directory that contains the app.ipynb file. Use the commands below to create a local git repo and add the newly created GitHub.com repo as a remote. Make sure to change <username> and <reponame> corresponding to you and your project. Add all the files in the directory, commit and push up to Github. git init git remote add origin https://github.com/<usename>/<reponame> git add . git commit -m \"initial commit\" git push origin master Pull the Repo down into WSL Now that the repo is up on GitHub.com, we can pull it down into WSL where the Heroku CLI is installed. Back in the Windows Subsystem for Linux terminal, type the following commands. Make sure to change <username> and <reponame> corresponding to you and your project. mkdir voila cd voila git init git remote add origin https://github.com/<username>/<reponame> git pull origin master After you pull the repo down from GitHub, the following files should be present. . ├── LICENSE ├── .gitignore ├── Procfile ├── README.md ├── app.ipynb ├── requirements.txt └── runtime.txt Now we can push our project up to Heroku. Push to Heroku After our files are pushed to GitHub, we are almost done. All that's left is to push the files to Heroku and view our live web app. Use the heroku create command to create a new Heroku instance.hergit heroku login heroku create The output will look something like below: Creating app... done, ⬢ apple-crumble-25196 https://apple-crumble-25196.herokuapp.com/ | https://git.heroku.com/apple-crumble-25196.git The last thing to do is to push the changes to Heroku to publish our app. git push heroku master The first time the command is run, it will take a little time for the web app to be deployed. View the Web App Online You can view the web app running with the following Heroku CLI command: heroku open A web browser window should pop up and you should be able to see your web app running! When the slider is moved, you will be able to see the plot change. The web address in the address bar can be shared with colleagues and friends. Summary In this post, we created a website from a Jupyter notebook using Voila. First, we created a Jupyter notebook with an interactive widget. Then we ran Voila locally and saw a preview of what the app would look like online. Lastly, we published the app on Heroku using the Heroku CLI. Thanks to all the maintainers of Voila. It is a wonderful package.","tags":"jupyter","url":"deploy-jupyter-notebook-voila-heroku.html","loc":"deploy-jupyter-notebook-voila-heroku.html"},{"title":"Python Resources for Instructors","text":"This post is a list of my recommended Python teaching resources for instructors in 2020. I received an email from a college instructor who was thinking about moving from MATLAB to Python in one of their courses. I wanted to share my email more broadly in case anyone else is looking for Python resources and doesn't know where to start. If you are teaching Python in a college or high school class, this post is for you. I've also included some resources for instructors that have experience with MATLAB but are transitioning to Python. Table of contents: Python Instructional Resources Python Installation on Campus Text Books Syllabi and Lesson Plans Learning Resources for Instructors Books YouTube Blogs Podcasts MATLAB to Python Summary Python Instructional Resources These resources are for instructors teaching college of highschool classes using Python. If you are a student or general learner, they may be helpful as well. Python Installation on Campus We use Jupyter notebooks in our engineering programming classes to teach Python. At our college, getting Python installed on campus computers was the biggest hurdle to adopting a new programming language. On-campus, we use the Anaconda Distribution of Python https://www.anaconda.com/distribution/ . This distribution of Python can be installed in user-space (no administrator password needed on campus computers). Students can also download the Anaconda Distribution of Python for free or use our JupyterHub server online. Anaconda is useful because it includes the scientific packages we use in our engineering programming classes such as NumPy, Matplotlib, Pandas, and Jupyter. Google now has a service called Google CoLab https://colab.research.google.com/ that allows students to run Jupyter notebooks from within Google drive. Microsoft also has a service called Azure Notebooks https://notebooks.azure.com/ that allows you to run Jupyter notebooks in the cloud. Both of these services require vendor-specific logins. Our college uses Gmail and Google calendar with college email addresses, so Google CoLab is an option for us. Text Books My book Problem Solving with Python 3.7 Edition is available on Amazon. I am teaching a section of our Engineering Programming course this quarter and using the book the textbook for the course. If you would like to use the book, please feel free! I am also looking for any feedback. I'll include you in the list of contributors (with your permission) if you are interested. A free version of the book is available at https://problemsolvingwithpython.com/ For my Intro to Engineering course, I constructed this book: https://professorkazarinoff.github.io/Problem-Solving-101-with-Python/ . I welcome any edits. I'll add you to the list of contributors (with your permission) for any edits suggested. Get Programming by Ana Bell is a great textbook. Dr. Bell nails the explanation part of programming. The only thing is I wish it had more end of chapter questions: https://www.amazon.com/Get-Programming-Learn-code-Python/dp/1617293784 Think Python by Allen Downey can be purchased in hard-copy or used online for free. You can check out Dr. Downey's other books on the greenteapress site as well: https://greenteapress.com/wp/think-python-2e/ Syllabi and Lesson Plans The syllabus and labs we use in our ENGR114 Engineering Programming class hare linked here: https://github.com/ProfessorKazarinoff/ENGR114 . If GitHub's notebook render isn't working, you can also view the syllabus and labs on nbviewer: Link The class notes I recorded last quarter in Jupyter notebooks from our ENGR114 Engineering Programming class can be found here: https://github.com/ProfessorKazarinoff/ENGR114-2019Q4 . Or see the notes on nbviewer: Link I found this GitHub repo for another Engineering Programming class. This course uses NumPy and Matplotlib like we do: https://github.com/karlvandesman/Python-Course A set of Engineering Computations Modules by Lorena Barba and Natalia Clementi are posted on GitHub. The authors mention they are happy to have instructors use their resources in full or partial form: https://github.com/engineersCode/EngComp1_offtheground Learning Resources for Instructors If you are an instructor and learning Python programming, below are a couple of resources I used to learn Python. I taught MATLAB at the college first, so I had some MATLAB experience before learning Python. Books Python Data Science Handbook by Jake VanderPlas: https://jakevdp.github.io/PythonDataScienceHandbook/ also on [Amazon].(https://www.amazon.com/Python-Data-Science-Handbook-Essential/dp/1491912057) Effective Computation in Physics by Anthony Scopatz and Kathryn Huff: https://www.amazon.com/Effective-Computation-Physics-Research-Python/dp/1491901535/ A list of free Python books was compiled by GitHub user pamoroso. This is a great list as all the books are free to read: https://github.com/pamoroso/free-python-books#list-of-free-python-books YouTube Corey Shafer's YouTube Channel: https://www.youtube.com/watch?v=YYXdXT2l-Gg&list=PL-osiE80TeTskrapNbzXhwoFUiLCjGgY7 Sendex YouTube Channel: https://www.youtube.com/watch?v=eXBD2bB9-RA&list=PLQVvvaa0QuDeAams7fkdcwOGBpGdHpXln Microsoft's Python for Beginners Tutorial Series: https://www.youtube.com/playlist?list=PLlrxD0HtieHhS8VzuMCfQD4uJ9yne1mE6 Blogs My blog, the one you are reading right now: https://pythonforundergradengineers.com/ Real Python Blog: https://realpython.com/tutorials/basics/ The PyImageSearch blog by Adrian Rosebrock: https://www.pyimagesearch.com/ Practical Business Python by Chris Moffitt: http://pbpython.com/ A running listing of Python blogs. I usually read PlanetPython a couple of times a week: https://planetpython.org/titles_only.html Podcasts I found listening to podcasts helped me get familiar with Python-specific jargon. Virtual Envs , Distribution , Web Framework , API ... those sorts of terms. Michael Kennedy's great podcast Talk Python to Me: https://talkpython.fm/ Michael Kennedy and Brian Okken's weekly rundown of Python news on Python Bytes: https://pythonbytes.fm/ Brian Okken's Test and Code, more on testing side, but usually Python related: https://testandcode.com/ Kelly Parades and Shawn Tibor's Teaching Python Podcast. Shawn and Kelly are both primary school teachers and share great insights for instructors: https://www.teachingpython.fm/ MATLAB to Python If you know MATLAB, but what to try Python in your class, below are some resources to look into. Real Python's long blog post comparing Python and MATLAB: https://realpython.com/matlab-vs-python/ SciPy (the folks that make NumPy and Matplotlib) have a docs page describing how to use NumPy if you are a MATLAB user: https://docs.scipy.org/doc/numpy/user/numpy-for-matlab-users.html This is an older resource, but I still found this table helpful. Maps MATLAB commands to NumPy commands: http://mathesaurus.sourceforge.net/matlab-numpy.html This GitHub repo is another place to check out a MATLAB to Python comparison: https://github.com/PythonForMatlabProgrammers Summary This post contained a listing of different Python resources for college or highschool instructors that I use and recommend. As an instructor, you can learn about Python in a bunch of different ways such as books, YouTube, Blogs, and Podcasts. I hope you find some of these resources helpful.","tags":"introduction","url":"python-resources-for-instructors-2020.html","loc":"python-resources-for-instructors-2020.html"},{"title":"Deploy a Serverless Web App on AWS Lambda with Zappa","text":"Zappa is a way to deploy serverless web apps on AWS Lambda. In this post, we will build a simple Flask web app with Python and run the web app on AWS Lambda using Zappa in only a few steps. Table of contents: What is Zappa? Install Zappa and Flask A Simple Flask App Test Locally AWS Credentials Sign Up for AWS Create AWS Access Keys 1. Create a group 2. Assign an inline policy to the group 3. Create a user and add the user to the group 4. Copy the user's keys Copy the Keys to a credentials File Create a zappa_settings.json File Save a requirements.txt File Deploy on AWS Modify the App and Re-deploy Shutdown and Delete the App Summary What is Zappa? Zappa is a Python package that bundles up web apps written in Flask or Django and deploys them to AWS (Amazon Web Services) Lambda. Lambda is Amazon's function as a service (FaaS) platorm. Why is Zappa so great? Because instead of deploying your Flask or Django web app on a cloud server, like an AWS EC2 instance or a Digital Ocean Droplet, you can deploy your app serverless as an AWS Lambda function. This isn't really \"serverless\" (servers run AWS Lambda), but with an AWS Lambda function, you don't have to spin up servers, install packages, make sure security patches are up to date, and most of all: you don't have to pay for server time that isn't used. A cloud server has to run all the time, whether or not someone visits your website. But an AWS Lambda function only runs when requested. Think of it this way: Cloud servers are kind of like rental cars. AWS Lambda is sort of like calling an Uber. With Uber, you only pay for the rides you take. The rental car has to be paid for even when it's just sitting in your driveway. For only a trip or two in a month, Uber is pretty cheap compared to renting a car for a month. So as long as your web traffic is low, running a web app serverless on AWS Lambda is pretty cheap compared to running a regular cloud server. AWS Lambda has a free tier. For a simple temporary hobby project, AWS is effectively free. Also, serverless Lambda functions scale up and down based on demand. Continuing our car analogy: If you need to get 100 people to work, you can request 100 Ubers, but a rental car will only fit four adults. Let's get started building our web app with Flask and deploying it on AWS Lambda with Zappa! Install Zappa and Flask Before we can deploy our web app on AWS Lambda with Zappa, first we need to install Zappa and a web framework to build our web app with. In this project, we are going to build a Flask app, so Flask needs to be installed too. You can install both of these packages with pip , the Python package manager. Using a terminal, create a project directory called zappa_app and cd into it. Create a virtual environment, activate it, and install Zappa and Flask. mkdir zappa_app cd zappa_app python -m venv venv source venv/bin/activate # on windows: venv\\Scripts\\activate pip install flask pip install zappa You can verify the installation by calling two help commands at the terminal. flask --help zappa --help If you see the help sections of Flask and Zappa, both of the packages were successfully installed. A Simple Flask App Next, we'll build a simple web app with Flask. This web app is super small and basic, but it will give you an idea of how Zappa and AWS Lambda works. The GitHub repo with all the code used in the rest of this post can be found here: https://github.com/ProfessorKazarinoff/flask-zappa-tutorial Create a file called app.py in the main project directory zappa_app we created earlier. Inside app.py , paste the following code. This super simple Flask app creates one webpage that displays the text Yeah, that is Zappa! Zappa! Zap! Zap! . You can modify the text between the <h1> .... </h1> tags to include any message you want. Copy the code below into app.py . # app.py from flask import Flask app = Flask(__name__) @app.route('/') def hello_world(): return '<h1>Yeah, that is Zappa! Zappa! Zap! Zap!</h1>' # We only need this for local development. if __name__ == '__main__': app.run() Ultimately, our web app will look something like the screen capture below. Test Locally Next, let's test the Flask app locally. We want to make sure the web app runs on our computer correctly before we deploy the app with Zappa on AWS Lambda. Run the command below in a terminal to test out our simple Flask app. Make sure to run the command in the virtual environment we installed Flask and Zappa into in the previous step. You should see (venv) before the terminal prompt. flask run Browse to the URL shown in the terminal http://127.0.0.1:5000/ . The webpage should look something like the screenshot below. Great! Our web app works locally. But before we can deploy our Flask app on AWS Lambda, there are a couple more steps. Next, we need to dive into AWS permissions and credentials. Put your seatbelt on. AWS Credentials Before we can deploy our serverless web app on AWS Lambda, we need to create and save a set of AWS credentials in a ~/.aws/credentials file. Sign Up for AWS If you don't have an AWS account, sign up here: https://aws.amazon.com/account/ . Signing up for an AWS account is free. Create AWS Access Keys Next, we need to create a new AWS access key id and secret access key . For me, this was kind of tricky. I mean how hard can it be to get an access key from AWS? Turns out permissions in AWS is a complicated beast. Log into your AWS account at https://aws.amazon.com/ Click the orange [Sign In to the Console] button on the upper right. Within the AWS Console, type IAM into the search box. IAM is the AWS user and permissions dashboard. Before we go any further, let's talk about permissions in AWS. This took me a while to figure this out. There are a couple of layers and roles to understand: accounts, groups, users, permissions, and policies. Accounts : One person has an AWS account. An AWS account is usually defined by a username (email address) and password. Accounts are not the same thing as users. Users : Each account can have multiple users associated with it. The account administrator (you) can create new users and delete old users. Users have a set of permissions and policies that determines what they can do on AWS. Users can belong to groups and inherit any of the permissions or policies that come with that group. Each user has an access key id and secret access key . I generally do not assign permissions and policies to users. Instead, I usually have users inherit permissions and policies from a group. Groups : Each account can have multiple groups. Users belong to groups. A group has a particular set of permissions and policies that get passed to the users that are part of the group. Groups do not have access key id's or secret access keys. I generally assign permissions and policies to groups. Permissions : A permission is a small piece of work a user or group is allowed to do on AWS. For instance, one permission could allow a user or group to upload to an S3 bucket. Another permission could allow a user or group to shut down an EC2 instance. Permissions are grouped into policies. Policy : Policies are groups of permissions assembled together. Since a user will probably want to both upload and download from S3, these two permissions could be combined into one policy. Users and groups can have many policies assigned to them. Managed Policy : Managed policies are permissions grouped by Amazon that covers some sort of sub-functionality in AWS. For instance, one managed policy created by Amazon is AWSLambdaFullAccess. This managed policy allows a user or group to do anything on AWS Lambda. Inline Policy : Inline policies are permissions grouped together by you. You can pick individual permissions and assemble them into an inline policy. A user or group can have many inline and managed policies at the same time. Inline policies are stored in json format. To create the AWS credentials needed to run our web app, we need to complete a couple of steps: Create a group Assign an inline policy to the group Create a user and add the user to the group Copy the user's keys 1. Create a group In the IAM Dashboard, click [Groups] on the left-hand menu. Then create a new group with the [Create New Group] button. Give your group a name, I called my group zappa_group , and click [Next Step]. In the Attach Policy screen, don't check any radio boxes, just click [Next Step]. All of the attached policy options are AWS managed policies. We want to create our own specific inline policy for our zappa_group, so we don't need to select any pre-selected AWS policies. At the review screen, review the group you created and click [Create Group]. Next, we will copy and paste an inline policy written in json format and assign our custom inline policy to our group. 2. Assign an inline policy to the group Double, double toil and trouble... I had a tough time figuring out which AWS security permissions I needed to attach to my AWS User to get Zappa to work. In the end, I attached one manually-created custom inline policy to the group. I think it's a good idea to attach the security policy to a group. Then you can add and delete users easily without losing any info in the security policy. At the Groups main screen, click on the group you just created to view the group's details. In the Permissions tab, under the Inline Policies section, choose the [click here] link to create a new Inline Policy. In the Set Permissions screen, click the Custom Policy radio button and click the [Select] button on the right. We could use the policy generator to create our inline policy, but instead, we will create a Custom Policy written in json format. Type a policy name and paste the json below into the Policy Document window. Note the XXXXXXXXXXX in the inline policy should be replaced by your AWS Account Number. Your AWS Account Number can be found by clicking [Support] → [Support Center]. Your Account Number is listed in the Support Center on the upper left-hand side. The json for the inline policy applied to the group is below. { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"iam:AttachRolePolicy\", \"iam:GetRole\", \"iam:CreateRole\", \"iam:PassRole\", \"iam:PutRolePolicy\" ], \"Resource\": [ \"arn:aws:iam::XXX_MY_AWS_ACCOUNT_ID_XXX:role/*-ZappaLambdaExecutionRole\" ] }, { \"Effect\": \"Allow\", \"Action\": [ \"apigateway:DELETE\", \"apigateway:GET\", \"apigateway:PATCH\", \"apigateway:POST\", \"apigateway:PUT\", \"events:DeleteRule\", \"events:DescribeRule\", \"events:ListRules\", \"events:ListRuleNamesByTarget\", \"events:ListTargetsByRule\", \"events:PutRule\", \"events:PutTargets\", \"events:RemoveTargets\", \"lambda:AddPermission\", \"lambda:CreateFunction\", \"lambda:DeleteFunction\", \"lambda:GetAlias\", \"lambda:GetFunction\", \"lambda:GetFunctionConfiguration\", \"lambda:GetPolicy\", \"lambda:InvokeFunction\", \"lambda:DeleteFunctionConcurrency\", \"lambda:ListVersionsByFunction\", \"lambda:RemovePermission\", \"lambda:UpdateFunctionCode\", \"lambda:UpdateFunctionConfiguration\", \"cloudformation:CreateStack\", \"cloudformation:DeleteStack\", \"cloudformation:DescribeStackResource\", \"cloudformation:DescribeStacks\", \"cloudformation:ListStackResources\", \"cloudformation:UpdateStack\", \"cloudfront:UpdateDistribution\", \"logs:DeleteLogGroup\", \"logs:DescribeLogStreams\", \"logs:FilterLogEvents\", \"route53:ListHostedZones\" ], \"Resource\": [ \"*\" ] }, { \"Effect\": \"Allow\", \"Action\": [ \"s3:CreateBucket\", \"s3:ListBucket\", \"s3:ListBucketMultipartUploads\" ], \"Resource\": [ \"arn:aws:s3:::zappa-*\" ] }, { \"Effect\": \"Allow\", \"Action\": [ \"s3:DeleteObject\", \"s3:GetObject\", \"s3:PutObject\", \"s3:AbortMultipartUpload\", \"s3:ListMultipartUploadParts\" ], \"Resource\": [ \"arn:aws:s3:::zappa-*/*\" ] } ] } After pasting and modifying the json with your AWS Account Number, click the [Validate Policy] button to ensure you copied valid json. Then click the [Apply Policy] button to attach the inline policy to the group. The json above is what worked for me. But, I expect this set of security permissions may be too open. To increase security, you could slowly pare down the permissions and see if Zappa still deploys. The settings above are the ones that finally worked for me. You can dig through this discussion on GitHub if you want to learn more about specific AWS permissions needed to run Zappa: https://github.com/Miserlou/Zappa/issues/244 . 3. Create a user and add the user to the group Back at the IAM Dashboard, create a new user with the [Users] left-hand menu option and the [Add User] button. In the Add user screen, give your new user a name and select the Access Type for Programmatic access. Then click the [Next: Permissions] button. In the Set permissions screen, select the group you created earlier in the Add user to group section and click [Next: Tags]. Tags are optional. Add tags if you want, then click [Next: Review]. Review the user details and click [Create user] You should now be able to see your new user attached to your new group. Hopefully, you see a green Success screen. 4. Copy the user's keys Click the [Show] button under the Secret access key heading. You should now be able to see both the Access key ID and the Secret access key . We need both of these keys to deploy our Zappa app. Don't close the AWS IAM window yet. In the next step, you will copy and paste these keys into a file. At this point, it's not a bad idea to copy and save these keys into a text file in a secure location. Make sure you don't save keys under version control. Copy the Keys to a credentials File Save the AWS access key id and secret access key assigned to the User you created in the file ~/.aws/credentials . Note the .aws/ directory needs to be in your home directory and the credentials file has no file extension. Note: On Windows, save the credentials file in C:\\> dir \"%UserProfile%\\.aws In the credentials file, copy the text below then modify the XXXXXXXX portions to include your User's keys (no quotes). [default] aws_access_key_id = XXXXXXXXXXXXXXXXXXXXXXXXXX aws_secret_access_key = XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Now that our AWS credentials are set, close the AWS IAM browser window. Almost time to let Zappa do it's magic! Create a zappa_settings.json File Next, we need to create the Zappa settings file: zappa_settings.json . Create this file by typing the command zappa init into a terminal (remember the virtual environment (venv) needs to be active when the command is entered). zappa init The command creates a zappa_settings.json file in the directory where the command was run. Edit the zappa_settings.json file so that the \"profile_name\": \"default\" corresponds to the name in square brackets we specified in .aws/credentials . The \"aws_region\" also needs to be set. I'm in Oregon, so I choose \"us-west-2\" . All other default settings from zappa init are OK. Note the \"s3_bucket\" name may be different for you. Zappa automatically creates a random S3 bucket name. The complete zappa_settings.json file is below: { \"dev\": { \"app_function\": \"app.app\", \"profile_name\": \"default\", \"project_name\": \"zappa-flask-app\", \"runtime\": \"python3.7\", \"s3_bucket\": \"zappa-9cf4j0c1h\", \"aws_region\": \"us-west-2\" } } Save a requirements.txt File Before we deploy our web app on AWS Lambda (we are almost done!), we'll create a requirements.txt file using pip freeze . pip freeze > requirements.txt NOTE: I saved my project directory in a GitHub repo and included a LICENSE , .gitignore and a README.md . Saving the project on GitHub isn't necessary, but I like to keep my code in multiple places and GitHub acts as the central storage location for the project. The following files should now be in the main project directory zappa_app : zappa_app/ ├── app.py ├── requirements.txt ├── venv/ └── zappa_settings.json Deploy on AWS It's time to deploy our Flask app on AWS Lambda! Deploy the web app with the command below: zappa deploy dev If everything worked, you should be able to browse to the URL listed in the terminal (something like https://heq5x2wioxcz.execute-api.us-west-2.amazonaws.com/dev) and see your web app running in all its serverless glory. Pretty Cool. We got a serverless Flask app running on AWS Lambda. Modify the App and Re-deploy We can modify our app and see the results live on the web. Open the app.py file and change the text in between the <h1> ... </h1> tags. You can change the message to display any text you want. # app.py ... @app.route('/') def hello_world(): return '<h1>Yeah, that is Zappa! Zappa! Zap! Zap! I am revised</h1>' ... Re-deploy the app with the command below: zappa update dev Reload your browser and see the modified text. Shutdown and Delete the App At some point, you will want to shut down and delete your app. Who knows, maybe your app becomes super popular and your AWS bill goes through the roof? (we can only hope). To shutdown the Zappa app, type the following command: zappa undeploy dev Summary In this post, we created a simple web app with Flask and deployed it to AWS Lambda with Zappa. We completed the project in a few steps. First, we built a simple Flask app and ran it locally. Next, we messed around with AWS permissions and saved an access key id and secret access key in ~/.aws/credentials . Finally, we ran zappa init and zappa deploy dev to deploy our web app on AWS Lambda. It's amazing how little code you need to write to deploy a serverless Flask app on AWS Lambda with Zappa. The GitHub repo with all the code used in this post can be found here: https://github.com/ProfessorKazarinoff/flask-zappa-tutorial Happy Zapping!","tags":"web","url":"deploy-serverless-web-app-aws-lambda-zappa.html","loc":"deploy-serverless-web-app-aws-lambda-zappa.html"},{"title":"Top 5 posts of 2019","text":"This post contains the top 5 Python for Undergraduate Engineers (this blog) posts of 2019. These posts are ranked in terms of the number of page views. Of the 15 blog posts published on this site in 2019, these five posts were the most popular. #5. Calculating the probability under a normal curve with Python The fifth most popular post of 2019 was about how to calculate the probability under a standard normal curve with Python. In the post, we utilized Python's math module, specifically the erf() and sqrt() functions. This post showed a good example of using Python and the Python Standard Library to solve an engineering problem. #4. How to upload .py-files onto an ESP8266 running MicroPython The number four most popular post of 2019 was an update to the sixth part of a multi-part series on Micropython. I had trouble in one of my classes this year uploading a .py-file to an ESP8266 microcontroller running MicroPython using a command-line tool called ampy . There was a trick getting ampy to work on with the ESP8266 microcontroller that I wanted to share in case other people came across the same problem. In the post, I showed how to uploaded upload .py-files to an ESP8266 microcontroller using Python and a Python package called ampy . #3. Taylor Series in Python The third most popular post of 2019 showed how to create a Taylor Series with Python and for loops . Then we refactored the Taylor Series script into functions and compared the output of our Taylor Series functions to functions from Python's Standard Library. At the end of the post, a plot of the Taylor Series function was created with Matplotlib to show how the output of the function changed based on the number of terms in the Taylor Series. #2. Solving Equations and Writing Expressions with SymPy and Python The second most popular post of 2019 was about how to write expressions and equations using Python and a library called SymPy. In this post, we reviewed how to create variables in SymPy and combine these variables into expressions and equations. At the end of the post, we saw to how to solve mathematical equations with SymPy and Python. #1. Plotting a Gaussian normal curve with Python and Matplotlib The top post of 2019 was about how to plot a Gaussian normal curve with Python and Matplotlib. In this post, we constructed a plot that illustrates the standard normal curve and calculated the area under the standard normal curve. To build the Gaussian normal curve, we used Python, Matplotlib, and SciPy.","tags":"this site","url":"2019-top-five.html","loc":"2019-top-five.html"},{"title":"Matplotlib Animation to Demonstrate Piston Motion","text":"Piston motion is one of the classic types of motion in engineering dynamics that belong to a category of 4-bar motion. Piston motion is the type of motion that the piston in a cylinder of a car engine goes through as the engine's crankshaft rotates. In this post, we'll review how to use Python and Matplotlib to build a moving animation of piston motion. Table of contents: Set up a Python virtual environment Install Python packages Create a new Python file Import packages Arrays of angles and points Fill the point arrays Set up the Matplotlib figure Initialization Function Animation Function Call and show the animation Run the script Results The complete script Set up a Python virtual environment To start this process, we will set up a virtual environment in Python. Real Python has a good introduction to virtual environments and why to use them. I recommend undergraduate engineers use the Anaconda distribution of Python which comes with the Anaconda Prompt . You can create a new virtual environment by opening the Anaconda Prompt and typing: Using the Anaconda Prompt: > mkdir piston_motion > cd piston_motion > conda create -n piston_motion python=3.7 Alternatively, on MacOS or Linux, a virtual environment can be set up with a terminal prompt and pip . Using a terminal on MacOS or Linux: $ mkdir piston_motion $ cd piston_motion $ python3 -m venv venv Install Python packages Now that we have a new clean virtual environment with Python 3 installed, we need to install the necessary packages: Using the Anaconda Prompt, activate the piston_motion virtual environment and use conda to install the following Python packages. Ensure the virtual environment you created above is activate when the packages are installed. > conda activate piston_motion (piston_motion) > conda install numpy (piston_motion) > conda install matplotlib Alternatively, if you are using MacOS or Linux, the packages can be installed with a terminal pip : $ source venv/bin/activate (venv) $ pip install numpy (venv) $ pip install matplotlib Create a new Python file Next, open a text editor (I like to use VS Code ) and create a new Python file called piston_motion.py Import packages We will start our piston_motion.py script by importing the necessary modules. NumPy is imported as the common alias np . Besides importing Matplotlib's pyplot module, we'll also import Matplotlib's animation module. #import necessary packages import numpy as np from numpy import pi , sin , cos , sqrt import matplotlib.pyplot as plt import matplotlib.animation as animation To model piston motion, we need to animate two moving parts: a crankshaft and a connecting rod. The crankshaft rotates around a central axis and has a constant radius. We'll model the crankshaft as a line of constant length, one end fixed at the origin and the other rotating in a circle like a hand on a clock. To model this line, we just need two points, the origin at x=0 and y=0 and the end of the line at the point x1 and x2 . We also need to define a crank radius and a connecting rode length. We will define these constants at the top of our script below the import lines. We'll set a fixed number of rotations so that the animation does not run around indefinitely. As our crankshaft arm rotates, the rotation increment defines how closely spaced the 'ticks' are. A rotation increment of 0.1 will make our animation appear smooth enough. # input parameters r = 1.0 # crank radius l = 4.0 # connecting rod length rot_num = 4 # number of crank rotations increment = 0.1 # angle increment Arrays of angles and points Next, we'll create an array of angles starting from zero radians up to the number of rotations (times 2 pi radians), stepping by our increment amount. NumPy's np.arange() function accepts the arguments (start,stop,step) . Note: Python counting starts at 0 and ends at n-1. NumPy follows the same counting convention, so if we want the final value in our angle array to be rot_num*2*pi , we need to add the increment amount to stop value and set the stop argument as rot_num*2*pi+increment . # create the angle array, where the last angle is the number of rotations*2*pi angles = np . arange ( 0 , rot_num * 2 * pi + increment , increment ) Once we have all the rotation angles in an array, we can set up empty arrays for the points in our animation. These point arrays need to have the same number of entries as the angles array: X1 = np . zeros ( len ( angles )) # array of crank x-positions: Point 1 Y1 = np . zeros ( len ( angles )) # array of crank y-positions: Point 1 X2 = np . zeros ( len ( angles )) # array of rod x-positions: Point 2 Y2 = np . zeros ( len ( angles )) # array of rod y-positions: Point 2 Fill the point arrays Now we'll populate the point arrays with values according to the geometry of piston motion: for index , theta in enumerate ( angles , start = 0 ): x1 = r * cos ( theta ) # x-cooridnate of the crank: Point 1 y1 = r * sin ( theta ) # y-cooridnate of the crank: Point 1 x2 = 0 # x-coordinate of the rod: Point 2 # y-coordinate of the rod: Point 2 y2 = r * sin ( theta ) + sqrt ( l ** 2 - ( r * cos ( theta )) ** 2 ) X1 [ index ] = x1 # crankshaft x-position Y1 [ index ] = y1 # crankshaft y-position X2 [ index ] = x2 # connecting rod x-position Y2 [ index ] = y2 # connecting rod y-position Set up the Matplotlib figure Now that the point arrays are full, we have the values necessary to build our animation. We can start building the animation using these arrays of points. In this plotting section of the script, it is important to set aspect='equal' and autoscale_on=False ; otherwise the x and y axes will not have the same scale and the animation will look ovoid instead of circular. # set up the figure and subplot fig = plt . figure () fig . canvas . set_window_title ( 'Matplotlib Animation' ) ax = fig . add_subplot ( 111 , aspect = 'equal' , autoscale_on = False , xlim = ( - 4 , 4 ), ylim = ( - 2 , 6 )) ax . grid () ax . set_title ( 'Piston Motion Animation' ) ax . axes . xaxis . set_ticklabels ([]) ax . axes . yaxis . set_ticklabels ([]) line , = ax . plot ([], [], 'o-' , lw = 5 , color = '#de2d26' ) Initialization Function The animation requires an initialization function. Let's code the initialization function next. # initialization function def init (): line . set_data ([], []) return line , Animation Function Finally on to building the animation function. We are almost done with our script. # animation function def animate ( i ): x_points = [ 0 , X1 [ i ], X2 [ i ]] y_points = [ 0 , Y1 [ i ], Y2 [ i ]] line . set_data ( x_points , y_points ) return line , Call and show the animation The last part of our Python script will call the animation and show the Matplotlib figure. Notice how the figure fig , animation function animate and initialization function init are passed to the FuncAnimation() class. # call the animation ani = animation . FuncAnimation ( fig , animate , init_func = init , frames = len ( X1 ), interval = 40 , blit = True , repeat = False ) ## to save animation, uncomment the line below: ## ani.save('offset_piston_motion_animation.mp4', fps=30, extra_args=['-vcodec', 'libx264']) #show the animation plt . show () Run the script The animation can be visualized by running the piston_motion.py script. You can run the script using the Anaconda prompt or a terminal. Make sure the virtual environment we created above is active when the command is run. > python piston_motion.py Results A frame from the resulting animation is below. A video of the resulting animation is below. The complete script The complete piston_motion.py script is below. The script can also be found in a GitHub repo here . # piston_motion.py \"\"\" Piston Motion Animation using Matplotlib. Author: Peter D. Kazarinoff, 2019 MIT License \"\"\" #import necessary packages import numpy as np from numpy import pi , sin , cos , sqrt import matplotlib.pyplot as plt import matplotlib.animation as animation # input parameters r = 1.0 # crank radius l = 4.0 # connecting rod length rot_num = 4 # number of crank rotations increment = 0.1 # angle increment # create the angle array, where the last angle is the number of rotations*2*pi angles = np . arange ( 0 , rot_num * 2 * pi + increment , increment ) X1 = np . zeros ( len ( angles )) # array of crank x-positions: Point 1 Y1 = np . zeros ( len ( angles )) # array of crank y-positions: Point 1 X2 = np . zeros ( len ( angles )) # array of rod x-positions: Point 2 Y2 = np . zeros ( len ( angles )) # array of rod y-positions: Point 2 #find the crank and connecting rod positions for each angle for index , theta in enumerate ( angles , start = 0 ): x1 = r * cos ( theta ) # x-cooridnate of the crank: Point 1 y1 = r * sin ( theta ) # y-cooridnate of the crank: Point 1 x2 = 0 # x-coordinate of the rod: Point 2 # y-coordinate of the rod: Point 2 y2 = r * sin ( theta ) + sqrt ( l ** 2 - ( r * cos ( theta )) ** 2 ) X1 [ index ] = x1 # crankshaft x-position Y1 [ index ] = y1 # crankshaft y-position X2 [ index ] = x2 # connecting rod x-position Y2 [ index ] = y2 # connecting rod y-position # set up the figure and subplot fig = plt . figure () fig . canvas . set_window_title ( 'Matplotlib Animation' ) ax = fig . add_subplot ( 111 , aspect = 'equal' , autoscale_on = False , xlim = ( - 4 , 4 ), ylim = ( - 2 , 6 )) ax . grid () ax . set_title ( 'Piston Motion Animation' ) ax . axes . xaxis . set_ticklabels ([]) ax . axes . yaxis . set_ticklabels ([]) line , = ax . plot ([], [], 'o-' , lw = 5 , color = '#de2d26' ) # initialization function def init (): line . set_data ([], []) return line , # animation function def animate ( i ): x_points = [ 0 , X1 [ i ], X2 [ i ]] y_points = [ 0 , Y1 [ i ], Y2 [ i ]] line . set_data ( x_points , y_points ) return line , # call the animation ani = animation . FuncAnimation ( fig , animate , init_func = init , frames = len ( X1 ), interval = 40 , blit = True , repeat = False ) ## to save animation, uncomment the line below: ## ani.save('offset_piston_motion_animation.mp4', fps=30, extra_args=['-vcodec', 'libx264']) #show the animation plt . show ()","tags":"Python","url":"piston-motion-with-python-matplotlib.html","loc":"piston-motion-with-python-matplotlib.html"},{"title":"How to Build a Streamlit App in Python","text":"Streamlit is a web app-building framework for Python. Streamlit is a way to create mostly simple single-page web apps that are easy to deploy. Streamlit is useful for engineers and data scientists who have some app functionality, like a plot that dynamically changes based on user interaction, but don't want to build out a full website using a web framework like Django or Flask. In this post, we will create a Streamlit app that displays a Bokeh plot and deploy it online with Heroku. Table of contents: Installing Streamlit Running Streamlit for the First Time Create a Simple Streamlit App Create a Mohr's Circle Streamlit App Bokeh Create the App Install Bokeh and NumPy Run the Streamlit App Save code on GitHub.com Deploy on Heroku Sign up for a Heroku account Use Windows Subsystem for Linux (WSL) to install the Heroku CLI Pull down the code from GitHub Create a virtual environment, install packages and save a requirements.txt file Test and make sure the streamlit app runs Create a Procfile and a setup.sh file Push the project up to Heroku View the Streamlit App live on the web Summary A link to the Streamlit docs is below: https://streamlit.io/docs/ Streamlit builds web-apps from a single Python file. Only a couple additional lines of code are needed to turn a Python .py file into a web-app using Streamlit. Installing Streamlit Streamlit can be installed with pip , the Python package manager. It's a good idea to install Streamlit into a virtual environment, rather than installing Streamlit into the base or built-in version of Python installed on your machine. I use the Anaconda Prompt to create virtual environments. The commands below are designed to run on the Anaconda Prompt and will create a virtual environment called (streamlit) and install the Streamlit package into that environment. Note that at the time of writing, Streamlit can not be installed with conda , it must be installed with pip . conda create -y -n streamlit python=3.7 conda activate streamlit pip install streamlit You can confirm your installation by opening up the Python REPL and typing the commands below (note the >>> prompt is shown to indicate the Python REPL, not characters for the user to enter). python >>> import streamlit >>> streamlit.__version__ Running Streamlit for the First Time You can run a demo app that comes with the Streamlit package by running the following command into a terminal. Note the (streamlit) virtual environment (with Streamlit installed into it) must be active for the command to work. streamlit hello This command starts a demo Streamlit app. Open a web browser and enter the URL shown in your terminal. The running app will look something like the screenshot below. If you select the Plotting Demo from the menu on the left-hand side, you'll see an animated line graph of random numbers. Type [Ctrl]+[c] into the terminal stop the Streamlit server. Now that we have a feel for some of the things Streamlit can do, let's build a simple Steamlit App. Create a Simple Streamlit App Next, let's build our own simple Streamlit app. Our app will ask a user for a number and a name. The app will add 1 to the number and tell the user \"Hello\" based on their name. The following code was entered into a file called simple_streamlit_app.py # simple_streamlit_app.py \"\"\" A simple streamlit app run the app by installing streamlit with pip and typing > streamlit run simple_streamlit_app.py \"\"\" import streamlit as st st.title('Simple Streamlit App') st.text('Type a number in the box below') n = st.number_input('Number', step=1) st.write(f'{n} + 1 = {n+1}') s = st.text_input('Type a name in the box below') st.write(f'Hello {s}') After the file is saved, simple_streamlit_app.py can be run as a Streamlit app from the command line (again, make sure you are in the virtual environment where Streamlit is installed): streamlit run simple_streamlit_app.py Browse to the URL shown in the terminal. The resulting Streamlit app looks something like the screenshot below. Type a couple numbers and try out a couple names. Pretty simple right? To shut down the app, type [Ctrl]+[c] into the terminal. Now that we have created a simple Streamlit app, let's build upon the experience and create a useful app. Our app will build a Mohr's Circle based on user input. Create a Mohr's Circle Streamlit App Next, we are going to create a Streamlit App that builds a Mohr's Circle based on user input. A Mohr's Circle is a type of diagram used in Mechanical Engineering to show the internal stresses acting on a region, called a stress element, of a part. When that stress element is rotated relative to the part's direction, the stresses change. A Mohr's circle shows the resulting normal and shear stresses based on the angle the stress element is rotated. Bokeh We will build Mohr's Circle using a plotting library called Bokeh . Bokeh is similar to other Python plotting packages like Matplotlib. The difference is that Bokeh is designed to show plots in browsers and on webpages. This functionality is perfect for our Streamlit app that runs in a web browser. Create the App Let's create two .py files to build our app. The first file, user_funcs.py contains a couple functions needed to calculate the parameters of Mohr's Circle. The Python code below contains the functions we need. # user_funcs.py \"\"\" user-defined functions for the Streamlit mohr's circle app \"\"\" import numpy as np def mohr_c(stress_x, stress_y, shear): \"\"\" input arguments: stress_x: int or float stress_y: int or float shear: int or float mohr_c() outputs two values for the circle, center, and radius output: C, R C is x-value of the circle center R is the radius of the circle \"\"\" C = (stress_x + stress_y) / 2 R = ((((stress_x - stress_y) / 2) ** 2) + shear ** 2) ** 0.5 return C, R def c_array(C, R, n=100): \"\"\" input arguments: C: int or float, the x-value of a circle center R: int or float, the radius of the circle n: int, number of points (optional) c_array() outputs two NumPy arrays of x and y values that creates the circle output: x, y x is a NumPy array with n-values that contains the x-values to build the circle y is a NumPy array with n-values that contains the y-value to build the circle \"\"\" t = np.linspace(0, 2 * np.pi, n + 1) x = R * np.cos(t) + C y = R * np.sin(t) return x, y def X_Y(stress_x, stress_y, shear): \"\"\"build the arrays that describe the line X-Y between the known points\"\"\" X = np.array([stress_x, stress_y]) Y = np.array([-shear, shear]) return X, Y The second Python file, called streamlit_app_bokeh.py contains the code to build the plot using Bokeh and build the app using Streamlit. Note the last line of code is st.bokeh_chart(p) . This line is the \"magic sauce\" that turns our Bokeh plot into a Streamlit app. The line is a substitute for the command to show a plot in a regular Bokeh application. # streamlit_app_bokeh.py \"\"\" A streamlit app to draw a Mohr's Circle based on user input using the Bokeh plotting library \"\"\" import numpy as np import streamlit as st from bokeh.plotting import figure from user_funcs import mohr_c, c_array, X_Y st.title(\"Mohr's Circle App\") stress_x = st.sidebar.number_input(\"stress in x\", value=2.0, step=0.1) stress_y = st.sidebar.number_input(\"stress in y\", value=5.0, step=0.1) shear = st.sidebar.number_input(\"shear xy\", value=4.0, step=0.1) # find center and radius C, R = mohr_c(stress_x, stress_y, shear) # build arrays plot circle circle_x, circle_y = c_array(C, R) # build arrays to plot line through the circle X, Y = X_Y(stress_x, stress_y, shear) st.sidebar.markdown(f\"max stress = {round(C+R,2)}\") st.sidebar.markdown(f\"min stress = {round(C-R,2)}\") st.sidebar.markdown(f\"max shear = {round(R,2)}\") p = figure( title=\"Mohr's Circle\", x_axis_label=\"stress\", y_axis_label=\"shear\", match_aspect=True, tools=\"pan,reset,save,wheel_zoom\", ) p.line(circle_x, circle_y, color=\"#1f77b4\", line_width=3, line_alpha=0.6) p.line(X, Y, color=\"#ff7f0e\", line_width=3, line_alpha=0.6) p.xaxis.fixed_location = 0 p.yaxis.fixed_location = 0 st.bokeh_chart(p) Install Bokeh and NumPy Before we can run our Mohr's Circle Streamlit app, we need to install the packages we imported in the two .py files. The packages we need are Bokeh and NumPy. Both of these packages can be installed with conda or pip on the command line. Make sure you are in the (streamlit) virtual environment when you run the install command. conda install -y bokeh numpy Run the Streamlit App Now we can run our Mohr's Circle App locally by typing the command below into the terminal. streamlit run streamlit_app_bokeh.py The resulting app will look something like the screenshot below: Try typing in different numbers for stress in x, stress in y and shear xy. See how the plot changes when different numbers are entered. The app looks great! Now that the app is running, let's save all the files on GitHub. We'll need the files saved on GitHub for the next couple steps. Save code on GitHub.com After I was sure the Streamlit app worked, I saved the code into a git repo and pushed the code up to Github.com. This isn't absolutly necessary, but as you can see below, I needed to use Windows Subsystem for Linux to deploy the Streamlit app. A simple way to bring the code into WSL is to pull the code down from a GitHub repo. Create a repo on Github, and then use the commands below to commit the code locally and push the code up to GitHub.com. Make sure to change <UserName> to your GitHub username and change <commit message> to your specific commit message. git init git remote add origin https://github.com/<UserName>/mohrs_circle.git git add . git commit -m \"<commit message>\" git push origin master Our Mohr's Circle Streamlit app runs locally, but if we want to share the app with friends, we need to deploy it over the internet. One way to deploy a Streamlit app is with a web service called Heroku. Deploy on Heroku Heroku is a cloud platform for deploying apps on the internet. We can deploy our Steamlit app on Heroku with a couple steps. Sign up for a Heroku account First, sign up for a Heroku account. See the link below. https://signup.heroku.com/ One of the easiest ways to deploy a web-app to Heroku is to use the Heroku CLI (Command Line Interface). Use Windows Subsystem for Linux (WSL) to install the Heroku CLI If you are using a Mac or Linux, the Heroku CLI is easy to install using a terminal. However, I had trouble installing and using the Heroku CLI in Windows 10. My work around was installing and using the Heroku CLI in Windows Subsystem for Linux. If you are using Windows 10, install Windows Subsystem for Linux (WSL) from the Windows Store. I installed the Ubuntu distribution. Using the start menu, and open the WSL prompt. Type the commands below to update the system and install the Heroku CLI. sudo apt-get -y update && sudo apt-get -y upgrade curl https://cli-assets.heroku.com/install.sh | sh source .bashrc These commands install the Heroku CLI. You can test the installation with the command below. heroku --version If the Heroku CLI is installed, output should look similar to the screen capture below. Pull down the code from GitHub Since we saved our code on GitHub.com, we can use git to pull the code down into the WSL environment. Remember to replace <UserName> with your GitHub username. clone https://github.com/<UserName>/mohrs_circle.git cd mohrs_circle Now that we have the code for our app, we need to create the same virtual environment in WSL as we had before when we got our app to run locally. Create a virtual environment, install packages and save a requirements.txt file Next, within Windows Subsystem for Linux, create a new virtual environment and install Streamlit, Bokeh and NumPy into it. I have Anaconda installed in my WSL environment, so I used conda to install the Python packages. Alternatively, you could use Python's venv module and pip instead. After the packages are installed, you can use pip to write a requirements.txt file. Heroku needs the requirements.txt file in order for the Streamlit app to work. conda create -n mohrs_circle python=3.7 conda activate mohrs_circle python -m pip install streamlit bokeh numpy pip freeze > requirements.txt Now we should be able to run the streamlit app from the WSL prompt. Test and make sure the streamlit app runs Next, within WSL, let's test and see that the Streamlit app still works. Ensure you are in the virtual environment created above when the command is run. streamlit run streamlit_app_bokeh.py You can browse to the URL listed and test the app by typing in a couple different stresses and see how the plot changes. Create a Procfile and a setup.sh file Before we can deploy the app on Heroku, a couple more files are required: Procfile setup.sh In the Procfile (the file name is Procfile with a capital P and no file extension) add the text: web: sh setup.sh && streamlit run streamlit_app_bokeh.py In setup.sh add the text: mkdir -p ~/.streamlit/ echo \"\\ [general]\\n\\ email = \\\"your-email@domain.com\\\"\\n\\ \" > ~/.streamlit/credentials.toml echo \"\\ [server]\\n\\ headless = true\\n\\ enableCORS=false\\n\\ port = $PORT\\n\\ \" > ~/.streamlit/config.toml Now the main project directory should have the following files present. The LICENSE and README.md files are optional, but I include these two files in my GitHub repos as a general practice. mohrs_circle/ ├── LICENSE ├── Procfile ├── README.md ├── requirements.txt ├── setup.sh ├── streamlit_app.py ├── streamlit_app_bokeh.py └── user_funcs.py Commit all the files and push to GitHub. git add . git commit -m \"add Procfile, setup.sh, requirements.txt\" git push origin master Now we are finally ready to deploy on Heroku. Push the project up to Heroku Log into Heroku with the Heroku CLI, create the Heroku project and git push to Heroku: heroku login heroku create git push heroku master # see if it's running heroku ps:scale web=1 That's it! The Streamlit app should now be running on Heroku. View the Streamlit App live on the web Check the URL provided by the Heroku CLI. The app works the same as when we ran it locally, but now it's live on the internet. Anyone with the URL provided by the Heroku CLI can view our Streamlit app. The Streamlit app opens on a phone too. Summary In this post, we created a web app with Streamlit and Bokeh. We ran the Streamlit app locally and then deployed it on the internet using Heroku. Streamlit makes it pretty easy to turn a Python script into a functional web app deployed on the internet.","tags":"Python","url":"streamlit-app-with-bokeh.html","loc":"streamlit-app-with-bokeh.html"},{"title":"Slides from my PyDataPDX Presentaion","text":"I gave a presentation about JupyterHub in Engineering Education at the PyData PDX Meetup in Portland, OR on November 12, 2019. This post contains the slides from my presentation. The slides for the entire talk are below. The slides can also be found on GitHub here .","tags":"jupyterhub","url":"slides-from-pydata-pdx-presentation.html","loc":"slides-from-pydata-pdx-presentation.html"},{"title":"Convert a PDF to Multiple Images with Python","text":"I had one of those \" Automate the Boring Stuff \" problems this week. How do you convert a multi-page PDF into a folder of images? One image for each page in the PDF? Read on to see how to solve this problem with Python. Table of contents: The Problem Install Python Create and virtual environment and install pdf2image Install img2pdf and poppler Imports The code Run the code Summary The Problem So here is the basic problem: Convert a multi-page PDF into a directory of images We're going to solve this problem with Python. Install Python If you don't have Python installed yet, I suggest you install the Anaconda distribution of Python. See this post to learn how to install Anaconda on your computer. Alternatively, you can download Python form Python.org or download Python from the Microsoft Store. Create and virtual environment and install pdf2image Before we start writing Python code, it is a good idea to create a new virtual environment. A virtual environment is an isolated installation of Python that is separate from other Python installations running on your computer. See this post to learn how to create a virtual environment with the Anaconda Prompt . To create a new Python virtual environment, open the Anaconda Prompt and type the following commands. Note the prompt sign > is included to indicate the prompt, not a character you should type. The -n pdf portion of the command denotes the name of the virtual environment. python=3.7 ensures Python Version 3.7 is installed into the pdf virtual environment. > conda create -n pdf python=3.7 Type y for yes when prompted. Before we install any packages into the pdf virtual environment, it needs to be activated. Activate the pdf virtual environment with the command below. Note that when the pdf virtual environment is active, (pdf) is shown in parenthesis before the prompt. > conda activate pdf (pdf)> Install img2pdf and poppler Next, we need to install the poppler package using conda and the pdf2image package using pip . The -c conda-forge portion of the conda install command indicates poppler will be installed from the conda-forge channel of packages. (pdf)> conda install -c conda-forge poppler (pdf)> pip install pdf2image Imports Alright, it's time to write the code. Use a code editor like VS Code or PyCharm to create a new file called pdf.py . At the top of the file, import the convert_from_path function from the pdf2image package and the pdf2image exceptions. # pdf.py from pdf2image import convert_from_path from pdf2image.exceptions import ( PDFInfoNotInstalledError , PDFPageCountError , PDFSyntaxError ) The code Below is the code to convert a PDF named myfile.pdf to multiple .png images. Save this code below the import lines. images = convert_from_path ( 'myfile.pdf' ) for i , image in enumerate ( images ): fname = \"image\" + str ( i ) + \".png\" image . save ( fname , \"PNG\" ) Run the code Put a PDF file in the same folder as the code. Make sure the PDF file has the same name as used in the code above. I called my PDF file myfile.pdf . If your PDF file has a different name, either re-name the PDF or use a different file name in the code above ├───pdf │ ├───pdf.py │ └───myfile.pdf Our pdf.py script can be run from the Anaconda Prompt . Make sure the (pdf) environment is active before the script is run. (pdf)> python pdf.py When the script finishes, you should see images in the same folder as your pdf.py script and myfile.pdf PDF file. My PDF had three pages, so three .png image files were created. Summary In this post, we used a Python package called pdf2image to convert a PDF file into a directory full of images. Big thanks to the maintainers of pdf2image for making such a useful package! The complete Python script is below: # pdf.py \"\"\" A Python script to convert a multi-page PDF to a directory of images Uses the pdf2image package \"\"\" from pdf2image import convert_from_path from pdf2image.exceptions import ( PDFInfoNotInstalledError , PDFPageCountError , PDFSyntaxError ) images = convert_from_path ( 'myfile.pdf' ) for i , image in enumerate ( images ): fname = 'image' + str ( i ) + '.png' image . save ( fname , \"PNG\" )","tags":"Python","url":"pdf-to-multiple-images.html","loc":"pdf-to-multiple-images.html"},{"title":"Slides from my PyPDX West Presentaion","text":"I gave a presentation at the first PyPDX West Meetup held in Hillsboro, OR. This post contains the slides from my presentation on JupyterHub and how JupyterHub is used to teach Python at our college. The slides for the entire talk are below. The slides can also be found on GitHub here .","tags":"jupyterhub","url":"slides-from-pypdx-west-presentation.html","loc":"slides-from-pypdx-west-presentation.html"},{"title":"My book Problem Solving with Python is available on Amazon","text":"My book: Problem Solving with Python 3.7 Edition is available on Amazon. This is the second edition of the book. The 3.7 Edition has a bunch of updates and improvments and is tested to work with Python 3.7: Link to Amazon The 3.7 Edition of the book has been a year in the making. Below is a partial list of updates that improved the book: Code tested to ensure it works with Python 3.7 Code tested work with with new versions of scientific Python libraries: NumPy 1.16, Matplotlib 3.1.1, SymPy 1.4, PySerial 3.4 Jupyter Notebook Chapter moved to right after the Orientation Chapter NumPy Chapter moved before the Matplotlib Chapter Revisions to end of chapter questions","tags":"books","url":"problem-solving-with-python-37-edition-book-on-amazon.html","loc":"problem-solving-with-python-37-edition-book-on-amazon.html"},{"title":"Estimating the Deflection of a Truncated Cone using Python","text":"In this post, we will complete a problem that might come up in a Strength of Materials class. We'll estimate the deflection of a truncated cone given an applied load using Python. The Problem Below is an engineering mechanics problem that can be solved in Python. Follow along this post to see how to solve the problem with code. Given: A solid truncated cone is subjected to an axial force $P$ as shown below. When load $P$ is applied to the cone, the exact elongation, $\\delta$ is: $$ \\delta = \\frac{PL}{2\\pi c&#94;{2}E} $$ Find: By replacing the cone by $n$ circular cylinders of equal thickness, determine the elongation of the the truncated cone. Also calculate the percent error obtained from using $n=6$, $n=12$, and $n=60$ circular cylinders. Assumptions: This problem can be completed generally, but for this solution, we are going to assume the following: load $P=10 \\ MPa$ minor radius $c=5 \\ mm$ major radius $2c=10 \\ mm$ length $L=100 \\ mm$ Elastic Modulus $E=120 \\ GPa$ Start the solution: install Python We are going to use Python to code the solution to this problem. If you don't already have Python installed on your computer, I recommend installing the Anaconda distribution of Python. See this post to learn how to install Anaconda on your computer. I am coding this solution in a Jupyter Notebook . Once you install Anaconda, you can open a Jupyter notebook from the Windows Start Menu or the Anaconda Prompt. See this post to learn about the ways to open a Jupyter notebook. Alternatively, instead of using a Jupyter notebook, you could code your solution in a .py file. Alright. Let's get coding.... Calculate the exact value of the deflection of the truncated cone Using the equation for the exact elongation, ($\\delta$) above and the assumed values for $P$, $c$, $L$, and $E$, we can calculate $\\delta$, which we will call d_exact . The equation and assumed values are below. $$ \\delta = \\frac{PL}{2\\pi c&#94;{2}E} $$ $P=10 \\ MPa$ $c=5 \\ mm$ $L=100 \\ mm$ $E=120 \\ GPa$ To code this solution in Python, first we need to import the math module. From the math module we will use math.pi as our value for $\\pi$. We can print our calculated d_exact using a Python f-string . Python f-strings allow us to put variables on the inside of print statements. Variables inside Python f-strings need to be surrounded by curly braces { } . Make sure to pre-pend the f-string with the letter \"f\" . In [1]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa d_exact = ( P * L ) / ( 2 * math . pi * ( c ** 2 ) * E ) print ( f \"The exact value for delfection of the cone is d_exact = {d_exact} \" ) Model a truncated cone as a series of disks Next we'll see how the approximations of the elongation of the cone compare to the exact elongation d_exact calculated above. We'll calculate the approximate elongation by dividing the cone into separate \" disks \". Below is a picture of a children's toy to illustrate the concept of modeling a truncated cone as a set of stacked disks. In the picture below, the truncated cone is modeled as 5 disks stacked on top of each other. The elongation $\\delta$ of each \"disk\" is equal to: $$ \\delta = \\frac{PL}{AE} $$ where $\\delta$ = deformation, or change in thickness of the disk $P$ = load $L$ = original length or thickness of the disk $A$ = cross-sectional area of the disk $E$ = elastic modulus (a material property) We can plot the upper surface of our truncated cone in two dimensions. The x-axis on the plot is the cone length $L$ and the y-axis on the plot is the cone radius $r$. The resulting plot looks like the hand-drawn plot below. According to our assumed parameters $r = c = 5 \\ mm$, $2r = 2c = 10 \\ mm$, and $L_0 = 100 \\ mm$. OK. Let's make our first approximation for the deflection of the truncated cone. Approximate the truncated cone as one disk If the truncated cone is modeled as a single disk (something that kind of looks like a can of soup), the radius of that single disk should be the average of the minor radius $r = 5 \\ mm$ and the major radius $2r = 10 \\ mm$. The plot below shows this approximation. Note how the upper surface of the cone (the line on the plot) has been approximated as a single horizontal line at a value of $r = 7.5 \\ mm$ (the average of $5$ and $10$). We can calculate the the elongation of this single cylinder (single disk) which has a radius of $r = 7.5$ using the standard equation for elongation in engineering mechanics. $$ \\delta_1 = \\frac{PL}{A_{1}E} $$ $\\delta_1$ = deformation, or change in thickness of the one disk $P = 10 \\ MPa$ $r_1 =7.5 \\ mm$ (radius of the one disk) $A_1 = \\pi r&#94;2$ (area of the one disk) $L = 100 \\ mm$ $E = 120 \\ GPa$ Let's code this approximation of the elongation (modeling the truncated cone as a single thick disk) in Python. In [2]: import math P = 10 r_1 = 7.5 A_1 = math . pi * r_1 ** 2 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa d_1 = ( P * L ) / ( A_1 * E ) print ( f \"The approximate value for delfection of the cone modeled as one disk is d_1 = {d_1} \" ) The approximate value calculated value of d_1 is around $4.72 \\times 10&#94;{-5}$. This approximate value is in the same order of magnitude as the previously calculated exact value of deflection d_exact which was about $5.31 \\times 10&#94;{-5}$. Approximate the deflection of the truncated cone by modeling it as multiple disks We can more closely approximate the deformation of our truncated cone by dividing the cone into more numerous and successively thinner disks. The plot below shows the progression of using two disks, then three disks, then four disks. Note that as the number of disks increases, the thickness of each disk also increases. Find the thickness of each disk The thickness of each disk $L_n$ can be calculated by taking the thickness (or Length) of the entire truncated cone and dividing it by the number of disks. $$ L_n = \\frac{L}{n} $$ $L_n$ = thickness of each disk $L$ = thickness of the whole truncated cone $n$ = number of disks the truncated cone is approximated by Find the L value for each disk Half of the disk thickness is where we will set our disk radius (the dotted vertical lines in the plot above). If we take the $L$ value (x-value) as the right-hand edge of each disk (solid vertical lines in the plot above), we need to back up half-way through the disk to set the location of the disk radius. $$ L_i = \\frac{n_i}{L} - (L_n/2) $$ $L_i$ = $L$ value that's the center of disk $i$ $n_i$ = disk number $L$ = thickness of the whole truncated cone $L_n$ = thickness of each disk $L_n/2$ = half the thickness of each disk (need to back up half-way through a disk to arrive at the $L$ value to set the radius) Great! We have an equation for the $L_i$ value of each disk. However, we still need the radius $r$ of each disk to calculate the area of each disk and ultimately the deformation $\\delta$ of each disk. So what we need is an equation that spits out radius $r$ given length $L$. Radius, r in terms of length, L We can write the equation with the help of a plot. The plot below shows how radius $r$ changes based on length $L$. The relationship is a simple line that we can approximate using the form $y = mx+b$. Where $y = r$, $m = slope$, and $b = y-intercept$. The hand-drawn plot below shows the equation for our assumed values. So our equation for $r$ in terms of $L_i$ is: $$ r = \\frac{-5}{100}L_i + 10 $$ $\\frac{-5}{100}$ = slope of $r$ vs. $L$ $L_i$ = L value (distance relative to the bottom of the truncated cone) 10 = y-intercept (the major radius) Approximate truncated cone as two disks Now let's use our formula for disk radius $r$ and approximate the elongation of the truncated cone using two disks ($n=2$). In [3]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa n = 2 # two disks L_n = L / n # thickness of each disk # calculate elgongation of the first disk (the disk with the larger radius) i = 1 L_1 = i * L / n - ( L_n * ( 1 / 2 )) print ( f \"L( {i} ) position: {L_1} \" ) r_1 = ( - c / L ) * L_1 + 2 * c print ( f \"r( {i} ) length: {r_1} \" ) A_1 = math . pi * r_1 ** 2 d_1 = ( P * L / n ) / ( A_1 * E ) print ( f \"The delfection of the first disk d_1 = {d_1} \" ) # calculate elgongation of the second disk (the disk with the larger radius) i = 2 L_2 = i * L / n - ( L_n * ( 1 / 2 )) print ( f \"L( {i} ) position: {L_2} \" ) r_2 = ( - c / L ) * L_2 + 2 * c print ( f \"r( {i} ) length: {r_2} \" ) A_2 = math . pi * r_2 ** 2 d_2 = ( P * L / n ) / ( A_2 * E ) print ( f \"The delfection of the second disk d_2 = {d_2} \" ) # add the two deflections together to calculate the total deflection d_t = d_1 + d_2 print ( f \"The total estimated deflections using {n} disks is d_t = {d_t} \" ) L(1) position: 25.0 r(1) length: 8.75 The delfection of the first disk d_1 = 1.7322987003199492e-05 L(2) position: 75.0 r(2) length: 6.25 The delfection of the second disk d_2 = 3.395305452627101e-05 The total estimated deflections using 2 disks is d_t = 5.12760415294705e-05 Great! We can see our approximation using two disks which is about $5.13 \\times 10&#94;{-5}$ is closer to the exact value than our first approximation using one disk. But hand coding in L_1 , r_1 , A_1 , d_1 followed by L_2 , r_2 , A_2 , d_2 even though we are doing the same operations each time is repetative. If we have 5 or 60 disks, we would end up with a lot of code. Approximate truncated cone as n-disks using a for loop To make our calculation work for $n$ disks, we'll use a for loop . We want to start our loop at i=1 and end our loop at i=n . We can do this with Python's range() function. Note that we set for i in range(1,n+1): (start at 1 end at n ) because Python counting starts at zero and ends at n-1. In [4]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa n = 2 # two disks L_n = L / n #thickness of each disk # calculate elgongation of the first disk (the disk with the larger radius) for i in range ( 1 , n + 1 ): L_i = i * L / n - ( L_n * ( 1 / 2 )) print ( f \"L( {i} ) position: {L_i} \" ) r_i = ( - c / L ) * L_i + 2 * c print ( f \"r( {i} ) length: {r_i} \" ) A_i = math . pi * r_i ** 2 d_i = ( P * L / n ) / ( A_i * E ) print ( f \"The delfection of the disk {i} = {d_i} \" ) L(1) position: 25.0 r(1) length: 8.75 The delfection of the disk 1 = 1.7322987003199492e-05 L(2) position: 75.0 r(2) length: 6.25 The delfection of the disk 2 = 3.395305452627101e-05 The deflection calculated using the Python for loop is the same as the deflection when we hard coded in each disk. Now we need to add these deflections together to calculate the total estimated deflection. Sum disk deflections to find total deflection We can add all of the individual disk deflections together into one variable called d_t . We'll use Python's += operator to add each disk's deflection to d_t each time we go through the for loop . The code below calculates the total deflection. In [5]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa n = 2 # two disks L_n = L / n #thickness of each disk d_t = 0 # calculate elgongation of the first disk (the disk with the larger radius) for i in range ( 1 , n + 1 ): L_i = i * L / n - ( L_n * ( 1 / 2 )) print ( f \"L( {i} ) position: {L_i} \" ) r_i = ( - c / L ) * L_i + 2 * c print ( f \"r( {i} ) length: {r_i} \" ) A_i = math . pi * r_i ** 2 d_i = ( P * L / n ) / ( A_i * E ) print ( f \"The delfection of the disk {i} = {d_i} \" ) d_t += d_i print ( f \"The total estimated deflection using {n} disks d_t = {d_t} \" ) L(1) position: 25.0 r(1) length: 8.75 The delfection of the disk 1 = 1.7322987003199492e-05 L(2) position: 75.0 r(2) length: 6.25 The delfection of the disk 2 = 3.395305452627101e-05 The total estimated deflection using 2 disks d_t = 5.12760415294705e-05 The total estimated deflection using a 2 disk approximation is $5.127 \\times 10&#94;{-5}$. This is a closer to the exact value than our estimated deflection using a 1 disk approximation. Calculate the estimated deflection using 6, 12, and 60 disks Now that the code works for 2 disks, we can easily approximate the deflection using a 6 disk, a 12 disk and a 60 disk approximation. Approximate with 6 disks The code below corresponds to a 6 disk approximation. Note how n=6 and how the variable d_6 is used to store the total deflection instead of d_t . We'll use this d_6 value later, so we want to set it to a unique variable name. In [6]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa n = 6 # two disks L_n = L / n #thickness of each disk d_6 = 0 # calculate elgongation of the first disk (the disk with the larger radius) for i in range ( 1 , n + 1 ): L_i = i * L / n - ( L_n * ( 1 / 2 )) print ( f \"L( {i} ) position: {L_i} \" ) r_i = ( - c / L ) * L_i + 2 * c print ( f \"r( {i} ) length: {r_i} \" ) A_i = math . pi * r_i ** 2 d_i = ( P * L / n ) / ( A_i * E ) print ( f \"The delfection of the disk {i} = {d_i} \" ) d_6 += d_i print ( f \"The total estimated deflection using {n} disks d_ {n} = {d_6} \" ) L(1) position: 8.333333333333334 r(1) length: 9.583333333333334 The delfection of the disk 1 = 4.813760093516683e-06 L(2) position: 25.0 r(2) length: 8.75 The delfection of the disk 2 = 5.774329001066498e-06 L(3) position: 41.666666666666664 r(3) length: 7.916666666666666 The delfection of the disk 3 = 7.0539586965937e-06 L(4) position: 58.333333333333336 r(4) length: 7.083333333333333 The delfection of the disk 4 = 8.811346330347146e-06 L(5) position: 75.0 r(5) length: 6.25 The delfection of the disk 5 = 1.1317684842090335e-05 L(6) position: 91.66666666666667 r(6) length: 5.416666666666666 The delfection of the disk 6 = 1.506792360633329e-05 The total estimated deflection using 6 disks d_6 = 5.283900256994765e-05 Approximate with 12 disks The same code can be used to approximate the deflection using 12 disks. This time we change n=12 and change d_6 to d_12 . I also commented out some of the print statements so that the output wouldn't be so long. In [7]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa n = 12 # twelve disks L_n = L / n #thickness of each disk d_12 = 0 # calculate elgongation of the first disk (the disk with the larger radius) for i in range ( 1 , n + 1 ): L_i = i * L / n - ( L_n * ( 1 / 2 )) #print(f\"L({i}) position: {L_i}\") r_i = ( - c / L ) * L_i + 2 * c #print(f\"r({i}) length: {r_i}\") A_i = math . pi * r_i ** 2 d_i = ( P * L / n ) / ( A_i * E ) print ( f \"The delfection of the disk {i} = {d_i} \" ) d_12 += d_i print ( f \"The total estimated deflection using {n} disks d_ {n} = {d_12} \" ) The delfection of the disk 1 = 2.305549198252898e-06 The delfection of the disk 2 = 2.5150410760200742e-06 The delfection of the disk 3 = 2.75443925307769e-06 The delfection of the disk 4 = 3.0297193212020534e-06 The delfection of the disk 5 = 3.3484274680740634e-06 The delfection of the disk 6 = 3.72020319864182e-06 The delfection of the disk 7 = 4.157516880767878e-06 The delfection of the disk 8 = 4.676729273591047e-06 The delfection of the disk 9 = 5.299644306910146e-06 The delfection of the disk 10 = 6.055836122402675e-06 The delfection of the disk 11 = 6.986225211166873e-06 The delfection of the disk 12 = 8.148733086305042e-06 The total estimated deflection using 12 disks d_12 = 5.299806439641226e-05 Using an approximation of 12 disks, we are even closer than our previous approximations. Approximate with 60 disks One more approximation to make, 60 disks. Let's comment out all of the print statements except for the final one. Remember to change n=60 and use the variable d_60 . In [8]: import math P = 10 c = 5 L = 100 E = 120 * 1000 #120 GPa = 120 * 1000 MPa n = 60 # sixty disks L_n = L / n #thickness of each disk d_60 = 0 # calculate elgongation of the first disk (the disk with the larger radius) for i in range ( 1 , n + 1 ): L_i = i * L / n - ( L_n * ( 1 / 2 )) #print(f\"L({i}) position: {L_i}\") r_i = ( - c / L ) * L_i + 2 * c #print(f\"r({i}) length: {r_i}\") A_i = math . pi * r_i ** 2 d_i = ( P * L / n ) / ( A_i * E ) #print(f\"The delfection of the disk {i} = {d_i}\") d_60 += d_i print ( f \"The total estimated deflection using {n} disks d_ {n} = {d_60} \" ) The total estimated deflection using 60 disks d_60 = 5.3049498845620634e-05 That's the closest approximation of them all. How close was each approximation? Let's quantify that using percent error. Calculate Percent Error To calculate the percent error we'll use: $$ \\%error = \\frac{\\delta_{approx}-\\delta_{exact}}{\\delta_{exact}} \\times 100\\% $$ In [9]: e_6 = ( d_6 - d_exact ) / d_exact print ( f \" The error using an approximation of 6 disks is {e_6*100}%\" ) The error using an approximation of 6 disks is -0.4008266219441551% In [10]: e_12 = ( d_12 - d_exact ) / d_exact print ( f \" The error using an approximation of 12 disks is {e_12*100}%\" ) The error using an approximation of 12 disks is -0.10100214265148796% In [11]: e_60 = ( d_60 - d_exact ) / d_exact print ( f \" The error using an approximation of 60 disks is {e_60*100}%\" ) The error using an approximation of 60 disks is -0.004050489986805123% Summary In this post we calculated and estimated the deflection of a truncated cone under an applied load. We calculated the exact value of deflection using an equation. Then we used a Python for loop to estimate the truncated cone deflection by modeling the cone as a series of disks. Modeling the cone as 60 disks gave us the lowest percent error.","tags":"strengths","url":"deflection-of-a-truncated-cone-with-python.html","loc":"deflection-of-a-truncated-cone-with-python.html"},{"title":"Plotting a Stress Strain Curve with Python and Matplotlib","text":"In this post, we'll use data from a tensile test to build a stress strain curve with Python and Matplotlib. A tensile test is a type of mechanical test performed by engineers used to determine the mechanical properties of a material. Engineering metal alloys such as steel and aluminum alloys are tensile tested in order to determine their strength and stiffness. Tensile tests are performed in a piece of equipment called a mechanical test frame. After a tensile test is complete, a set of data is produced by the mechanical test frame. Using the data acquired during a tensile test, a stress-strain curve can be produced. In this post, we will create a stress-strain curve (a plot) from a set of tensile test data of a steel 1045 sample and an aluminum 6061 sample. The stress strain curve we construct will have the following features: A descriptive title Axes labels with units Two lines on the same plot. One line for steel 1045 and one line for aluminum 6061 A legend Install Python We are going to build our stress strain curve with Python and a Jupyter notebook. I suggest engineers and problem-solvers download and install the Anaconda distribution of Python . See this post to learn how to install Anaconda on your computer. Alternatively, you can download Python form Python.org or download Python the Microsoft Store. Install Jupyter, NumPy, Pandas, and Matplotlib Once Python is installed, the next thing we need to do is install a couple of Python packages. If you are using the Anaconda distribution of Python, the packages we are going to use to build the plot: Jupyter, NumPy, Pandas, and Matplotlib come pre-installed and no additional installation steps are necessary. However, if you downloaded Python from Python.org or installed Python using the Microsoft Store, you will need to install install Jupyter, NumPy, Pandas, and Matplotlib separately. You can install Jupyter, NumPy, Pandas, and Matplotlib with pip (the Python package manager) or install theses four packages with the Anaconda Prompt. If you are using a terminal and pip, type: > pip install jupyter numpy pandas matplotlib If you have Anaconda installed and use the Anaconda Prompt, type: > conda install jupyter numpy pandas matplotlib Open a Jupyter notebook We will construct our stress strain curve using a Jupyter notebook. See this post to see how to open a Jupyter notebook. Make sure to save your Jupyter notebook with a recognizable name. Download the data and move the data into the same folder as the Jupyter notebook Next, we need to download the two data files that we will use to build our stress-strain curve. You can download sample data using the links below: steel1045.xls aluminum6061.xls After these .xls files are downloaded, both .xls files need to be moved into the same folder as our Jupyter notebook. Import NumPy, Pandas, and Matplotlib Now that our Jupyter notebook is open and the two .xls data files are in the same folder as the Jupyter notebook, we can start coding and build our plot. At the top of the Jupyter notebook, import NumPy, Pandas and Matplotlib. The command %matplotlib inline is included so that our plot will display directly inside our Jupyter notebook. If you are using a .py file instead of a Jupyter notebook, make sure to comment out %matplotlib inline as this line is not valid Python code. We will also print out the versions of our NumPy and Pandas packages using the .__version__ attribute. If the versions of NumPy and Pandas prints out, that means that NumPy and Pandas are installed and we can use these packages in our code. In [1]: import numpy as np import pandas as pd import matplotlib.pyplot as plt % matplotlib inline print ( \"NumPy version:\" , np . __version__ ) print ( \"Pandas version:\" , pd . __version__ ) NumPy version: 1.16.5 Pandas version: 0.25.1 Ensure the two .xls data files are in the same folder as the Jupyter notebook Before we proceed, let's make sure the two .xls data files are in the same folder as our running Jupyter notebook. We'll use a Jupyter notebook magic command to print out the contents of the folder that our notebook is in. The %ls command lists the contents of the current folder. In [2]: % ls Volume in drive C is Windows Volume Serial Number is A048-4C53 Directory of C:\\Users\\peter.kazarinoff\\Documents\\staticsite\\content\\code\\matplotlib_plots\\stress_strain_curves 02/13/2020 02:50 PM <DIR> . 02/13/2020 02:50 PM <DIR> .. 05/20/2019 10:37 AM <DIR> .ipynb_checkpoints 05/13/2019 12:59 PM 36,864 aluminum6061.xls 05/20/2019 10:20 AM <DIR> images 05/13/2019 01:09 PM 38,912 steel1045.xls 10/21/2019 11:22 AM 44,972 stress_strain_curve_with_inset.png 10/21/2019 11:22 AM 148,175 stress_strain_curve_with_inset_elastic_region.ipynb 02/13/2020 02:50 PM 87,568 stress_strain_curve_with_python.ipynb 02/13/2020 02:40 PM 113,352 stress-strain_curve.png 6 File(s) 469,843 bytes 4 Dir(s) 119,576,158,208 bytes free We can see our Jupyter notebook stress_strain_curve_with_python.ipynb as well as the two .xls data files aluminum6061.xls and steel1045.xls are in our current folder. Now that we are sure the two .xls data files are in the same folder as our notebook, we can import the data in the two two .xls files using Panda's pd.read_excel() function. The data from the two excel files will be stored in two Pandas dataframes called steel_df and al_df . In [3]: steel_df = pd . read_excel ( \"steel1045.xls\" ) al_df = pd . read_excel ( \"aluminum6061.xls\" ) WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero We can use Pandas .head() method to view the first five rows of each dataframe. In [4]: steel_df . head () Out[4]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } TESTNUM POINTNUM TIME POSIT FORCE EXT CH5 CH6 CH7 CH8 0 762 1 5.969 0.01284 201.030792 0.001572 -0.007133 NaN NaN NaN 1 762 2 6.242 0.01392 215.235886 0.000009 -0.014581 NaN NaN NaN 2 762 3 6.936 0.01646 246.816742 -0.000832 0.006942 NaN NaN NaN 3 762 4 8.632 0.02340 371.870361 0.002203 0.000776 NaN NaN NaN 4 762 5 10.533 0.03110 502.501862 0.001481 0.018102 NaN NaN NaN In [5]: al_df . head () Out[5]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } TESTNUM POINTNUM TIME POSIT FORCE EXT CH5 CH6 CH7 CH8 0 761 1 6.532 0.01524 201.158508 0.018893 -0.023081 NaN NaN NaN 1 761 2 6.702 0.01600 205.978119 0.000265 -0.013024 NaN NaN NaN 2 761 3 7.098 0.01720 219.295441 -0.000877 -0.024879 NaN NaN NaN 3 761 4 8.697 0.02350 268.505890 0.001453 -0.006798 NaN NaN NaN 4 761 5 10.196 0.03004 322.028168 0.001865 0.012563 NaN NaN NaN We see a number of columns in each dataframe. The columns we are interested in are FORCE , EXT , and CH5 . Below is a description of what these columns mean. FORCE Force measurements from the load cell in pounds (lb), force in pounds EXT Extension measurements from the mechanical extensometer in percent (%), strain in percent CH5 Extension readings from the laser extensometer in percent (%), strain in percent Create stress and strain series from the FORCE , EXT , and CH5 columns Next we'll create a four Pandas series from the ['CH5'] and ['FORCE'] columns of our al_df and steel_df dataframes. The equations below show how to calculate stress, $\\sigma$, and strain, $\\epsilon$, from force $F$ and cross-sectional area $A$. Cross-sectional area $A$ is the formula for the area of a circle. For the steel and aluminum samples we tested, the diameter $d$ was $0.506 \\ in$. $$ \\sigma = \\frac{F}{A_0} $$$$ F \\ (kip) = F \\ (lb) \\times 0.001 $$$$ A_0 = \\pi (d/2)&#94;2 $$$$ d = 0.506 \\ in $$$$ \\epsilon \\ (unitless) = \\epsilon \\ (\\%) \\times 0.01 $$ In [6]: strain_steel = steel_df [ 'CH5' ] * 0.01 d_steel = 0.506 # test bar diameter = 0.506 inches stress_steel = ( steel_df [ 'FORCE' ] * 0.001 ) / ( np . pi * (( d_steel / 2 ) ** 2 )) strain_al = al_df [ 'CH5' ] * 0.01 d_al = 0.506 # test bar diameter = 0.506 inches stress_al = ( al_df [ 'FORCE' ] * 0.001 ) / ( np . pi * (( d_al / 2 ) ** 2 )) Build a quick plot Now that we have the data from the tensile test in four series, we can build a quick plot using Matplotlib's plt.plot() method. The first x,y pair we pass to plt.plot() is strain_steel,stress_steel and the second x,y pair we pass in is strain_al,stress_al . The command plt.show() shows the plot. In [7]: plt . plot ( strain_steel , stress_steel , strain_al , stress_al ) plt . show () We see a plot with two lines. One line represents the steel sample and one line represents the aluminum sample. We can improve our plot by adding axis labels with units, a title and a legend. Add axis labels, title and a legend Axis labels, titles and a legend are added to our plot with three Matplotlib methods. The methods are summarized in the table below. Matplotlib method description example plt.xlabel() x-axis label plt.xlabel('strain (in/in)') plt.ylabel() y-axis label plt.ylabel('stress (ksi)') plt.title() plot title plt.title('Stress Strain Curve') plt.legend() legend plt.legend(['steel','aluminum']) The code cell below shows these four methods in action and produces a plot. In [8]: plt . plot ( strain_steel , stress_steel , strain_al , stress_al ) plt . xlabel ( 'strain (in/in)' ) plt . ylabel ( 'stress (ksi)' ) plt . title ( 'Stress Strain Curve of Steel 1045 and Aluminum 6061 in tension' ) plt . legend ([ 'Steel 1045' , 'Aluminum 6061' ]) plt . show () The plot we see has two lines, axis labels, a title and a legend. Next we'll save the plot to a .png image file. Save the plot as a .png image Now we can save the plot as a .png image using Matplotlib's plt.savefig() method. The code cell below builds the plot and saves an image file called stress-strain_curve.png . The argument dpi=300 inside of Matplotlib's plt.savefig() method specifies the resolution of our saved image. The image stress-strain_curve.png will be saved in the same folder as our running Jupyter notebook. In [9]: plt . plot ( strain_steel , stress_steel , strain_al , stress_al ) plt . xlabel ( 'strain (in/in)' ) plt . ylabel ( 'stress (ksi)' ) plt . title ( 'Stress Strain Curve of Steel 1045 and Aluminum 6061 in tension' ) plt . legend ([ 'Steel 1045' , 'Aluminum 6061' ]) plt . savefig ( 'stress-strain_curve.png' , dpi = 300 , bbox_inches = 'tight' ) plt . show () Our complete stress strain curve contains two lines, one for steel and one for aluminum. The plot has axis labels with units, a title and a legend. A copy of the plot is now saved as stress-strain_curve.png in the same folder as our Jupyter notebook. Summary In this post, we built a stress strain curve using Python. First we installed Python and made sure that NumPy, Pandas, Matplotlib and Jupyter were installed. Next we opened a Jupyter notebook and moved our .xls data files into the same folder as the Jupyter notebook. Inside the Jupyter notebook we entered code into a couple different code cells. In the first Jupyter notebook code cell, we imported NumPy, Pandas, and Matplotlib and printed our their versions. In the next code cell, we saved the data from two .xls data files into two Pandas dataframes. In the third code cell, we created Pandas series for stress and strain from the columns in the dataframes. In the final code cell we built our stress strain curve with Matplotlib and saved the plot to a .png image file.","tags":"matplotlib","url":"stress-strain-curve-with-python-and-matpotlib.html","loc":"stress-strain-curve-with-python-and-matpotlib.html"},{"title":"Plotting Bond Energy vs. Distance with Python and Matplotlib","text":"Atoms in solid materials like steel and aluminum are held together with chemical bonds. Atoms of solid materials are more stable when they are chemically bonded together, and it takes energy to separate atoms which are joined together with a chemical bond. The bonding energy associated with a chemical bond describes the amount of energy needed to separate two atoms from their equilibrium positions to a substantial distance apart. In this post, we'll review how to build a line plot with Python and Matplotlib that describes the bond energy compared to the separation distance of a Na + Cl - ion pair. Describe bond energy in terms of attractive and repulsive terms For an Na + Cl - pair, attractive and repulsive energies E a and E r depend on the distance $r$ between the Na + and Cl - ions. The attractive energy E a and the repulsive energy energy E r of an Na + Cl - pair depends on the inter-atomic distance, $r$ according to the following equations: $$E_a = \\frac{- 1.436}{r} $$$$ E_r = \\frac{7.32 \\times 10&#94;{-6}}{r&#94;8} $$ The total bond energy, E n is the sum of the attractive energy term E a and the repulsive energy term E r : $$ E_n = E_a + E_r $$ On a single plot, we can graph E a , E r and E n vs. $r$ using Python and Matplotlib. Our plot will conform to the following parameters: The range of $r$ values should be between 0.01 and 1.00 in increments of 0.01 The x-axis limits should be between $r$ = 0 and $r$ = 1.00 The y-axis limits should be between E = -10 and E = 10 We will also include a plot title and axis labels with units. Each of the three lines on the plot will also be incorporated in a legend. All of this can be accomplished with Python and Matplotlib. I use the Anaconda distribution of Python. See this post to see how to install Anaconda on Windows. If you use the Anaconda distribution of Python, Matplotlib is already installed. If you use Miniconda, a virtual environment or installed Python from Python.org, Matplotlib can be installed using the Anaconda Prompt or installed using a terminal and pip . The install command is below. > conda install matplotlib numpy or $ pip install matplotlib numpy Import NumPy and Matplotlib The first step to build our plot is to import NumPy and Matplotlib. We'll use NumPy to build an array that contains the distance values $r$ and the energies E a , E r and E n . We'll use Matplotlib to build the plot. The necessary import commands are below. I am using a Jupyter notebook to build the plot. To see how open a Jupyter notebook, see this post . If you are using a Jupyter notebook, include the line %matplotlib inline . If you build your code in a .py-file, make sure to leave this line out as %matplotlib inline is not valid Python code. In [1]: import numpy as np import matplotlib.pyplot as plt # if using a Jupyter notebook, include: % matplotlib inline Create a NumPy array of r-values Next, we will create a NumPy array of $r$ values that starts at 0.01 , ends at 1.00 and increments by 0.01 . We'll create the array using NumPy's np.arange() function. The np.arange() function accepts three input arguments shown below. np.arange(start,stop,step) Note that Python counting starts at zero and ends at n-1. So if we want the last value in the array to be 1.00 , we need to set our stop value as 1.01 . In [2]: r = np . arange ( 0.01 , 1.01 , 0.01 ) # start, stop(exclusive), step Create arrays for the attractive energy term, the repulsive energy term and the total energy Next we'll create arrays for the attractive energy term E a , the repulsive energy term E r and the total energy E n . We'll use the equations shown above and our array r to build these three arrays. Note that exponents are denoted in Python with the double asterisk symbol ** , not the carrot symbol &#94; . In [3]: Ea = - 1.436 / r # attractive energy term Er = ( 7.32e-6 ) / ( r ** ( 8 )) # repulsive energy term En = Ea + Er # total energy Build a simple line plot Now that we have the four arrays, we can build a simple line plot with Matplotlib. Each line on the plot is created using a pair of arrays. The first line uses the pair r, Ea , the second line on the plot uses the pair r, Er , and the third line on the plot is described by the pair r, En . Matplotlib's plt.plot() method accepts pairs of arrays (or pairs of lists) as shown below. plt.plot(x1,y1,x2,y2,x3,y3....) After the plt.plot() line, the command plt.show() shows the plot. These two lines have to be in the proper order. In [4]: plt . plot ( r , Ea , r , Er , r , En ) plt . show () We see a plot, but the plot looks like it only has one line on it. What's going on? We can only see one line because our y-axis has a very large range, between 0 and 1e10. If we limit the y-axis range, we'll be able to see all three line on the plot. Apply x-axis and y-axis limits Next, we'll use Matplotlib's plt.xlim() and plt.ylim() commands to apply axis limits to our plot. A list or an array needs to be passed to these two commands. The format is below. plt.xlim([lower_limit, upper_limit]) plt.ylim([lower_limit, upper_limit]) We'll limit our x-axis to start at 0.00 and end at 1.00 . Our y-axis will be limited to between -10 and 10 . The plt.plot() line needs to be before we customize the axis limits. The plt.show() line is included after we set the axis limits. In [5]: plt . plot ( r , Ea , r , Er , r , En ) plt . xlim ([ 0.00 , 1.00 ]) plt . ylim ([ - 10 , 10 ]) plt . show () Great! We see a plot with three lines. We can also see the y-axis starts at -10 and ends at 10 . Next we'll add axis labels and a title to our plot. Axis labels and title We can add axis labels to our plot with plt.xlabel() and plt.ylabel() . We need to pass a string enclosed in quotation marks ' ' as input arguments to these two methods. plt.title() adds a title to our plot. In [6]: plt . plot ( r , Ea , r , Er , r , En ) plt . xlim ([ 0.01 , 1.00 ]) plt . ylim ([ - 10 , 10 ]) plt . title ( 'Attractive, Replusive and Total energy of an Na+ Cl- ion pair' ) plt . xlabel ( 'r (nm)' ) plt . ylabel ( 'Energy (eV)' ) plt . show () We see a plot with three lines that includes axis labels and a title. The final detail we'll to add to our plot is a legend. Add a legend We can add a legend to our plot with the plt.legend() command. A list of strings needs to be passed to plt.legend() in the form below. Note the parenthesis, square brackets, and quotation marks. plt.legend(['Entry 1', 'Entry 2', 'Entry 3']) The plt.legend() line needs to be between the plt.plot() line and the plt.show() line just like our other plot customizations. In [7]: plt . plot ( r , Ea , r , Er , r , En ) plt . xlim ([ 0.01 , 1.00 ]) plt . ylim ([ - 10 , 10 ]) plt . title ( 'Attractive, Replusive and Total energy of an Na+ Cl- ion pair' ) plt . xlabel ( 'r (nm)' ) plt . ylabel ( 'Energy (eV)' ) plt . legend ([ 'Ea' , 'Er' , 'En' ]) plt . show () We see a plot with three lines, axis labels, a title, and a legend with three entries. There is one last step. In case we want to include the plot in a report or presentation, it would be nice to save the plot as an image file. Save the plot as an image file If we want to include the plot in a Word document or a PowerPoint presentation, we can just right-click on the plot and select copy image or save image as . We can also save our plot programmatically with the plt.savefig() method. The plt.savefig() method takes a couple arguments including the image file name and the image resolution. Matplotlib infers the filetype based on the filename. The general format is below. plt.savefig('filename.ext', dpi=resolution) We'll save our plot as energy_vs_distance_curve.png with a resolution of 72 dpi (dots per inch). You could use a higher resolution in a printed document, such as 200 dpi, but for a webpage 72 dpi is fine. The plt.savefig() line needs to be after the plt.plot() line and all the lines of customization, but before the plt.show() line. The code below builds the plot and saves the plot as a separate image file. In [8]: plt . plot ( r , Ea , r , Er , r , En ) plt . xlim ([ 0.01 , 1.00 ]) plt . ylim ([ - 10 , 10 ]) plt . title ( 'Attractive, Replusive and Total energy of an Na+ Cl- ion pair' ) plt . xlabel ( 'r (nm)' ) plt . ylabel ( 'Energy (eV)' ) plt . legend ([ 'Ea' , 'Er' , 'En' ]) plt . savefig ( 'energy_vs_distance_curve.png' , dpi = 72 ) plt . show () Summary In this post, we created a plot with Python and Matplotlib. The plot contained three lines, axis labels, a title, and a legend. We also saved the plot to a separate image file. The Matplotlib commands we used to build the plot are summarized below. Matplotlib method Description plt.plot(x,y) construct a line plot plt.xlabel('x label') x-axis label plt.ylabel('y label') y-axis label plt.title('title') plot title plt.xlim([0, 10]) x-axis limits plt.ylim([-5, 5]) y-axis limits plt.legend(['line 1', 'line 2', 'line 3']) legend entries plt.savefig('plot.png', dpi=72) save plot as an image file","tags":"matplotlib","url":"plotting-bond-energy-with-matplotlib-and-python.html","loc":"plotting-bond-energy-with-matplotlib-and-python.html"},{"title":"How to upload .py-files onto an ESP8266 running MicroPython","text":"This is an update to the sixth part of a multi-part series on Micropython. I had trouble in class today uploading a .py-file to an ESP8266 microcontroller running MicroPython using a command line tool called ampy . There was a trick getting ampy to work on with the ESP8266 microcontroller that I want to share in case other people come across the same problem. In this post, I'll show you how I uploaded upload .py files to an ESP8266 microcontroller using Python and a Python package called ampy . Before you can upload a .py-file onto the ESP8266 microcontroller, first make sure MicroPython is installed on the microcontroller. See the MicroPython docs and a previous post on how to install MicroPython on an ESP8266 and how to install PuTTY on a Windows 10 machine. PuTTY needs to be installed on your computer to communicate with the ESP8266 running MicroPython. Table of contents: Create a new virtual environment Install ampy with pip Disable debug output on the ESP8266 MicroController List the files stored on the ESP8266 microcontroller Download files stored on the ESP8266 to your computer Modify boot.py to include esp.osdebug(None) Upload the revised boot.py file onto the ESP8266 with ampy Unplug and power up the ESP8266 microcontroller Write a main.py script Upload main.py onto the board Start the board to see the code run Modify the code in main.py and re-upload Summary Create a new virtual environment It is a good idea to create a new virtual environment when you start a Python project. A virtual environment is an isolated installation of Python that is separate from other Python installations running on your computer. See this post to learn how to create a virtual environment with the Anaconda Prompt . I called my new virtual environment ampy . I like to name my virtual environments with a name that corresponds to what the environment is used for. To create a new Python virtual environment, open the Anaconda Prompt and type the following commands. Note the prompt character (the greater than sign > ) does not need to be typed. It is included to indicate the Anaconda Prompt . The -n ampy portion of the command denotes the name of the virtual environment. python=3.7 ensures Python version 3.7 is installed into the ampy virtual environment. > conda create -n ampy python=3.7 Type y for yes when prompted. After the virtual environment is created, it needs to be activated before any packages are installed into it. Activate the ampy virtual environment with the command below. Note that when the ampy virtual environment is active, (ampy) is shown in parenthesis before the prompt. > conda activate ampy (ampy) > Install ampy with pip Ampy is a command-line tool (a program that accepts text commands typed into a terminal) for uploading files onto microcontrollers running MicroPython. Ampy was created by Adafruit. Adafruit is the company that makes the ESP8266 Microcontroller I'm using. The microcontroller is called the Adafruit Feather Huzzah ESP2866. Ampy can also be used to download files stored on an ESP8266 microcontroller. Before installing ampy , make sure to activate the virtual environment you just created. You know the virtual environment is activated because (ampy) will be shown before the prompt. The command line tool is called ampy , but you enter the command pip install ampy-adafruit to install it. Remember the prompt character > and (ampy) do not need to be typed. They are included below to indicate the Anaconda Prompt . # if the virtual environment isn't already active > conda activate ampy (ampy) > pip install ampy-adafruit (ampy) > ampy --help If ampy is successfully installed, the command ampy --help will show some documentation about how to use the tool. Disable debug output on the ESP8266 MicroController Here is the gotcha - I had trouble uploading .py-files to the ESP8266 microcontroller, and I couldn't figure out why I kept getting when I ran ampy commands. When I tried to run ampy commands, the output would show some type of error involving the web REPL. I couldn't figure out what was wrong. At first, I thought the ESP8266 microcontroller was trying to connect to WiFi, and that was the reason ampy didn't work. Then I thought maybe the version of MicroPython running on the board was out of date. But after I did a fresh MicroPython install, ampy still didn't work. It turned out the problem had to do with a debug setting running on the ESP8266 by default. I found the section below inside the ampy documentation. The ampy documentation says that debugging can be disabled by running the command esp.osdebug(None) at the MicroPython REPL. So to get ampy working and upload .py-files onto the board, you first need to open PuTTY and connect to the board over a serial connection. Remember to include the correct Port and use 115200 as the baud rate. Type the commands below into the MicroPython REPL (into the PuTTY window). Note the triple arrow prompt >>> should not be typed. The triple arrow prompt >>> is shown to denote the MicroPython prompt. >>> import esp >>> esp.osdebug(None) After you type the esp.osdebug(None) command, close the PuTTY window, but don't unplug the ESP8266 microcontroller from the computer . If you unplug the microcontroller, the board will reset, and the command will not take effect. Then you'll have to type the command again before using ampy . List the files stored on the ESP8266 microcontroller Before you upload files on the microcontroller, it is a good idea to see what files are already stored on the microcontroller. Seeing which files are on the board is also a good test to make sure ampy works appropriately. To see which files are on your ESP8266 microcontroller, open the Anaconda Prompt and make sure the (ampy) virtual environment is active. Then run the following command. Again, remember you don't have to type the > , which denotes the Anaconda Prompt . The port your ESP8266 is connected to may be COM4 , but it might be called something else. You can use the Windows Device Manager and search under [Ports (COM & LPT)]. The ESP8266 will be listed at the bottom of the list of COM ports. (ampy) > ampy --port COM4 --baud 115200 ls boot.py web_repl.py You can see the files boot.py , and web_repl.py are currently on the board. Download files stored on the ESP8266 to your computer If you can successfully read which files are on the ESP8266, a next step is to download one of these files from the microcontroller onto your computer. The ampy command get is used to complete this operation. Note that when a single file name is listed before get , you only see the contents of the file. The file will not download onto your computer. (ampy) > ampy --port COM4 --baud 115200 get boot.py # output To download the boot.py file onto your computer, you need to include the file name twice in the ampy get command. One time to indicate which file on the microcontroller you want to download and another time to name the file that's stored on your computer. (ampy) > ampy --port COM4 --baud 115200 get boot.py boot.py Now you can look at your folders and see the boot.py file you just downloaded. You can find out which folder boot.py is saved in by running the command pwd (for print working directory) at the Anaconda Prompt . (ampy) > pwd Modify boot.py to include esp.osdebug(None) Next, modify the boot.py file you just downloaded so that the ESP8266 microcontroller won't run debugging automatically when it starts up. boot.py is the file that runs first when the microcontroller is first powered up. After boot.py runs, then a file called main.py runs if it is present. We can add other .py files to the board to provide main.py some functions to work with. You can modify boot.py on your computer and then upload the revised version of boot.py to the ESP8266. The ESP8266 will then run whatever is in boot.py the next time the microcontroller restarts. Open boot.py on your computer with a text editor. I like to use Visula Studio Code , but another text editor like Sublime will work as well. I don't recommend using Notepad to edit the file. Notepad doesn't display the line endings correctly. So the code in Notepad is challenging to read and modify. Edit boot.py to include the following code. Note how the lines import esp and esp.osdebug(None) are uncommented. The lines web_repl_start are commented. # boot.py import esp esp.osdebug(None) import uos, machine #uos.dupterm(None, 1) # disable REPL on UART(0) import gc #import webrepl #webrepl.start() gc.collect() Save the boot.py file. If you are using Visual Studio Code, you can leave the file open. If you are using another text editor, you may need to close boot.py before you can upload it to the board with ampy . Upload the revised boot.py file onto the ESP8266 with ampy Now you can upload the boot.py file you just edited onto the ESP8266 microcontroller using ampy . Make sure you are in the directory with the boot.py file and that you are working in the (ampy) virtual environment. The command below will upload the file to the board. (ampy)$ ampy --port COM4 --baud 115200 put boot.py (ampy)$ ampy --port COM4 --baud 115200 ls (ampy)$ ampy --port COM4 --baud 115200 get boot.py # output The output of the ampy get command should be the code you just revised. Unplug and power up the ESP8266 microcontroller Now you can see if the changes you did work, and the esp.osdebug(None) command really worked. To restart the board, unplug and then replug the board's USB cable. Once power is restored, the board runs boot.py . Try and connect to the board with ampy again and make sure ampy still works with the board. (ampy)$ ampy --port COM4 --baud 115200 ls \\boot.py (ampy)$ ampy --port COM4 --baud 115200 get boot.py # output Write a main.py script Now you can write a main.py script that will run on the microcontroller after boot.py executes. Open a text editor and include the following code. The code blinks the built-in LED on the ESP8266 on and off 10 times. # main.py import machine import time pin = machine.Pin(0, machine.Pin.OUT) for i in range(10): pin.value(1) time.sleep(0.5) pin.value(0) time.sleep(0.5) Upload main.py onto the board After main.py is saved, you can upload main.py onto the microcontroller. You can use the same ampy put command that you used to upload boot.py onto the board. (ampy)$ ampy --port COM4 --baud 115200 put main.py (ampy)$ ampy --port COM4 --baud 115200 ls \\boot.py \\main.py (ampy)$ ampy --port COM4 --baud 115200 get main.py #output You should see the contents of your main.py file in the terminal. Start the board to see the code run Unplug and replug the USB cable connected to the board to restart it. When the board restarts, it runs boot.py then main.py . After the board is plugged back in, you should see the LED on the board blink on and off 10 times. Modify the code in main.py and re-upload You can write any valid MicroPyton code you want in main.py . After the edits are complete, you can re-upload main.py to the board. When the board restarts, any changes you made to main.py will take effect. You can also upload additional .py-files to the board with the same ampy put command. A typical pattern is to have very minimal code in main.py . You can use main.py to import functions from other .py-files stored on the board and run them. Summary In this post, I showed you how to use ampy to upload .py-files onto an ESP8266 microcontroller running MicroPython. The big gotcha we solved was that by default esp.osdebug(None) wasn't running, and therefore ampy didn't work. First, we ran the esp.osdebug(None) command at the MicroPython REPL using PuTTY. Next, we downloaded the boot.py file stored and the board and modified boot.py to include the esp.osdebug(None) command. Then we used ampy to upload the revised boot.py file onto the board. Finally, we modified a file called main.py on our computer and then uploaded this file to the board using ampy .","tags":"micropython","url":"upload-py-files-to-esp8266-running-micropython.html","loc":"upload-py-files-to-esp8266-running-micropython.html"},{"title":"Taylor Series in Python","text":"In this post, we will review how to create a Taylor Series with Python and for loops. Then we will refactor the Taylor Series into functions and compare the output of our Taylor Series functions to functions from Python's Standard Library. A Taylor Series is an infinite series of mathematical terms that when summed together approximate a mathematical function. A Taylor Series can be used to approximate $e&#94;x$, and $cosine$. An example of a Taylor Series that approximates $e&#94;x$ is below. $$ {e&#94;x} \\approx \\sum\\limits_{n = 0}&#94;\\infty {\\frac{{{x&#94;n}}}{{n!}}} \\approx 1 + x + \\frac{{{x&#94;2}}}{{2!}} + \\frac{{{x&#94;3}}}{{3!}} + \\frac{{{x&#94;4}}}{{4!}} \\ + \\ ... $$ We can see that each term in the Taylor Series expansion is dependent on that term's place in the series. Below is a chart that shows each term of the Taylor Series in a row. The columns of the table represent the term index, the mathematical term and, how to code that term in Python. Note that the factorial() function is part of the math module in Python's Standard Library. Term Index Mathematical Term Term coded in Python 0 $x&#94;0/0!$ x**0/math.factorial(0) 1 $x&#94;1/1!$ x**1/math.factorial(1) 2 $x&#94;2/2!$ x**2/math.factorial(2) 3 $x&#94;3/3!$ x**3/math.factorial(3) 4 $x&#94;4/4!$ x**4/math.factorial(4) Code the Taylor Series by writing out each term individually We can combine these terms in a line of Python code to estimate $e&#94;2$. The code below calculates the sum of the first five terms of the Taylor Series expansion of $e&#94;x$, where $x=2$. Note the math module needs to be imported before math.factorial() can be used. In [1]: import math x = 2 e_to_2 = x ** 0 / math . factorial ( 0 ) + x ** 1 / math . factorial ( 1 ) + x ** 2 / math . factorial ( 2 ) + x ** 3 / math . factorial ( 3 ) + x ** 4 / math . factorial ( 4 ) print ( e_to_2 ) 7.0 Our Taylor Series approximation of $e&#94;2$ was calculated as 7.0 . Let's compare our Taylor Series approximation to Python's math.exp() function. Python's math.exp() function raises $e$ to any power. In our case, we want to use math.exp(2) because we want to calculate $e&#94;2$. In [2]: print ( math . exp ( 2 )) 7.38905609893065 Our Taylor Series approximation 7.0 is not that far off the calculated value 7.389056... using Python's exp() function. Use a for loop to calculate a Taylor Series If we want to get closer to the value of $e&#94;x$, we need to add more terms to our Taylor Series. The problem is coding each individual term is time-consuming and repetitive. Instead of coding each term individually, we can use a for loop . A for loop is a repetition structure in Python that runs a section of code a specified number of times. The syntax for coding a for loop in Python using the range() function is below: for <var> in range(<num>): <code> Where <var> is any valid Python variable name and <num> is an integer to determines how many times the <code> in the loop runs. We can recreate our approximation of $e&#94;2$ with 5 terms using a for loop . Note we need to set the variable e_to_2 to 0 before the loop starts. The mathematical operator += in the line e_to_2 += x**i/math.factorial(i) is equivalent to e_to_2 = e_to_2 + x**i/math.factorial(i) . In [3]: import math x = 2 e_to_2 = 0 for i in range ( 5 ): e_to_2 += x ** i / math . factorial ( i ) print ( e_to_2 ) 7.0 The result 7.0 is the same as the result we calculated when we wrote out each term of the Taylor Series individually. An advantage of using a for loop is that we can easily increase the number of terms. If we increase the number of times the for loop runs, we increase the number of terms in the Taylor Series expansion. Let's try 10 terms. Note how the line for i in range(10): now includes 10 passed to the range() function. In [4]: import math x = 2 e_to_2 = 0 for i in range ( 10 ): e_to_2 += x ** i / math . factorial ( i ) print ( e_to_2 ) 7.3887125220458545 The result is 7.38871... . Let's see how close that is to $e&#94;2$ calculated with Python's exp() function. In [5]: print ( math . exp ( 2 )) 7.38905609893065 The result is 7.38905... . We get closer to the value of $e&#94;2$ when 10 terms are used in the Taylor Series compared to when 5 terms were used in the Taylor Series. Refactor the for loop into a function Next, let's refactor the code above that contained a for loop (which calculated $e&#94;2$) into a function that can compute $e$ raised to any power estimated with any number of terms in the Taylor Series. The general syntax to define a function in Python is below. def <func name>(<arg 1>, <arg 2>, ...): <code> return <output> Where def is the Python keyword that defines a function, <func name> is a valid Python variable name, and <arg 1>, <arg 2> are the input arguments passed to the function. <code> that runs when the function is called must be indented (the standard indentation is 4 spaces). The keyword return denotes the <output> of the function. Let's code our for loop that approximates $e&#94;2$ into a function. In [6]: import math def func_e_to_2 ( n ): x = 2 e_to_2 = 0 for i in range ( n ): e_to_2 += x ** i / math . factorial ( i ) return e_to_2 If we call our function func_e_to_2() with the input argument 10 , the result is the same as when we ran the for loop 10 times. In [7]: out = func_e_to_2 ( 10 ) print ( out ) 7.3887125220458545 The output of our func_e_to_2() function is 7.38871... . We can make our function more general by setting x (the number that $e$ gets raised to) as an input argument. Note how now there are two input arguments in the function definition (x, n) . x is the number $e$ is raised to, and n is the number of terms in the Taylor Series (which is the number of times the for loop runs on the inside of the function definition). In [8]: import math def func_e ( x , n ): e_approx = 0 for i in range ( n ): e_approx += x ** i / math . factorial ( i ) return e_approx Let's calculate $e&#94;2$ using 10 terms with our new func_e() function. In [9]: out = func_e ( 2 , 10 ) print ( out ) 7.3887125220458545 The result is 7.38871... , the same result as before. An advantage to writing our Taylor Series expansion in a function is that now the Taylor Series approximation calculation is reusable and can be called in one line of code. For instance, we can estimate the value of $e&#94;5$ with 10 terms, by calling our func_e() function with the input arguments (5,10) . In [10]: out = func_e ( 5 , 10 ) print ( out ) 143.68945656966488 The result is 143.68945... . Let's see how close this value is to Python's exp() function when we make the same calculation $e&#94;5$. In [11]: out = math . exp ( 5 ) print ( out ) 148.4131591025766 The result is 148.41315... . The Taylor Series approximation calculated by our func_e() function is pretty close to the value calculated by Python's exp() function. Use a for loop to calculate the difference between the Taylor Series expansion and Python's exp() function Now let's use a for loop to calculate the difference between the Taylor Series expansion as calculated by our func_e() function compared to Python's exp() function. We'll calculate the difference between the two functions when we use between 1 and 10 terms in the Taylor Series expansion. The code below uses f-strings , which is a Python syntax for inserting the value of a variable in a string. The general syntax for an f-string in Python is below. f'string statment {<var>}' Where f denotes the beginning of an f-string , the f-string is surrounded by quotes ' ' , and the variable <var> is enclosed in curly braces { } . The value of <var> will be printed out without the curly braces. In [12]: import math x = 5 for i in range ( 1 , 11 ): e_approx = func_e ( x , i ) e_exp = math . exp ( x ) e_error = abs ( e_approx - e_exp ) print ( f ' {i} terms: Taylor Series approx= {e_approx} , exp calc= {e_exp} , error = {e_error} ' ) 1 terms: Taylor Series approx= 1.0, exp calc= 148.4131591025766, error = 147.4131591025766 2 terms: Taylor Series approx= 6.0, exp calc= 148.4131591025766, error = 142.4131591025766 3 terms: Taylor Series approx= 18.5, exp calc= 148.4131591025766, error = 129.9131591025766 4 terms: Taylor Series approx= 39.33333333333333, exp calc= 148.4131591025766, error = 109.07982576924327 5 terms: Taylor Series approx= 65.375, exp calc= 148.4131591025766, error = 83.0381591025766 6 terms: Taylor Series approx= 91.41666666666667, exp calc= 148.4131591025766, error = 56.99649243590993 7 terms: Taylor Series approx= 113.11805555555556, exp calc= 148.4131591025766, error = 35.29510354702104 8 terms: Taylor Series approx= 128.61904761904762, exp calc= 148.4131591025766, error = 19.79411148352898 9 terms: Taylor Series approx= 138.30716765873015, exp calc= 148.4131591025766, error = 10.105991443846449 10 terms: Taylor Series approx= 143.68945656966488, exp calc= 148.4131591025766, error = 4.723702532911716 Note how the error decreases as we add terms to the Taylor Series. When the Taylor Series only has 1 term, the error is 147.41... . When 10 terms are used in the Taylor Series, the error goes down to 4.7237... . Use a break statement to exit a for loop early. How many terms would it take to produce an error of less than 1 ? We can use a break statement to drop out of the for loop when the error is less than 1 . The code below calculates how many terms are needed in the Taylor Series, when $e&#94;5$ is calculated, to keep the error less than 1 . In [13]: import math x = 5 for i in range ( 1 , 20 ): e_approx = func_e ( x , i ) e_exp = math . exp ( x ) e_error = abs ( e_approx - e_exp ) if e_error < 1 : break print ( f ' {i} terms: Taylor Series approx= {e_approx} , exp calc= {e_exp} , error = {e_error} ' ) 12 terms: Taylor Series approx= 147.60384850489015, exp calc= 148.4131591025766, error = 0.8093105976864479 The output shows that it takes 12 terms in the Taylor Series to drop the error below 1 . Create a function to estimate the value of $cos(x)$ using a Taylor Series Next, let's calculate the value of the cosine function using a Taylor Series. The Taylor Series expansion for $\\cos(x)$ is below. $$ \\cos \\left( x \\right) \\approx \\sum\\limits_{n = 0}&#94;\\infty {{{\\left( { - 1} \\right)}&#94;n}\\frac{{{x&#94;{2n}}}}{{\\left( {2n} \\right)!}}} \\approx 1 - \\frac{{{x&#94;2}}}{{2!}} + \\frac{{{x&#94;4}}}{{4!}} - \\frac{{{x&#94;6}}}{{6!}} + \\frac{{{x&#94;8}}}{{8!}} - \\frac{{{x&#94;{10}}}}{{10!}} \\ + \\ ... $$ We can code this formula into a function that contains a for loop . Note the variable x is the value we are trying to find the cosine of, the variable n is the number of terms in the Taylor Series, and the variable i is the loop index which is also the Taylor Series term number. We are using a separate variable for the coefficient coef which is equal to $(-1)&#94;i$, the numerator num which is equal to $x&#94;{2i}$ and the denominator denom which is equal to $(2i!)$. Breaking the Taylor Series formula into three parts can cut down on coding errors. In [14]: import math def func_cos ( x , n ): cos_approx = 0 for i in range ( n ): coef = ( - 1 ) ** i num = x ** ( 2 * i ) denom = math . factorial ( 2 * i ) cos_approx += ( coef ) * ( ( num ) / ( denom ) ) return cos_approx Let's use our func_cos() function to estimate the cosine of 45 degrees. Note that func_cos() function computes the cosine of an angle in radians. If we want to calculate the cosine of 45 degrees using our function, we first have to convert 45 degrees into radians. Luckily, Python's math module has a function called radians() that makes the angle conversion early. In [15]: angle_rad = ( math . radians ( 45 )) out = func_cos ( angle_rad , 5 ) print ( out ) 0.7071068056832942 Using our func_cos() function and 5 terms in the Taylor Series approximation, we estimate the cosine of 45 degrees is 0.707106805... . Let's check our func_cos() function compared to Python's cos() function from the math module. In [16]: out = math . cos ( angle_rad ) print ( out ) 0.7071067811865476 Using Python's cos() function, the cosine of 45 degrees returns 0.707106781... This value is very close to the approximation calculated using our func_cos() function. Build a plot to compare the Taylor Series approximation to Python's cos() function In the last part of this post, we are going to build a plot that shows how the Taylor Series approximation calculated by our func_cos() function compares to Python's cos() function. The idea is to make a plot that has one line for Python's cos() function and lines for the Taylor Series approximation based on different numbers of terms. For instance, if we use 3 terms in the Taylor Series approximation, our plot has two lines. One line for Python's cos() function and one line for our func_cos() function with three terms in the Taylor series approximation. We'll calculate the cosine using both functions for angles between $-2\\pi$ radians and $2\\pi$ radians. In [17]: import math import numpy as np import matplotlib.pyplot as plt # if using a Jupyter notebook, include: % matplotlib inline angles = np . arange ( - 2 * np . pi , 2 * np . pi , 0.1 ) p_cos = np . cos ( angles ) t_cos = [ func_cos ( angle , 3 ) for angle in angles ] fig , ax = plt . subplots () ax . plot ( angles , p_cos ) ax . plot ( angles , t_cos ) ax . set_ylim ([ - 5 , 5 ]) ax . legend ([ 'cos() function' , 'Taylor Series - 3 terms' ]) plt . show () We can use a for loop to see how much better adding additional terms to our Taylor Series approximation compares to Python's cos() function. In [18]: import math import numpy as np import matplotlib.pyplot as plt # if using a Jupyter notebook, include: % matplotlib inline angles = np . arange ( - 2 * np . pi , 2 * np . pi , 0.1 ) p_cos = np . cos ( angles ) fig , ax = plt . subplots () ax . plot ( angles , p_cos ) # add lines for between 1 and 6 terms in the Taylor Series for i in range ( 1 , 6 ): t_cos = [ func_cos ( angle , i ) for angle in angles ] ax . plot ( angles , t_cos ) ax . set_ylim ([ - 7 , 4 ]) # set up legend legend_lst = [ 'cos() function' ] for i in range ( 1 , 6 ): legend_lst . append ( f 'Taylor Series - {i} terms' ) ax . legend ( legend_lst , loc = 3 ) plt . show () We see the Taylor Series with 5 terms (the brown line) comes closest to approximating Python's cos() function. The Taylor Series with 5 terms is a good approximation of the cosine of angles between about $-\\pi$ and $\\pi$ radians. The Taylor Series with 5 terms is a worse approximation for angles less than $-\\pi$ or greater than $\\pi$. As the angle gets further away from zero radians, the estimate of the cosine using a Taylor Series gets worse and worse. Summary In this post, we reviewed how to construct the Taylor Series of $e&#94;x$ and $\\cos(x)$ in Python. First, we coded each term of the Taylor series individually. Next, we used a for loop to calculate $n$ terms in the Taylor Series expansion. We then refactored the code with the for loop into a function and parameterized our function so that we could calculate $e$ raised to any number calculated out to any number of terms. At the end of the post, we coded the Taylor Series of $\\cos(x)$ into a Python function. Finally, we used our Taylor Series cosine function to build a plot with Matplotlib that shows how the Taylor Series approximation compares to Python's cos() function for angles between $-2\\pi$ and $2\\pi$ radians.","tags":"functions","url":"creating-taylor-series-functions-with-python.html","loc":"creating-taylor-series-functions-with-python.html"},{"title":"Hear my story about moving from MATLAB to Python on TalkPython","text":"I was on the TalkPython podcast with Michael Kennedy! We talked about teaching Python at a Community College and how I moved a college engineering class from MATLAB to Python. In the course I'm teaching this quarter, my students use Jupyter notebooks running on a JupyterHub server. I talked with Michael about how the JupyterHub server was set up and the advantages JupyterHub has over MATLAB. You can click on This Link to hear the episode or click on the player below: If you want to see how I deployed JupyterHub for my students, check out the docs here: https://professorkazarinoff.github.io/jupyterhub-engr101/ Before we started recording, I was excited and nervous. TalkPython is a show I listen to every time a new episode is released. Michael, the host of TalkPython, is an excellent, skilled and experienced interviewer. He made the recording process clear for me as a guest. A couple of notes on being a podcast guest: Michael send out a Google doc with some talking points before we recorded. It was helpful to have an outline of talking points in front of me when we started recording. I gave myself an hour to get ready and set up my recording stuff. Even with an hour to set up, I still called in over Skype about 5 minutes late. I used a USB microphone and a set of headphones. Michael started the Skype call with some get-to-know-you chat. It was lovely to talk to him \"offline\" before we began recording. Our ~10-minute casual conversation calmed my nerves and helped me understand how the recording was going to work. Michael edits the audio before he posts the final podcast. Knowing that the sound could be modified was a big help. It made me worry less that I would flub a sentence. Because TalkPython episodes are edited and Michael has lots of guests lined up, the episode with me was posted a couple weeks after we recorded. When the episode came out, I tweeted the episode link out (I also wrote this blog post). Being a guest on TalkPython was super fun! I feel honored to be on such a high-quality show with such a large following. Thank-you TalkPython and Michael for helping me share my story with the Python community!","tags":"podcasts","url":"moving-from-matlab-to-python-on-talkpython.html","loc":"moving-from-matlab-to-python-on-talkpython.html"},{"title":"Plotting a Gaussian normal curve with Python and Matplotlib","text":"In the previous post , we calculated the area under the standard normal curve using Python and the erf() function from the math module in Python's Standard Library. In this post, we will construct a plot that illustrates the standard normal curve and the area we calculated. To build the Gaussian normal curve, we are going to use Python, Matplotlib, and a module called SciPy. Calculating the probability under a normal curve is useful for engineers. This type of calculation can be helpful to predict the likely hood of a part coming off an assembly line being within a given specification when the statistical properties of all the parts that have come of the assembly line previously are known. In this post, we will calculate the probability under the normal curve to answer a question like the one below: GIVEN: At a facility that manufactures electrical resistors, a statistical sample of 1-kΩ resistors is pulled from the production line. The resistor's resistances are measured and recorded. A mean resistance of 979.8 kΩ and a standard deviation of 73.10 kΩ represents the sample of resistors. The desired resistance tolerance for the 1-kΩ resistors is ± 10%. This tolerance range means the acceptable range of resistance is 900 Ω to 1100 Ω. FIND: Assuming a normal distribution, determine the probability that a resistor coming off the production line will be within spec (in the range of 900 Ω to 1100 Ω). Show the probability that a resistor picked off the production line is within spec on a plot. SOLUTION: To build the plot, we will use Python and a plotting package called Matplotlib. We will also use the norm() function from SciPy's stats library. Both Matplotlib and SciPy come included when you install Anaconda . If you do not have Anaconda installed, Matplotlib and SciPy can be installed from the command line with pip . $ pip install matplotlib $ pip install scipy Before we build the plot, let's take a look at a gaussin curve. The shape of a gaussin curve is sometimes referred to as a \"bell curve.\" This is the type of curve we are going to plot with Matplotlib. Create a new Python script called normal_curve.py . At the top of the script, import NumPy, Matplotlib, and SciPy's norm() function. If using a Jupyter notebook, include the line %matplotlib inline . If you are not using a Jupyter notebook, leave %matplotlib inline out as %matplotlib inline is not a valid line of Python code. # normal_curve.py import numpy as np import matplotlib.pyplot as plt from scipy.stats import norm # if using a Jupyter notebook, inlcude: % matplotlib inline Next, we need to define the constants given in the problem. The mean is 979.8 and the standard deviation is 73.10 . The lower bound is 900 and the upper bound is 1100 . # define constants mu = 998.8 sigma = 73.10 x1 = 900 x2 = 1100 Next, we calculate the Z-transform of the lower and upper bound using the mean and standard deviation defined above. # calculate the z-transform z1 = ( x1 - mu ) / sigma z2 = ( x2 - mu ) / sigma After the Z-transform of the lower and upper bounds are calculated, we calculate the probability with SciPy's scipy.stats.norm.pdf() function. x = np . arange ( z1 , z2 , 0.001 ) # range of x in spec x_all = np . arange ( - 10 , 10 , 0.001 ) # entire range of x, both in and out of spec # mean = 0, stddev = 1, since Z-transform was calculated y = norm . pdf ( x , 0 , 1 ) y2 = norm . pdf ( x_all , 0 , 1 ) Finally, we build the plot. Note how Matplotlib's ax.fill_between() method is used to highlight the area of interest. We'll use Matplotlib's 'fivethirtyeight' style and save the figure as 'normal_curve.png' . # build the plot fig , ax = plt . subplots ( figsize = ( 9 , 6 )) plt . style . use ( 'fivethirtyeight' ) ax . plot ( x_all , y2 ) ax . fill_between ( x , y , 0 , alpha = 0.3 , color = 'b' ) ax . fill_between ( x_all , y2 , 0 , alpha = 0.1 ) ax . set_xlim ([ - 4 , 4 ]) ax . set_xlabel ( '# of Standard Deviations Outside the Mean' ) ax . set_yticklabels ([]) ax . set_title ( 'Normal Gaussian Curve' ) plt . savefig ( 'normal_curve.png' , dpi = 72 , bbox_inches = 'tight' ) plt . show () The finished plot is below. Notice how the area corresponding to resistors in the given specification (between the upper and lower bounds) is shaded.","tags":"matplotlib","url":"plotting-normal-curve-with-python.html","loc":"plotting-normal-curve-with-python.html"},{"title":"Calculate the Probability Under a Normal Curve","text":"Calculating the probability under a normal curve is useful for engineers. This type of calculation can be helpful to predict the likely hood of a part coming off an assembly line being within a given specification. The probability can be calculated when the statistical properties of all the parts that have come of the assembly line are known. In this post, we will calculate the probability under the normal curve to answer a question like the one below: GIVEN: At a facility that manufactures electrical resistors, a statistical sample of 1-kΩ resistors is pulled from the production line. The resistor's resistances are measured and recorded. A mean resistance of 979.8 kΩ and a standard deviation of 73.10 kΩ represents the sample of resistors. The desired resistance tolerance for the 1-kΩ resistors is ± 10%. This tolerance range means the acceptable range of resistance is 900 Ω to 1100 Ω. FIND: Assuming a normal distribution, determine the probability that a resistor coming off the production line will be within spec (in the range of 900 Ω to 1100 Ω). SOLUTION: The Python script we are going to build to solve the resistor problem above needs to accomplish a couple of things: Import the necessary functions. We need to use the erf() and sqrt() functions in Python's math module. Define the constants for this problem. The mean, standard deviation, lower bound and upper bound will be defined. Calculate the probability using the erf() function from Python's math() module. Print the results to the Python interpreter Let's take a look at a Gaussian curve. The shape of the curve describes the spread of resistors coming off the production line. We need to find the area under the curve within our upper and lower bounds to solve the problem. Open up a new Python script called stats.py . In the first line of code, we import the erf and sqrt() functions from the math module. Because the math module is part of the Python Standard Library, math does not need to be installed using conda or pip . # stats.py from math import erf , sqrt Now we need to define the constants. The mean is 978.8 kΩ, and the standard deviation is 73.1 kΩ. The acceptable range of resistance is between 900 kΩ and 1100 kΩ. These two values, 900 kΩ, and 1100 kΩ define our upper and lower bounds. # define constants mu = 979.8 # mean = 978.8 kΩ sigma = 73.1 # standard deviation = 73.1 kΩ x1 = 900 # lower bound = 900 kΩ x2 = 1100 # upper bound = 1100 kΩ Next, we calculate the Z-transform of the upper and lower bounds using the mean and standard deviation. Then we use the erf() function to calculate the probability from Z = 0 to the Z-transform derived from the upper and lower bounds. # calculate probability # probability from Z=0 to lower bound double_prob = erf ( ( x1 - mu ) / ( sigma * sqrt ( 2 )) ) p_lower = double_prob / 2 print ( f ' \\n Lower Bound: {round(p_lower,4)}' ) # probability from Z=0 to upper bound double_prob = erf ( ( x2 - mu ) / ( sigma * sqrt ( 2 )) ) p_upper = double_prob / 2 print ( f ' \\n Upper Bound: {round(p_upper,4)}' ) From the Z-transform of the upper and lower limits, we calculated two probabilities: p_lower and p_upper . We can use these probabilities to calculate the likelihood a resistor randomly pulled off the line is within tolerance (inside the range of 900 kΩ to 1100 kΩ) or out of tolerance (outside the range of 900 kΩ to 1100 kΩ). # print the results Pin = ( p_upper ) - ( p_lower ) print ( ' \\n ' ) print ( f 'mean = {mu} std dev = {sigma} \\n ' ) print ( f 'Calculating the probability of occurring between {x1} <--> {x2} \\n ' ) print ( f 'inside interval Pin = {round(Pin*100,1)}%' ) print ( f 'outside interval Pout = {round((1-Pin)*100,1)}% \\n ' ) print ( ' \\n ' ) When the entire script is run, the output of our stats.py script is: Lower Bound: -0.3625 Upper Bound: 0.4499 mean = 979.8 std dev = 73.1 Calculating the probability of occurring between 900 <--> 1100 inside interval Pin = 81.2% outside interval Pout = 18.8% So back to the original question: Determine the probability that a resistor coming off the production line will be within spec. The answer is: The probability a resistor coming off the production line is within spec is the probability of the inside interval, 81.2% In the next post, we will use Python and Matplotlib to build a curve that describes the problem.","tags":"statistics","url":"probability-under-normal-curve-with-python.html","loc":"probability-under-normal-curve-with-python.html"},{"title":"My book Problem Solving with Python is available on Amazon","text":"My first book: Problem Solving with Python 3.6 Edition is available on Amazon. So excited about publishing my first book! Pick it up here: Link to Amazon The book has been over a year in the making. Many long nights writing and revising. Without the support of my awesome wife, there is no way I would have been able to finish it. Thank-you sweetie - I love you! See below to read about how the book Problem Solving with Python 3.6 Edition was created. Jupyter Notebooks My book, Problem Solving with Python was constructed using Jupyter Notebooks. The text was written in markdown cells and the code was written in code cells. Sometimes I used the Classic Notebook interface as my editor and other times I used the Jupyter Lab interface. The GitHub repo for the book can be found at: https://github.com/ProfessorKazarinoff/Problem-Solving-with-Python The GitHub repo contains all the Jupyter notebooks used the write the book. The repo also contains a set of custom conversion scripts and templates which convert the Jupyuter notebooks into .html and .tex files. The directory structure of the GitHub repo for the book is below: Problem-Solving-with-Python/ |-- conversion_tools/ |-- notebooks/ |-- LICENSE |-- notebooks/ |-- pdf/ |-- README.md |-- website/ The notebooks directory contains a subdirectory for each chapter of the book: notebooks/ |-- 00-Preface/ |-- 01-Orientation/ |-- 02-The-Python-REPL/ |-- 03-Data-Types-and-Variables/ |-- 04-Jupyter-Notebooks/ |-- 05-Functions-and-Modules/ |-- 06-Plotting-with-Matplotlib/ |-- 07-If-Else-Try-Except/ |-- 08-Loops/ |-- 09-Matrices-and-Arrays/ |-- 10-Symbolic-Math/ |-- 11-Python-and-External-Hardware/ |-- 12-MicroPython/ |-- 99-Appendix/ |-- figures/ `-- TOC.ipynb There is a Jupyter notebook for each section of the book within each chapter directory. Each chapter directory contains an images directory for any images used in the markdown cells of the notebooks. 01-Orientation/ |-- 01.00-Welcome.ipynb |-- 01.01-Why-Python.ipynb |-- 01.02-The-Anaconda-Distribution-of-Python.ipynb |-- 01.03-Installing-Anaconda-on-Windows.ipynb |-- 01.04-Installing-Anaconda-on-MacOS.ipynb |-- 01.05-Installing-Anaconda-on-Linux.ipynb |-- 01.06-Installing-Python-from-Python-dot-org.ipynb |-- 01.07-Summary.ipynb |-- 01.08-Review-Questions.ipynb `-- images/ Website The website for this book was constructed using mkdocs and the Material for MkDocs theme. Jupyter noteboks were exported to .html files with markdown cells unformatted using a custom script and nbconvert . Hardcopy The hard copy of the book was constructed using LaTeX, nbconvert and a set of custom scripts and templates. One conversion script combined all of the notebooks into one BIG notebook. The BIG notebook was then converted into LaTeX using nbconvert and a custom template. Outside of the Python ecosystem, a separate installation of TeXworks compiled the LaTeX .tex file to a .pdf document.","tags":"books","url":"problem-solving-with-python-book-on-amazon.html","loc":"problem-solving-with-python-book-on-amazon.html"},{"title":"Using Python to control an Arduino","text":"Python is used in many applications including data science, machine learning, and web development. Another area where we can use Python is external hardware control. What do I mean by external hardware? A piece of external hardware could be a light or a sensor. External hardware includes multimeters or spectral analyzers. I consider anything connected to a computer that isn't typically connected to a computer as external hardware. So not a keyboard, mouse, headphones, webcams, USB drives, but things like motors, light arrays, solenoids, linear actuators, pressure sensors, etc. In this post, we'll review over how to use Python to control an LED that is connected to an Arduino. Python running on a computer will turn the Arduino LED on and off. Table of contents: Collect the hardware Install PySerial Download the Arduino IDE Wire an LED and a resistor to the Arduino Connect the Arduino to the computer and check the COM port Upload the Arduino example sketch Blink.ino onto the Arduino. Confirm the Arduino and LED blinks Upload the Arduino example sketch PhysicalPixel.ino onto the Arduino Use the Arduino Serial Monitor to turn the Arduino LED on and off Use the Python REPL to turn the Arduino LED on and off. Write a Python Script to turn the LED on and off Write a Python script to prompt a user to turn the LED on and off Summary Collect the hardware In this project, we are going to use a couple pieces of hardware. Below is the list of harware we need to complete the project: Component Item and Link Arduino SparkFun RedBoard - Programmed with Arduino Jumper Wires Jumper Wires Premium 6\" M/M Pack of 10 LED LED Rainbow Pack - 5mm PTH 330 Ohm Resistor Resistor 330 Ohm ⅙ Watt PTH - 20 pack Breadboard Breadboard - Self-Adhesive (White) USB cable SparkFun USB Mini-B Cable - 6 Foot Install PySerial To start a new Python project, it is best practice to create a new virtual environment. I have the Anaconda distribution of Python installed on my Windows 10 machine. When you install Anaconda , it comes with the very useful Anaconda Prompt . Using the Anaconda Prompt is a bit like using the terminal on a MacOS or Linux. To start the Anaconda Prompt on Windows 10, go to the Windows Start Button on the lower left and select Anaconda Prompt . Now using the Anaconda Prompt , let's create a new virtual environment for our Arduino LED project. Note the arrow symbol > does not need to be typed. The arrow symbol > is just shown to indicate the Anaconda Prompt . > conda create --name arduino python=3.7 The conda create command builds the new virtual environment. The --name arduino flag gives our new virtual environment the name arduino . I like to name my virtual environments the same name as the project that uses the virtual environment. Including python=3.7 ensures the new virtual environment has an up to date version of Python. Type y to confirm and create the new virtual environment. To use the new virtual environment arduino , you need to first activate it by typing: > conda activate arduino You know you are in the arduino virtual environment when (arduino) is in parenthesis at the start of the Anaconda Prompt : (arduino) > To communicate with the Arduino using Python, we need to install the PySerial package. You can install the PySerial package at the Anaconda Prompt using the command conda install pyserial . Note the (arduino) virtual environment should be active when you run the conda install command. (arduino) > conda install pyserial To confirm PySerial is installed, open the Python REPL while the (arduio) virtual environment is active. At the >>> REPL prompt, import PySerial with the command import serial . Note that although we installed PySerial with the command conda install pyserial , we import PySerial using the line import serial . The command exit() exits out of the Python REPL and brings us back to the Anaconda Prompt . ( arduino ) > python >>> import serial >>> serial . __version__ '3.4' >>> exit () ( arduino ) > Download the Arduino IDE The next step is to download the Arduino IDE . IDE stands for Integrated Development Environment. The Arduino IDE is a program that runs on your computer used to edit Arduino code. The Arduino IDE is also used to compile and upload code to an Arduino. We'll use the Arduino IDE to upload two different sketches to our Arduino. A sketch is the name given to Arduino programs. Arduino sketches end in the .ino file extension. Download the Arduino IDE using the following link: https://www.arduino.cc/en/Main/Software Scroll down the page to the Download the Arduino IDE section. Be sure to select: Windows ZIP file for non-admin install if you don't have the administrator privileges to install software on the computer you're using. You can choose JUST DOWNLOAD from the donation screen. Extract the downloaded .zip folder to your thumb drive or the desktop. Wire an LED and a resistor to the Arduino Take out an LED (any color), a 330 Ohm resistor, three jumper wires (red, yellow and black), the Arduino, and a white breadboard. Connect the LED, resistor, and colored jumper wires as shown below. Note the LED has two different sized \"legs.\" Ensure the LED is wired in the correct orientation. Current can only flow in one direction through an LED. short LED leg → resistor → ground long LED leg → Pin 13 on Arduino. Also see the SparkFun Inventor's kit online guide: https://learn.sparkfun.com/tutorials/sparkfun-inventors-kit-experiment-guide---v40/circuit-1a-blink-an-led Connect the Arduino to the computer and check the COM port Connect the Arduino to the computer using a USB cable. On SparkFun Redboards (a type of Arduino), the cable needs to be a USB 2.0 type A to Mini-B 5-pin cable. One end of the cable looks like a regular USB cable. Connect that end to the computer. The other end of the cable has a small connector that sort of looks like a phone charging cable, but a little different. Connect this smaller end of the cable to the Arduino. Now we need to determine which COM Port the Arduino is connected to. We will need to know which COM Port the Arduino is connected to when we upload code to the Arduino or attempt to communicate with the Arduino. You can use the Windows Device Manager to determine which serial port the Arduino is connected to. On my Windows 10 laptop, the port the Arduino is connected to usually comes up as COM4 . You can find the serial port by looking in the Ports (COM & LPT) category of the Windows Device Manager. Look for something like USB Serial Port (COM4) in the Ports (COM & LPT) menu. It is the COM# that you are looking for. In the picture below, I can see the COM# is COM15 see Ports (COM & LPT) menu → USB Serial Port (COM15) . Your COM# is likely to be different. Upload the Arduino example sketch Blink.ino onto the Arduino. Confirm the Arduino and LED blinks Open the extracted Arduino IDE folder and double-click the Arduino.exe program. Open the Arduino Blink.ino sketch by going to: File → Examples → 01.Basics → Blink Now ensure that the Port and the Board type are set correctly in the Arduino IDE. In the Arduino IDE Tools menu, select the following: Tools → Port → COM4 (or whichever port the Arduino is connected to, found with the Windows Device Manager) Tools → Board → Arduino / Genuino Uno In the Arduino IDE Window that contains the Blink.ino sketch, click the check mark to Verify then click the arrow to Upload. Once the upload is complete, the Arduino and LED should blink on and off. If you don't see the Arduino and LED blinking, you need to do some troubleshooting. Check the COM Port or try unplugging and re-plugging in the Arduino. Also check the wiring. Ensure the two LED \"legs\" are wired correctly. Upload the Arduino example sketch PhysicalPixel.ino onto the Arduino Open the Arduino sketch PhysicalPixel.ino by going to File → Examples → 04.Communication → PhysicalPixel Once again, click the check mark to Verify then click the arrow to Upload. Use the Arduino Serial Monitor to turn the Arduino LED on and off In the Arduino IDE Window that contains the PhysicalPixel.ino sketch, open the Arduino Serial Monitor by going to Tools → Serial Monitor In the Arduino Serial Monitor type: H and click Send (or press ENTER). Then type: L and click Send (or press ENTER). The letters H and L need to be uppercase. When you click Send or press ENTER, you should see the Arduino LED turn on and off. If have trouble, make sure the Port is set correctly in Tools → Port and make sure the Serial Monitor is set to 9600 baud. You can also try unplugging and replugging in the Arduino and closing then reopening the Arduino IDE. Use the Python REPL to turn the Arduino LED on and off. Open the Anaconda Prompt and activate the (arduino) virtual environment (if it is not currently active). Then start the Python REPL by typing python at the prompt. Type the following commands to turn the Arduino LED on and off. Note the arrow symbols > and >>> should not be typed. The arrow symbols > and >>> are just shown to indicate the prompt. > conda activate arduino ( arduino ) > python Python 3.7 . 1 ( default , Dec 10 2018 , 22 : 54 : 23 ) [ MSC v . 1915 64 bit ( AMD64 )] :: Anaconda , Inc . on win32 Type \"help\" , \"copyright\" , \"credits\" or \"license\" for more information . >>> import serial >>> ser = serial . Serial ( 'COM4' , 9800 , timeout = 1 ) >>> ser . write ( b 'H' ) >>> ser . write ( b 'L' ) >>> ser . write ( b 'H' ) >>> ser . write ( b 'L' ) >>> ser . close () >>> exit () ( arduino ) > You should see the Arduino LED turn on and off when you type the commands ser.write(b'H') and ser.write(b'L') . These commands send the characters H and L over the serial line to the Arduino. The Arduino reads these characters and turns the LED on and off. Make sure you run the ser.close() command at the end. If the serial line is not closed, you may have trouble opening the serial line again and running these same commands a second time. If you have trouble, make sure the Arduino Serial Monitor is closed before you run the commands at the Ananconda Prompt. If the Arduino Serial Monitor is open, you can't communicate with the Arduino with the Anaconda Prompt. Write a Python Script to turn the LED on and off Now that the Arduino LED turns on and off based on sending H and L with the Python REPL, let's write a Python script to turn the LED on and off. Again, the serial communication between the Python script and the Arduino is facilitated by the PySerial package. Ensure PySerial is installed before running the Python script. Open a new script called arduino_blink.py . At the top of the Python script, import the PySerial package. Note that even though the package is called PySerial, the line import serial is used. Python's built-in time module is also imported as the time.sleep() function will be used in the script. Include the following code in arduino_blink.py : # arduino_blink.py import serial import time In the next part of arduino_blink.py , create a loop that blinks the LED on and off for about 5 seconds. Note the byte string b'H' is sent to the Arduino, not the unicode string 'H' . The unicode string 'H' is pre-pended with the letter b in the line ser.write(b'H') . Make sure the 'COM#' is set correctly. This 'COM#' is the COM port we found using the Windows Device Manager. It may be 'COM4' , but you may have to change it to something else. # arduino_blink.py for i in range ( 10 ): with serial . Serial ( 'COM4' , 9800 , timeout = 1 ) as ser : time . sleep ( 0.5 ) ser . write ( b 'H' ) # send the pyte string 'H' time . sleep ( 0.5 ) # wait 0.5 seconds ser . write ( b 'L' ) # send the byte string 'L' Run the arduino_blink.py script. You should see the Arduino LED blink on and off 10 times. Write a Python script to prompt a user to turn the LED on and off Once the LED blinks on and off successfully using a for loop in a Python script, let's write a new Python script called arduino_LED_user.py that allows a user to turn the LED on and off. Create a new file called arduino_LED_user.py . At the top of the arduino_LED_user.py script, import the PySerial package and built-in time module. Then define the serial port. Make sure to include the correct 'COM#' . Use the 'COM#' you found in the Windows Device Manager. If the 'COM#' is not set correctly, the script will not run. Include the code below in arduino_LED_user.py : # arduino_LED_user.py import serial import time # Define the serial port and baud rate. # Ensure the 'COM#' corresponds to what was seen in the Windows Device Manager ser = serial . Serial ( 'COM4' , 9600 ) def led_on_off (): user_input = input ( \" \\n Type on / off / quit : \" ) if user_input == \"on\" : print ( \"LED is on...\" ) time . sleep ( 0.1 ) ser . write ( b 'H' ) led_on_off () elif user_input == \"off\" : print ( \"LED is off...\" ) time . sleep ( 0.1 ) ser . write ( b 'L' ) led_on_off () elif user_input == \"quit\" or user_input == \"q\" : print ( \"Program Exiting\" ) time . sleep ( 0.1 ) ser . write ( b 'L' ) ser . close () else : print ( \"Invalid input. Type on / off / quit.\" ) led_on_off () time . sleep ( 2 ) # wait for the serial connection to initialize led_on_off () Run the Python script arduino_LED_user.py . Type H and L and observe the Arduino LED turn on and off. Type q to end the program. Summary In this post, we reviewed how to control an Arduino LED with Python. We accomplished this task in a couple steps. First, we created a virtual environment and installed the PySerial package into it. Next, we downloaded the Arduino IDE. Then we wired up an LED to an Arduino and uploaded the blink.ino sketch to the Arduino. This ensured the Arduino was worked properly. After that, we uploaded the PhysicalPixel.ino sketch to the Arduino and turned the Arduino LED on and off with the Arduino Serial Monitor. Once that was successful, we used the Python REPL and PySerial to turn the LED on and off. Finally, we constructed a Python script to turn the Arduino LED on and off based on user input.","tags":"python and arduino","url":"python-arduino-LED.html","loc":"python-arduino-LED.html"},{"title":"A List of Python Learning Resources","text":"This post is a short list of my recommended Python learning resources. I received an email from someone who found this blog and my GitHub repo and asked about the right place to go to start learning Python. The list of resources in this post comes from the email I sent back. I want to share these Python resources with everyone reading this blog. Table of contents: Books YouTube Blogs Podcasts GitHub Repos Summary Books My book Problem Solving with Python 3.7 Edition is available on Amazon. I am teaching a section of our Engineering Programming course this quarter, Winter 2019. If you would like to use the book, please feel free! I am also looking for any feedback. I'll include you in the list of contributors (with your permission) if you are interested. For my Intro to Engineering course, I constructed this book: https://professorkazarinoff.github.io/Problem-Solving-101-with-Python/ . I welcome any edits. I'll add you to the list of contributors (with your permission) for any edits suggested. So far, one person has given me feedback. You can see how contributors are listed here: https://professorkazarinoff.github.io/Problem-Solving-101-with-Python/99-Appendix/99.08-Contributions/ Think Python by Allen Downey: https://greenteapress.com/wp/think-python-2e/ Python 101 by Michael Driscoll: http://python101.pythonlibrary.org/index.html Python Data Science Handbook by Jake VanderPlas: https://jakevdp.github.io/PythonDataScienceHandbook/ YouTube Corey Schafer's YouTube Channel: https://www.youtube.com/watch?v=YYXdXT2l-Gg&list=PL-osiE80TeTskrapNbzXhwoFUiLCjGgY7 Sentdex YouTube Channel: https://www.youtube.com/watch?v=eXBD2bB9-RA&list=PLQVvvaa0QuDeAams7fkdcwOGBpGdHpXln Blogs My blog, the one you are viewing right now: https://pythonforundergradengineers.com/ The Real Python Blog: https://realpython.com/ The PyImageSearch blog by Adrian Rosebrock: https://www.pyimagesearch.com/ Practical Business Python by Chris Moffitt: http://pbpython.com/ A running listing of Python blogs. I usually read PlanetPython a couple of times a week: https://planetpython.org/titles_only.html Podcasts Michael Kennedy's great podcast: https://talkpython.fm/ Michael Kennedy and Brian Okken's weekly rundown of Python news: https://pythonbytes.fm/ GitHub Repos The labs I ran over the summer for my Intro to Engineering course are in this repo: https://github.com/ProfessorKazarinoff/ENGR101 The labs for my Engineering Programming course this Winter are currently in development. You can find drafts of them here: https://github.com/ProfessorKazarinoff/ENGR114/tree/master/ENGR114-Labs A much more extensive list of awesome Python in this repo: https://github.com/vinta/awesome-python Summary This post contained a listing of different Python learning resources I use and recommend. You can learn about Python in a bunch of different mediums such as books, YouTube, Blogs, and Podcasts. I hope you find some of these resources useful.","tags":"introduction","url":"list-of-python-learning-resources.html","loc":"list-of-python-learning-resources.html"},{"title":"Quiver plots using Python, matplotlib and Jupyter notebooks","text":"In this post, we will build a couple different quiver plots using Python and matplotlib . A quiver plot is a type of 2D plot that shows vector lines as arrows. Quiver plots are useful in electrical engineering to visualize electrical potential and valuable in mechanical engineering to show stress gradients. Install matplotlib and numpy To create the quiver plots, we'll use Python, matplotlib , numpy and a Jupyter notebook . I recommend undergraduate engineers use the Anaconda distribution of Python , which comes with matplotlib , numpy and Jupyter notebooks pre-installed installed. If matplotlib , numpy and Jupyter are not available, these packages can be installed with conda or pip . To install, open the Anaconda Prompt or a terminal and type: > conda install matplotlib numpy jupyter or $ pip install matplotlib numpy jupyter To start a Jupyter notebook , open the Anaconda Prompt and type: > jupyter notebook Jupyter notebooks can also be started on at a command prompt with: $ jupyter notebook Import matplotlib and numpy At the top of the Jupyter notebook , we need to import the required packages to build our quiver plots: matplotlib numpy The %matplotlib inline magic command is added so that we can see our plots right in the Jupyter notebook . In [1]: import matplotlib.pyplot as plt import numpy as np #add %matplotlib inline if using a Jupyter notebook, remove if using a .py script % matplotlib inline Quiver plot with one arrow Let's buid a simple quiver plot that contains one arrow to see how matplotlib's ax.quiver() method works. The ax.quiver() method takes four positional arguments: ax.quiver(x_pos, y_pos, x_direct, y_direct) Where x_pos and y_pos are the arrow starting positions and x_direct , y_direct are the arrow directions. Let's build our first plot to contain one quiver arrow at the starting point x_pos = 0 , y_pos = 0 . We'll define this one quiver arrow's direction as pointing up and to the right x_direct = 1 , y_direct = 1 . In [2]: fig , ax = plt . subplots () x_pos = 0 y_pos = 0 x_direct = 1 y_direct = 1 ax . quiver ( x_pos , y_pos , x_direct , y_direct ) plt . show () We see a plot with one arrow pointing up and to the right. Quiver plot with two arrows Now let's add a second arrow to our quiver plot by passing in two starting points and two arrow directions. We'll keep our first arrow- starting position at the origin 0,0 and pointing up and to the right, direction 1,1 . We'll define the second arrow with a starting position of -0.5,0.5 which points straight down (in the 0,-1 direction). An additional keyword argument to add the ax.quiver() method is scale=5 . This keyword argument scales the arrow lengths, so the arrows are longer and easier to see on the quiver plot. To see the start and end of both arrows, we'll set the axis limits between -1.5 and 1.5 using the ax.axis() method. ax.axis() accepts a list of axis limits in the form [xmin, xmax, ymin, ymax] . In [3]: fig , ax = plt . subplots () x_pos = [ 0 , - 0.5 ] y_pos = [ 0 , 0.5 ] x_direct = [ 1 , 0 ] y_direct = [ 1 , - 1 ] ax . quiver ( x_pos , y_pos , x_direct , y_direct , scale = 5 ) ax . axis ([ - 1.5 , 1.5 , - 1.5 , 1.5 ]) plt . show () We see two arrows on the quiver plot. One arrow points to the upper right and the other arrow points straight down. Quiver plot using np.meshgrid() Two arrows are great, but to create a whole 2D surface worth of arrows, we'll utilize numpy's meshgrid() function. We need to build a set of arrays that denote the x and y starting positions of each quiver arrow on the plot. We will call our quiver arrow starting position arrays X and Y . We can use the x,y arrow starting positions to define the x and y components of each quiver arrow direction . We' ll call the quiver arrow direction arrays u and v . On this quiver plot, we'll define the quiver arrow direction based on the quiver arrow starting point using: $$ x_{direction} = cos(x_{starting \\ point}) $$$$ y_{direction} = sin(y_{starting \\ point}) $$ In [4]: x = np . arange ( 0 , 2.2 , 0.2 ) y = np . arange ( 0 , 2.2 , 0.2 ) X , Y = np . meshgrid ( x , y ) u = np . cos ( X ) * Y v = np . sin ( y ) * Y Now we can build the quiver plot using matplotlib's ax.quiver() method. Remember, the ax.quiver() method call takes four positional arguments: ax.quiver(x_pos, y_pos, x_direct, y_direct) This time x_pos and y_pos are 2D arrays which contain the starting positions of the arrows and x_direct , y_direct are 2D arrays which contain the arrow directions. The commands ax.xaxis.set_ticks([]) and ax.yaxis.set_ticks([]) removes the tick marks from the axis and ax.set_aspect('equal') sets the aspect ratio of the plot to 1:1. In [5]: fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , u , v ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . axis ([ - 0.2 , 2.3 , - 0.2 , 2.3 ]) ax . set_aspect ( 'equal' ) plt . show () Now let's build another quiver plot with the $\\hat{i}$ and $\\hat{j}$ components (the horizontal and vertical components) of vector, $\\vec{F}$ are dependant upon the arrow starting point $x,y$ according to the function: $$ \\vec{F} = \\frac{x}{5} \\ \\hat{i} - \\frac{y}{5} \\ \\hat{j} $$ Again we'll use numpy's np.meshgrid() function to build the arrow starting position arrays, then apply our function $\\vec{F}$ to the $x$ and $y$ arrow starting point arrays. In [6]: x = np . arange ( - 5 , 6 , 1 ) y = np . arange ( - 5 , 6 , 1 ) X , Y = np . meshgrid ( x , y ) u , v = X / 5 , - Y / 5 fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , u , v ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . axis ([ - 6 , 6 , - 6 , 6 ]) ax . set_aspect ( 'equal' ) plt . show () Quiver plot containing a gradient Next, let's build a quiver plot using the gradient function. The gradient function has the form: $$ z = xe&#94;{-x&#94;2-y&#94;2} $$ We'll use numpy's np.gradient() function to apply the gradient function based on every arrow's x,y starting position. In [7]: x = np . arange ( - 2 , 2.2 , 0.2 ) y = np . arange ( - 2 , 2.2 , 0.2 ) X , Y = np . meshgrid ( x , y ) z = X * np . exp ( - X ** 2 - Y ** 2 ) dx , dy = np . gradient ( z ) fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , dx , dy ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . set_aspect ( 'equal' ) plt . show () Quiver plot with four vortices Now let's build a quiver plot that contains four vortices. The function $\\vec{F}$ which describes the 2D vortex field is: $$ \\vec{F} = sin(x)cos(y) \\ \\hat{i} -cos(x)sin(y) \\ \\hat{j} $$ We'll build these direction arrays using numpy and the np.meshgrid() function. In [8]: x = np . arange ( 0 , 2 * np . pi + 2 * np . pi / 20 , 2 * np . pi / 20 ) y = np . arange ( 0 , 2 * np . pi + 2 * np . pi / 20 , 2 * np . pi / 20 ) X , Y = np . meshgrid ( x , y ) u = np . sin ( X ) * np . cos ( Y ) v = - np . cos ( X ) * np . sin ( Y ) fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , u , v ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . axis ([ 0 , 2 * np . pi , 0 , 2 * np . pi ]) ax . set_aspect ( 'equal' ) plt . show () Cool. Nice and swirly. Quiver plots with color Next, let's add some color to the quiver plots. The ax.quiver() method has an optional fifth positional argument that specifies the quiver arrow color. The quiver arrow color argument needs to have the same dimensions as the position and direction arrays. In [9]: x = np . arange ( 0 , 2.2 , 0.2 ) y = np . arange ( 0 , 2.2 , 0.2 ) X , Y = np . meshgrid ( x , y ) u = np . cos ( X ) * Y v = np . sin ( y ) * Y n = - 2 color_array = np . sqrt ((( v - n ) / 2 ) ** 2 + (( u - n ) / 2 ) ** 2 ) fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , u , v , color_array , alpha = 0.8 ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . axis ([ - 0.2 , 2.3 , - 0.2 , 2.3 ]) ax . set_aspect ( 'equal' ) plt . show () Let's add some color to the gradient quiver plot: In [10]: x = np . arange ( - 2 , 2.2 , 0.2 ) y = np . arange ( - 2 , 2.2 , 0.2 ) X , Y = np . meshgrid ( x , y ) z = X * np . exp ( - X ** 2 - Y ** 2 ) dx , dy = np . gradient ( z ) n = - 2 color_array = np . sqrt ((( dx - n ) / 2 ) ** 2 + (( dy - n ) / 2 ) ** 2 ) fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , dx , dy , color_array ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . set_aspect ( 'equal' ) plt . show () Finally, we'll add some color to the vortex plot: In [11]: x = np . arange ( 0 , 2 * np . pi + 2 * np . pi / 20 , 2 * np . pi / 20 ) y = np . arange ( 0 , 2 * np . pi + 2 * np . pi / 20 , 2 * np . pi / 20 ) X , Y = np . meshgrid ( x , y ) u = np . sin ( X ) * np . cos ( Y ) v = - np . cos ( X ) * np . sin ( Y ) n = - 1 color_array = np . sqrt ((( dx - n ) / 2 ) ** 2 + (( dy - n ) / 2 ) ** 2 ) fig , ax = plt . subplots ( figsize = ( 7 , 7 )) ax . quiver ( X , Y , u , v , color_array , scale = 17 ) ax . xaxis . set_ticks ([]) ax . yaxis . set_ticks ([]) ax . axis ([ 0 , 2 * np . pi , 0 , 2 * np . pi ]) ax . set_aspect ( 'equal' ) plt . show () Summary In this post, we built a couple different quiver plots with matplotlib and Python. Quiver plots are part of matplotlib's pylot library. The ax.quiver() method accepts four positional arguments: x-positions, y-positions, x-directions, y-directions. Numpy's meshgrid() function is useful for creating these position arrays. Finally, we added some color to our quiver plots by including a fifth positional argument to the ax.quiver() method.","tags":"matplotlib","url":"quiver-plot-with-matplotlib-and-jupyter-notebooks.html","loc":"quiver-plot-with-matplotlib-and-jupyter-notebooks.html"},{"title":"Plotting a stress-strain curve with four libraries: matplotlib, pandas, altair and bokeh","text":"There are many different plotting libraries in the Python ecosystem. Matplotlib is widley used, but there are other alternatives. After I watched a webinar from the Anaconda folks about all the possible plotting options Taming the Python Visualization Jungle and heard a podcast.__init__ episode about Data Science For Academic Research with Jake Vanderplas, I wanted to try using a few new Python plotting libraries and compare them to Matplotlib. In this post, we're going to plot the same stress-strain curve using four different Python plotting libraries. The four plotting libraries are: Pandas Matplotlib Altair Bokeh (with Holoviews ) The data we are going to plot is from a mechanical test frame. Mechanical test frames are used to test the mechanical properties of materials. The test frame pulls a sample apart. As the frame extends, the amount of force and the amount of extension are measured and recorded. The data from the mechanical test frame was saved in the form of a .csv file. We'll plot a stress-strain curve with the four libraries using this data. Before we can build any plots, we need to make sure the plotting libraries are installed in our current working Python environment. Installation All four of the plotting libraries can be installed at the Anaconda Prompt. Let's build a virtual environment too, and then install the plotting libraries into the new virtual environment. It's easy to use all four libraries in a Jupyter notebook, so we'll install Jupyter as well. The command jupyter notebook will start the Jupyter notebook application. > conda create -n plotting python=3.7 > conda activate plotting (plotting)> conda install pandas matplotlib bokeh holoviews (plotting)> conda install -c conda-forge altair vega_datasets notebook vega (plotting)> conda install jupyter (plotting)> jupyter notebook 1. Pandas First up is Pandas . Pandas is really a library for dealing with tabular data, not plotting. But if we use Pandas to import data, clean data, and rearrange data, we might as well try plotting with it too. Plotting in Pandas is quick and easy. In [1]: import pandas as pd % matplotlib inline print ( f 'Pandas version: {pd.__version__} ' ) Pandas version: 0.23.4 The same data will be used to build each plot. It is pretty easy to load the raw data into a Pandas dataframe. The data is in two columns, the first column is the strain, which will be the x-values in each plot. The second column is stress, which will be the y-values in each plot. In [2]: df = pd . read_csv ( 'stress_strain_data.csv' , sep = ',' , header = None , skiprows = 0 ) df . columns = [ 'strain' , 'stress' ] df . head () Out[2]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } strain stress 0 0.000000 0.000 1 0.000605 43.821 2 0.001211 74.356 3 0.001816 104.930 4 0.002421 137.510 Building a simple plot with Pandas requires the df.plot() method call. The keyword arguments (x='strain', y='stress') are passed into the method. This puts strain on the x-axis and stress on the y-axis. df.plot() produces a pretty basic plot, but it sure is quick. Besides the import lines, that's two lines of code to build a plot in Python. In [3]: df . plot ( x = 'strain' , y = 'stress' ) Out[3]: <matplotlib.axes._subplots.AxesSubplot at 0x1e1c9dce9e8> 2. Matplotlib Matplotlib is the plotting library I'm the most familiar with. Matplotlib is also one of the oldest and most used Python plotting libraries. Before building the plot, pulling the strain and stress columns out of dataframe allows us to set the columns as the x-values and y-values. Compared to Pandas, Matplotlib allows a lot more customization. In [4]: import matplotlib.pyplot as plt import pandas as pd % matplotlib inline df = pd . read_csv ( 'stress_strain_data.csv' , sep = ',' , header = None , skiprows = 0 ) df . columns = [ 'strain' , 'stress' ] strain = df [ 'strain' ] stress = df [ 'stress' ] plt . plot ( strain , stress ) plt . xlabel ( 'Strain (mm/mm)' ) plt . ylabel ( 'Stress (MPa)' ) plt . title ( 'matplotlib' ) plt . show () 3. Altair Altair is a new library for me. It was created by the awesome Jake Vanderplas as a more portable plotting option compared to Matplotlib. The Altair documentation recommends installing Altair with either pip or conda . I used the conda command to install Altair from the conda-forge channel. Altair is not included in the Anaconda distribution of Python. So if you are using Anaconda, Altair must be installed seperatly. The Altair documentation states that vega_datasets and vega need to be installed (as well as Altair) in order to use Altair in a Jupyter notebook . To render altair plots in a Jupyter notebook the line alt.renderers.enable('notebook') needs be included below the imports. > conda install -c conda-forge altair vega_datasets notebook vega In [5]: import altair as alt alt . renderers . enable ( 'notebook' ) import pandas as pd print ( \"Altair Version: \" , alt . __version__ ) Altair Version: 2.2.2 In [6]: df = pd . read_csv ( 'stress_strain_data.csv' , sep = ',' , header = None , skiprows = 0 ) df . columns = [ 'strain' , 'stress' ] alt . Chart ( df ) . mark_line () . encode ( x = 'strain' , y = 'stress' ) var element = $('#0b8ce09c-5fdf-41be-86c8-cea04d17f8d1'); var spec = {\"config\": {\"view\": {\"width\": 400, \"height\": 300}}, \"data\": {\"name\": \"data-c04df6ba0aadabda5068226a5e65d2ee\"}, \"mark\": \"line\", \"encoding\": {\"x\": {\"type\": \"quantitative\", \"field\": \"strain\"}, \"y\": {\"type\": \"quantitative\", \"field\": \"stress\"}}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v2.6.0.json\", \"datasets\": {\"data-c04df6ba0aadabda5068226a5e65d2ee\": [{\"strain\": 0.0, \"stress\": 0.0}, {\"strain\": 0.00060539, \"stress\": 43.821000000000005}, {\"strain\": 0.0012107, \"stress\": 74.35600000000001}, {\"strain\": 0.0018160999999999997, \"stress\": 104.93}, {\"strain\": 0.0024213, \"stress\": 137.51}, {\"strain\": 0.0030268, \"stress\": 169.57}, {\"strain\": 0.0036321999999999995, \"stress\": 195.86}, {\"strain\": 0.0042377, \"stress\": 210.31}, {\"strain\": 0.004843, \"stress\": 218.42}, {\"strain\": 0.0054486000000000005, \"stress\": 224.14}, {\"strain\": 0.006053899999999999, \"stress\": 228.85}, {\"strain\": 0.006659, \"stress\": 232.94}, {\"strain\": 0.007264399999999999, \"stress\": 236.67}, {\"strain\": 0.0078697, \"stress\": 239.95}, {\"strain\": 0.0085996, \"stress\": 243.62}, {\"strain\": 0.010983, \"stress\": 254.33}, {\"strain\": 0.013366999999999999, \"stress\": 263.82}, {\"strain\": 0.01575, \"stress\": 272.71}, {\"strain\": 0.018133, \"stress\": 281.0}, {\"strain\": 0.020516999999999997, \"stress\": 288.87}, {\"strain\": 0.0229, \"stress\": 296.2}, {\"strain\": 0.025283, \"stress\": 303.3}, {\"strain\": 0.027667, \"stress\": 309.97}, {\"strain\": 0.03005, \"stress\": 316.34}, {\"strain\": 0.032434, \"stress\": 322.31}, {\"strain\": 0.034817, \"stress\": 328.01}, {\"strain\": 0.0372, \"stress\": 333.35}, {\"strain\": 0.039583999999999994, \"stress\": 338.45}, {\"strain\": 0.041967000000000004, \"stress\": 343.19}, {\"strain\": 0.044351, \"stress\": 347.75}, {\"strain\": 0.046734, \"stress\": 351.99}, {\"strain\": 0.049118, \"stress\": 356.04}, {\"strain\": 0.051476999999999995, \"stress\": 359.74}, {\"strain\": 0.053860000000000005, \"stress\": 363.34}, {\"strain\": 0.056244, \"stress\": 366.59}, {\"strain\": 0.058627, \"stress\": 369.73}, {\"strain\": 0.061011, \"stress\": 372.72}, {\"strain\": 0.063394, \"stress\": 375.52}, {\"strain\": 0.065778, \"stress\": 378.06}, {\"strain\": 0.068161, \"stress\": 380.54}, {\"strain\": 0.07054400000000001, \"stress\": 382.84}, {\"strain\": 0.07292799999999999, \"stress\": 385.13}, {\"strain\": 0.075311, \"stress\": 387.19}, {\"strain\": 0.077695, \"stress\": 389.2}, {\"strain\": 0.080078, \"stress\": 391.0}, {\"strain\": 0.082461, \"stress\": 392.88}, {\"strain\": 0.084845, \"stress\": 394.48}, {\"strain\": 0.087228, \"stress\": 396.13}, {\"strain\": 0.089612, \"stress\": 397.74}, {\"strain\": 0.09199500000000001, \"stress\": 399.16}, {\"strain\": 0.094378, \"stress\": 400.52}, {\"strain\": 0.096762, \"stress\": 401.84}, {\"strain\": 0.09914500000000001, \"stress\": 402.99}, {\"strain\": 0.10153, \"stress\": 404.3}, {\"strain\": 0.10390999999999999, \"stress\": 405.48}, {\"strain\": 0.1063, \"stress\": 406.47}, {\"strain\": 0.10868, \"stress\": 407.4}, {\"strain\": 0.11105999999999999, \"stress\": 408.39}, {\"strain\": 0.11345, \"stress\": 409.2}, {\"strain\": 0.11582999999999999, \"stress\": 410.03}, {\"strain\": 0.11821, \"stress\": 410.71}, {\"strain\": 0.1206, \"stress\": 411.36}, {\"strain\": 0.12297999999999999, \"stress\": 411.9}, {\"strain\": 0.12536, \"stress\": 412.47}, {\"strain\": 0.12775, \"stress\": 412.82}, {\"strain\": 0.13013, \"stress\": 413.18}, {\"strain\": 0.13251, \"stress\": 413.43}, {\"strain\": 0.1349, \"stress\": 413.5}, {\"strain\": 0.13727999999999999, \"stress\": 413.2}, {\"strain\": 0.13965999999999998, \"stress\": 412.49}, {\"strain\": 0.14205, \"stress\": 410.41}, {\"strain\": 0.14443, \"stress\": 403.47}, {\"strain\": 0.14681, \"stress\": 379.18}]}}; var opt = {}; var type = \"vega-lite\"; var id = \"472de7c5-6c12-409b-8826-4bc6c3655ed3\"; var output_area = this; require([\"nbextensions/jupyter-vega/index\"], function(vega) { var target = document.createElement(\"div\"); target.id = id; target.className = \"vega-embed\"; var style = document.createElement(\"style\"); style.textContent = [ \".vega-embed .error p {\", \" color: firebrick;\", \" font-size: 14px;\", \"}\", ].join(\"\\\\n\"); // element is a jQuery wrapped DOM element inside the output area // see http://ipython.readthedocs.io/en/stable/api/generated/\\ // IPython.display.html#IPython.display.Javascript.__init__ element[0].appendChild(target); element[0].appendChild(style); vega.render(\"#\" + id, spec, type, opt, output_area); }, function (err) { if (err.requireType !== \"scripterror\") { throw(err); } }); Out[6]: 4. Bokeh (with Holoviews) The final plotting library is Bokeh . Bokeh plots are designed for web viewing. Bokeh plots include a set of tools that allows zoom, pan, saving, and reloading. I find the Bokeh API pretty complex. There are so many options, it can be difficult to get a simple plot like our stress-strain curve up and running. Luckily, there is a wrapper for Bokeh called Holoviews that makes using Bokeh easier for simple plots (like our stress-strain curve). To install Bokeh and Holoviews, I used conda : > conda install bokeh > conda install holoviews If using a Jupyter notebook, calling the hv.Curve() method will produce a plot. I am saving the plot .html and re-displaying it using Jupyter's HTML() function. This just allows me to put the plot on my blog. In [7]: import pandas as pd import holoviews as hv hv . extension ( 'bokeh' ) print ( f 'Holoviews verion: {hv.__version__} ' ) var element = $('#3e7bd37f-96f7-42b8-b27c-caedb7661c56'); (function(root) { function now() { return new Date(); } var force = true; if (typeof (root._bokeh_onload_callbacks) === \"undefined\" || force === true) { root._bokeh_onload_callbacks = []; root._bokeh_is_loading = undefined; } var JS_MIME_TYPE = 'application/javascript'; var HTML_MIME_TYPE = 'text/html'; var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json'; var CLASS_NAME = 'output_bokeh rendered_html'; /** * Render data to the DOM node */ function render(props, node) { var script = document.createElement(\"script\"); node.appendChild(script); } /** * Handle when an output is cleared or removed */ function handleClearOutput(event, handle) { var cell = handle.cell; var id = cell.output_area._bokeh_element_id; var server_id = cell.output_area._bokeh_server_id; // Clean up Bokeh references if (id != null && id in Bokeh.index) { Bokeh.index[id].model.document.clear(); delete Bokeh.index[id]; } if (server_id !== undefined) { // Clean up Bokeh references var cmd = \"from bokeh.io.state import curstate; print(curstate().uuid_to_server['\" + server_id + \"'].get_sessions()[0].document.roots[0]._id)\"; cell.notebook.kernel.execute(cmd, { iopub: { output: function(msg) { var id = msg.content.text.trim(); if (id in Bokeh.index) { Bokeh.index[id].model.document.clear(); delete Bokeh.index[id]; } } } }); // Destroy server and session var cmd = \"import bokeh.io.notebook as ion; ion.destroy_server('\" + server_id + \"')\"; cell.notebook.kernel.execute(cmd); } } /** * Handle when a new output is added */ function handleAddOutput(event, handle) { var output_area = handle.output_area; var output = handle.output; // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only if ((output.output_type != \"display_data\") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) { return } var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]); if (output.metadata[EXEC_MIME_TYPE][\"id\"] !== undefined) { toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE]; // store reference to embed id on output_area output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE][\"id\"]; } if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) { var bk_div = document.createElement(\"div\"); bk_div.innerHTML = output.data[HTML_MIME_TYPE]; var script_attrs = bk_div.children[0].attributes; for (var i = 0; i < script_attrs.length; i++) { toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value); } // store reference to server id on output_area output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"]; } } function register_renderer(events, OutputArea) { function append_mime(data, metadata, element) { // create a DOM node to render to var toinsert = this.create_output_subarea( metadata, CLASS_NAME, EXEC_MIME_TYPE ); this.keyboard_manager.register_events(toinsert); // Render to node var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]}; render(props, toinsert[toinsert.length - 1]); element.append(toinsert); return toinsert } /* Handle when an output is cleared or removed */ events.on('clear_output.CodeCell', handleClearOutput); events.on('delete.Cell', handleClearOutput); /* Handle when a new output is added */ events.on('output_added.OutputArea', handleAddOutput); /** * Register the mime type and append_mime function with output_area */ OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, { /* Is output safe? */ safe: true, /* Index of renderer in `output_area.display_order` */ index: 0 }); } // register the mime type if in Jupyter Notebook environment and previously unregistered if (root.Jupyter !== undefined) { var events = require('base/js/events'); var OutputArea = require('notebook/js/outputarea').OutputArea; if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) { register_renderer(events, OutputArea); } } if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) { root._bokeh_timeout = Date.now() + 5000; root._bokeh_failed_load = false; } var NB_LOAD_WARNING = {'data': {'text/html': \"<div style='background-color: #fdd'>\\n\"+ \"<p>\\n\"+ \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+ \"may be due to a slow or bad network connection. Possible fixes:\\n\"+ \"</p>\\n\"+ \"<ul>\\n\"+ \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+ \"<li>use INLINE resources instead, as so:</li>\\n\"+ \"</ul>\\n\"+ \"<code>\\n\"+ \"from bokeh.resources import INLINE\\n\"+ \"output_notebook(resources=INLINE)\\n\"+ \"</code>\\n\"+ \"</div>\"}}; function display_loaded() { var el = document.getElementById(null); if (el != null) { el.textContent = \"BokehJS is loading...\"; } if (root.Bokeh !== undefined) { if (el != null) { el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\"; } } else if (Date.now() < root._bokeh_timeout) { setTimeout(display_loaded, 100) } } function run_callbacks() { try { root._bokeh_onload_callbacks.forEach(function(callback) { callback() }); } finally { delete root._bokeh_onload_callbacks } console.info(\"Bokeh: all callbacks have finished\"); } function load_libs(js_urls, callback) { root._bokeh_onload_callbacks.push(callback); if (root._bokeh_is_loading > 0) { console.log(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now()); return null; } if (js_urls == null || js_urls.length === 0) { run_callbacks(); return null; } console.log(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now()); root._bokeh_is_loading = js_urls.length; for (var i = 0; i < js_urls.length; i++) { var url = js_urls[i]; var s = document.createElement('script'); s.src = url; s.async = false; s.onreadystatechange = s.onload = function() { root._bokeh_is_loading--; if (root._bokeh_is_loading === 0) { console.log(\"Bokeh: all BokehJS libraries loaded\"); run_callbacks() } }; s.onerror = function() { console.warn(\"failed to load library \" + url); }; console.log(\"Bokeh: injecting script tag for BokehJS library: \", url); document.getElementsByTagName(\"head\")[0].appendChild(s); } }; var js_urls = []; var inline_js = [ function(Bokeh) { /* BEGIN bokeh.min.js */ /*! * Copyright (c) 2012, Anaconda, Inc. * All rights reserved. * * Redistribution and use in source and binary forms, with or without modification, * are permitted provided that the following conditions are met: * * Redistributions of source code must retain the above copyright notice, * this list of conditions and the following disclaimer. * * Redistributions in binary form must reproduce the above copyright notice, * this list of conditions and the following disclaimer in the documentation * and/or other materials provided with the distribution. * * Neither the name of Anaconda nor the names of any contributors * may be used to endorse or promote products derived from this software * without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF * THE POSSIBILITY OF SUCH DAMAGE. */ !function(t,e){var o,s,r,a,l;t.Bokeh=(o=[function(t,e,i){var n=t(148),r=t(32);i.overrides={};var o=r.clone(n);i.Models=function(t){var e=i.overrides[t]||o[t];if(null==e)throw new Error(\"Model '\"+t+\"' does not exist. This could be due to a widget\\n or a custom model not being registered before first usage.\");return e},i.Models.register=function(t,e){i.overrides[t]=e},i.Models.unregister=function(t){delete i.overrides[t]},i.Models.register_models=function(t,e,i){if(void 0===e&&(e=!1),null!=t)for(var n in t){var r=t[n];e||!o.hasOwnProperty(n)?o[n]=r:null!=i?i(n):console.warn(\"Model '\"+n+\"' was already registered\")}},i.register_models=i.Models.register_models,i.Models.registered_names=function(){return Object.keys(o)},i.index={}},function(t,e,o){var s=t(326),a=t(14),l=t(50),h=t(269),c=t(270),u=t(2);o.DEFAULT_SERVER_WEBSOCKET_URL=\"ws://localhost:5006/ws\",o.DEFAULT_SESSION_ID=\"default\";var _=0,p=function(){function t(t,e,i,n,r){void 0===t&&(t=o.DEFAULT_SERVER_WEBSOCKET_URL),void 0===e&&(e=o.DEFAULT_SESSION_ID),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),this.url=t,this.id=e,this.args_string=i,this._on_have_session_hook=n,this._on_closed_permanently_hook=r,this._number=_++,this.socket=null,this.session=null,this.closed_permanently=!1,this._current_handler=null,this._pending_ack=null,this._pending_replies={},this._receiver=new c.Receiver,a.logger.debug(\"Creating websocket \"+this._number+\" to '\"+this.url+\"' session '\"+this.id+\"'\")}return t.prototype.connect=function(){var i=this;if(this.closed_permanently)return s.Promise.reject(new Error(\"Cannot connect() a closed ClientConnection\"));if(null!=this.socket)return s.Promise.reject(new Error(\"Already connected\"));this._pending_replies={},this._current_handler=null;try{var t=this.url+\"?bokeh-protocol-version=1.0&bokeh-session-id=\"+this.id;return null!=this.args_string&&0<this.args_string.length&&(t+=\"&\"+this.args_string),this.socket=new WebSocket(t),new s.Promise(function(t,e){i.socket.binaryType=\"arraybuffer\",i.socket.onopen=function(){return i._on_open(t,e)},i.socket.onmessage=function(t){return i._on_message(t)},i.socket.onclose=function(t){return i._on_close(t)},i.socket.onerror=function(){return i._on_error(e)}})}catch(t){return a.logger.error(\"websocket creation failed to url: \"+this.url),a.logger.error(\" - \"+t),s.Promise.reject(t)}},t.prototype.close=function(){this.closed_permanently||(a.logger.debug(\"Permanently closing websocket connection \"+this._number),this.closed_permanently=!0,null!=this.socket&&this.socket.close(1e3,\"close method called on ClientConnection \"+this._number),this.session._connection_closed(),null!=this._on_closed_permanently_hook&&(this._on_closed_permanently_hook(),this._on_closed_permanently_hook=null))},t.prototype._schedule_reconnect=function(t){var e=this;setTimeout(function(){e.closed_permanently||a.logger.info(\"Websocket connection \"+e._number+\" disconnected, will not attempt to reconnect\")},t)},t.prototype.send=function(t){if(null==this.socket)throw new Error(\"not connected so cannot send \"+t);t.send(this.socket)},t.prototype.send_with_reply=function(i){var n=this,t=new s.Promise(function(t,e){n._pending_replies[i.msgid()]=[t,e],n.send(i)});return t.then(function(t){if(\"ERROR\"===t.msgtype())throw new Error(\"Error reply \"+t.content.text);return t},function(t){throw t})},t.prototype._pull_doc_json=function(){var t=h.Message.create(\"PULL-DOC-REQ\",{}),e=this.send_with_reply(t);return e.then(function(t){if(!(\"doc\"in t.content))throw new Error(\"No 'doc' field in PULL-DOC-REPLY\");return t.content.doc},function(t){throw t})},t.prototype._repull_session_doc=function(){var r=this;null==this.session?a.logger.debug(\"Pulling session for first time\"):a.logger.debug(\"Repulling session\"),this._pull_doc_json().then(function(t){if(null==r.session)if(r.closed_permanently)a.logger.debug(\"Got new document after connection was already closed\");else{var e=l.Document.from_json(t),i=l.Document._compute_patch_since_json(t,e);if(0<i.events.length){a.logger.debug(\"Sending \"+i.events.length+\" changes from model construction back to server\");var n=h.Message.create(\"PATCH-DOC\",{},i);r.send(n)}r.session=new u.ClientSession(r,e,r.id),a.logger.debug(\"Created a new session from new pulled doc\"),null!=r._on_have_session_hook&&(r._on_have_session_hook(r.session),r._on_have_session_hook=null)}else r.session.document.replace_with_json(t),a.logger.debug(\"Updated existing session with new pulled doc\")},function(t){throw t}).catch(function(t){null!=console.trace&&console.trace(t),a.logger.error(\"Failed to repull session \"+t)})},t.prototype._on_open=function(t,e){var i=this;a.logger.info(\"Websocket connection \"+this._number+\" is now open\"),this._pending_ack=[t,e],this._current_handler=function(t){i._awaiting_ack_handler(t)}},t.prototype._on_message=function(t){null==this._current_handler&&a.logger.error(\"Got a message with no current handler set\");try{this._receiver.consume(t.data)}catch(t){this._close_bad_protocol(t.toString())}if(null!=this._receiver.message){var e=this._receiver.message,i=e.problem();null!=i&&this._close_bad_protocol(i),this._current_handler(e)}},t.prototype._on_close=function(t){var i=this;a.logger.info(\"Lost websocket \"+this._number+\" connection, \"+t.code+\" (\"+t.reason+\")\"),(this.socket=null)!=this._pending_ack&&(this._pending_ack[1](new Error(\"Lost websocket connection, \"+t.code+\" (\"+t.reason+\")\")),this._pending_ack=null);for(var e=function(){for(var t in i._pending_replies){var e=i._pending_replies[t];return delete i._pending_replies[t],e}return null},n=e();null!=n;)n[1](\"Disconnected\"),n=e();this.closed_permanently||this._schedule_reconnect(2e3)},t.prototype._on_error=function(t){a.logger.debug(\"Websocket error on socket \"+this._number),t(new Error(\"Could not open websocket\"))},t.prototype._close_bad_protocol=function(t){a.logger.error(\"Closing connection: \"+t),null!=this.socket&&this.socket.close(1002,t)},t.prototype._awaiting_ack_handler=function(t){var e=this;\"ACK\"===t.msgtype()?(this._current_handler=function(t){return e._steady_state_handler(t)},this._repull_session_doc(),null!=this._pending_ack&&(this._pending_ack[0](this),this._pending_ack=null)):this._close_bad_protocol(\"First message was not an ACK\")},t.prototype._steady_state_handler=function(t){if(t.reqid()in this._pending_replies){var e=this._pending_replies[t.reqid()];delete this._pending_replies[t.reqid()],e[0](t)}else this.session.handle(t)},t}();o.ClientConnection=p,o.pull_session=function(i,n,r){return new s.Promise(function(t,e){return new p(i,n,r,function(e){try{t(e)}catch(t){throw a.logger.error(\"Promise handler threw an error, closing session \"+t),e.close(),t}},function(){e(new Error(\"Connection was closed before we successfully pulled a session\"))}).connect().then(function(t){},function(t){throw a.logger.error(\"Failed to connect to Bokeh server \"+t),t})})}},function(t,e,i){var n=t(14),r=t(50),o=t(269),s=function(){function t(t,e,i){var n=this;this._connection=t,this.document=e,this.id=i,this._document_listener=function(t){return n._document_changed(t)},this.document.on_change(this._document_listener),this.event_manager=this.document.event_manager,this.event_manager.session=this}return t.prototype.handle=function(t){var e=t.msgtype();\"PATCH-DOC\"===e?this._handle_patch(t):\"OK\"===e?this._handle_ok(t):\"ERROR\"===e?this._handle_error(t):n.logger.debug(\"Doing nothing with message \"+t.msgtype())},t.prototype.close=function(){this._connection.close()},t.prototype.send_event=function(t){var e=o.Message.create(\"EVENT\",{},JSON.stringify(t));this._connection.send(e)},t.prototype._connection_closed=function(){this.document.remove_on_change(this._document_listener)},t.prototype.request_server_info=function(){var t=o.Message.create(\"SERVER-INFO-REQ\",{}),e=this._connection.send_with_reply(t);return e.then(function(t){return t.content})},t.prototype.force_roundtrip=function(){return this.request_server_info().then(function(t){})},t.prototype._document_changed=function(t){if(t.setter_id!==this.id&&(!(t instanceof r.ModelChangedEvent)||t.attr in t.model.serializable_attributes())){var e=o.Message.create(\"PATCH-DOC\",{},this.document.create_json_patch([t]));this._connection.send(e)}},t.prototype._handle_patch=function(t){this.document.apply_json_patch(t.content,t.buffers,this.id)},t.prototype._handle_ok=function(t){n.logger.trace(\"Unhandled OK reply to \"+t.reqid())},t.prototype._handle_error=function(t){n.logger.error(\"Unhandled ERROR reply to \"+t.reqid()+\": \"+t.content.text)},t}();i.ClientSession=s},function(t,e,i){var n=t(387),r=t(14),o=t(32),s={};function a(e){return function(t){t.prototype.event_name=e,s[e]=t}}i.register_event_class=a,i.register_with_event=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=t.prototype.applicable_models.concat(e);t.prototype.applicable_models=n};var l=function(){function t(t){void 0===t&&(t={}),this.model_id=null,(this._options=t).model_id&&(this.model_id=t.model_id)}return t.prototype.set_model_id=function(t){return this._options.model_id=t,this.model_id=t,this},t.prototype.is_applicable_to=function(e){return this.applicable_models.some(function(t){return e instanceof t})},t.event_class=function(t){if(t.type)return s[t.type];r.logger.warn(\"BokehEvent.event_class required events with a string type attribute\")},t.prototype.toJSON=function(){return{event_name:this.event_name,event_values:o.clone(this._options)}},t.prototype._customize_event=function(t){return this},t}();(i.BokehEvent=l).prototype.applicable_models=[];var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"button_click\")],e)}(l);i.ButtonClick=h;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(l),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"lodstart\")],e)}(i.UIEvent=c);i.LODStart=u;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"lodend\")],e)}(c);i.LODEnd=_;var p=function(i){function t(t){var e=i.call(this,t)||this;return e.geometry=t.geometry,e.final=t.final,e}return n.__extends(t,i),t=n.__decorate([a(\"selectiongeometry\")],t)}(c);i.SelectionGeometry=p;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"reset\")],e)}(c);i.Reset=d;var f=function(i){function t(t){var e=i.call(this,t)||this;return e.sx=t.sx,e.sy=t.sy,e.x=null,e.y=null,e}return n.__extends(t,i),t.from_event=function(t,e){return void 0===e&&(e=null),new this({sx:t.sx,sy:t.sy,model_id:e})},t.prototype._customize_event=function(t){var e=t.plot_canvas.frame.xscales.default,i=t.plot_canvas.frame.yscales.default;return this.x=e.invert(this.sx),this.y=i.invert(this.sy),this._options.x=this.x,this._options.y=this.y,this},t}(c),v=function(i){function t(t){void 0===t&&(t={});var e=i.call(this,t)||this;return e.delta_x=t.delta_x,e.delta_y=t.delta_y,e}return n.__extends(t,i),t.from_event=function(t,e){return void 0===e&&(e=null),new this({sx:t.sx,sy:t.sy,delta_x:t.deltaX,delta_y:t.deltaY,direction:t.direction,model_id:e})},t=n.__decorate([a(\"pan\")],t)}(i.PointEvent=f);i.Pan=v;var m=function(i){function t(t){void 0===t&&(t={});var e=i.call(this,t)||this;return e.scale=t.scale,e}return n.__extends(t,i),t.from_event=function(t,e){return void 0===e&&(e=null),new this({sx:t.sx,sy:t.sy,scale:t.scale,model_id:e})},t=n.__decorate([a(\"pinch\")],t)}(f);i.Pinch=m;var g=function(i){function t(t){void 0===t&&(t={});var e=i.call(this,t)||this;return e.delta=t.delta,e}return n.__extends(t,i),t.from_event=function(t,e){return void 0===e&&(e=null),new this({sx:t.sx,sy:t.sy,delta:t.delta,model_id:e})},t=n.__decorate([a(\"wheel\")],t)}(f);i.MouseWheel=g;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"mousemove\")],e)}(f);i.MouseMove=y;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"mouseenter\")],e)}(f);i.MouseEnter=b;var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"mouseleave\")],e)}(f);i.MouseLeave=x;var w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"tap\")],e)}(f);i.Tap=w;var k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"doubletap\")],e)}(f);i.DoubleTap=k;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"press\")],e)}(f);i.Press=S;var T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"panstart\")],e)}(f);i.PanStart=T;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"panend\")],e)}(f);i.PanEnd=C;var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"pinchstart\")],e)}(f);i.PinchStart=A;var E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e=n.__decorate([a(\"pinchend\")],e)}(f);i.PinchEnd=E},function(t,e,i){var g=t(387),y=t(21);i.build_views=function(e,t,i,n){void 0===n&&(n=function(t){return t.default_view});for(var r=y.difference(Object.keys(e),t.map(function(t){return t.id})),o=0,s=r;o<s.length;o++){var a=s[o];e[a].remove(),delete e[a]}for(var l=[],h=t.filter(function(t){return null==e[t.id]}),c=0,u=h;c<u.length;c++){var _=u[c],p=n(_),d=g.__assign({},i,{model:_,connect_signals:!1}),f=new p(d);e[_.id]=f,l.push(f)}for(var v=0,m=l;v<m.length;v++){var f=m[v];f.connect_signals()}return l},i.remove_views=function(t){for(var e in t)t[e].remove(),delete t[e]}},function(t,e,i){var n,y=t(44),r=function(g){return function(t){void 0===t&&(t={});for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=document.createElement(g);for(var r in t){var o=t[r];if(null!=o&&(!y.isBoolean(o)||o))if(\"class\"===r&&y.isArray(o))for(var s=0,a=o;s<a.length;s++){var l=a[s];null!=l&&n.classList.add(l)}else if(\"style\"===r&&y.isObject(o))for(var h in o)n.style[h]=o[h];else if(\"data\"===r&&y.isObject(o))for(var c in o)n.dataset[c]=o[c];else n.setAttribute(r,o)}function u(t){if(t instanceof HTMLElement)n.appendChild(t);else if(y.isString(t))n.appendChild(document.createTextNode(t));else if(null!=t&&!1!==t)throw new Error(\"expected an HTMLElement, string, false or null, got \"+JSON.stringify(t))}for(var _=0,p=e;_<p.length;_++){var d=p[_];if(y.isArray(d))for(var f=0,v=d;f<v.length;f++){var m=v[f];u(m)}else u(d)}return n}};function o(t,e){var i=Element.prototype,n=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector;return n.call(t,e)}i.createElement=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return r(t).apply(void 0,[e].concat(i))},i.div=r(\"div\"),i.span=r(\"span\"),i.link=r(\"link\"),i.style=r(\"style\"),i.a=r(\"a\"),i.p=r(\"p\"),i.i=r(\"i\"),i.pre=r(\"pre\"),i.button=r(\"button\"),i.label=r(\"label\"),i.input=r(\"input\"),i.select=r(\"select\"),i.option=r(\"option\"),i.optgroup=r(\"optgroup\"),i.textarea=r(\"textarea\"),i.canvas=r(\"canvas\"),i.ul=r(\"ul\"),i.ol=r(\"ol\"),i.li=r(\"li\"),i.nbsp=document.createTextNode(\" \"),i.removeElement=function(t){var e=t.parentNode;null!=e&&e.removeChild(t)},i.replaceWith=function(t,e){var i=t.parentNode;null!=i&&i.replaceChild(e,t)},i.prepend=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=t.firstChild,r=0,o=e;r<o.length;r++){var s=o[r];t.insertBefore(s,n)}},i.empty=function(t){for(var e;e=t.firstChild;)t.removeChild(e)},i.show=function(t){t.style.display=\"\"},i.hide=function(t){t.style.display=\"none\"},i.position=function(t){return{top:t.offsetTop,left:t.offsetLeft}},i.offset=function(t){var e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset-document.documentElement.clientTop,left:e.left+window.pageXOffset-document.documentElement.clientLeft}},i.matches=o,i.parent=function(t,e){for(var i=t;i=i.parentElement;)if(o(i,e))return i;return null},i.margin=function(t){var e=getComputedStyle(t);return{top:parseFloat(e.marginTop)||0,bottom:parseFloat(e.marginBottom)||0,left:parseFloat(e.marginLeft)||0,right:parseFloat(e.marginRight)||0}},i.padding=function(t){var e=getComputedStyle(t);return{top:parseFloat(e.paddingTop)||0,bottom:parseFloat(e.paddingBottom)||0,left:parseFloat(e.paddingLeft)||0,right:parseFloat(e.paddingRight)||0}},(n=i.Keys||(i.Keys={}))[n.Backspace=8]=\"Backspace\",n[n.Tab=9]=\"Tab\",n[n.Enter=13]=\"Enter\",n[n.Esc=27]=\"Esc\",n[n.PageUp=33]=\"PageUp\",n[n.PageDown=34]=\"PageDown\",n[n.Left=37]=\"Left\",n[n.Up=38]=\"Up\",n[n.Right=39]=\"Right\",n[n.Down=40]=\"Down\",n[n.Delete=46]=\"Delete\"},function(t,e,i){var n=t(387),r=t(48),o=t(5),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this._has_finished=!1,this.el=this._createElement()},t.prototype.remove=function(){o.removeElement(this.el),e.prototype.remove.call(this)},t.prototype.css_classes=function(){return[]},t.prototype.cursor=function(t,e){return null},t.prototype.layout=function(){},t.prototype.render=function(){},t.prototype.renderTo=function(t){t.appendChild(this.el),this.layout()},t.prototype.has_finished=function(){return this._has_finished},Object.defineProperty(t.prototype,\"_root_element\",{get:function(){return o.parent(this.el,\".bk-root\")||document.body},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"solver\",{get:function(){return this.is_root?this._solver:this.parent.solver},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"is_idle\",{get:function(){return this.has_finished()},enumerable:!0,configurable:!0}),t.prototype._createElement=function(){return o.createElement(this.tagName,{id:this.id,class:this.css_classes()})},t}(r.View);(i.DOMView=s).prototype.tagName=\"div\"},function(t,e,i){i.AngleUnits=[\"deg\",\"rad\"],i.Dimension=[\"width\",\"height\"],i.Dimensions=[\"width\",\"height\",\"both\"],i.Direction=[\"clock\",\"anticlock\"],i.FontStyle=[\"normal\",\"italic\",\"bold\"],i.LatLon=[\"lat\",\"lon\"],i.LineCap=[\"butt\",\"round\",\"square\"],i.LineJoin=[\"miter\",\"round\",\"bevel\"],i.Location=[\"above\",\"below\",\"left\",\"right\"],i.LegendClickPolicy=[\"none\",\"hide\",\"mute\"],i.LegendLocation=[\"top_left\",\"top_center\",\"top_right\",\"center_left\",\"center\",\"center_right\",\"bottom_left\",\"bottom_center\",\"bottom_right\"],i.Anchor=i.LegendLocation,i.Orientation=[\"vertical\",\"horizontal\"],i.OutputBackend=[\"canvas\",\"svg\",\"webgl\"],i.RenderLevel=[\"image\",\"underlay\",\"glyph\",\"annotation\",\"overlay\"],i.RenderMode=[\"canvas\",\"css\"],i.Side=[\"above\",\"below\",\"left\",\"right\"],i.Place=[\"above\",\"below\",\"left\",\"right\",\"center\"],i.SpatialUnits=[\"screen\",\"data\"],i.StartEnd=[\"start\",\"end\"],i.VerticalAlign=[\"top\",\"middle\",\"bottom\"],i.TextAlign=[\"left\",\"right\",\"center\"],i.TextBaseline=[\"top\",\"middle\",\"bottom\",\"alphabetic\",\"hanging\",\"ideographic\"],i.TickLabelOrientation=[\"vertical\",\"horizontal\",\"parallel\",\"normal\"],i.TooltipAttachment=[\"horizontal\",\"vertical\",\"left\",\"right\",\"above\",\"below\"],i.Distribution=[\"uniform\",\"normal\"],i.StepMode=[\"after\",\"before\",\"center\"],i.SizingMode=[\"stretch_both\",\"scale_width\",\"scale_height\",\"scale_both\",\"fixed\"],i.PaddingUnits=[\"percent\",\"absolute\"],i.SliderCallbackPolicy=[\"continuous\",\"throttle\",\"mouseup\"],i.RoundingFunction=[\"round\",\"nearest\",\"floor\",\"rounddown\",\"ceil\",\"roundup\"],i.UpdateMode=[\"replace\",\"append\"],i.HTTPMethod=[\"POST\",\"GET\"],i.Logo=[\"normal\",\"grey\"]},function(t,e,i){var o=t(387),l=t(19),n=t(16),h=t(34),r=t(15),c=t(38),s=t(21),_=t(32),p=t(44),d=t(30),a=function(a){function u(t){void 0===t&&(t={});var e=a.call(this)||this;for(var i in e._subtype=void 0,e.document=null,e.destroyed=new l.Signal0(e,\"destroyed\"),e.change=new l.Signal0(e,\"change\"),e.transformchange=new l.Signal0(e,\"transformchange\"),e.attributes={},e.properties={},e._set_after_defaults={},e._pending=!1,e._changing=!1,e.props){var n=e.props[i],r=n.type,o=n.default_value;if(null==r)throw new Error(\"undefined property type for \"+e.type+\".\"+i);e.properties[i]=new r(e,i,o)}null==t.id&&e.setv({id:c.uniqueId()},{silent:!0});var s=t.__deferred__||!1;return s&&delete(t=_.clone(t)).__deferred__,e.setv(t,{silent:!0}),s||e.finalize(),e}return o.__extends(u,a),u.initClass=function(){this.prototype.type=\"HasProps\",this.prototype.props={},this.prototype.mixins=[],this.define({id:[r.Any]})},u._fix_default=function(t,e){return void 0===t?void 0:p.isFunction(t)?t:p.isObject(t)?p.isArray(t)?function(){return s.copy(t)}:function(){return _.clone(t)}:function(){return t}},u.define=function(a){var t=function(i){var t=a[i];if(null!=l.prototype.props[i])throw new Error(\"attempted to redefine property '\"+l.prototype.type+\".\"+i+\"'\");if(null!=l.prototype[i])throw new Error(\"attempted to redefine attribute '\"+l.prototype.type+\".\"+i+\"'\");Object.defineProperty(l.prototype,i,{get:function(){var t=this.getv(i);return t},set:function(t){var e;return this.setv(((e={})[i]=t,e)),this},configurable:!1,enumerable:!0});var e=t[0],n=t[1],r=t[2],o={type:e,default_value:l._fix_default(n,i),internal:r||!1},s=_.clone(l.prototype.props);s[i]=o,l.prototype.props=s},l=this;for(var e in a)t(e)},u.internal=function(t){var e={};for(var i in t){var n=t[i],r=n[0],o=n[1];e[i]=[r,o,!0]}this.define(e)},u.mixin=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.define(n.create(t));var i=this.prototype.mixins.concat(t);this.prototype.mixins=i},u.mixins=function(t){this.mixin.apply(this,t)},u.override=function(t){for(var e in t){var i=this._fix_default(t[e],e),n=this.prototype.props[e];if(null==n)throw new Error(\"attempted to override nonexistent '\"+this.prototype.type+\".\"+e+\"'\");var r=_.clone(this.prototype.props);r[e]=o.__assign({},n,{default_value:i}),this.prototype.props=r}},u.prototype.toString=function(){return this.type+\"(\"+this.id+\")\"},u.prototype.finalize=function(){var t=this;for(var e in this.properties){var i=this.properties[e];i.update(),null!=i.spec.transform&&this.connect(i.spec.transform.change,function(){return t.transformchange.emit()})}this.initialize(),this.connect_signals()},u.prototype.initialize=function(){},u.prototype.connect_signals=function(){},u.prototype.disconnect_signals=function(){l.Signal.disconnectReceiver(this)},u.prototype.destroy=function(){this.disconnect_signals(),this.destroyed.emit()},u.prototype.clone=function(){return new this.constructor(this.attributes)},u.prototype._setv=function(t,e){var i=e.check_eq,n=e.silent,r=[],o=this._changing;this._changing=!0;var s=this.attributes;for(var a in t){var l=t[a];!1!==i&&d.isEqual(s[a],l)||r.push(a),s[a]=l}if(!n){0<r.length&&(this._pending=!0);for(var h=0;h<r.length;h++)this.properties[r[h]].change.emit()}if(!o){if(!n&&!e.no_change)for(;this._pending;)this._pending=!1,this.change.emit();this._pending=!1,this._changing=!1}},u.prototype.setv=function(t,e){for(var i in void 0===e&&(e={}),t)if(t.hasOwnProperty(i)){var n=i;if(null==this.props[n])throw new Error(\"property \"+this.type+\".\"+n+\" wasn't declared\");null!=e&&e.defaults||(this._set_after_defaults[i]=!0)}if(!_.isEmpty(t)){var r={};for(var i in t)r[i]=this.getv(i);this._setv(t,e);var o=e.silent;if(null==o||!o)for(var i in t)this._tell_document_about_change(i,r[i],this.getv(i),e)}},u.prototype.getv=function(t){if(null==this.props[t])throw new Error(\"property \"+this.type+\".\"+t+\" wasn't declared\");return this.attributes[t]},u.prototype.ref=function(){return h.create_ref(this)},u.prototype.set_subtype=function(t){this._subtype=t},u.prototype.attribute_is_serializable=function(t){var e=this.props[t];if(null==e)throw new Error(this.type+\".attribute_is_serializable('\"+t+\"'): \"+t+\" wasn't declared\");return!e.internal},u.prototype.serializable_attributes=function(){var t={};for(var e in this.attributes){var i=this.attributes[e];this.attribute_is_serializable(e)&&(t[e]=i)}return t},u._value_to_json=function(t,e,i){if(e instanceof u)return e.ref();if(p.isArray(e)){for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(u._value_to_json(r.toString(),o,e))}return n}if(p.isObject(e)){var s={};for(var a in e)e.hasOwnProperty(a)&&(s[a]=u._value_to_json(a,e[a],e));return s}return e},u.prototype.attributes_as_json=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=u._value_to_json);var i=this.serializable_attributes(),n={};for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];t?n[r]=o:r in this._set_after_defaults&&(n[r]=o)}return e(\"attributes\",n,this)},u._json_record_references=function(t,e,i,n){if(null==e);else if(h.is_ref(e)){if(!(e.id in i)){var r=t.get_model_by_id(e.id);u._value_record_references(r,i,n)}}else if(p.isArray(e))for(var o=0,s=e;o<s.length;o++){var a=s[o];u._json_record_references(t,a,i,n)}else if(p.isObject(e))for(var l in e)if(e.hasOwnProperty(l)){var a=e[l];u._json_record_references(t,a,i,n)}},u._value_record_references=function(t,e,i){if(null==t);else if(t instanceof u){if(!(t.id in e)&&(e[t.id]=t,i))for(var n=t._immediate_references(),r=0,o=n;r<o.length;r++){var s=o[r];u._value_record_references(s,e,!0)}}else if(t.buffer instanceof ArrayBuffer);else if(p.isArray(t))for(var a=0,l=t;a<l.length;a++){var h=l[a];u._value_record_references(h,e,i)}else if(p.isObject(t))for(var c in t)if(t.hasOwnProperty(c)){var h=t[c];u._value_record_references(h,e,i)}},u.prototype._immediate_references=function(){var t={},e=this.serializable_attributes();for(var i in e){var n=e[i];u._value_record_references(n,t,!1)}return _.values(t)},u.prototype.references=function(){var t={};return u._value_record_references(this,t,!0),_.values(t)},u.prototype._doc_attached=function(){},u.prototype.attach_document=function(t){if(null!=this.document&&this.document!=t)throw new Error(\"models must be owned by only a single document\");this.document=t,this._doc_attached()},u.prototype.detach_document=function(){this.document=null},u.prototype._tell_document_about_change=function(t,e,i,n){if(this.attribute_is_serializable(t)&&null!=this.document){var r={};u._value_record_references(i,r,!1);var o={};u._value_record_references(e,o,!1);var s=!1;for(var a in r)if(!(a in o)){s=!0;break}if(!s)for(var l in o)if(!(l in r)){s=!0;break}s&&this.document._invalidate_all_models(),this.document._notify_change(this,t,e,i,n)}},u.prototype.materialize_dataspecs=function(t){var e={};for(var i in this.properties){var n=this.properties[i];n.dataspec&&(!n.optional||null!=n.spec.value||i in this._set_after_defaults)&&(e[\"_\"+i]=n.array(t),null!=n.spec.field&&n.spec.field in t._shapes&&(e[\"_\"+i+\"_shape\"]=t._shapes[n.spec.field]),n instanceof r.Distance&&(e[\"max_\"+i]=s.max(e[\"_\"+i])))}return e},u}(l.Signalable());(i.HasProps=a).initClass()},function(t,e,i){var n=t(21),r=t(187);function o(t){return t*t}function s(t,e){return o(t.x-e.x)+o(t.y-e.y)}function a(t,e,i){var n=s(e,i);if(0==n)return s(t,e);var r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;if(r<0)return s(t,e);if(1<r)return s(t,i);var o={x:e.x+r*(i.x-e.x),y:e.y+r*(i.y-e.y)};return s(t,o)}i.point_in_poly=function(t,e,i,n){for(var r=!1,o=i[i.length-1],s=n[n.length-1],a=0;a<i.length;a++){var l=i[a],h=n[a];s<e!=h<e&&o+(e-s)/(h-s)*(l-o)<t&&(r=!r),o=l,s=h}return r},i.create_empty_hit_test_result=function(){return new r.Selection},i.create_hit_test_result_from_hits=function(t){var e=new r.Selection;return e.indices=n.sortBy(t,function(t){return t[0],t[1]}).map(function(t){var e=t[0];return t[1],e}),e},i.validate_bbox_coords=function(t,e){var i,n,r=t[0],o=t[1],s=e[0],a=e[1];return o<r&&(r=(i=[o,r])[0],o=i[1]),a<s&&(s=(n=[a,s])[0],a=n[1]),{minX:r,minY:s,maxX:o,maxY:a}},i.dist_2_pts=s,i.dist_to_segment_squared=a,i.dist_to_segment=function(t,e,i){return Math.sqrt(a(t,e,i))},i.check_2_segments_intersect=function(t,e,i,n,r,o,s,a){var l=(a-o)*(i-t)-(s-r)*(n-e);if(0==l)return{hit:!1,x:null,y:null};var h=e-o,c=t-r,u=(s-r)*h-(a-o)*c,_=(i-t)*h-(n-e)*c;c=_/l;var p=t+(h=u/l)*(i-t),d=e+h*(n-e);return{hit:0<h&&h<1&&0<c&&c<1,x:p,y:d}}},function(t,e,i){var s=t(13),a=t(21);i.vstack=function(t,e){var i=[];if(0<e.length){i.push(s.EQ(a.head(e)._bottom,[-1,t._bottom])),i.push(s.EQ(a.tail(e)._top,[-1,t._top])),i.push.apply(i,a.pairwise(e,function(t,e){return s.EQ(t._top,[-1,e._bottom])}));for(var n=0,r=e;n<r.length;n++){var o=r[n];i.push(s.EQ(o._left,[-1,t._left])),i.push(s.EQ(o._right,[-1,t._right]))}}return i},i.hstack=function(t,e){var i=[];if(0<e.length){i.push(s.EQ(a.head(e)._right,[-1,t._right])),i.push(s.EQ(a.tail(e)._left,[-1,t._left])),i.push.apply(i,a.pairwise(e,function(t,e){return s.EQ(t._left,[-1,e._right])}));for(var n=0,r=e;n<r.length;n++){var o=r[n];i.push(s.EQ(o._top,[-1,t._top])),i.push(s.EQ(o._bottom,[-1,t._bottom]))}}return i}},function(t,e,i){var n=t(387),r=t(13),o=t(8),s=t(24),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LayoutCanvas\"},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._top=new r.Variable(this.toString()+\".top\"),this._left=new r.Variable(this.toString()+\".left\"),this._width=new r.Variable(this.toString()+\".width\"),this._height=new r.Variable(this.toString()+\".height\"),this._right=new r.Variable(this.toString()+\".right\"),this._bottom=new r.Variable(this.toString()+\".bottom\"),this._hcenter=new r.Variable(this.toString()+\".hcenter\"),this._vcenter=new r.Variable(this.toString()+\".vcenter\")},t.prototype.get_editables=function(){return[]},t.prototype.get_constraints=function(){return[r.GE(this._top),r.GE(this._bottom),r.GE(this._left),r.GE(this._right),r.GE(this._width),r.GE(this._height),r.EQ(this._left,this._width,[-1,this._right]),r.EQ(this._top,this._height,[-1,this._bottom]),r.EQ([2,this._hcenter],[-1,this._left],[-1,this._right]),r.EQ([2,this._vcenter],[-1,this._top],[-1,this._bottom])]},t.prototype.get_layoutable_children=function(){return[]},Object.defineProperty(t.prototype,\"bbox\",{get:function(){return new s.BBox({x0:this._left.value,y0:this._top.value,x1:this._right.value,y1:this._bottom.value})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"layout_bbox\",{get:function(){return{top:this._top.value,left:this._left.value,width:this._width.value,height:this._height.value,right:this._right.value,bottom:this._bottom.value,hcenter:this._hcenter.value,vcenter:this._vcenter.value}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"xview\",{get:function(){var r=this;return{compute:function(t){return r._left.value+t},v_compute:function(t){for(var e=new Float64Array(t.length),i=r._left.value,n=0;n<t.length;n++)e[n]=i+t[n];return e}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"yview\",{get:function(){var r=this;return{compute:function(t){return r._bottom.value-t},v_compute:function(t){for(var e=new Float64Array(t.length),i=r._bottom.value,n=0;n<t.length;n++)e[n]=i-t[n];return e}}},enumerable:!0,configurable:!0}),t}(o.HasProps);(i.LayoutCanvas=a).initClass()},function(t,e,r){var i=t(387),o=t(13),n=t(11),s=t(15),a=t(14),l=t(44),h=Math.PI/2,c=\"alphabetic\",u=\"middle\",_=\"hanging\",p=\"left\",d=\"right\",f=\"center\",v={above:{parallel:0,normal:-h,horizontal:0,vertical:-h},below:{parallel:0,normal:h,horizontal:0,vertical:h},left:{parallel:-h,normal:0,horizontal:0,vertical:-h},right:{parallel:h,normal:0,horizontal:0,vertical:h}},m={above:{justified:\"top\",parallel:c,normal:u,horizontal:c,vertical:u},below:{justified:\"bottom\",parallel:_,normal:u,horizontal:_,vertical:u},left:{justified:\"top\",parallel:c,normal:u,horizontal:u,vertical:c},right:{justified:\"top\",parallel:c,normal:u,horizontal:u,vertical:c}},g={above:{justified:f,parallel:f,normal:p,horizontal:f,vertical:p},below:{justified:f,parallel:f,normal:p,horizontal:f,vertical:p},left:{justified:f,parallel:f,normal:d,horizontal:d,vertical:f},right:{justified:f,parallel:f,normal:p,horizontal:p,vertical:f}},y={above:d,below:p,left:d,right:p},b={above:p,below:d,left:d,right:p};function x(t){return\"panel\"in t}r.isSizeable=x,r.isSizeableView=function(t){return x(t.model)&&\"get_size\"in t},r._view_sizes=new WeakMap,r._view_constraints=new WeakMap,r.update_panel_constraints=function(t){var e=t.solver,i=t.get_size(),n=r._view_constraints.get(t);if(null!=n&&e.has_constraint(n)){if(r._view_sizes.get(t)===i)return;e.remove_constraint(n)}n=o.GE(t.model.panel._size,-i),e.add_constraint(n),r._view_sizes.set(t,i),r._view_constraints.set(t,n)};var w=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"SidePanel\",this.internal({side:[s.String]})},t.prototype.toString=function(){return this.type+\"(\"+this.id+\", \"+this.side+\")\"},t.prototype.initialize=function(){switch(e.prototype.initialize.call(this),this.side){case\"above\":this._dim=0,this._normals=[0,-1],this._size=this._height;break;case\"below\":this._dim=0,this._normals=[0,1],this._size=this._height;break;case\"left\":this._dim=1,this._normals=[-1,0],this._size=this._width;break;case\"right\":this._dim=1,this._normals=[1,0],this._size=this._width;break;default:a.logger.error(\"unrecognized side: '\"+this.side+\"'\")}},Object.defineProperty(t.prototype,\"dimension\",{get:function(){return this._dim},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"normals\",{get:function(){return this._normals},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"is_horizontal\",{get:function(){return\"above\"==this.side||\"below\"==this.side},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"is_vertical\",{get:function(){return\"left\"==this.side||\"right\"==this.side},enumerable:!0,configurable:!0}),t.prototype.apply_label_text_heuristics=function(t,e){var i,n,r=this.side;l.isString(e)?(i=m[r][e],n=g[r][e]):0===e?n=i=\"whatever\":e<0?(i=\"middle\",n=y[r]):(i=\"middle\",n=b[r]),t.textBaseline=i,t.textAlign=n},t.prototype.get_label_angle_heuristic=function(t){return v[this.side][t]},t}(n.LayoutCanvas);(r.SidePanel=w).initClass()},function(t,e,i){var n=t(346);function r(i){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new n.Constraint(new(n.Expression.bind.apply(n.Expression,[void 0].concat(t))),i)}}function o(i){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new n.Constraint(new(n.Expression.bind.apply(n.Expression,[void 0].concat(t))),i,n.Strength.weak)}}i.Variable=n.Variable,i.Expression=n.Expression,i.Constraint=n.Constraint,i.Operator=n.Operator,i.Strength=n.Strength,i.EQ=r(n.Operator.Eq),i.LE=r(n.Operator.Le),i.GE=r(n.Operator.Ge),i.WEAK_EQ=o(n.Operator.Eq),i.WEAK_LE=o(n.Operator.Le),i.WEAK_GE=o(n.Operator.Ge);var s=function(){function t(){this.solver=new n.Solver}return t.prototype.clear=function(){this.solver=new n.Solver},t.prototype.toString=function(){return\"Solver(num_constraints=\"+this.num_constraints+\", num_editables=\"+this.num_editables+\")\"},Object.defineProperty(t.prototype,\"num_constraints\",{get:function(){return this.solver.numConstraints},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"num_editables\",{get:function(){return this.solver.numEditVariables},enumerable:!0,configurable:!0}),t.prototype.get_constraints=function(){return this.solver.getConstraints()},t.prototype.update_variables=function(){this.solver.updateVariables()},t.prototype.has_constraint=function(t){return this.solver.hasConstraint(t)},t.prototype.add_constraint=function(e){try{this.solver.addConstraint(e)}catch(t){throw new Error(t.message+\": \"+e.toString())}},t.prototype.remove_constraint=function(t){this.solver.removeConstraint(t)},t.prototype.add_edit_variable=function(t,e){this.solver.addEditVariable(t,e)},t.prototype.remove_edit_variable=function(t){this.solver.removeEditVariable(t)},t.prototype.suggest_value=function(t,e){this.solver.suggestValue(t,e)},t}();i.Solver=s},function(t,e,i){var o=t(44),n={},s=function(t,e){this.name=t,this.level=e};i.LogLevel=s;var r=function(){function r(t,e){void 0===e&&(e=r.INFO),this._name=t,this.set_level(e)}return Object.defineProperty(r,\"levels\",{get:function(){return Object.keys(r.log_levels)},enumerable:!0,configurable:!0}),r.get=function(t,e){if(void 0===e&&(e=r.INFO),0<t.length){var i=n[t];return null==i&&(n[t]=i=new r(t,e)),i}throw new TypeError(\"Logger.get() expects a non-empty string name and an optional log-level\")},Object.defineProperty(r.prototype,\"level\",{get:function(){return this.get_level()},enumerable:!0,configurable:!0}),r.prototype.get_level=function(){return this._log_level},r.prototype.set_level=function(t){if(t instanceof s)this._log_level=t;else{if(!o.isString(t)||null==r.log_levels[t])throw new Error(\"Logger.set_level() expects a log-level object or a string name of a log-level\");this._log_level=r.log_levels[t]}var e=\"[\"+this._name+\"]\";for(var i in r.log_levels){var n=r.log_levels[i];n.level<this._log_level.level||this._log_level.level===r.OFF.level?this[i]=function(){}:this[i]=a(i,e)}},r.prototype.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r.TRACE=new s(\"trace\",0),r.DEBUG=new s(\"debug\",1),r.INFO=new s(\"info\",2),r.WARN=new s(\"warn\",6),r.ERROR=new s(\"error\",7),r.FATAL=new s(\"fatal\",8),r.OFF=new s(\"off\",9),r.log_levels={trace:r.TRACE,debug:r.DEBUG,info:r.INFO,warn:r.WARN,error:r.ERROR,fatal:r.FATAL,off:r.OFF},r}();function a(t,e){return null!=console[t]?console[t].bind(console,e):null!=console.log?console.log.bind(console,e):function(){}}i.Logger=r,i.logger=r.get(\"bokeh\"),i.set_log_level=function(t){null==r.log_levels[t]?(console.log(\"[bokeh] unrecognized logging level '\"+t+\"' passed to Bokeh.set_log_level(), ignoring\"),console.log(\"[bokeh] valid log levels are: \"+r.levels.join(\", \"))):(console.log(\"[bokeh] setting log level to: '\"+t+\"'\"),i.logger.set_level(t))}},function(t,e,i){var o=t(387),s=t(19),n=t(8),r=t(7),a=t(39),l=t(27),h=t(21),c=t(22),u=t(44);function _(e){try{return JSON.stringify(e)}catch(t){return e.toString()}}function p(t){return!(t instanceof n.HasProps)&&u.isObject(t)&&(void 0===t.value?0:1)+(void 0===t.field?0:1)+(void 0===t.expr?0:1)==1}s.Signal,i.isSpec=p;var d=function(r){function t(t,e,i){var n=r.call(this)||this;return n.obj=t,n.attr=e,n.default_value=i,n.optional=!1,n.obj=t,n.attr=e,n.default_value=i,n.change=new s.Signal0(n.obj,\"change\"),n._init(),n.connect(n.change,function(){return n._init()}),n}return o.__extends(t,r),t.prototype.update=function(){this._init()},t.prototype.init=function(){},t.prototype.transform=function(t){return t},t.prototype.validate=function(t){},t.prototype.value=function(t){if(void 0===t&&(t=!0),void 0===this.spec.value)throw new Error(\"attempted to retrieve property value for property without value specification\");var e=this.transform([this.spec.value])[0];return null!=this.spec.transform&&t&&(e=this.spec.transform.compute(e)),e},t.prototype.array=function(t){if(!this.dataspec)throw new Error(\"attempted to retrieve property array for non-dataspec property\");var e;if(null!=this.spec.field){if(null==(e=this.transform(t.get_column(this.spec.field))))throw new Error(\"attempted to retrieve property array for nonexistent field '\"+this.spec.field+\"'\")}else if(null!=this.spec.expr)e=this.transform(this.spec.expr.v_compute(t));else{var i=t.get_length();null==i&&(i=1);var n=this.value(!1);e=h.repeat(n,i)}return null!=this.spec.transform&&(e=this.spec.transform.v_compute(e)),e},t.prototype._init=function(){var t,e=this.obj,i=this.attr,n=e.getv(i);if(void 0===n){var r=this.default_value;n=void 0!==r?r(e):null,e.setv(((t={})[i]=n,t),{silent:!0,defaults:!0})}if(u.isArray(n)?this.spec={value:n}:p(n)?this.spec=n:this.spec={value:n},null!=this.spec.field&&!u.isString(this.spec.field))throw new Error(\"field value for property '\"+i+\"' is not a string\");null!=this.spec.value&&this.validate(this.spec.value),this.init()},t.prototype.toString=function(){return\"Prop(\"+this.obj+\".\"+this.attr+\", spec: \"+_(this.spec)+\")\"},t}(s.Signalable());function f(i,n){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.validate=function(t){if(!n(t))throw new Error(i+\" property '\"+this.attr+\"' given invalid value: \"+_(t))},e}(d)}(i.Property=d).prototype.dataspec=!1;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}((i.simple_prop=f)(\"Any\",function(t){return!0}));i.Any=v;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"Array\",function(t){return u.isArray(t)||t instanceof Float64Array}));i.Array=m;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"Bool\",u.isBoolean));i.Bool=g,i.Boolean=g;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"Color\",function(t){return a.is_svg_color(t.toLowerCase())||\"#\"==t.substring(0,1)||l.valid_rgb(t)}));i.Color=y;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"Instance\",function(t){return null!=t.properties}));i.Instance=b;var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"Number\",function(t){return u.isNumber(t)||u.isBoolean(t)}));i.Number=x,i.Int=x;var w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"Number\",function(t){return(u.isNumber(t)||u.isBoolean(t))&&0<=t&&t<=1}));i.Percent=w;var k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(\"String\",u.isString)),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(i.String=k);function T(t,e){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(f(t,function(t){return h.includes(e,t)}))}i.Font=S;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}((i.enum_prop=T)(\"Anchor\",r.LegendLocation));i.Anchor=C;var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"AngleUnits\",r.AngleUnits));i.AngleUnits=A;var E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.transform=function(t){for(var e=new Uint8Array(t.length),i=0;i<t.length;i++)switch(t[i]){case\"clock\":e[i]=0;break;case\"anticlock\":e[i]=1}return e},e}(T(\"Direction\",r.Direction));i.Direction=E;var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"Dimension\",r.Dimension));i.Dimension=M;var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"Dimensions\",r.Dimensions));i.Dimensions=O;var z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"FontStyle\",r.FontStyle));i.FontStyle=z;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"LatLon\",r.LatLon));i.LatLon=P;var j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"LineCap\",r.LineCap));i.LineCap=j;var N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"LineJoin\",r.LineJoin));i.LineJoin=N;var F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"LegendLocation\",r.LegendLocation));i.LegendLocation=F;var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"Location\",r.Location));i.Location=D;var I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"OutputBackend\",r.OutputBackend));i.OutputBackend=I;var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"Orientation\",r.Orientation));i.Orientation=R;var B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"VerticalAlign\",r.VerticalAlign));i.VerticalAlign=B;var L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"TextAlign\",r.TextAlign));i.TextAlign=L;var V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"TextBaseline\",r.TextBaseline));i.TextBaseline=V;var G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"RenderLevel\",r.RenderLevel));i.RenderLevel=G;var U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"RenderMode\",r.RenderMode));i.RenderMode=U;var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"SizingMode\",r.SizingMode));i.SizingMode=q;var Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"SpatialUnits\",r.SpatialUnits));i.SpatialUnits=Y;var X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"Distribution\",r.Distribution));i.Distribution=X;var H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"StepMode\",r.StepMode));i.StepMode=H;var W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"PaddingUnits\",r.PaddingUnits));i.PaddingUnits=W;var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(T(\"StartEnd\",r.StartEnd));function Q(i,n,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.init=function(){null==this.spec.units&&(this.spec.units=r);var t=this.spec.units;if(!h.includes(n,t))throw new Error(i+\" units must be one of \"+n+\", given invalid value: \"+t)},Object.defineProperty(e.prototype,\"units\",{get:function(){return this.spec.units},set:function(t){this.spec.units=t},enumerable:!0,configurable:!0}),e}(x)}i.StartEnd=J;var $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.transform=function(t){return\"deg\"==this.spec.units&&(t=c.map(t,function(t){return t*Math.PI/180})),t=c.map(t,function(t){return-t}),e.prototype.transform.call(this,t)},t}((i.units_prop=Q)(\"Angle\",r.AngleUnits,\"rad\"));i.Angle=$;var K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(Q(\"Distance\",r.SpatialUnits,\"data\"));i.Distance=K;var Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}($);(i.AngleSpec=Z).prototype.dataspec=!0;var tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(y);(i.ColorSpec=tt).prototype.dataspec=!0;var et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(K);(i.DistanceSpec=et).prototype.dataspec=!0;var it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(k);(i.FontSizeSpec=it).prototype.dataspec=!0;var nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(x);(i.NumberSpec=nt).prototype.dataspec=!0;var rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}(k);(i.StringSpec=rt).prototype.dataspec=!0},function(t,e,h){var i=t(15),c=t(32);function n(t,e){var i={};for(var n in t){var r=t[n];i[e+n]=r}return i}var r={line_color:[i.ColorSpec,\"black\"],line_width:[i.NumberSpec,1],line_alpha:[i.NumberSpec,1],line_join:[i.LineJoin,\"bevel\"],line_cap:[i.LineCap,\"butt\"],line_dash:[i.Array,[]],line_dash_offset:[i.Number,0]};h.line=function(t){return void 0===t&&(t=\"\"),n(r,t)};var o={fill_color:[i.ColorSpec,\"gray\"],fill_alpha:[i.NumberSpec,1]};h.fill=function(t){return void 0===t&&(t=\"\"),n(o,t)};var s={text_font:[i.Font,\"helvetica\"],text_font_size:[i.FontSizeSpec,\"12pt\"],text_font_style:[i.FontStyle,\"normal\"],text_color:[i.ColorSpec,\"#444444\"],text_alpha:[i.NumberSpec,1],text_align:[i.TextAlign,\"left\"],text_baseline:[i.TextBaseline,\"bottom\"],text_line_height:[i.Number,1.2]};h.text=function(t){return void 0===t&&(t=\"\"),n(s,t)},h.create=function(t){for(var e={},i=0,n=t;i<n.length;i++){var r=n[i],o=r.split(\":\"),s=o[0],a=o[1],l=void 0;switch(s){case\"line\":l=h.line;break;case\"fill\":l=h.fill;break;case\"text\":l=h.text;break;default:throw new Error(\"Unknown property mixin kind '\"+s+\"'\")}c.extend(e,l(a))}return e}},function(t,e,i){var n=t(387),r=t(8),o=t(187),p=t(175),d=t(176),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.initClass=function(){this.prototype.type=\"SelectionManager\",this.internal({source:[s.Any]})},e.prototype.initialize=function(){t.prototype.initialize.call(this),this.inspectors={}},e.prototype.select=function(t,e,i,n){void 0===n&&(n=!1);for(var r=[],o=[],s=0,a=t;s<a.length;s++){var l=a[s];l instanceof p.GlyphRendererView?r.push(l):l instanceof d.GraphRendererView&&o.push(l)}for(var h=!1,c=0,u=o;c<u.length;c++){var l=u[c],_=l.model.selection_policy.hit_test(e,l);h=h||l.model.selection_policy.do_selection(_,l.model,i,n)}if(0<r.length){var _=this.source.selection_policy.hit_test(e,r);h=h||this.source.selection_policy.do_selection(_,this.source,i,n)}return h},e.prototype.inspect=function(t,e){var i=!1;if(t instanceof p.GlyphRendererView){var n=t.hit_test(e);if(null!=n){i=!n.is_empty();var r=this.get_or_create_inspector(t.model);r.update(n,!0,!1),this.source.setv({inspected:r},{silent:!0}),this.source.inspect.emit([t,{geometry:e}])}}else if(t instanceof d.GraphRendererView){var n=t.model.inspection_policy.hit_test(e,t);i=i||t.model.inspection_policy.do_inspection(n,e,t,!1,!1)}return i},e.prototype.clear=function(t){this.source.selected.clear(),null!=t&&this.get_or_create_inspector(t.model).clear()},e.prototype.get_or_create_inspector=function(t){return null==this.inspectors[t.id]&&(this.inspectors[t.id]=new o.Selection),this.inspectors[t.id]},e}(r.HasProps);(i.SelectionManager=a).initClass()},function(t,e,i){var n=function(){function t(){this._dev=!1}return Object.defineProperty(t.prototype,\"dev\",{get:function(){return this._dev},set:function(t){this._dev=t},enumerable:!0,configurable:!0}),t}();i.Settings=n,i.settings=new n},function(t,e,i){var n,r=t(387),o=t(25),s=t(21),a=function(){function t(t,e){this.sender=t,this.name=e}return t.prototype.connect=function(t,e){void 0===e&&(e=null),h.has(this.sender)||h.set(this.sender,[]);var i=h.get(this.sender);if(null!=u(i,this,t,e))return!1;var n=e||t;c.has(n)||c.set(n,[]);var r=c.get(n),o={signal:this,slot:t,context:e};return i.push(o),r.push(o),!0},t.prototype.disconnect=function(t,e){void 0===e&&(e=null);var i=h.get(this.sender);if(null==i||0===i.length)return!1;var n=u(i,this,t,e);if(null==n)return!1;var r=e||t,o=c.get(r);return n.signal=null,p(i),p(o),!0},t.prototype.emit=function(t){for(var e=h.get(this.sender)||[],i=0,n=e;i<n.length;i++){var r=n[i],o=r.signal,s=r.slot,a=r.context;o===this&&s.call(a,t,this.sender)}},t}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.emit=function(){t.prototype.emit.call(this,void 0)},e}(i.Signal=a);i.Signal0=l,(n=a=i.Signal||(i.Signal={})).disconnectBetween=function(t,e){var i=h.get(t);if(null!=i&&0!==i.length){var n=c.get(e);if(null!=n&&0!==n.length){for(var r=0,o=n;r<o.length;r++){var s=o[r];if(null==s.signal)return;s.signal.sender===t&&(s.signal=null)}p(i),p(n)}}},n.disconnectSender=function(t){var e=h.get(t);if(null!=e&&0!==e.length){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(null==r.signal)return;var o=r.context||r.slot;r.signal=null,p(c.get(o))}p(e)}},n.disconnectReceiver=function(t){var e=c.get(t);if(null!=e&&0!==e.length){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(null==r.signal)return;var o=r.signal.sender;r.signal=null,p(h.get(o))}p(e)}},n.disconnectAll=function(t){var e=h.get(t);if(null!=e&&0!==e.length){for(var i=0,n=e;i<n.length;i++){var r=n[i];r.signal=null}p(e)}var o=c.get(t);if(null!=o&&0!==o.length){for(var s=0,a=o;s<a.length;s++){var r=a[s];r.signal=null}p(o)}},i.Signal=a,i.Signalable=function(t){return null!=t?function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.connect=function(t,e){return t.connect(e,this)},e}(t):function(){function t(){}return t.prototype.connect=function(t,e){return t.connect(e,this)},t}()},(i._Signalable||(i._Signalable={})).connect=function(t,e){return t.connect(e,this)};var h=new WeakMap,c=new WeakMap;function u(t,e,i,n){return s.find(t,function(t){return t.signal===e&&t.slot===i&&t.context===n})}var _=new Set;function p(t){0===_.size&&o.defer(d),_.add(t)}function d(){_.forEach(function(t){s.removeBy(t,function(t){return null==t.signal})}),_.clear()}},function(t,e,p){var i=t(387),r=t(343),o=t(19),a=t(14),l=t(5),n=t(45),h=t(21),d=t(32),s=t(44),c=t(3);p.is_mobile=\"ontouchstart\"in window||0<navigator.maxTouchPoints;var u=function(){function t(t,e,i,n){this.plot_view=t,this.toolbar=e,this.hit_area=i,this.plot=n,this.pan_start=new o.Signal(this,\"pan:start\"),this.pan=new o.Signal(this,\"pan\"),this.pan_end=new o.Signal(this,\"pan:end\"),this.pinch_start=new o.Signal(this,\"pinch:start\"),this.pinch=new o.Signal(this,\"pinch\"),this.pinch_end=new o.Signal(this,\"pinch:end\"),this.rotate_start=new o.Signal(this,\"rotate:start\"),this.rotate=new o.Signal(this,\"rotate\"),this.rotate_end=new o.Signal(this,\"rotate:end\"),this.tap=new o.Signal(this,\"tap\"),this.doubletap=new o.Signal(this,\"doubletap\"),this.press=new o.Signal(this,\"press\"),this.move_enter=new o.Signal(this,\"move:enter\"),this.move=new o.Signal(this,\"move\"),this.move_exit=new o.Signal(this,\"move:exit\"),this.scroll=new o.Signal(this,\"scroll\"),this.keydown=new o.Signal(this,\"keydown\"),this.keyup=new o.Signal(this,\"keyup\"),this.hammer=new r(this.hit_area),this._configure_hammerjs()}return t.prototype._configure_hammerjs=function(){var e=this;this.hammer.get(\"doubletap\").recognizeWith(\"tap\"),this.hammer.get(\"tap\").requireFailure(\"doubletap\"),this.hammer.get(\"doubletap\").dropRequireFailure(\"tap\"),this.hammer.on(\"doubletap\",function(t){return e._doubletap(t)}),this.hammer.on(\"tap\",function(t){return e._tap(t)}),this.hammer.on(\"press\",function(t){return e._press(t)}),this.hammer.get(\"pan\").set({direction:r.DIRECTION_ALL}),this.hammer.on(\"panstart\",function(t){return e._pan_start(t)}),this.hammer.on(\"pan\",function(t){return e._pan(t)}),this.hammer.on(\"panend\",function(t){return e._pan_end(t)}),this.hammer.get(\"pinch\").set({enable:!0}),this.hammer.on(\"pinchstart\",function(t){return e._pinch_start(t)}),this.hammer.on(\"pinch\",function(t){return e._pinch(t)}),this.hammer.on(\"pinchend\",function(t){return e._pinch_end(t)}),this.hammer.get(\"rotate\").set({enable:!0}),this.hammer.on(\"rotatestart\",function(t){return e._rotate_start(t)}),this.hammer.on(\"rotate\",function(t){return e._rotate(t)}),this.hammer.on(\"rotateend\",function(t){return e._rotate_end(t)}),this.hit_area.addEventListener(\"mousemove\",function(t){return e._mouse_move(t)}),this.hit_area.addEventListener(\"mouseenter\",function(t){return e._mouse_enter(t)}),this.hit_area.addEventListener(\"mouseleave\",function(t){return e._mouse_exit(t)}),this.hit_area.addEventListener(\"wheel\",function(t){return e._mouse_wheel(t)}),document.addEventListener(\"keydown\",function(t){return e._key_down(t)}),document.addEventListener(\"keyup\",function(t){return e._key_up(t)})},t.prototype.register_tool=function(i){var n=this,t=i.model.event_type;null!=t&&(s.isString(t)?this._register_tool(i,t):t.forEach(function(t,e){return n._register_tool(i,t,e<1)}))},t.prototype._register_tool=function(t,e,i){void 0===i&&(i=!0);var n=t,r=n.model.id,o=function(e){return function(t){t.id==r&&e(t.e)}},s=function(e){return function(t){e(t.e)}};switch(e){case\"pan\":null!=n._pan_start&&n.connect(this.pan_start,o(n._pan_start.bind(n))),null!=n._pan&&n.connect(this.pan,o(n._pan.bind(n))),null!=n._pan_end&&n.connect(this.pan_end,o(n._pan_end.bind(n)));break;case\"pinch\":null!=n._pinch_start&&n.connect(this.pinch_start,o(n._pinch_start.bind(n))),null!=n._pinch&&n.connect(this.pinch,o(n._pinch.bind(n))),null!=n._pinch_end&&n.connect(this.pinch_end,o(n._pinch_end.bind(n)));break;case\"rotate\":null!=n._rotate_start&&n.connect(this.rotate_start,o(n._rotate_start.bind(n))),null!=n._rotate&&n.connect(this.rotate,o(n._rotate.bind(n))),null!=n._rotate_end&&n.connect(this.rotate_end,o(n._rotate_end.bind(n)));break;case\"move\":null!=n._move_enter&&n.connect(this.move_enter,o(n._move_enter.bind(n))),null!=n._move&&n.connect(this.move,o(n._move.bind(n))),null!=n._move_exit&&n.connect(this.move_exit,o(n._move_exit.bind(n)));break;case\"tap\":null!=n._tap&&n.connect(this.tap,o(n._tap.bind(n)));break;case\"press\":null!=n._press&&n.connect(this.press,o(n._press.bind(n)));break;case\"scroll\":null!=n._scroll&&n.connect(this.scroll,o(n._scroll.bind(n)));break;default:throw new Error(\"unsupported event_type: \"+e)}i&&(null!=n._doubletap&&n.connect(this.doubletap,s(n._doubletap.bind(n))),null!=n._keydown&&n.connect(this.keydown,s(n._keydown.bind(n))),null!=n._keyup&&n.connect(this.keyup,s(n._keyup.bind(n))),p.is_mobile&&null!=n._scroll&&\"pinch\"==e&&(a.logger.debug(\"Registering scroll on touch screen\"),n.connect(this.scroll,o(n._scroll.bind(n)))))},t.prototype._hit_test_renderers=function(t,e){for(var i=this.plot_view.get_renderer_views(),n=0,r=h.reversed(i);n<r.length;n++){var o=r[n],s=o.model.level;if((\"annotation\"==s||\"overlay\"==s)&&null!=o.interactive_hit&&o.interactive_hit(t,e))return o}return null},t.prototype._hit_test_frame=function(t,e){return this.plot_view.frame.bbox.contains(t,e)},t.prototype._trigger=function(e,i,t){var n=this,r=this.toolbar.gestures,o=e.name,s=o.split(\":\")[0],a=this._hit_test_renderers(i.sx,i.sy);switch(s){case\"move\":var l=r[s].active;null!=l&&this.trigger(e,i,l.id);var h=this.toolbar.inspectors.filter(function(t){return t.active}),c=\"default\";null!=a?(c=a.cursor(i.sx,i.sy)||c,d.isEmpty(h)||(e=this.move_exit,o=e.name)):this._hit_test_frame(i.sx,i.sy)&&(d.isEmpty(h)||(c=\"crosshair\")),this.plot_view.set_cursor(c),h.map(function(t){return n.trigger(e,i,t.id)});break;case\"tap\":var u=t.target;if(null!=u&&u!=this.hit_area)return;null!=a&&null!=a.on_hit&&a.on_hit(i.sx,i.sy);var l=r[s].active;null!=l&&this.trigger(e,i,l.id);break;case\"scroll\":var _=p.is_mobile?\"pinch\":\"scroll\",l=r[_].active;null!=l&&(t.preventDefault(),t.stopPropagation(),this.trigger(e,i,l.id));break;default:var l=r[s].active;null!=l&&this.trigger(e,i,l.id)}this._trigger_bokeh_event(i)},t.prototype.trigger=function(t,e,i){void 0===i&&(i=null),t.emit({id:i,e:e})},t.prototype._trigger_bokeh_event=function(t){var e=c.BokehEvent.event_class(t);null!=e?this.plot.trigger_event(e.from_event(t)):a.logger.debug(\"Unhandled event of type \"+t.type)},t.prototype._get_sxy=function(t){var e,i=(e=t,\"undefined\"!=typeof TouchEvent&&e instanceof TouchEvent?(0!=t.touches.length?t.touches:t.changedTouches)[0]:t),n=i.pageX,r=i.pageY,o=l.offset(this.hit_area),s=o.left,a=o.top;return{sx:n-s,sy:r-a}},t.prototype._gesture_event=function(t){return i.__assign({type:t.type},this._get_sxy(t.srcEvent),{deltaX:t.deltaX,deltaY:t.deltaY,scale:t.scale,shiftKey:t.srcEvent.shiftKey})},t.prototype._tap_event=function(t){return i.__assign({type:t.type},this._get_sxy(t.srcEvent),{shiftKey:t.srcEvent.shiftKey})},t.prototype._move_event=function(t){return i.__assign({type:t.type},this._get_sxy(t))},t.prototype._scroll_event=function(t){return i.__assign({type:t.type},this._get_sxy(t),{delta:n.getDeltaY(t)})},t.prototype._key_event=function(t){return{type:t.type,keyCode:t.keyCode}},t.prototype._pan_start=function(t){var e=this._gesture_event(t);e.sx-=t.deltaX,e.sy-=t.deltaY,this._trigger(this.pan_start,e,t.srcEvent)},t.prototype._pan=function(t){this._trigger(this.pan,this._gesture_event(t),t.srcEvent)},t.prototype._pan_end=function(t){this._trigger(this.pan_end,this._gesture_event(t),t.srcEvent)},t.prototype._pinch_start=function(t){this._trigger(this.pinch_start,this._gesture_event(t),t.srcEvent)},t.prototype._pinch=function(t){this._trigger(this.pinch,this._gesture_event(t),t.srcEvent)},t.prototype._pinch_end=function(t){this._trigger(this.pinch_end,this._gesture_event(t),t.srcEvent)},t.prototype._rotate_start=function(t){this._trigger(this.rotate_start,this._gesture_event(t),t.srcEvent)},t.prototype._rotate=function(t){this._trigger(this.rotate,this._gesture_event(t),t.srcEvent)},t.prototype._rotate_end=function(t){this._trigger(this.rotate_end,this._gesture_event(t),t.srcEvent)},t.prototype._tap=function(t){this._trigger(this.tap,this._tap_event(t),t.srcEvent)},t.prototype._doubletap=function(t){var e=this._tap_event(t);this._trigger_bokeh_event(e),this.trigger(this.doubletap,e)},t.prototype._press=function(t){this._trigger(this.press,this._tap_event(t),t.srcEvent)},t.prototype._mouse_enter=function(t){this._trigger(this.move_enter,this._move_event(t),t)},t.prototype._mouse_move=function(t){this._trigger(this.move,this._move_event(t),t)},t.prototype._mouse_exit=function(t){this._trigger(this.move_exit,this._move_event(t),t)},t.prototype._mouse_wheel=function(t){this._trigger(this.scroll,this._scroll_event(t),t)},t.prototype._key_down=function(t){this.trigger(this.keydown,this._key_event(t))},t.prototype._key_up=function(t){this.trigger(this.keyup,this._key_event(t))},t}();p.UIEvents=u},function(t,e,n){var o=t(31),c=t(23),i=t(22);n.min=i.min,n.minBy=i.minBy,n.max=i.max,n.maxBy=i.maxBy,n.sum=i.sum;var r=Array.prototype.slice;function s(t){var e;return(e=[]).concat.apply(e,t)}function u(t,e){return-1!==t.indexOf(e)}function a(t,e,i){void 0===i&&(i=1),c.assert(0<i,\"'step' must be a positive number\"),null==e&&(e=t,t=0);for(var n=Math.max,r=Math.ceil,o=Math.abs,s=t<=e?i:-i,a=n(r(o(e-t)/i),0),l=Array(a),h=0;h<a;h++,t+=s)l[h]=t;return l}function l(r){return function(t,e){for(var i=t.length,n=0<r?0:i-1;0<=n&&n<i;n+=r)if(e(t[n]))return n;return-1}}function h(t){for(var e=[],i=0,n=t;i<n.length;i++){var r=n[i];u(e,r)||e.push(r)}return e}n.head=function(t){return t[0]},n.tail=function(t){return t[t.length-1]},n.last=function(t){return t[t.length-1]},n.copy=function(t){return r.call(t)},n.concat=s,n.includes=u,n.contains=u,n.nth=function(t,e){return t[0<=e?e:t.length+e]},n.zip=function(t,e){for(var i=Math.min(t.length,e.length),n=new Array(i),r=0;r<i;r++)n[r]=[t[r],e[r]];return n},n.unzip=function(t){for(var e,i=t.length,n=new Array(i),r=new Array(i),o=0;o<i;o++)e=t[o],n[o]=e[0],r[o]=e[1];return[n,r]},n.range=a,n.linspace=function(t,e,i){void 0===i&&(i=100);for(var n=(e-t)/(i-1),r=new Array(i),o=0;o<i;o++)r[o]=t+n*o;return r},n.transpose=function(t){for(var e=t.length,i=t[0].length,n=[],r=0;r<i;r++){n[r]=[];for(var o=0;o<e;o++)n[r][o]=t[o][r]}return n},n.cumsum=function(t){var n=[];return t.reduce(function(t,e,i){return n[i]=t+e},0),n},n.argmin=function(e){return i.minBy(a(e.length),function(t){return e[t]})},n.argmax=function(e){return i.maxBy(a(e.length),function(t){return e[t]})},n.all=function(t,e){for(var i=0,n=t;i<n.length;i++){var r=n[i];if(!e(r))return!1}return!0},n.any=function(t,e){for(var i=0,n=t;i<n.length;i++){var r=n[i];if(e(r))return!0}return!1},n.findIndex=l(1),n.findLastIndex=l(-1),n.find=function(t,e){var i=n.findIndex(t,e);return-1==i?void 0:t[i]},n.findLast=function(t,e){var i=n.findLastIndex(t,e);return-1==i?void 0:t[i]},n.sortedIndex=function(t,e){for(var i=0,n=t.length;i<n;){var r=Math.floor((i+n)/2);t[r]<e?i=r+1:n=r}return i},n.sortBy=function(t,i){var e=t.map(function(t,e){return{value:t,index:e,key:i(t)}});return e.sort(function(t,e){var i=t.key,n=e.key;if(i!==n){if(n<i||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),e.map(function(t){return t.value})},n.uniq=h,n.uniqBy=function(t,e){for(var i=[],n=[],r=0,o=t;r<o.length;r++){var s=o[r],a=e(s);u(n,a)||(n.push(a),i.push(s))}return i},n.union=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return h(s(t))},n.intersection=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=[];t:for(var r=0,o=t;r<o.length;r++){var s=o[r];if(!u(n,s)){for(var a=0,l=e;a<l.length;a++){var h=l[a];if(!u(h,s))continue t}n.push(s)}}return n},n.difference=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=s(e);return t.filter(function(t){return!u(n,t)})},n.removeBy=function(t,e){for(var i=0;i<t.length;)e(t[i])?t.splice(i,1):i++},n.shuffle=function(t){for(var e=t.length,i=new Array(e),n=0;n<e;n++){var r=o.randomIn(0,n);r!==n&&(i[n]=i[r]),i[r]=t[n]}return i},n.pairwise=function(t,e){for(var i=t.length,n=new Array(i-1),r=0;r<i-1;r++)n[r]=e(t[r],t[r+1]);return n},n.reversed=function(t){for(var e=t.length,i=new Array(e),n=0;n<e;n++)i[e-n-1]=t[n];return i},n.repeat=function(t,e){for(var i=new Array(e),n=0;n<e;n++)i[n]=t;return i}},function(t,e,i){function n(t,e,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];var o=t.length;e<0&&(e+=o),e<0?e=0:o<e&&(e=o),null==i||o-e<i?i=o-e:i<0&&(i=0);for(var s=o-i+n.length,a=new t.constructor(s),l=0;l<e;l++)a[l]=t[l];for(var h=0,c=n;h<c.length;h++){var u=c[h];a[l++]=u}for(var _=e+i;_<o;_++)a[l++]=t[_];return a}i.splice=n,i.insert=function(t,e,i){return n(t,i,0,e)},i.append=function(t,e){return n(t,t.length,0,e)},i.prepend=function(t,e){return n(t,0,0,e)},i.indexOf=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},i.map=function(t,e){for(var i=t.length,n=new t.constructor(i),r=0;r<i;r++)n[r]=e(t[r],r,t);return n},i.min=function(t){for(var e,i=1/0,n=0,r=t.length;n<r;n++)(e=t[n])<i&&(i=e);return i},i.minBy=function(t,e){if(0==t.length)throw new Error(\"minBy() called with an empty array\");for(var i=t[0],n=e(i),r=1,o=t.length;r<o;r++){var s=t[r],a=e(s);a<n&&(i=s,n=a)}return i},i.max=function(t){for(var e,i=-1/0,n=0,r=t.length;n<r;n++)e=t[n],i<e&&(i=e);return i},i.maxBy=function(t,e){if(0==t.length)throw new Error(\"maxBy() called with an empty array\");for(var i=t[0],n=e(i),r=1,o=t.length;r<o;r++){var s=t[r],a=e(s);n<a&&(i=s,n=a)}return i},i.sum=function(t){for(var e=0,i=0,n=t.length;i<n;i++)e+=t[i];return e}},function(t,e,i){var n=t(387),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(Error);i.AssertionError=r,i.assert=function(t,e){if(!(!0===t||!1!==t&&t()))throw new r(e||\"Assertion failed\")}},function(t,e,i){var n=Math.min,r=Math.max;i.empty=function(){return{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},i.positive_x=function(){return{minX:Number.MIN_VALUE,minY:-1/0,maxX:1/0,maxY:1/0}},i.positive_y=function(){return{minX:-1/0,minY:Number.MIN_VALUE,maxX:1/0,maxY:1/0}},i.union=function(t,e){return{minX:n(t.minX,e.minX),maxX:r(t.maxX,e.maxX),minY:n(t.minY,e.minY),maxY:r(t.maxY,e.maxY)}};var o=function(){function e(t){if(\"x0\"in t&&\"y0\"in t&&\"x1\"in t&&\"y1\"in t){var e=t,i=e.x0,n=e.y0,r=e.x1,o=e.y1;if(!(i<=r&&n<=o))throw new Error(\"invalid bbox {x0: \"+i+\", y0: \"+n+\", x1: \"+r+\", y1: \"+o+\"}\");this.x0=i,this.y0=n,this.x1=r,this.y1=o}else{var s=t,a=s.x,l=s.y,h=s.width,c=s.height;if(!(0<=h&&0<=c))throw new Error(\"invalid bbox {x: \"+a+\", y: \"+l+\", width: \"+h+\", height: \"+c+\"}\");this.x0=a,this.y0=l,this.x1=a+h,this.y1=l+c}}return Object.defineProperty(e.prototype,\"minX\",{get:function(){return this.x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"minY\",{get:function(){return this.y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"maxX\",{get:function(){return this.x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"maxY\",{get:function(){return this.y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"left\",{get:function(){return this.x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"top\",{get:function(){return this.y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"right\",{get:function(){return this.x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"bottom\",{get:function(){return this.y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"p0\",{get:function(){return[this.x0,this.y0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"p1\",{get:function(){return[this.x1,this.y1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"x\",{get:function(){return this.x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"y\",{get:function(){return this.y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"width\",{get:function(){return this.x1-this.x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"height\",{get:function(){return this.y1-this.y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"rect\",{get:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"h_range\",{get:function(){return{start:this.x0,end:this.x1}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"v_range\",{get:function(){return{start:this.y0,end:this.y1}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"ranges\",{get:function(){return[this.h_range,this.v_range]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"aspect\",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0}),e.prototype.contains=function(t,e){return t>=this.x0&&t<=this.x1&&e>=this.y0&&e<=this.y1},e.prototype.clip=function(t,e){return t<this.x0?t=this.x0:t>this.x1&&(t=this.x1),e<this.y0?e=this.y0:e>this.y1&&(e=this.y1),[t,e]},e.prototype.union=function(t){return new e({x0:n(this.x0,t.x0),y0:n(this.y0,t.y0),x1:r(this.x1,t.x1),y1:r(this.y1,t.y1)})},e}();i.BBox=o},function(t,e,i){i.delay=function(t,e){return setTimeout(t,e)};var n=\"function\"==typeof requestAnimationFrame?requestAnimationFrame:setImmediate;i.defer=function(t){return n(t)},i.throttle=function(i,n,r){void 0===r&&(r={});var o,s,a,l=null,h=0,c=function(){h=!1===r.leading?0:Date.now(),l=null,a=i.apply(o,s),l||(o=s=null)};return function(){var t=Date.now();h||!1!==r.leading||(h=t);var e=n-(t-h);return o=this,s=arguments,e<=0||n<e?(l&&(clearTimeout(l),l=null),h=t,a=i.apply(o,s),l||(o=s=null)):l||!1===r.trailing||(l=setTimeout(c,e)),a}},i.once=function(t){var e,i=!1;return function(){return i||(i=!0,e=t()),e}}},function(t,e,i){var n=t(273);i.SVGRenderingContext2D=n,i.fixup_ctx=function(t){var e,u,i,n,r;(e=t).setLineDash||(e.setLineDash=function(t){e.mozDash=t,e.webkitLineDash=t}),e.getLineDash||(e.getLineDash=function(){return e.mozDash}),(r=t).setLineDashOffset=function(t){r.lineDashOffset=t,r.mozDashOffset=t,r.webkitLineDashOffset=t},r.getLineDashOffset=function(){return r.mozDashOffset},(n=t).setImageSmoothingEnabled=function(t){n.imageSmoothingEnabled=t,n.mozImageSmoothingEnabled=t,n.oImageSmoothingEnabled=t,n.webkitImageSmoothingEnabled=t,n.msImageSmoothingEnabled=t},n.getImageSmoothingEnabled=function(){var t=n.imageSmoothingEnabled;return null==t||t},(i=t).measureText&&null==i.html5MeasureText&&(i.html5MeasureText=i.measureText,i.measureText=function(t){var e=i.html5MeasureText(t);return e.ascent=1.6*i.html5MeasureText(\"m\").width,e}),(u=t).ellipse||(u.ellipse=function(t,e,i,n,r,o,s,a){void 0===a&&(a=!1);var l=.551784;u.translate(t,e),u.rotate(r);var h=i,c=n;a&&(h=-i,c=-n),u.moveTo(-h,0),u.bezierCurveTo(-h,c*l,-h*l,c,0,c),u.bezierCurveTo(h*l,c,h,c*l,h,0),u.bezierCurveTo(h,-c*l,h*l,-c,0,-c),u.bezierCurveTo(-h*l,-c,-h,-c*l,-h,0),u.rotate(-r),u.translate(-t,-e)})},i.get_scale_ratio=function(t,e,i){if(\"svg\"==i)return 1;if(e){var n=window.devicePixelRatio||1,r=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/r}return 1}},function(t,e,i){var n=t(39),r=t(21);function o(t){var e=Number(t).toString(16);return 1==e.length?\"0\"+e:e}function s(t){if(0==(t+=\"\").indexOf(\"#\"))return t;if(n.is_svg_color(t))return n.svg_colors[t];if(0==t.indexOf(\"rgb\")){var e=t.replace(/&#94;rgba?\\(|\\s+|\\)$/g,\"\").split(\",\"),i=e.slice(0,3).map(o).join(\"\");return 4==e.length&&(i+=o(Math.floor(255*parseFloat(e[3])))),\"#\"+i.slice(0,8)}return t}i.color2hex=s,i.color2rgba=function(t,e){if(void 0===e&&(e=1),!t)return[0,0,0,0];var i=s(t);(i=i.replace(/ |#/g,\"\")).length<=4&&(i=i.replace(/(.)/g,\"$1$1\"));for(var n=i.match(/../g).map(function(t){return parseInt(t,16)/255});n.length<3;)n.push(0);return n.length<4&&n.push(e),n.slice(0,4)},i.valid_rgb=function(t){var e;switch(t.substring(0,4)){case\"rgba\":e={start:\"rgba(\",len:4,alpha:!0};break;case\"rgb(\":e={start:\"rgb(\",len:3,alpha:!1};break;default:return!1}if(new RegExp(\".*?(\\\\.).*(,)\").test(t))throw new Error(\"color expects integers for rgb in rgb/rgba tuple, received \"+t);var i=t.replace(e.start,\"\").replace(\")\",\"\").split(\",\").map(parseFloat);if(i.length!=e.len)throw new Error(\"color expects rgba \"+e.len+\"-tuple, received \"+t);if(e.alpha&&!(0<=i[3]&&i[3]<=1))throw new Error(\"color expects rgba 4-tuple to have alpha value between 0 and 1\");if(r.includes(i.slice(0,3).map(function(t){return 0<=t&&t<=255}),!1))throw new Error(\"color expects rgb to have value between 0 and 255\");return!0}},function(t,e,i){i.is_ie=0<=navigator.userAgent.indexOf(\"MSIE\")||0<navigator.userAgent.indexOf(\"Trident\")||0<navigator.userAgent.indexOf(\"Edge\"),i.is_little_endian=function(){var t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t);i[1]=168496141;var n=!0;return 10==e[4]&&11==e[5]&&12==e[6]&&13==e[7]&&(n=!1),n}()},function(t,e,i){var r=t(21),o=t(30),s=t(44),n=function(){function t(){this._dict={}}return t.prototype._existing=function(t){return t in this._dict?this._dict[t]:null},t.prototype.add_value=function(t,e){var i=this._existing(t);null==i?this._dict[t]=e:s.isArray(i)?i.push(e):this._dict[t]=[i,e]},t.prototype.remove_value=function(t,e){var i=this._existing(t);if(s.isArray(i)){var n=r.difference(i,[e]);0<n.length?this._dict[t]=n:delete this._dict[t]}else o.isEqual(i,e)&&delete this._dict[t]},t.prototype.get_one=function(t,e){var i=this._existing(t);if(s.isArray(i)){if(1===i.length)return i[0];throw new Error(e)}return i},t}();i.MultiDict=n;var a=function(){function o(t){this.values=null==t?[]:t instanceof o?r.copy(t.values):this._compact(t)}return o.prototype._compact=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var r=n[i];-1===e.indexOf(r)&&e.push(r)}return e},o.prototype.push=function(t){this.missing(t)&&this.values.push(t)},o.prototype.remove=function(t){var e=this.values.indexOf(t);this.values=this.values.slice(0,e).concat(this.values.slice(e+1))},o.prototype.length=function(){return this.values.length},o.prototype.includes=function(t){return-1!=this.values.indexOf(t)},o.prototype.missing=function(t){return!this.includes(t)},o.prototype.slice=function(t,e){return this.values.slice(t,e)},o.prototype.join=function(t){return this.values.join(t)},o.prototype.toString=function(){return this.join(\", \")},o.prototype.union=function(t){return t=new o(t),new o(this.values.concat(t.values))},o.prototype.intersect=function(t){t=new o(t);for(var e=new o,i=0,n=t.values;i<n.length;i++){var r=n[i];this.includes(r)&&t.includes(r)&&e.push(r)}return e},o.prototype.diff=function(t){t=new o(t);for(var e=new o,i=0,n=this.values;i<n.length;i++){var r=n[i];t.missing(r)&&e.push(r)}return e},o}();i.Set=a},function(t,e,i){var _=t(44),p=Object.prototype.toString;i.isEqual=function(t,e){return function t(e,i,n,r){if(e===i)return 0!==e||1/e==1/i;if(null==e||null==i)return e===i;var o=p.call(e);if(o!==p.call(i))return!1;switch(o){case\"[object RegExp]\":case\"[object String]\":return\"\"+e==\"\"+i;case\"[object Number]\":return+e!=+e?+i!=+i:0==+e?1/+e==1/i:+e==+i;case\"[object Date]\":case\"[object Boolean]\":return+e==+i}var s=\"[object Array]\"===o;if(!s){if(\"object\"!=typeof e||\"object\"!=typeof i)return!1;var a=e.constructor,l=i.constructor;if(a!==l&&!(_.isFunction(a)&&a instanceof a&&_.isFunction(l)&&l instanceof l)&&\"constructor\"in e&&\"constructor\"in i)return!1}r=r||[];for(var h=(n=n||[]).length;h--;)if(n[h]===e)return r[h]===i;if(n.push(e),r.push(i),s){if((h=e.length)!==i.length)return!1;for(;h--;)if(!t(e[h],i[h],n,r))return!1}else{var c=Object.keys(e),u=void 0;if(h=c.length,Object.keys(i).length!==h)return!1;for(;h--;)if(u=c[h],!i.hasOwnProperty(u)||!t(e[u],i[u],n,r))return!1}return n.pop(),r.pop(),!0}(t,e)}},function(t,e,i){function a(t){for(;t<0;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t}function l(t,e){return Math.abs(a(t-e))}function o(){return Math.random()}i.angle_norm=a,i.angle_dist=l,i.angle_between=function(t,e,i,n){var r=a(t),o=l(e,i),s=l(e,r)<=o&&l(r,i)<=o;return 1==n?!s:s},i.random=o,i.randomIn=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},i.atan2=function(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])},i.rnorm=function(t,e){for(var i,n;i=o(),n=(2*(n=o())-1)*Math.sqrt(1/Math.E*2),!(-4*i*i*Math.log(i)>=n*n););var r=n/i;return r=t+e*r},i.clamp=function(t,e,i){return i<t?i:t<e?e:t}},function(t,e,i){var n=t(387),h=t(21);function r(t,e){return n.__assign(t,e)}function o(t){return Object.keys(t).length}i.keys=Object.keys,i.values=function(t){for(var e=Object.keys(t),i=e.length,n=new Array(i),r=0;r<i;r++)n[r]=t[e[r]];return n},i.extend=r,i.clone=function(t){return r({},t)},i.merge=function(t,e){for(var i=Object.create(Object.prototype),n=h.concat([Object.keys(t),Object.keys(e)]),r=0,o=n;r<o.length;r++){var s=o[r],a=t.hasOwnProperty(s)?t[s]:[],l=e.hasOwnProperty(s)?e[s]:[];i[s]=h.union(a,l)}return i},i.size=o,i.isEmpty=function(t){return 0===o(t)}},function(t,e,h){var i=t(370),n=t(358),r=new n(\"GOOGLE\"),o=new n(\"WGS84\");h.wgs84_mercator=i(o,r);var s={lon:[-20026376.39,20026376.39],lat:[-20048966.1,20048966.1]},a={lon:[-180,180],lat:[-85.06,85.06]};function c(t,e){for(var i=Math.min(t.length,e.length),n=new Array(i),r=new Array(i),o=0;o<i;o++){var s=h.wgs84_mercator.forward([t[o],e[o]]),a=s[0],l=s[1];n[o]=a,r[o]=l}return[n,r]}h.clip_mercator=function(t,e,i){var n=s[i],r=n[0],o=n[1];return[Math.max(t,r),Math.min(e,o)]},h.in_bounds=function(t,e){return t>a[e][0]&&t<a[e][1]},h.project_xy=c,h.project_xsys=function(t,e){for(var i=Math.min(t.length,e.length),n=new Array(i),r=new Array(i),o=0;o<i;o++){var s=c(t[o],e[o]),a=s[0],l=s[1];n[o]=a,r[o]=l}return[n,r]}},function(t,e,i){var n=t(44);i.create_ref=function(t){var e={type:t.type,id:t.id};return null!=t._subtype&&(e.subtype=t._subtype),e},i.is_ref=function(t){if(n.isObject(t)){var e=Object.keys(t).sort();if(2==e.length)return\"id\"==e[0]&&\"type\"==e[1];if(3==e.length)return\"id\"==e[0]&&\"subtype\"==e[1]&&\"type\"==e[2]}return!1}},function(t,e,i){i.get_indices=function(t){var e=t.selected;return e[\"0d\"].glyph?e[\"0d\"].indices:0<e[\"1d\"].indices.length?e[\"1d\"].indices:0<e[\"2d\"].indices.length?e[\"2d\"].indices:[]}},function(t,e,c){var f=t(44),i=t(28);function u(t){for(var e=new Uint8Array(t.buffer,t.byteOffset,2*t.length),i=0,n=e.length;i<n;i+=2){var r=e[i];e[i]=e[i+1],e[i+1]=r}}function _(t){for(var e=new Uint8Array(t.buffer,t.byteOffset,4*t.length),i=0,n=e.length;i<n;i+=4){var r=e[i];e[i]=e[i+3],e[i+3]=r,r=e[i+1],e[i+1]=e[i+2],e[i+2]=r}}function p(t){for(var e=new Uint8Array(t.buffer,t.byteOffset,8*t.length),i=0,n=e.length;i<n;i+=8){var r=e[i];e[i]=e[i+7],e[i+7]=r,r=e[i+1],e[i+1]=e[i+6],e[i+6]=r,r=e[i+2],e[i+2]=e[i+5],e[i+5]=r,r=e[i+3],e[i+3]=e[i+4],e[i+4]=r}}function n(t,e){for(var i=t.order!==c.BYTE_ORDER,n=t.shape,r=null,o=0,s=e;o<s.length;o++){var a=s[o],l=JSON.parse(a[0]);if(l.id===t.__buffer__){r=a[1];break}}var h=new c.ARRAY_TYPES[t.dtype](r);return i&&(2===h.BYTES_PER_ELEMENT?u(h):4===h.BYTES_PER_ELEMENT?_(h):8===h.BYTES_PER_ELEMENT&&p(h)),[h,n]}function v(t,e){return f.isObject(t)&&\"__ndarray__\"in t?o(t):f.isObject(t)&&\"__buffer__\"in t?n(t,e):f.isArray(t)?[t,[]]:void 0}function s(t){var e=new Uint8Array(t),i=Array.from(e).map(function(t){return String.fromCharCode(t)});return btoa(i.join(\"\"))}function r(t){for(var e=atob(t),i=e.length,n=new Uint8Array(i),r=0,o=i;r<o;r++)n[r]=e.charCodeAt(r);return n.buffer}function o(t){var e=r(t.__ndarray__),i=t.dtype,n=t.shape;if(!(i in c.ARRAY_TYPES))throw new Error(\"unknown dtype: \"+i);return[new c.ARRAY_TYPES[i](e),n]}function d(t,e){var i,n=s(t.buffer),r=function(t){if(\"name\"in t.constructor)return t.constructor.name;switch(!0){case t instanceof Uint8Array:return\"Uint8Array\";case t instanceof Int8Array:return\"Int8Array\";case t instanceof Uint16Array:return\"Uint16Array\";case t instanceof Int16Array:return\"Int16Array\";case t instanceof Uint32Array:return\"Uint32Array\";case t instanceof Int32Array:return\"Int32Array\";case t instanceof Float32Array:return\"Float32Array\";case t instanceof Float64Array:return\"Float64Array\";default:throw new Error(\"unsupported typed array\")}}(t);if(!(r in c.DTYPES))throw new Error(\"unknown array type: \"+r);i=c.DTYPES[r];var o={__ndarray__:n,shape:e,dtype:i};return o}c.ARRAY_TYPES={uint8:Uint8Array,int8:Int8Array,uint16:Uint16Array,int16:Int16Array,uint32:Uint32Array,int32:Int32Array,float32:Float32Array,float64:Float64Array},c.DTYPES={Uint8Array:\"uint8\",Int8Array:\"int8\",Uint16Array:\"uint16\",Int16Array:\"int16\",Uint32Array:\"uint32\",Int32Array:\"int32\",Float32Array:\"float32\",Float64Array:\"float64\"},c.BYTE_ORDER=i.is_little_endian?\"little\":\"big\",c.swap16=u,c.swap32=_,c.swap64=p,c.process_buffer=n,c.process_array=v,c.arrayBufferToBase64=s,c.base64ToArrayBuffer=r,c.decode_base64=o,c.encode_base64=d,c.decode_column_data=function(t,e){void 0===e&&(e=[]);var i={},n={};for(var r in t){var o=t[r];if(f.isArray(o)){if(0==o.length||!f.isObject(o[0])&&!f.isArray(o[0])){i[r]=o;continue}for(var s=[],a=[],l=0,h=o;l<h.length;l++){var c=h[l],u=v(c,e),_=u[0],p=u[1];s.push(_),a.push(p)}i[r]=s,n[r]=a}else{var d=v(o,e),_=d[0],p=d[1];i[r]=_,n[r]=p}}return[i,n]},c.encode_column_data=function(t,e){var i={};for(var n in t){var r=t[n],o=void 0;if(f.isTypedArray(r))o=d(r,null!=e?e[n]:void 0);else if(f.isArray(r)){for(var s=[],a=0,l=r.length;a<l;a++){var h=r[a];if(f.isTypedArray(h)){var c=null!=e&&null!=e[n]?e[n][a]:void 0;s.push(d(h,c))}else s.push(h)}o=s}else o=r;i[n]=o}return i}},function(t,e,i){var l=t(342),o=t(24),n=function(){function t(t){if(this.points=t,this.index=null,0<t.length){this.index=new l(t.length);for(var e=0,i=t;e<i.length;e++){var n=i[e],r=n.minX,o=n.minY,s=n.maxX,a=n.maxY;this.index.add(r,o,s,a)}this.index.finish()}}return Object.defineProperty(t.prototype,\"bbox\",{get:function(){if(null==this.index)return o.empty();var t=this.index,e=t.minX,i=t.minY,n=t.maxX,r=t.maxY;return{minX:e,minY:i,maxX:n,maxY:r}},enumerable:!0,configurable:!0}),t.prototype.search=function(t){var e=this;if(null==this.index)return[];var i=t.minX,n=t.minY,r=t.maxX,o=t.maxY,s=this.index.search(i,n,r,o);return s.map(function(t){return e.points[t]})},t.prototype.indices=function(t){return this.search(t).map(function(t){var e=t.i;return e})},t}();i.SpatialIndex=n},function(t,e,i){var n=t(18);function r(){for(var t=new Array(32),e=\"0123456789ABCDEF\",i=0;i<32;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[12]=\"4\",t[16]=e.substr(3&t[16].charCodeAt(0)|8,1),t.join(\"\")}i.startsWith=function(t,e,i){return void 0===i&&(i=0),t.substr(i,e.length)==e},i.uuid4=r;var o=1e3;i.uniqueId=function(t){var e=n.settings.dev?\"j\"+o++:r();return null!=t?t+\"-\"+e:e},i.escape=function(t){return t.replace(/(?:[&<>\"'`])/g,function(t){switch(t){case\"&\":return\"&amp;\";case\"<\":return\"&lt;\";case\">\":return\"&gt;\";case'\"':return\"&quot;\";case\"'\":return\"&#x27;\";case\"`\":return\"&#x60;\";default:return t}})},i.unescape=function(t){return t.replace(/&(amp|lt|gt|quot|#x27|#x60);/g,function(t,e){switch(e){case\"amp\":return\"&\";case\"lt\":return\"<\";case\"gt\":return\">\";case\"quot\":return'\"';case\"#x27\":return\"'\";case\"#x60\":return\"`\";default:return e}})},i.use_strict=function(t){return\"'use strict';\\n\"+t}},function(t,e,i){i.svg_colors={indianred:\"#CD5C5C\",lightcoral:\"#F08080\",salmon:\"#FA8072\",darksalmon:\"#E9967A\",lightsalmon:\"#FFA07A\",crimson:\"#DC143C\",red:\"#FF0000\",firebrick:\"#B22222\",darkred:\"#8B0000\",pink:\"#FFC0CB\",lightpink:\"#FFB6C1\",hotpink:\"#FF69B4\",deeppink:\"#FF1493\",mediumvioletred:\"#C71585\",palevioletred:\"#DB7093\",coral:\"#FF7F50\",tomato:\"#FF6347\",orangered:\"#FF4500\",darkorange:\"#FF8C00\",orange:\"#FFA500\",gold:\"#FFD700\",yellow:\"#FFFF00\",lightyellow:\"#FFFFE0\",lemonchiffon:\"#FFFACD\",lightgoldenrodyellow:\"#FAFAD2\",papayawhip:\"#FFEFD5\",moccasin:\"#FFE4B5\",peachpuff:\"#FFDAB9\",palegoldenrod:\"#EEE8AA\",khaki:\"#F0E68C\",darkkhaki:\"#BDB76B\",lavender:\"#E6E6FA\",thistle:\"#D8BFD8\",plum:\"#DDA0DD\",violet:\"#EE82EE\",orchid:\"#DA70D6\",fuchsia:\"#FF00FF\",magenta:\"#FF00FF\",mediumorchid:\"#BA55D3\",mediumpurple:\"#9370DB\",blueviolet:\"#8A2BE2\",darkviolet:\"#9400D3\",darkorchid:\"#9932CC\",darkmagenta:\"#8B008B\",purple:\"#800080\",indigo:\"#4B0082\",slateblue:\"#6A5ACD\",darkslateblue:\"#483D8B\",mediumslateblue:\"#7B68EE\",greenyellow:\"#ADFF2F\",chartreuse:\"#7FFF00\",lawngreen:\"#7CFC00\",lime:\"#00FF00\",limegreen:\"#32CD32\",palegreen:\"#98FB98\",lightgreen:\"#90EE90\",mediumspringgreen:\"#00FA9A\",springgreen:\"#00FF7F\",mediumseagreen:\"#3CB371\",seagreen:\"#2E8B57\",forestgreen:\"#228B22\",green:\"#008000\",darkgreen:\"#006400\",yellowgreen:\"#9ACD32\",olivedrab:\"#6B8E23\",olive:\"#808000\",darkolivegreen:\"#556B2F\",mediumaquamarine:\"#66CDAA\",darkseagreen:\"#8FBC8F\",lightseagreen:\"#20B2AA\",darkcyan:\"#008B8B\",teal:\"#008080\",aqua:\"#00FFFF\",cyan:\"#00FFFF\",lightcyan:\"#E0FFFF\",paleturquoise:\"#AFEEEE\",aquamarine:\"#7FFFD4\",turquoise:\"#40E0D0\",mediumturquoise:\"#48D1CC\",darkturquoise:\"#00CED1\",cadetblue:\"#5F9EA0\",steelblue:\"#4682B4\",lightsteelblue:\"#B0C4DE\",powderblue:\"#B0E0E6\",lightblue:\"#ADD8E6\",skyblue:\"#87CEEB\",lightskyblue:\"#87CEFA\",deepskyblue:\"#00BFFF\",dodgerblue:\"#1E90FF\",cornflowerblue:\"#6495ED\",royalblue:\"#4169E1\",blue:\"#0000FF\",mediumblue:\"#0000CD\",darkblue:\"#00008B\",navy:\"#000080\",midnightblue:\"#191970\",cornsilk:\"#FFF8DC\",blanchedalmond:\"#FFEBCD\",bisque:\"#FFE4C4\",navajowhite:\"#FFDEAD\",wheat:\"#F5DEB3\",burlywood:\"#DEB887\",tan:\"#D2B48C\",rosybrown:\"#BC8F8F\",sandybrown:\"#F4A460\",goldenrod:\"#DAA520\",darkgoldenrod:\"#B8860B\",peru:\"#CD853F\",chocolate:\"#D2691E\",saddlebrown:\"#8B4513\",sienna:\"#A0522D\",brown:\"#A52A2A\",maroon:\"#800000\",white:\"#FFFFFF\",snow:\"#FFFAFA\",honeydew:\"#F0FFF0\",mintcream:\"#F5FFFA\",azure:\"#F0FFFF\",aliceblue:\"#F0F8FF\",ghostwhite:\"#F8F8FF\",whitesmoke:\"#F5F5F5\",seashell:\"#FFF5EE\",beige:\"#F5F5DC\",oldlace:\"#FDF5E6\",floralwhite:\"#FFFAF0\",ivory:\"#FFFFF0\",antiquewhite:\"#FAEBD7\",linen:\"#FAF0E6\",lavenderblush:\"#FFF0F5\",mistyrose:\"#FFE4E1\",gainsboro:\"#DCDCDC\",lightgray:\"#D3D3D3\",lightgrey:\"#D3D3D3\",silver:\"#C0C0C0\",darkgray:\"#A9A9A9\",darkgrey:\"#A9A9A9\",gray:\"#808080\",grey:\"#808080\",dimgray:\"#696969\",dimgrey:\"#696969\",lightslategray:\"#778899\",lightslategrey:\"#778899\",slategray:\"#708090\",slategrey:\"#708090\",darkslategray:\"#2F4F4F\",darkslategrey:\"#2F4F4F\",black:\"#000000\"},i.is_svg_color=function(t){return t in i.svg_colors}},function(t,e,s){var r=t(385),n=t(357),o=t(386),_=t(38),a=t(44);function l(t,e,i){if(a.isNumber(t)){var n=function(){switch(!1){case Math.floor(t)!=t:return\"%d\";case!(.1<Math.abs(t)&&Math.abs(t)<1e3):return\"%0.3f\";default:return\"%0.3e\"}}();return r.sprintf(n,t)}return\"\"+t}function p(t,e,i,n){if(null==i)return l;if(null!=n&&(t in n||e in n)){var r=e in n?e:t,o=n[r];if(a.isString(o)){if(o in s.DEFAULT_FORMATTERS)return s.DEFAULT_FORMATTERS[o];throw new Error(\"Unknown tooltip field formatter type '\"+o+\"'\")}return function(t,e,i){return o.format(t,e,i)}}return s.DEFAULT_FORMATTERS.numeral}function d(t,e,i,n){if(\"$\"==t[0]){if(t.substring(1)in n)return n[t.substring(1)];throw new Error(\"Unknown special variable '\"+t+\"'\")}var r=e.get_column(t);if(null==r)return null;if(a.isNumber(i))return r[i];var o=r[i.index];if(a.isTypedArray(o)||a.isArray(o)){if(a.isArray(o[0])){var s=o[i.dim2];return s[i.dim1]}return o[i.flat_index]}return o}s.DEFAULT_FORMATTERS={numeral:function(t,e,i){return n.format(t,e)},datetime:function(t,e,i){return o(t,e)},printf:function(t,e,i){return r.sprintf(e,t)}},s.basic_formatter=l,s.get_formatter=p,s.get_value=d,s.replace_placeholders=function(t,a,l,h,c){void 0===c&&(c={});var u=t.replace(/(?:&#94;|[&#94;@])([@|\\$](?:\\w+|{[&#94;{}]+}))(?:{[&#94;{}]+})?/g,function(t,e,i){return\"\"+e});return t=(t=(t=t.replace(/@\\$name/g,function(t){return\"@{\"+c.name+\"}\"})).replace(/(&#94;|[&#94;\\$])\\$(\\w+)/g,function(t,e,i){return e+\"@$\"+i})).replace(/(&#94;|[&#94;@])@(?:(\\$?\\w+)|{([&#94;{}]+)})(?:{([&#94;{}]+)})?/g,function(t,e,i,n,r){var o=d(i=null!=n?n:i,a,l,c);if(null==o)return\"\"+e+_.escape(\"???\");if(\"safe\"==r)return\"\"+e+o;var s=p(i,u,r,h);return\"\"+e+_.escape(s(o,r,c))})}},function(t,e,i){var a=t(5),l={};i.get_text_height=function(t){if(null!=l[t])return l[t];var e=a.span({style:{font:t}},\"Hg\"),i=a.div({style:{display:\"inline-block\",width:\"1px\",height:\"0px\"}}),n=a.div({},e,i);document.body.appendChild(n);try{i.style.verticalAlign=\"baseline\";var r=a.offset(i).top-a.offset(e).top;i.style.verticalAlign=\"bottom\";var o=a.offset(i).top-a.offset(e).top,s={height:o,ascent:r,descent:o-r};return l[t]=s}finally{document.body.removeChild(n)}}},function(t,e,i){var a=(\"undefined\"!=typeof window?window.requestAnimationFrame:void 0)||(\"undefined\"!=typeof window?window.webkitRequestAnimationFrame:void 0)||(\"undefined\"!=typeof window?window.mozRequestAnimationFrame:void 0)||(\"undefined\"!=typeof window?window.msRequestAnimationFrame:void 0)||function(t){return t(Date.now()),-1};i.throttle=function(t,i){var n=null,r=0,o=!1,s=function(){r=Date.now(),n=null,o=!1,t()};return function(){var t=Date.now(),e=i-(t-r);e<=0&&!o?(null!=n&&clearTimeout(n),o=!0,a(s)):n||o||(n=setTimeout(function(){return a(s)},e))}}},function(t,e,i){i.concat=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=t.length,r=0,o=e;r<o.length;r++){var s=o[r];n+=s.length}var a=new t.constructor(n);a.set(t,0);for(var l=t.length,h=0,c=e;h<c.length;h++){var s=c[h];a.set(s,l),l+=s.length}return a}},function(t,e,i){var n=t(21),r=Object.prototype.toString;function o(t){return\"[object Number]\"===r.call(t)}i.isBoolean=function(t){return!0===t||!1===t||\"[object Boolean]\"===r.call(t)},i.isNumber=o,i.isInteger=function(t){return o(t)&&isFinite(t)&&Math.floor(t)===t},i.isString=function(t){return\"[object String]\"===r.call(t)},i.isStrictNaN=function(t){return o(t)&&t!==+t},i.isFunction=function(t){return\"[object Function]\"===r.call(t)},i.isArray=function(t){return Array.isArray(t)},i.isArrayOf=function(t,e){return n.all(t,e)},i.isArrayableOf=function(t,e){for(var i=0,n=t.length;i<n;i++)if(!e(t[i]))return!1;return!0},i.isTypedArray=function(t){return null!=t&&null!=t.buffer&&t.buffer instanceof ArrayBuffer},i.isObject=function(t){var e=typeof t;return\"function\"===e||\"object\"===e&&!!t}},function(t,e,i){function n(t){var e=getComputedStyle(t).fontSize;return null!=e?parseInt(e,10):null}i.getDeltaY=function(t){var e,i=-t.deltaY;if(t.target instanceof HTMLElement)switch(t.deltaMode){case t.DOM_DELTA_LINE:i*=n((e=t.target).offsetParent||document.body)||n(e)||16;break;case t.DOM_DELTA_PAGE:i*=t.target.clientHeight}return i}},function(t,e,i){var f=t(31);function v(t,e,i){var n=[t.start,t.end],r=n[0],o=n[1],s=null!=i?i:(o+r)/2,a=r-(r-s)*e,l=o-(o-s)*e;return[a,l]}function m(t,e){var i=e[0],n=e[1],r={};for(var o in t){var s=t[o],a=s.r_invert(i,n),l=a[0],h=a[1];r[o]={start:l,end:h}}return r}i.scale_highlow=v,i.get_info=m,i.scale_range=function(t,e,i,n,r){void 0===i&&(i=!0),void 0===n&&(n=!0),e=f.clamp(e,-.9,.9);var o=i?e:0,s=v(t.bbox.h_range,o,null!=r?r.x:void 0),a=s[0],l=s[1],h=m(t.xscales,[a,l]),c=n?e:0,u=v(t.bbox.v_range,c,null!=r?r.y:void 0),_=u[0],p=u[1],d=m(t.yscales,[_,p]);return{xrs:h,yrs:d,factor:e}}},function(t,e,i){var n=t(44);i.isValue=function(t){return n.isObject(t)&&\"value\"in t},i.isField=function(t){return n.isObject(t)&&\"field\"in t}},function(t,e,i){var n=t(387),r=t(19),o=t(38),s=function(i){function t(t){var e=i.call(this)||this;if(e.removed=new r.Signal0(e,\"removed\"),null==t.model)throw new Error(\"model of a view wasn't configured\");return e.model=t.model,e._parent=t.parent,e.id=t.id||o.uniqueId(),e.initialize(t),!1!==t.connect_signals&&e.connect_signals(),e}return n.__extends(t,i),t.prototype.initialize=function(t){},t.prototype.remove=function(){this._parent=void 0,this.disconnect_signals(),this.removed.emit()},t.prototype.toString=function(){return this.model.type+\"View(\"+this.id+\")\"},Object.defineProperty(t.prototype,\"parent\",{get:function(){if(void 0!==this._parent)return this._parent;throw new Error(\"parent of a view wasn't configured\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"is_root\",{get:function(){return null===this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"root\",{get:function(){return this.is_root?this:this.parent.root},enumerable:!0,configurable:!0}),t.prototype.connect_signals=function(){},t.prototype.disconnect_signals=function(){r.Signal.disconnectReceiver(this)},t.prototype.notify_finished=function(){this.root.notify_finished()},t}(r.Signalable());i.View=s},function(t,e,i){var n=t(387),r=t(16),o=t(27),s=function(){function t(t,e){void 0===e&&(e=\"\"),this.obj=t,this.prefix=e,this.cache={};var i=t.properties[e+this.do_attr].spec;this.doit=null!==i.value;for(var n=0,r=this.attrs;n<r.length;n++){var o=r[n];this[o]=t.properties[e+o]}}return t.prototype.warm_cache=function(t){for(var e=0,i=this.attrs;e<i.length;e++){var n=i[e],r=this.obj.properties[this.prefix+n];if(void 0!==r.spec.value)this.cache[n]=r.spec.value;else{if(null==t)throw new Error(\"source is required with a vectorized visual property\");this.cache[n+\"_array\"]=r.array(t)}}},t.prototype.cache_select=function(t,e){var i,n=this.obj.properties[this.prefix+t];return void 0!==n.spec.value?this.cache[t]=i=n.spec.value:this.cache[t]=i=this.cache[t+\"_array\"][e],i},t.prototype.set_vectorize=function(t,e){null!=this.all_indices?this._set_vectorize(t,this.all_indices[e]):this._set_vectorize(t,e)},t}(),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.set_value=function(t){t.strokeStyle=this.line_color.value(),t.globalAlpha=this.line_alpha.value(),t.lineWidth=this.line_width.value(),t.lineJoin=this.line_join.value(),t.lineCap=this.line_cap.value(),t.setLineDash(this.line_dash.value()),t.setLineDashOffset(this.line_dash_offset.value())},e.prototype._set_vectorize=function(t,e){this.cache_select(\"line_color\",e),t.strokeStyle!==this.cache.line_color&&(t.strokeStyle=this.cache.line_color),this.cache_select(\"line_alpha\",e),t.globalAlpha!==this.cache.line_alpha&&(t.globalAlpha=this.cache.line_alpha),this.cache_select(\"line_width\",e),t.lineWidth!==this.cache.line_width&&(t.lineWidth=this.cache.line_width),this.cache_select(\"line_join\",e),t.lineJoin!==this.cache.line_join&&(t.lineJoin=this.cache.line_join),this.cache_select(\"line_cap\",e),t.lineCap!==this.cache.line_cap&&(t.lineCap=this.cache.line_cap),this.cache_select(\"line_dash\",e),t.getLineDash()!==this.cache.line_dash&&t.setLineDash(this.cache.line_dash),this.cache_select(\"line_dash_offset\",e),t.getLineDashOffset()!==this.cache.line_dash_offset&&t.setLineDashOffset(this.cache.line_dash_offset)},e.prototype.color_value=function(){var t=o.color2rgba(this.line_color.value(),this.line_alpha.value()),e=t[0],i=t[1],n=t[2],r=t[3];return\"rgba(\"+255*e+\",\"+255*i+\",\"+255*n+\",\"+r+\")\"},e}(i.ContextProperties=s);(i.Line=h).prototype.attrs=Object.keys(r.line()),h.prototype.do_attr=\"line_color\";var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.set_value=function(t){t.fillStyle=this.fill_color.value(),t.globalAlpha=this.fill_alpha.value()},e.prototype._set_vectorize=function(t,e){this.cache_select(\"fill_color\",e),t.fillStyle!==this.cache.fill_color&&(t.fillStyle=this.cache.fill_color),this.cache_select(\"fill_alpha\",e),t.globalAlpha!==this.cache.fill_alpha&&(t.globalAlpha=this.cache.fill_alpha)},e.prototype.color_value=function(){var t=o.color2rgba(this.fill_color.value(),this.fill_alpha.value()),e=t[0],i=t[1],n=t[2],r=t[3];return\"rgba(\"+255*e+\",\"+255*i+\",\"+255*n+\",\"+r+\")\"},e}(s);(i.Fill=c).prototype.attrs=Object.keys(r.fill()),c.prototype.do_attr=\"fill_color\";var u=function(a){function t(){return null!==a&&a.apply(this,arguments)||this}return n.__extends(t,a),t.prototype.cache_select=function(t,e){var i;if(\"font\"==t){a.prototype.cache_select.call(this,\"text_font_style\",e),a.prototype.cache_select.call(this,\"text_font_size\",e),a.prototype.cache_select.call(this,\"text_font\",e);var n=this.cache,r=n.text_font_style,o=n.text_font_size,s=n.text_font;this.cache.font=i=r+\" \"+o+\" \"+s}else i=a.prototype.cache_select.call(this,t,e);return i},t.prototype.font_value=function(){var t=this.text_font.value(),e=this.text_font_size.value(),i=this.text_font_style.value();return i+\" \"+e+\" \"+t},t.prototype.color_value=function(){var t=o.color2rgba(this.text_color.value(),this.text_alpha.value()),e=t[0],i=t[1],n=t[2],r=t[3];return\"rgba(\"+255*e+\",\"+255*i+\",\"+255*n+\",\"+r+\")\"},t.prototype.set_value=function(t){t.font=this.font_value(),t.fillStyle=this.text_color.value(),t.globalAlpha=this.text_alpha.value(),t.textAlign=this.text_align.value(),t.textBaseline=this.text_baseline.value()},t.prototype._set_vectorize=function(t,e){this.cache_select(\"font\",e),t.font!==this.cache.font&&(t.font=this.cache.font),this.cache_select(\"text_color\",e),t.fillStyle!==this.cache.text_color&&(t.fillStyle=this.cache.text_color),this.cache_select(\"text_alpha\",e),t.globalAlpha!==this.cache.text_alpha&&(t.globalAlpha=this.cache.text_alpha),this.cache_select(\"text_align\",e),t.textAlign!==this.cache.text_align&&(t.textAlign=this.cache.text_align),this.cache_select(\"text_baseline\",e),t.textBaseline!==this.cache.text_baseline&&(t.textBaseline=this.cache.text_baseline)},t}(s);(i.Text=u).prototype.attrs=Object.keys(r.text()),u.prototype.do_attr=\"text_color\";var a=function(){function t(t){for(var e=0,i=t.mixins;e<i.length;e++){var n=i[e],r=n.split(\":\"),o=r[0],s=r[1],a=void 0===s?\"\":s,l=void 0;switch(o){case\"line\":l=h;break;case\"fill\":l=c;break;case\"text\":l=u;break;default:throw new Error(\"unknown visual: \"+o)}this[a+o]=new l(t,a)}}return t.prototype.warm_cache=function(t){for(var e in this)if(this.hasOwnProperty(e)){var i=this[e];i instanceof s&&i.warm_cache(t)}},t.prototype.set_all_indices=function(t){for(var e in this)if(this.hasOwnProperty(e)){var i=this[e];i instanceof s&&(i.all_indices=t)}},t}();i.Visuals=a},function(t,e,i){var o=t(387),s=t(0),_=t(272),j=t(14),n=t(3),p=t(8),r=t(19),a=t(34),N=t(36),m=t(29),y=t(21),b=t(32),x=t(30),d=t(44),l=t(152),F=t(190),g=t(57),h=function(){function t(t){this.document=t,this.session=null,this.subscribed_models=new m.Set}return t.prototype.send_event=function(t){null!=this.session&&this.session.send_event(t)},t.prototype.trigger=function(t){for(var e=0,i=this.subscribed_models.values;e<i.length;e++){var n=i[e];if(null==t.model_id||t.model_id===n){var r=this.document._all_models[n];null!=r&&r._process_event(t)}}},t}();i.EventManager=h;var c=function(t){this.document=t},u=function(a){function t(t,e,i,n,r,o){var s=a.call(this,t)||this;return s.model=e,s.attr=i,s.old=n,s.new_=r,s.setter_id=o,s}return o.__extends(t,a),t.prototype.json=function(t){if(\"id\"===this.attr)throw new Error(\"'id' field should never change, whatever code just set it is wrong\");var e=this.new_,i=p.HasProps._value_to_json(this.attr,e,this.model),n={};for(var r in p.HasProps._value_record_references(e,n,!0),this.model.id in n&&this.model!==e&&delete n[this.model.id],n)t[r]=n[r];return{kind:\"ModelChanged\",model:this.model.ref(),attr:this.attr,new:i}},t}(i.DocumentChangedEvent=c);i.ModelChangedEvent=u;var f=function(r){function t(t,e,i){var n=r.call(this,t)||this;return n.title=e,n.setter_id=i,n}return o.__extends(t,r),t.prototype.json=function(t){return{kind:\"TitleChanged\",title:this.title}},t}(c);i.TitleChangedEvent=f;var v=function(r){function t(t,e,i){var n=r.call(this,t)||this;return n.model=e,n.setter_id=i,n}return o.__extends(t,r),t.prototype.json=function(t){return p.HasProps._value_record_references(this.model,t,!0),{kind:\"RootAdded\",model:this.model.ref()}},t}(c);i.RootAddedEvent=v;var w=function(r){function t(t,e,i){var n=r.call(this,t)||this;return n.model=e,n.setter_id=i,n}return o.__extends(t,r),t.prototype.json=function(t){return{kind:\"RootRemoved\",model:this.model.ref()}},t}(c);i.RootRemovedEvent=w,i.documents=[],i.DEFAULT_TITLE=\"Bokeh Application\";var k=function(){function P(){i.documents.push(this),this._init_timestamp=Date.now(),this._title=i.DEFAULT_TITLE,this._roots=[],this._all_models={},this._all_models_by_name=new m.MultiDict,this._all_models_freeze_count=0,this._callbacks=[],this.event_manager=new h(this),this.idle=new r.Signal0(this,\"idle\"),this._idle_roots=new WeakMap,this._interactive_timestamp=null,this._interactive_plot=null}return Object.defineProperty(P.prototype,\"layoutables\",{get:function(){return this._roots.filter(function(t){return t instanceof l.LayoutDOM})},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,\"is_idle\",{get:function(){for(var t=0,e=this.layoutables;t<e.length;t++){var i=e[t];if(!this._idle_roots.has(i))return!1}return!0},enumerable:!0,configurable:!0}),P.prototype.notify_idle=function(t){this._idle_roots.set(t,!0),this.is_idle&&(j.logger.info(\"document idle at \"+(Date.now()-this._init_timestamp)+\" ms\"),this.idle.emit())},P.prototype.clear=function(){this._push_all_models_freeze();try{for(;0<this._roots.length;)this.remove_root(this._roots[0])}finally{this._pop_all_models_freeze()}},P.prototype.interactive_start=function(t){null==this._interactive_plot&&(this._interactive_plot=t,this._interactive_plot.trigger_event(new n.LODStart({}))),this._interactive_timestamp=Date.now()},P.prototype.interactive_stop=function(t){null!=this._interactive_plot&&this._interactive_plot.id===t.id&&this._interactive_plot.trigger_event(new n.LODEnd({})),this._interactive_plot=null,this._interactive_timestamp=null},P.prototype.interactive_duration=function(){return null==this._interactive_timestamp?-1:Date.now()-this._interactive_timestamp},P.prototype.destructively_move=function(t){if(t===this)throw new Error(\"Attempted to overwrite a document with itself\");t.clear();var e=y.copy(this._roots);this.clear();for(var i=0,n=e;i<n.length;i++){var r=n[i];if(null!=r.document)throw new Error(\"Somehow we didn't detach \"+r)}if(0!==Object.keys(this._all_models).length)throw new Error(\"this._all_models still had stuff in it: \"+this._all_models);for(var o=0,s=e;o<s.length;o++){var r=s[o];t.add_root(r)}t.set_title(this._title)},P.prototype._push_all_models_freeze=function(){this._all_models_freeze_count+=1},P.prototype._pop_all_models_freeze=function(){this._all_models_freeze_count-=1,0===this._all_models_freeze_count&&this._recompute_all_models()},P.prototype._invalidate_all_models=function(){j.logger.debug(\"invalidating document models\"),0===this._all_models_freeze_count&&this._recompute_all_models()},P.prototype._recompute_all_models=function(){for(var t=new m.Set,e=0,i=this._roots;e<i.length;e++){var n=i[e];t=t.union(n.references())}for(var r=new m.Set(b.values(this._all_models)),o=r.diff(t),s=t.diff(r),a={},l=0,h=t.values;l<h.length;l++){var c=h[l];a[c.id]=c}for(var u=0,_=o.values;u<_.length;u++){var p=_[u];p.detach_document(),p instanceof g.Model&&null!=p.name&&this._all_models_by_name.remove_value(p.name,p)}for(var d=0,f=s.values;d<f.length;d++){var v=f[d];v.attach_document(this),v instanceof g.Model&&null!=v.name&&this._all_models_by_name.add_value(v.name,v)}this._all_models=a},P.prototype.roots=function(){return this._roots},P.prototype.add_root=function(t,e){if(j.logger.debug(\"Adding root: \"+t),!y.includes(this._roots,t)){this._push_all_models_freeze();try{this._roots.push(t)}finally{this._pop_all_models_freeze()}this._trigger_on_change(new v(this,t,e))}},P.prototype.remove_root=function(t,e){var i=this._roots.indexOf(t);if(!(i<0)){this._push_all_models_freeze();try{this._roots.splice(i,1)}finally{this._pop_all_models_freeze()}this._trigger_on_change(new w(this,t,e))}},P.prototype.title=function(){return this._title},P.prototype.set_title=function(t,e){t!==this._title&&(this._title=t,this._trigger_on_change(new f(this,t,e)))},P.prototype.get_model_by_id=function(t){return t in this._all_models?this._all_models[t]:null},P.prototype.get_model_by_name=function(t){return this._all_models_by_name.get_one(t,\"Multiple models are named '\"+t+\"'\")},P.prototype.on_change=function(t){y.includes(this._callbacks,t)||this._callbacks.push(t)},P.prototype.remove_on_change=function(t){var e=this._callbacks.indexOf(t);0<=e&&this._callbacks.splice(e,1)},P.prototype._trigger_on_change=function(t){for(var e=0,i=this._callbacks;e<i.length;e++){var n=i[e];n(t)}},P.prototype._notify_change=function(t,e,i,n,r){\"name\"===e&&(this._all_models_by_name.remove_value(i,t),null!=n&&this._all_models_by_name.add_value(n,t));var o=null!=r?r.setter_id:void 0;this._trigger_on_change(new u(this,t,e,i,n,o))},P._references_json=function(t,e){void 0===e&&(e=!0);for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n],s=o.ref();s.attributes=o.attributes_as_json(e),delete s.attributes.id,i.push(s)}return i},P._instantiate_object=function(t,e,i){var n=o.__assign({},i,{id:t,__deferred__:!0}),r=s.Models(e);return new r(n)},P._instantiate_references_json=function(t,e){for(var i={},n=0,r=t;n<r.length;n++){var o=r[n],s=o.id,a=o.type,l=o.attributes||{},h=void 0;s in e?h=e[s]:(h=P._instantiate_object(s,a,l),null!=o.subtype&&h.set_subtype(o.subtype)),i[h.id]=h}return i},P._resolve_refs=function(t,e,i){function o(t){if(a.is_ref(t)){if(t.id in e)return e[t.id];if(t.id in i)return i[t.id];throw new Error(\"reference \"+JSON.stringify(t)+\" isn't known (not in Document?)\")}return d.isArray(t)?function(t){for(var e=[],i=0,n=t;i<n.length;i++){var r=n[i];e.push(o(r))}return e}(t):d.isObject(t)?function(t){var e={};for(var i in t){var n=t[i];e[i]=o(n)}return e}(t):t}return o(t)},P._initialize_references_json=function(t,e,i){for(var n={},r=0,o=t;r<o.length;r++){var s=o[r],a=s.id,l=s.attributes,h=!(a in e),c=h?i[a]:e[a],u=P._resolve_refs(l,e,i);n[c.id]=[c,u,h]}function _(h,c){var u={};function _(t){if(t instanceof p.HasProps){if(!(t.id in u)&&t.id in h){u[t.id]=!0;var e=h[t.id],i=e[1],n=e[2];for(var r in i){var o=i[r];_(o)}c(t,i,n)}}else if(d.isArray(t))for(var s=0,a=t;s<a.length;s++){var o=a[s];_(o)}else if(d.isObject(t))for(var l in t){var o=t[l];_(o)}}for(var t in h){var e=h[t],i=e[0];_(i)}}_(n,function(t,e,i){i&&t.setv(e,{silent:!0})}),_(n,function(t,e,i){i&&t.finalize()})},P._event_for_attribute_change=function(t,e,i,n,r){var o=n.get_model_by_id(t.id);if(o.attribute_is_serializable(e)){var s={kind:\"ModelChanged\",model:{id:t.id,type:t.type},attr:e,new:i};return p.HasProps._json_record_references(n,i,r,!0),s}return null},P._events_to_sync_objects=function(t,e,i,n){for(var r=Object.keys(t.attributes),o=Object.keys(e.attributes),s=y.difference(r,o),a=y.difference(o,r),l=y.intersection(r,o),h=[],c=0,u=s;c<u.length;c++){var _=u[c];j.logger.warn(\"Server sent key \"+_+\" but we don't seem to have it in our JSON\")}for(var p=0,d=a;p<d.length;p++){var _=d[p],f=e.attributes[_];h.push(P._event_for_attribute_change(t,_,f,i,n))}for(var v=0,m=l;v<m.length;v++){var _=m[v],g=t.attributes[_],f=e.attributes[_];null==g&&null==f||(null==g||null==f?h.push(P._event_for_attribute_change(t,_,f,i,n)):x.isEqual(g,f)||h.push(P._event_for_attribute_change(t,_,f,i,n)))}return h.filter(function(t){return null!=t})},P._compute_patch_since_json=function(t,e){var i=e.to_json(!1);function n(t){for(var e={},i=0,n=t.roots.references;i<n.length;i++){var r=n[i];e[r.id]=r}return e}for(var r=n(t),o={},s=[],a=0,l=t.roots.root_ids;a<l.length;a++){var h=l[a];o[h]=r[h],s.push(h)}for(var c=n(i),u={},_=[],p=0,d=i.roots.root_ids;p<d.length;p++){var h=d[p];u[h]=c[h],_.push(h)}if(s.sort(),_.sort(),0<y.difference(s,_).length||0<y.difference(_,s).length)throw new Error(\"Not implemented: computing add/remove of document roots\");var f={},v=[];for(var m in e._all_models)if(m in r){var g=P._events_to_sync_objects(r[m],c[m],e,f);v=v.concat(g)}return{references:P._references_json(b.values(f),!1),events:v}},P.prototype.to_json_string=function(t){return void 0===t&&(t=!0),JSON.stringify(this.to_json(t))},P.prototype.to_json=function(t){void 0===t&&(t=!0);var e=this._roots.map(function(t){return t.id}),i=b.values(this._all_models);return{title:this._title,roots:{root_ids:e,references:P._references_json(i,t)}}},P.from_json_string=function(t){var e=JSON.parse(t);return P.from_json(e)},P.from_json=function(t){j.logger.debug(\"Creating Document from JSON\");var e=t.version,i=-1!==e.indexOf(\"+\")||-1!==e.indexOf(\"-\"),n=\"Library versions: JS (\"+_.version+\") / Python (\"+e+\")\";i||_.version===e?j.logger.debug(n):(j.logger.warn(\"JS/Python version mismatch\"),j.logger.warn(n));var r=t.roots,o=r.root_ids,s=r.references,a=P._instantiate_references_json(s,{});P._initialize_references_json(s,{},a);for(var l=new P,h=0,c=o;h<c.length;h++){var u=c[h];l.add_root(a[u])}return l.set_title(t.title),l},P.prototype.replace_with_json=function(t){var e=P.from_json(t);e.destructively_move(this)},P.prototype.create_json_patch_string=function(t){return JSON.stringify(this.create_json_patch(t))},P.prototype.create_json_patch=function(t){for(var e={},i=[],n=0,r=t;n<r.length;n++){var o=r[n];if(o.document!==this)throw j.logger.warn(\"Cannot create a patch using events from a different document, event had \",o.document,\" we are \",this),new Error(\"Cannot create a patch using events from a different document\");i.push(o.json(e))}return{events:i,references:P._references_json(b.values(e))}},P.prototype.apply_json_patch=function(t,e,i){for(var n,r=t.references,o=t.events,s=P._instantiate_references_json(r,this._all_models),a=0,l=o;a<l.length;a++){var h=l[a];switch(h.kind){case\"RootAdded\":case\"RootRemoved\":case\"ModelChanged\":var c=h.model.id;if(c in this._all_models)s[c]=this._all_models[c];else if(!(c in s))throw j.logger.warn(\"Got an event for unknown model \",h.model),new Error(\"event model wasn't known\")}}var u={},_={};for(var p in s){var d=s[p];p in this._all_models?u[p]=d:_[p]=d}P._initialize_references_json(r,u,_);for(var f=0,v=o;f<v.length;f++){var h=v[f];switch(h.kind){case\"ModelChanged\":var m=h.model.id;if(!(m in this._all_models))throw new Error(\"Cannot apply patch to \"+m+\" which is not in the document\");var g=this._all_models[m],y=h.attr,b=h.model.type;if(\"data\"===y&&\"ColumnDataSource\"===b){var x=N.decode_column_data(h.new,e),w=x[0],k=x[1];g.setv({_shapes:k,data:w},{setter_id:i})}else{var d=P._resolve_refs(h.new,u,_);g.setv(((n={})[y]=d,n),{setter_id:i})}break;case\"ColumnDataChanged\":var S=h.column_source.id;if(!(S in this._all_models))throw new Error(\"Cannot stream to \"+S+\" which is not in the document\");var T=this._all_models[S],C=N.decode_column_data(h.new,e),w=C[0],k=C[1];if(null!=h.cols){for(var A in T.data)A in w||(w[A]=T.data[A]);for(var A in T._shapes)A in k||(k[A]=T._shapes[A])}T.setv({_shapes:k,data:w},{setter_id:i,check_eq:!1});break;case\"ColumnsStreamed\":var S=h.column_source.id;if(!(S in this._all_models))throw new Error(\"Cannot stream to \"+S+\" which is not in the document\");var T=this._all_models[S];if(!(T instanceof F.ColumnDataSource))throw new Error(\"Cannot stream to non-ColumnDataSource\");var w=h.data,E=h.rollover;T.stream(w,E);break;case\"ColumnsPatched\":var S=h.column_source.id;if(!(S in this._all_models))throw new Error(\"Cannot patch \"+S+\" which is not in the document\");var T=this._all_models[S];if(!(T instanceof F.ColumnDataSource))throw new Error(\"Cannot patch non-ColumnDataSource\");var M=h.patches;T.patch(M);break;case\"RootAdded\":var O=h.model.id,z=s[O];this.add_root(z,i);break;case\"RootRemoved\":var O=h.model.id,z=s[O];this.remove_root(z,i);break;case\"TitleChanged\":this.set_title(h.title,i);break;default:throw new Error(\"Unknown patch event \"+JSON.stringify(h))}}},P}();i.Document=k},function(t,e,n){var r=t(5);function o(t){var e=document.getElementById(t);if(null==e)throw new Error(\"Error rendering Bokeh model: could not find #\"+t+\" HTML tag\");if(!document.body.contains(e))throw new Error(\"Error rendering Bokeh model: element #\"+t+\" must be under <body>\");if(\"SCRIPT\"==e.tagName){var i=r.div({class:n.BOKEH_ROOT});r.replaceWith(e,i),e=i}return e}n.BOKEH_ROOT=\"bk-root\",n.inject_css=function(t){var e=r.link({href:t,rel:\"stylesheet\",type:\"text/css\"});document.body.appendChild(e)},n.inject_raw_css=function(t){var e=r.style({},t);document.body.appendChild(e)},n._resolve_element=function(t){var e=t.elementid;return null!=e?o(e):document.body},n._resolve_root_elements=function(t){var e={};if(null!=t.roots)for(var i in t.roots)e[i]=o(t.roots[i]);return e}},function(t,e,i){var d=t(50),f=t(14),r=t(25),v=t(38),m=t(44),g=t(55),y=t(54),b=t(51),n=t(55);i.add_document_standalone=n.add_document_standalone;var o=t(54);i.add_document_from_session=o.add_document_from_session;var s=t(53);i.embed_items_notebook=s.embed_items_notebook;var a=t(51);i.BOKEH_ROOT=a.BOKEH_ROOT,i.inject_css=a.inject_css,i.inject_raw_css=a.inject_raw_css,i.embed_items=function(t,e,i,n){r.defer(function(){return function(t,e,i,n){m.isString(t)&&(t=JSON.parse(v.unescape(t)));var r={};for(var o in t){var s=t[o];r[o]=d.Document.from_json(s)}for(var a=0,l=e;a<l.length;a++){var h=l[a],c=b._resolve_element(h),u=b._resolve_root_elements(h);if(null!=h.docid)g.add_document_standalone(r[h.docid],c,u,h.use_for_title);else{if(null==h.sessionid)throw new Error(\"Error rendering Bokeh items: either 'docid' or 'sessionid' was expected.\");var _=y._get_ws_url(i,n);f.logger.debug(\"embed: computed ws url: \"+_);var p=y.add_document_from_session(_,h.sessionid,c,u,h.use_for_title);p.then(function(){console.log(\"Bokeh items were rendered successfully\")},function(t){console.log(\"Error rendering Bokeh items:\",t)})}}}(t,e,i,n)})}},function(t,e,r){var l=t(50),o=t(270),s=t(14),h=t(32),c=t(55),u=t(51);function a(t,e){0<e.buffers.length?t.consume(e.buffers[0].buffer):t.consume(e.content.data);var i=t.message;null!=i&&this.apply_json_patch(i.content,i.buffers)}function _(i,n){if(\"undefined\"!=typeof Jupyter&&null!=Jupyter.notebook.kernel){s.logger.info(\"Registering Jupyter comms for target \"+i);var t=Jupyter.notebook.kernel.comm_manager;try{t.register_target(i,function(t){s.logger.info(\"Registering Jupyter comms for target \"+i);var e=new o.Receiver;t.on_msg(a.bind(n,e))})}catch(t){s.logger.warn(\"Jupyter comms failed to register. push_notebook() will not function. (exception reported: \"+t+\")\")}}else if(n.roots()[0].id in r.kernels){s.logger.info(\"Registering JupyterLab comms for target \"+i);var e=r.kernels[n.roots()[0].id];try{e.registerCommTarget(i,function(t){s.logger.info(\"Registering JupyterLab comms for target \"+i);var e=new o.Receiver;t.onMsg=a.bind(n,e)})}catch(t){s.logger.warn(\"Jupyter comms failed to register. push_notebook() will not function. (exception reported: \"+t+\")\")}}else console.warn(\"Jupyter notebooks comms not available. push_notebook() will not function. If running JupyterLab ensure the latest jupyterlab_bokeh extension is installed. In an exported notebook this warning is expected.\")}r.kernels={},r.embed_items_notebook=function(t,e){if(1!=h.size(t))throw new Error(\"embed_items_notebook expects exactly one document in docs_json\");for(var i=l.Document.from_json(h.values(t)[0]),n=0,r=e;n<r.length;n++){var o=r[n];null!=o.notebook_comms_target&&_(o.notebook_comms_target,i);var s=u._resolve_element(o),a=u._resolve_root_elements(o);c.add_document_standalone(i,s,a)}}},function(t,e,i){var s=t(1),a=t(14),l=t(55);i._get_ws_url=function(t,e){var i,n=\"ws:\";return\"https:\"==window.location.protocol&&(n=\"wss:\"),null!=e?(i=document.createElement(\"a\")).href=e:i=window.location,null!=t?\"/\"==t&&(t=\"\"):t=i.pathname.replace(/\\/+$/,\"\"),n+\"//\"+i.host+t+\"/ws\"};var h={};i.add_document_from_session=function(t,e,i,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var o=window.location.search.substr(1);return function(t,e,i){t in h||(h[t]={});var n=h[t];return e in n||(n[e]=s.pull_session(t,e,i)),n[e]}(t,e,o).then(function(t){return l.add_document_standalone(t.document,i,n,r)},function(t){throw a.logger.error(\"Failed to load Bokeh session \"+e+\": \"+t),t})}},function(t,e,i){var h=t(50),c=t(5),u=t(0),_=t(51);i.add_document_standalone=function(t,o,s,e){void 0===s&&(s={}),void 0===e&&(e=!1);var a={};function i(t){var e;t.id in s?e=s[t.id]:o.classList.contains(_.BOKEH_ROOT)?e=o:(e=c.div({class:_.BOKEH_ROOT}),o.appendChild(e));var i,n,r=(n=new(i=t).default_view({model:i,parent:null}),u.index[i.id]=n);r.renderTo(e),a[t.id]=r}for(var n=0,r=t.roots();n<r.length;n++){var l=r[n];i(l)}return e&&(window.document.title=t.title()),t.on_change(function(t){t instanceof h.RootAddedEvent?i(t.model):t instanceof h.RootRemovedEvent?function(t){var e=t.id;if(e in a){var i=a[e];i.remove(),delete a[e],delete u.index[e]}}(t.model):e&&t instanceof h.TitleChangedEvent&&(window.document.title=t.title)}),a}},function(t,e,i){t(267);var n=t(272);i.version=n.version;var r=t(52);i.embed=r;var o=t(268);i.protocol=o;var s=t(14);i.logger=s.logger,i.set_log_level=s.set_log_level;var a=t(18);i.settings=a.settings;var l=t(0);i.Models=l.Models,i.index=l.index;var h=t(50);i.documents=h.documents;var c=t(271);i.safely=c.safely},function(t,e,i){var n=t(387),r=t(8),o=t(15),s=t(44),a=t(32),l=t(14),h=function(_){function i(t){return _.call(this,t)||this}return n.__extends(i,_),i.initClass=function(){this.prototype.type=\"Model\",this.define({tags:[o.Array,[]],name:[o.String],js_property_callbacks:[o.Any,{}],js_event_callbacks:[o.Any,{}],subscribed_events:[o.Array,[]]})},i.prototype.connect_signals=function(){var i=this;for(var t in _.prototype.connect_signals.call(this),this.js_property_callbacks)for(var e=this.js_property_callbacks[t],n=t.split(\":\"),r=n[0],o=n[1],s=void 0===o?null:o,a=function(t){var e=null!=s?l.properties[s][r]:l[r];l.connect(e,function(){return t.execute(i,{})})},l=this,h=0,c=e;h<c.length;h++){var u=c[h];a(u)}this.connect(this.properties.js_event_callbacks.change,function(){return i._update_event_callbacks}),this.connect(this.properties.subscribed_events.change,function(){return i._update_event_callbacks})},i.prototype._process_event=function(e){if(e.is_applicable_to(this)){e=e._customize_event(this);for(var t=0,i=this.js_event_callbacks[e.event_name]||[];t<i.length;t++){var n=i[t];n.execute(e,{})}null!=this.document&&this.subscribed_events.some(function(t){return t==e.event_name})&&this.document.event_manager.send_event(e)}},i.prototype.trigger_event=function(t){null!=this.document&&this.document.event_manager.trigger(t.set_model_id(this.id))},i.prototype._update_event_callbacks=function(){null!=this.document?this.document.event_manager.subscribed_models.push(this.id):l.logger.warn(\"WARNING: Document not defined for updating event callbacks\")},i.prototype._doc_attached=function(){a.isEmpty(this.js_event_callbacks)&&a.isEmpty(this.subscribed_events)||this._update_event_callbacks()},i.prototype.select=function(e){if(s.isString(e))return this.references().filter(function(t){return t instanceof i&&t.name===e});if(e.prototype instanceof r.HasProps)return this.references().filter(function(t){return t instanceof e});throw new Error(\"invalid selector\")},i.prototype.select_one=function(t){var e=this.select(t);switch(e.length){case 0:return null;case 1:return e[0];default:throw new Error(\"found more than one object matching given selector\")}},i}(r.HasProps);(i.Model=h).initClass()},function(t,e,i){var n=t(387),r=t(12),o=t(15),s=t(33),a=t(32),l=t(179),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._get_size=function(){throw new Error(\"not implemented\")},e.prototype.get_size=function(){return this.model.visible?Math.round(this._get_size()):0},e.prototype.set_data=function(t){var e,i,n=this.model.materialize_dataspecs(t);if(a.extend(this,n),this.plot_model.use_map){var r=this;null!=r._x&&(e=s.project_xy(r._x,r._y),r._x=e[0],r._y=e[1]),null!=r._xs&&(i=s.project_xsys(r._xs,r._ys),r._xs=i[0],r._ys=i[1])}},e}(l.RendererView);i.AnnotationView=h;var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Annotation\",this.define({plot:[o.Instance]}),this.override({level:\"annotation\"})},t.prototype.add_panel=function(t){if(null==this.panel||t!==this.panel.side){var e=new r.SidePanel({side:t});e.attach_document(this.document),this.set_panel(e)}},t.prototype.set_panel=function(t){this.panel=t,this.level=\"overlay\"},t}(l.Renderer);(i.Annotation=c).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(60),s=t(190),a=t(15),l=t(31),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),null==this.model.source&&(this.model.source=new s.ColumnDataSource),this.set_data(this.model.source)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.plot_view.request_render()}),this.connect(this.model.source.streaming,function(){return t.set_data(t.model.source)}),this.connect(this.model.source.patching,function(){return t.set_data(t.model.source)}),this.connect(this.model.source.change,function(){return t.set_data(t.model.source)})},t.prototype.set_data=function(t){e.prototype.set_data.call(this,t),this.visuals.warm_cache(t),this.plot_view.request_render()},t.prototype._map_data=function(){var t,e,i,n,r=this.plot_view.frame;return\"data\"==this.model.start_units?(t=r.xscales[this.model.x_range_name].v_compute(this._x_start),e=r.yscales[this.model.y_range_name].v_compute(this._y_start)):(t=r.xview.v_compute(this._x_start),e=r.yview.v_compute(this._y_start)),\"data\"==this.model.end_units?(i=r.xscales[this.model.x_range_name].v_compute(this._x_end),n=r.yscales[this.model.y_range_name].v_compute(this._y_end)):(i=r.xview.v_compute(this._x_end),n=r.yview.v_compute(this._y_end)),[[t,e],[i,n]]},t.prototype.render=function(){if(this.model.visible){var t=this.plot_view.canvas_view.ctx;t.save();var e=this._map_data(),i=e[0],n=e[1];null!=this.model.end&&this._arrow_head(t,\"render\",this.model.end,i,n),null!=this.model.start&&this._arrow_head(t,\"render\",this.model.start,n,i),t.beginPath();var r=this.plot_model.canvas.bbox.rect,o=r.x,s=r.y,a=r.width,l=r.height;t.rect(o,s,a,l),null!=this.model.end&&this._arrow_head(t,\"clip\",this.model.end,i,n),null!=this.model.start&&this._arrow_head(t,\"clip\",this.model.start,n,i),t.closePath(),t.clip(),this._arrow_body(t,i,n),t.restore()}},t.prototype._arrow_head=function(t,e,i,n,r){for(var o=0,s=this._x_start.length;o<s;o++){var a=Math.PI/2+l.atan2([n[0][o],n[1][o]],[r[0][o],r[1][o]]);t.save(),t.translate(r[0][o],r[1][o]),t.rotate(a),\"render\"==e?i.render(t,o):\"clip\"==e&&i.clip(t,o),t.restore()}},t.prototype._arrow_body=function(t,e,i){if(this.visuals.line.doit)for(var n=0,r=this._x_start.length;n<r;n++)this.visuals.line.set_vectorize(t,n),t.beginPath(),t.moveTo(e[0][n],e[1][n]),t.lineTo(i[0][n],i[1][n]),t.stroke()},t}(r.AnnotationView);i.ArrowView=h;var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Arrow\",this.prototype.default_view=h,this.mixins([\"line\"]),this.define({x_start:[a.NumberSpec],y_start:[a.NumberSpec],start_units:[a.String,\"data\"],start:[a.Instance,null],x_end:[a.NumberSpec],y_end:[a.NumberSpec],end_units:[a.String,\"data\"],end:[a.Instance,function(){return new o.OpenHead({})}],source:[a.Instance],x_range_name:[a.String,\"default\"],y_range_name:[a.String,\"default\"]})},t}(r.Annotation);(i.Arrow=c).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(49),s=t(15),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ArrowHead\",this.define({size:[s.Number,25]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.visuals=new o.Visuals(this)},t}(r.Annotation);(i.ArrowHead=a).initClass();var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"OpenHead\",this.mixins([\"line\"])},t.prototype.clip=function(t,e){this.visuals.line.set_vectorize(t,e),t.moveTo(.5*this.size,this.size),t.lineTo(.5*this.size,-2),t.lineTo(-.5*this.size,-2),t.lineTo(-.5*this.size,this.size),t.lineTo(0,0),t.lineTo(.5*this.size,this.size)},t.prototype.render=function(t,e){this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,e),t.beginPath(),t.moveTo(.5*this.size,this.size),t.lineTo(0,0),t.lineTo(-.5*this.size,this.size),t.stroke())},t}(a);(i.OpenHead=l).initClass();var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"NormalHead\",this.mixins([\"line\",\"fill\"]),this.override({fill_color:\"black\"})},t.prototype.clip=function(t,e){this.visuals.line.set_vectorize(t,e),t.moveTo(.5*this.size,this.size),t.lineTo(.5*this.size,-2),t.lineTo(-.5*this.size,-2),t.lineTo(-.5*this.size,this.size),t.lineTo(.5*this.size,this.size)},t.prototype.render=function(t,e){this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,e),this._normal(t,e),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,e),this._normal(t,e),t.stroke())},t.prototype._normal=function(t,e){t.beginPath(),t.moveTo(.5*this.size,this.size),t.lineTo(0,0),t.lineTo(-.5*this.size,this.size),t.closePath()},t}(a);(i.NormalHead=h).initClass();var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"VeeHead\",this.mixins([\"line\",\"fill\"]),this.override({fill_color:\"black\"})},t.prototype.clip=function(t,e){this.visuals.line.set_vectorize(t,e),t.moveTo(.5*this.size,this.size),t.lineTo(.5*this.size,-2),t.lineTo(-.5*this.size,-2),t.lineTo(-.5*this.size,this.size),t.lineTo(0,.5*this.size),t.lineTo(.5*this.size,this.size)},t.prototype.render=function(t,e){this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,e),this._vee(t,e),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,e),this._vee(t,e),t.stroke())},t.prototype._vee=function(t,e){t.beginPath(),t.moveTo(.5*this.size,this.size),t.lineTo(0,0),t.lineTo(-.5*this.size,this.size),t.lineTo(0,.5*this.size),t.closePath()},t}(a);(i.VeeHead=c).initClass();var u=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"TeeHead\",this.mixins([\"line\"])},t.prototype.render=function(t,e){this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,e),t.beginPath(),t.moveTo(.5*this.size,0),t.lineTo(-.5*this.size,0),t.stroke())},t.prototype.clip=function(t,e){},t}(a);(i.TeeHead=u).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(190),s=t(15),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.set_data(this.model.source)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.source.streaming,function(){return t.set_data(t.model.source)}),this.connect(this.model.source.patching,function(){return t.set_data(t.model.source)}),this.connect(this.model.source.change,function(){return t.set_data(t.model.source)})},t.prototype.set_data=function(t){e.prototype.set_data.call(this,t),this.visuals.warm_cache(t),this.plot_view.request_render()},t.prototype._map_data=function(){var t,e,i,n=this.plot_view.frame,r=this.model.dimension,o=n.xscales[this.model.x_range_name],s=n.yscales[this.model.y_range_name],a=\"height\"==r?s:o,l=\"height\"==r?o:s,h=\"height\"==r?n.yview:n.xview,c=\"height\"==r?n.xview:n.yview;t=\"data\"==this.model.lower.units?a.v_compute(this._lower):h.v_compute(this._lower),e=\"data\"==this.model.upper.units?a.v_compute(this._upper):h.v_compute(this._upper),i=\"data\"==this.model.base.units?l.v_compute(this._base):c.v_compute(this._base);var u=\"height\"==r?[1,0]:[0,1],_=u[0],p=u[1],d=[t,i],f=[e,i];this._lower_sx=d[_],this._lower_sy=d[p],this._upper_sx=f[_],this._upper_sy=f[p]},t.prototype.render=function(){if(this.model.visible){this._map_data();var t=this.plot_view.canvas_view.ctx;t.beginPath(),t.moveTo(this._lower_sx[0],this._lower_sy[0]);for(var e=0,i=this._lower_sx.length;e<i;e++)t.lineTo(this._lower_sx[e],this._lower_sy[e]);for(var n=this._upper_sx.length-1,e=n;0<=e;e--)t.lineTo(this._upper_sx[e],this._upper_sy[e]);t.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_value(t),t.fill()),t.beginPath(),t.moveTo(this._lower_sx[0],this._lower_sy[0]);for(var e=0,i=this._lower_sx.length;e<i;e++)t.lineTo(this._lower_sx[e],this._lower_sy[e]);this.visuals.line.doit&&(this.visuals.line.set_value(t),t.stroke()),t.beginPath(),t.moveTo(this._upper_sx[0],this._upper_sy[0]);for(var e=0,i=this._upper_sx.length;e<i;e++)t.lineTo(this._upper_sx[e],this._upper_sy[e]);this.visuals.line.doit&&(this.visuals.line.set_value(t),t.stroke())}},t}(r.AnnotationView);i.BandView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Band\",this.prototype.default_view=a,this.mixins([\"line\",\"fill\"]),this.define({lower:[s.DistanceSpec],upper:[s.DistanceSpec],base:[s.DistanceSpec],dimension:[s.Dimension,\"height\"],source:[s.Instance,function(){return new o.ColumnDataSource}],x_range_name:[s.String,\"default\"],y_range_name:[s.String,\"default\"]}),this.override({fill_color:\"#fff9ba\",fill_alpha:.4,line_color:\"#cccccc\",line_alpha:.3})},t}(r.Annotation);(i.Band=l).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(19),l=t(5),s=t(15),a=t(24);i.EDGE_TOLERANCE=2.5;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.plot_view.canvas_overlays.appendChild(this.el),this.el.classList.add(\"bk-shading\"),l.hide(this.el)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),\"css\"==this.model.render_mode?(this.connect(this.model.change,function(){return t.render()}),this.connect(this.model.data_update,function(){return t.render()})):(this.connect(this.model.change,function(){return t.plot_view.request_render()}),this.connect(this.model.data_update,function(){return t.plot_view.request_render()}))},t.prototype.render=function(){var o=this;if(this.model.visible||\"css\"!=this.model.render_mode||l.hide(this.el),this.model.visible)if(null!=this.model.left||null!=this.model.right||null!=this.model.top||null!=this.model.bottom){var t=this.plot_model.frame,e=t.xscales[this.model.x_range_name],i=t.yscales[this.model.y_range_name],n=function(t,e,i,n,r){return null!=t?o.model.screen?t:\"data\"==e?i.compute(t):n.compute(t):r};this.sleft=n(this.model.left,this.model.left_units,e,t.xview,t._left.value),this.sright=n(this.model.right,this.model.right_units,e,t.xview,t._right.value),this.stop=n(this.model.top,this.model.top_units,i,t.yview,t._top.value),this.sbottom=n(this.model.bottom,this.model.bottom_units,i,t.yview,t._bottom.value);var r=\"css\"==this.model.render_mode?this._css_box.bind(this):this._canvas_box.bind(this);r(this.sleft,this.sright,this.sbottom,this.stop)}else l.hide(this.el)},t.prototype._css_box=function(t,e,i,n){var r=this.model.properties.line_width.value(),o=Math.floor(e-t)-r,s=Math.floor(i-n)-r;this.el.style.left=t+\"px\",this.el.style.width=o+\"px\",this.el.style.top=n+\"px\",this.el.style.height=s+\"px\",this.el.style.borderWidth=r+\"px\",this.el.style.borderColor=this.model.properties.line_color.value(),this.el.style.backgroundColor=this.model.properties.fill_color.value(),this.el.style.opacity=this.model.properties.fill_alpha.value();var a=this.model.properties.line_dash.value().length<2?\"solid\":\"dashed\";this.el.style.borderStyle=a,l.show(this.el)},t.prototype._canvas_box=function(t,e,i,n){var r=this.plot_view.canvas_view.ctx;r.save(),r.beginPath(),r.rect(t,n,e-t,i-n),this.visuals.fill.set_value(r),r.fill(),this.visuals.line.set_value(r),r.stroke(),r.restore()},t.prototype.interactive_bbox=function(){var t=this.model.properties.line_width.value()+i.EDGE_TOLERANCE;return new a.BBox({x0:this.sleft-t,y0:this.stop-t,x1:this.sright+t,y1:this.sbottom+t})},t.prototype.interactive_hit=function(t,e){if(null==this.model.in_cursor)return!1;var i=this.interactive_bbox();return i.contains(t,e)},t.prototype.cursor=function(t,e){return Math.abs(t-this.sleft)<3||Math.abs(t-this.sright)<3?this.model.ew_cursor:Math.abs(e-this.sbottom)<3||Math.abs(e-this.stop)<3?this.model.ns_cursor:t>this.sleft&&t<this.sright&&e>this.stop&&e<this.sbottom?this.model.in_cursor:null},t}(r.AnnotationView);i.BoxAnnotationView=h;var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"BoxAnnotation\",this.prototype.default_view=h,this.mixins([\"line\",\"fill\"]),this.define({render_mode:[s.RenderMode,\"canvas\"],x_range_name:[s.String,\"default\"],y_range_name:[s.String,\"default\"],top:[s.Number,null],top_units:[s.SpatialUnits,\"data\"],bottom:[s.Number,null],bottom_units:[s.SpatialUnits,\"data\"],left:[s.Number,null],left_units:[s.SpatialUnits,\"data\"],right:[s.Number,null],right_units:[s.SpatialUnits,\"data\"]}),this.internal({screen:[s.Boolean,!1],ew_cursor:[s.String,null],ns_cursor:[s.String,null],in_cursor:[s.String,null]}),this.override({fill_color:\"#fff9ba\",fill_alpha:.4,line_color:\"#cccccc\",line_alpha:.3})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.data_update=new o.Signal0(this,\"data_update\")},t.prototype.update=function(t){var e=t.left,i=t.right,n=t.top,r=t.bottom;this.setv({left:e,right:i,top:n,bottom:r,screen:!0},{silent:!0}),this.data_update.emit()},t}(r.Annotation);(i.BoxAnnotation=c).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(197),s=t(102),c=t(160),a=t(182),l=t(183),h=t(174),u=t(15),_=t(41),p=t(21),g=t(22),d=t(32),f=t(44),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this._set_canvas_image()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.visible.change,function(){return t.plot_view.request_render()}),this.connect(this.model.ticker.change,function(){return t.plot_view.request_render()}),this.connect(this.model.formatter.change,function(){return t.plot_view.request_render()}),null!=this.model.color_mapper&&this.connect(this.model.color_mapper.change,function(){t._set_canvas_image(),t.plot_view.request_render()})},t.prototype._get_size=function(){if(null==this.model.color_mapper)return 0;var t=this.compute_legend_dimensions(),e=this.model.panel.side;switch(e){case\"above\":case\"below\":return t.height;case\"left\":case\"right\":return t.width;default:throw new Error(\"unreachable code\")}},t.prototype._set_canvas_image=function(){var t,e;if(null!=this.model.color_mapper){var i,n,r=this.model.color_mapper.palette;switch(\"vertical\"==this.model.orientation&&(r=p.reversed(r)),this.model.orientation){case\"vertical\":t=[1,r.length],i=t[0],n=t[1];break;case\"horizontal\":e=[r.length,1],i=e[0],n=e[1];break;default:throw new Error(\"unreachable code\")}var o=document.createElement(\"canvas\");o.width=i,o.height=n;var s=o.getContext(\"2d\"),a=s.getImageData(0,0,i,n),l=new c.LinearColorMapper({palette:r}).rgba_mapper,h=l.v_compute(p.range(0,r.length));a.data.set(h),s.putImageData(a,0,0),this.image=o}},t.prototype.compute_legend_dimensions=function(){var t,e,i=this.model._computed_image_dimensions(),n=[i.height,i.width],r=n[0],o=n[1],s=this._get_label_extent(),a=this.model._title_extent(),l=this.model._tick_extent(),h=this.model.padding;switch(this.model.orientation){case\"vertical\":t=r+a+2*h,e=o+l+s+2*h;break;case\"horizontal\":t=r+a+l+s+2*h,e=o+2*h;break;default:throw new Error(\"unreachable code\")}return{width:e,height:t}},t.prototype.compute_legend_location=function(){var t,e,i=this.compute_legend_dimensions(),n=[i.height,i.width],r=n[0],o=n[1],s=this.model.margin,a=null!=this.model.panel?this.model.panel:this.plot_view.frame,l=a.bbox.ranges,h=l[0],c=l[1],u=this.model.location;if(f.isString(u))switch(u){case\"top_left\":t=h.start+s,e=c.start+s;break;case\"top_center\":t=(h.end+h.start)/2-o/2,e=c.start+s;break;case\"top_right\":t=h.end-s-o,e=c.start+s;break;case\"bottom_right\":t=h.end-s-o,e=c.end-s-r;break;case\"bottom_center\":t=(h.end+h.start)/2-o/2,e=c.end-s-r;break;case\"bottom_left\":t=h.start+s,e=c.end-s-r;break;case\"center_left\":t=h.start+s,e=(c.end+c.start)/2-r/2;break;case\"center\":t=(h.end+h.start)/2-o/2,e=(c.end+c.start)/2-r/2;break;case\"center_right\":t=h.end-s-o,e=(c.end+c.start)/2-r/2;break;default:throw new Error(\"unreachable code\")}else{if(!f.isArray(u)||2!=u.length)throw new Error(\"unreachable code\");var _=u[0],p=u[1];t=a.xview.compute(_),e=a.yview.compute(p)-r}return{sx:t,sy:e}},t.prototype.render=function(){if(this.model.visible&&null!=this.model.color_mapper){var t=this.plot_view.canvas_view.ctx;t.save();var e=this.compute_legend_location(),i=e.sx,n=e.sy;t.translate(i,n),this._draw_bbox(t);var r=this._get_image_offset();if(t.translate(r.x,r.y),this._draw_image(t),null!=this.model.color_mapper.low&&null!=this.model.color_mapper.high){var o=this.model.tick_info();this._draw_major_ticks(t,o),this._draw_minor_ticks(t,o),this._draw_major_labels(t,o)}this.model.title&&this._draw_title(t),t.restore()}},t.prototype._draw_bbox=function(t){var e=this.compute_legend_dimensions();t.save(),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),t.fillRect(0,0,e.width,e.height)),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),t.strokeRect(0,0,e.width,e.height)),t.restore()},t.prototype._draw_image=function(t){var e=this.model._computed_image_dimensions();t.save(),t.setImageSmoothingEnabled(!1),t.globalAlpha=this.model.scale_alpha,t.drawImage(this.image,0,0,e.width,e.height),this.visuals.bar_line.doit&&(this.visuals.bar_line.set_value(t),t.strokeRect(0,0,e.width,e.height)),t.restore()},t.prototype._draw_major_ticks=function(t,e){if(this.visuals.major_tick_line.doit){var i=this.model._normals(),n=i[0],r=i[1],o=this.model._computed_image_dimensions(),s=[o.width*n,o.height*r],a=s[0],l=s[1],h=e.coords.major,c=h[0],u=h[1],_=this.model.major_tick_in,p=this.model.major_tick_out;t.save(),t.translate(a,l),this.visuals.major_tick_line.set_value(t);for(var d=0,f=c.length;d<f;d++)t.beginPath(),t.moveTo(Math.round(c[d]+n*p),Math.round(u[d]+r*p)),t.lineTo(Math.round(c[d]-n*_),Math.round(u[d]-r*_)),t.stroke();t.restore()}},t.prototype._draw_minor_ticks=function(t,e){if(this.visuals.minor_tick_line.doit){var i=this.model._normals(),n=i[0],r=i[1],o=this.model._computed_image_dimensions(),s=[o.width*n,o.height*r],a=s[0],l=s[1],h=e.coords.minor,c=h[0],u=h[1],_=this.model.minor_tick_in,p=this.model.minor_tick_out;t.save(),t.translate(a,l),this.visuals.minor_tick_line.set_value(t);for(var d=0,f=c.length;d<f;d++)t.beginPath(),t.moveTo(Math.round(c[d]+n*p),Math.round(u[d]+r*p)),t.lineTo(Math.round(c[d]-n*_),Math.round(u[d]-r*_)),t.stroke();t.restore()}},t.prototype._draw_major_labels=function(t,e){if(this.visuals.major_label_text.doit){var i=this.model._normals(),n=i[0],r=i[1],o=this.model._computed_image_dimensions(),s=[o.width*n,o.height*r],a=s[0],l=s[1],h=this.model.label_standoff+this.model._tick_extent(),c=[h*n,h*r],u=c[0],_=c[1],p=e.coords.major,d=p[0],f=p[1],v=e.labels.major;this.visuals.major_label_text.set_value(t),t.save(),t.translate(a+u,l+_);for(var m=0,g=d.length;m<g;m++)t.fillText(v[m],Math.round(d[m]+n*this.model.label_standoff),Math.round(f[m]+r*this.model.label_standoff));t.restore()}},t.prototype._draw_title=function(t){this.visuals.title_text.doit&&(t.save(),this.visuals.title_text.set_value(t),t.fillText(this.model.title,0,-this.model.title_standoff),t.restore())},t.prototype._get_label_extent=function(){var t,e=this.model.tick_info().labels.major;if(null==this.model.color_mapper.low||null==this.model.color_mapper.high||d.isEmpty(e))t=0;else{var i=this.plot_view.canvas_view.ctx;switch(i.save(),this.visuals.major_label_text.set_value(i),this.model.orientation){case\"vertical\":t=p.max(e.map(function(t){return i.measureText(t.toString()).width}));break;case\"horizontal\":t=_.get_text_height(this.visuals.major_label_text.font_value()).height;break;default:throw new Error(\"unreachable code\")}t+=this.model.label_standoff,i.restore()}return t},t.prototype._get_image_offset=function(){var t=this.model.padding,e=this.model.padding+this.model._title_extent();return{x:t,y:e}},t}(r.AnnotationView);i.ColorBarView=v;var m=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ColorBar\",this.prototype.default_view=v,this.mixins([\"text:major_label_\",\"text:title_\",\"line:major_tick_\",\"line:minor_tick_\",\"line:border_\",\"line:bar_\",\"fill:background_\"]),this.define({location:[u.Any,\"top_right\"],orientation:[u.Orientation,\"vertical\"],title:[u.String],title_standoff:[u.Number,2],width:[u.Any,\"auto\"],height:[u.Any,\"auto\"],scale_alpha:[u.Number,1],ticker:[u.Instance,function(){return new o.BasicTicker}],formatter:[u.Instance,function(){return new s.BasicTickFormatter}],major_label_overrides:[u.Any,{}],color_mapper:[u.Instance],label_standoff:[u.Number,5],margin:[u.Number,30],padding:[u.Number,10],major_tick_in:[u.Number,5],major_tick_out:[u.Number,0],minor_tick_in:[u.Number,0],minor_tick_out:[u.Number,0]}),this.override({background_fill_color:\"#ffffff\",background_fill_alpha:.95,bar_line_color:null,border_line_color:null,major_label_text_align:\"center\",major_label_text_baseline:\"middle\",major_label_text_font_size:\"8pt\",major_tick_line_color:\"#ffffff\",minor_tick_line_color:null,title_text_font_size:\"10pt\",title_text_font_style:\"italic\"})},t.prototype._normals=function(){return\"vertical\"==this.orientation?[1,0]:[0,1]},t.prototype._title_extent=function(){var t=this.title_text_font+\" \"+this.title_text_font_size+\" \"+this.title_text_font_style,e=this.title?_.get_text_height(t).height+this.title_standoff:0;return e},t.prototype._tick_extent=function(){return null!=this.color_mapper.low&&null!=this.color_mapper.high?p.max([this.major_tick_out,this.minor_tick_out]):0},t.prototype._computed_image_dimensions=function(){var t,e,i=this.plot.plot_canvas.frame._height.value,n=this.plot.plot_canvas.frame._width.value,r=this._title_extent();switch(this.orientation){case\"vertical\":\"auto\"==this.height?null!=this.panel?t=i-2*this.padding-r:(t=p.max([25*this.color_mapper.palette.length,.3*i]),t=p.min([t,.8*i-2*this.padding-r])):t=this.height,e=\"auto\"==this.width?25:this.width;break;case\"horizontal\":t=\"auto\"==this.height?25:this.height,\"auto\"==this.width?null!=this.panel?e=n-2*this.padding:(e=p.max([25*this.color_mapper.palette.length,.3*n]),e=p.min([e,.8*n-2*this.padding])):e=this.width;break;default:throw new Error(\"unreachable code\")}return{width:e,height:t}},t.prototype._tick_coordinate_scale=function(t){var e={source_range:new h.Range1d({start:this.color_mapper.low,end:this.color_mapper.high}),target_range:new h.Range1d({start:0,end:t})};switch(this.color_mapper.type){case\"LinearColorMapper\":return new a.LinearScale(e);case\"LogColorMapper\":return new l.LogScale(e);default:throw new Error(\"unreachable code\")}},t.prototype._format_major_labels=function(t,e){for(var i=this.formatter.doFormat(t,null),n=0,r=e.length;n<r;n++)e[n]in this.major_label_overrides&&(i[n]=this.major_label_overrides[e[n]]);return i},t.prototype.tick_info=function(){var e,t=this._computed_image_dimensions();switch(this.orientation){case\"vertical\":e=t.height;break;case\"horizontal\":e=t.width;break;default:throw new Error(\"unreachable code\")}for(var i=this._tick_coordinate_scale(e),n=this._normals(),r=n[0],o=n[1],s=[this.color_mapper.low,this.color_mapper.high],a=s[0],l=s[1],h=this.ticker.get_ticks(a,l,null,null,this.ticker.desired_num_ticks),c=h.major,u=h.minor,_=[[],[]],p=[[],[]],d=0,f=c.length;d<f;d++)c[d]<a||c[d]>l||(_[r].push(c[d]),_[o].push(0));for(var d=0,f=u.length;d<f;d++)u[d]<a||u[d]>l||(p[r].push(u[d]),p[o].push(0));var v={major:this._format_major_labels(_[r],c)},m={major:[[],[]],minor:[[],[]]};return m.major[r]=i.v_compute(_[r]),m.minor[r]=i.v_compute(p[r]),m.major[o]=_[o],m.minor[o]=p[o],\"vertical\"==this.orientation&&(m.major[r]=g.map(m.major[r],function(t){return e-t}),m.minor[r]=g.map(m.minor[r],function(t){return e-t})),{coords:m,labels:v}},t}(r.Annotation);(i.ColorBar=m).initClass()},function(t,e,i){var n=t(58);i.Annotation=n.Annotation;var r=t(59);i.Arrow=r.Arrow;var o=t(60);i.ArrowHead=o.ArrowHead;var s=t(60);i.OpenHead=s.OpenHead;var a=t(60);i.NormalHead=a.NormalHead;var l=t(60);i.TeeHead=l.TeeHead;var h=t(60);i.VeeHead=h.VeeHead;var c=t(61);i.Band=c.Band;var u=t(62);i.BoxAnnotation=u.BoxAnnotation;var _=t(63);i.ColorBar=_.ColorBar;var p=t(65);i.Label=p.Label;var d=t(66);i.LabelSet=d.LabelSet;var f=t(67);i.Legend=f.Legend;var v=t(68);i.LegendItem=v.LegendItem;var m=t(69);i.PolyAnnotation=m.PolyAnnotation;var g=t(70);i.Slope=g.Slope;var y=t(71);i.Span=y.Span;var b=t(72);i.TextAnnotation=b.TextAnnotation;var x=t(73);i.Title=x.Title;var w=t(74);i.ToolbarPanel=w.ToolbarPanel;var k=t(75);i.Tooltip=k.Tooltip;var S=t(76);i.Whisker=S.Whisker},function(t,e,i){var n=t(387),r=t(72),a=t(5),o=t(15),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.visuals.warm_cache()},t.prototype._get_size=function(){var t=this.plot_view.canvas_view.ctx;if(this.visuals.text.set_value(t),this.model.panel.is_horizontal){var e=t.measureText(this.model.text).ascent;return e}var i=t.measureText(this.model.text).width;return i},t.prototype.render=function(){if(this.model.visible||\"css\"!=this.model.render_mode||a.hide(this.el),this.model.visible){var t;switch(this.model.angle_units){case\"rad\":t=-this.model.angle;break;case\"deg\":t=-this.model.angle*Math.PI/180;break;default:throw new Error(\"unreachable code\")}var e=null!=this.model.panel?this.model.panel:this.plot_view.frame,i=this.plot_view.frame.xscales[this.model.x_range_name],n=this.plot_view.frame.yscales[this.model.y_range_name],r=\"data\"==this.model.x_units?i.compute(this.model.x):e.xview.compute(this.model.x),o=\"data\"==this.model.y_units?n.compute(this.model.y):e.yview.compute(this.model.y);r+=this.model.x_offset,o-=this.model.y_offset;var s=\"canvas\"==this.model.render_mode?this._canvas_text.bind(this):this._css_text.bind(this);s(this.plot_view.canvas_view.ctx,this.model.text,r,o,t)}},t}(r.TextAnnotationView);i.LabelView=s;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Label\",this.prototype.default_view=s,this.mixins([\"text\",\"line:border_\",\"fill:background_\"]),this.define({x:[o.Number],x_units:[o.SpatialUnits,\"data\"],y:[o.Number],y_units:[o.SpatialUnits,\"data\"],text:[o.String],angle:[o.Angle,0],angle_units:[o.AngleUnits,\"rad\"],x_offset:[o.Number,0],y_offset:[o.Number,0],x_range_name:[o.String,\"default\"],y_range_name:[o.String,\"default\"]}),this.override({background_fill_color:null,border_line_color:null})},t}(r.TextAnnotation);(i.Label=l).initClass()},function(t,e,i){var n=t(387),r=t(72),o=t(190),c=t(5),s=t(15),a=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return n.__extends(t,r),t.prototype.initialize=function(t){if(r.prototype.initialize.call(this,t),this.set_data(this.model.source),\"css\"==this.model.render_mode)for(var e=0,i=this._text.length;e<i;e++){var n=c.div({class:\"bk-annotation-child\",style:{display:\"none\"}});this.el.appendChild(n)}},t.prototype.connect_signals=function(){var t=this;r.prototype.connect_signals.call(this),\"css\"==this.model.render_mode?(this.connect(this.model.change,function(){t.set_data(t.model.source),t.render()}),this.connect(this.model.source.streaming,function(){t.set_data(t.model.source),t.render()}),this.connect(this.model.source.patching,function(){t.set_data(t.model.source),t.render()}),this.connect(this.model.source.change,function(){t.set_data(t.model.source),t.render()})):(this.connect(this.model.change,function(){t.set_data(t.model.source),t.plot_view.request_render()}),this.connect(this.model.source.streaming,function(){t.set_data(t.model.source),t.plot_view.request_render()}),this.connect(this.model.source.patching,function(){t.set_data(t.model.source),t.plot_view.request_render()}),this.connect(this.model.source.change,function(){t.set_data(t.model.source),t.plot_view.request_render()}))},t.prototype.set_data=function(t){r.prototype.set_data.call(this,t),this.visuals.warm_cache(t)},t.prototype._map_data=function(){var t=this.plot_view.frame.xscales[this.model.x_range_name],e=this.plot_view.frame.yscales[this.model.y_range_name],i=null!=this.model.panel?this.model.panel:this.plot_view.frame,n=\"data\"==this.model.x_units?t.v_compute(this._x):i.xview.v_compute(this._x),r=\"data\"==this.model.y_units?e.v_compute(this._y):i.yview.v_compute(this._y);return[n,r]},t.prototype.render=function(){if(this.model.visible||\"css\"!=this.model.render_mode||c.hide(this.el),this.model.visible)for(var t=\"canvas\"==this.model.render_mode?this._v_canvas_text.bind(this):this._v_css_text.bind(this),e=this.plot_view.canvas_view.ctx,i=this._map_data(),n=i[0],r=i[1],o=0,s=this._text.length;o<s;o++)t(e,o,this._text[o],n[o]+this._x_offset[o],r[o]-this._y_offset[o],this._angle[o])},t.prototype._get_size=function(){var t=this.plot_view.canvas_view.ctx;switch(this.visuals.text.set_value(t),this.model.panel.side){case\"above\":case\"below\":var e=t.measureText(this._text[0]).ascent;return e;case\"left\":case\"right\":var i=t.measureText(this._text[0]).width;return i;default:throw new Error(\"unreachable code\")}},t.prototype._v_canvas_text=function(t,e,i,n,r,o){this.visuals.text.set_vectorize(t,e);var s=this._calculate_bounding_box_dimensions(t,i);t.save(),t.beginPath(),t.translate(n,r),t.rotate(o),t.rect(s[0],s[1],s[2],s[3]),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_vectorize(t,e),t.fill()),this.visuals.border_line.doit&&(this.visuals.border_line.set_vectorize(t,e),t.stroke()),this.visuals.text.doit&&(this.visuals.text.set_vectorize(t,e),t.fillText(i,0,0)),t.restore()},t.prototype._v_css_text=function(t,e,i,n,r,o){var s=this.el.children[e];s.textContent=i,this.visuals.text.set_vectorize(t,e);var a=this._calculate_bounding_box_dimensions(t,i),l=this.visuals.border_line.line_dash.value(),h=l.length<2?\"solid\":\"dashed\";this.visuals.border_line.set_vectorize(t,e),this.visuals.background_fill.set_vectorize(t,e),s.style.position=\"absolute\",s.style.left=n+a[0]+\"px\",s.style.top=r+a[1]+\"px\",s.style.color=\"\"+this.visuals.text.text_color.value(),s.style.opacity=\"\"+this.visuals.text.text_alpha.value(),s.style.font=\"\"+this.visuals.text.font_value(),s.style.lineHeight=\"normal\",o&&(s.style.transform=\"rotate(\"+o+\"rad)\"),this.visuals.background_fill.doit&&(s.style.backgroundColor=\"\"+this.visuals.background_fill.color_value()),this.visuals.border_line.doit&&(s.style.borderStyle=\"\"+h,s.style.borderWidth=this.visuals.border_line.line_width.value()+\"px\",s.style.borderColor=\"\"+this.visuals.border_line.color_value()),c.show(s)},t}(r.TextAnnotationView);i.LabelSetView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LabelSet\",this.prototype.default_view=a,this.mixins([\"text\",\"line:border_\",\"fill:background_\"]),this.define({x:[s.NumberSpec],y:[s.NumberSpec],x_units:[s.SpatialUnits,\"data\"],y_units:[s.SpatialUnits,\"data\"],text:[s.StringSpec,{field:\"text\"}],angle:[s.AngleSpec,0],x_offset:[s.NumberSpec,{value:0}],y_offset:[s.NumberSpec,{value:0}],source:[s.Instance,function(){return new o.ColumnDataSource}],x_range_name:[s.String,\"default\"],y_range_name:[s.String,\"default\"]}),this.override({background_fill_color:null,border_line_color:null})},t}(r.TextAnnotation);(i.LabelSet=l).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(15),M=t(41),O=t(24),z=t(21),P=t(32),j=t(44),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.cursor=function(t,e){return\"none\"==this.model.click_policy?null:\"pointer\"},Object.defineProperty(t.prototype,\"legend_padding\",{get:function(){return null!=this.visuals.border_line.line_color.value()?this.model.padding:0},enumerable:!0,configurable:!0}),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.visible.change,function(){return t.plot_view.request_render()})},t.prototype.compute_legend_bbox=function(){var t=this.model.get_legend_names(),e=this.model,i=e.glyph_height,n=e.glyph_width,r=this.model,o=r.label_height,s=r.label_width;this.max_label_height=z.max([M.get_text_height(this.visuals.label_text.font_value()).height,o,i]);var a=this.plot_view.canvas_view.ctx;a.save(),this.visuals.label_text.set_value(a),this.text_widths={};for(var l=0,h=t;l<h.length;l++){var c=h[l];this.text_widths[c]=z.max([a.measureText(c).width,s])}a.restore();var u,_,p=Math.max(z.max(P.values(this.text_widths)),0),d=this.model.margin,f=this.legend_padding,v=this.model.spacing,m=this.model.label_standoff;if(\"vertical\"==this.model.orientation)u=t.length*this.max_label_height+Math.max(t.length-1,0)*v+2*f,_=p+n+m+2*f;else{for(var g in _=2*f+Math.max(t.length-1,0)*v,this.text_widths){var y=this.text_widths[g];_+=z.max([y,s])+n+m}u=this.max_label_height+2*f}var b,x,w=null!=this.model.panel?this.model.panel:this.plot_view.frame,k=w.bbox.ranges,S=k[0],T=k[1],C=this.model.location;if(j.isString(C))switch(C){case\"top_left\":b=S.start+d,x=T.start+d;break;case\"top_center\":b=(S.end+S.start)/2-_/2,x=T.start+d;break;case\"top_right\":b=S.end-d-_,x=T.start+d;break;case\"bottom_right\":b=S.end-d-_,x=T.end-d-u;break;case\"bottom_center\":b=(S.end+S.start)/2-_/2,x=T.end-d-u;break;case\"bottom_left\":b=S.start+d,x=T.end-d-u;break;case\"center_left\":b=S.start+d,x=(T.end+T.start)/2-u/2;break;case\"center\":b=(S.end+S.start)/2-_/2,x=(T.end+T.start)/2-u/2;break;case\"center_right\":b=S.end-d-_,x=(T.end+T.start)/2-u/2;break;default:throw new Error(\"unreachable code\")}else{if(!j.isArray(C)||2!=C.length)throw new Error(\"unreachable code\");var A=C[0],E=C[1];b=w.xview.compute(A),x=w.yview.compute(E)-u}return{x:b,y:x,width:_,height:u}},t.prototype.interactive_bbox=function(){var t=this.compute_legend_bbox(),e=t.x,i=t.y,n=t.width,r=t.height;return new O.BBox({x:e,y:i,width:n,height:r})},t.prototype.interactive_hit=function(t,e){var i=this.interactive_bbox();return i.contains(t,e)},t.prototype.on_hit=function(t,e){for(var i,n,r,o=this.model.glyph_width,s=this.legend_padding,a=this.model.spacing,l=this.model.label_standoff,h=r=s,c=this.compute_legend_bbox(),u=\"vertical\"==this.model.orientation,_=0,p=this.model.items;_<p.length;_++)for(var d=p[_],f=d.get_labels_list_from_label_prop(),v=0,m=f;v<m.length;v++){var g=m[v],y=c.x+h,b=c.y+r,x=void 0,w=void 0;u?(i=[c.width-2*s,this.max_label_height],x=i[0],w=i[1]):(n=[this.text_widths[g]+o+l,this.max_label_height],x=n[0],w=n[1]);var k=new O.BBox({x:y,y:b,width:x,height:w});if(k.contains(t,e)){switch(this.model.click_policy){case\"hide\":for(var S=0,T=d.renderers;S<T.length;S++){var C=T[S];C.visible=!C.visible}break;case\"mute\":for(var A=0,E=d.renderers;A<E.length;A++){var C=E[A];C.muted=!C.muted}}return!0}u?r+=this.max_label_height+a:h+=this.text_widths[g]+o+l+a}return!1},t.prototype.render=function(){if(this.model.visible&&0!=this.model.items.length){var t=this.plot_view.canvas_view.ctx,e=this.compute_legend_bbox();t.save(),this._draw_legend_box(t,e),this._draw_legend_items(t,e),t.restore()}},t.prototype._draw_legend_box=function(t,e){t.beginPath(),t.rect(e.x,e.y,e.width,e.height),this.visuals.background_fill.set_value(t),t.fill(),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),t.stroke())},t.prototype._draw_legend_items=function(y,b){for(var x=this,t=this.model,w=t.glyph_width,k=t.glyph_height,S=this.legend_padding,T=this.model.spacing,C=this.model.label_standoff,A=S,E=S,M=\"vertical\"==this.model.orientation,e=function(t){var e,i,n=t.get_labels_list_from_label_prop(),r=t.get_field_from_label_prop();if(0==n.length)return\"continue\";for(var o=function(){switch(x.model.click_policy){case\"none\":return!0;case\"hide\":return z.all(t.renderers,function(t){return t.visible});case\"mute\":return z.all(t.renderers,function(t){return!t.muted})}}(),s=0,a=n;s<a.length;s++){var l=a[s],h=b.x+A,c=b.y+E,u=h+w,_=c+k;M?E+=O.max_label_height+T:A+=O.text_widths[l]+w+C+T,O.visuals.label_text.set_value(y),y.fillText(l,u+C,c+O.max_label_height/2);for(var p=0,d=t.renderers;p<d.length;p++){var f=d[p],v=O.plot_view.renderer_views[f.id];v.draw_legend(y,h,u,c,_,r,l)}if(!o){var m=void 0,g=void 0;M?(e=[b.width-2*S,O.max_label_height],m=e[0],g=e[1]):(i=[O.text_widths[l]+w+C,O.max_label_height],m=i[0],g=i[1]),y.beginPath(),y.rect(h,c,m,g),O.visuals.inactive_fill.set_value(y),y.fill()}}},O=this,i=0,n=this.model.items;i<n.length;i++){var r=n[i];e(r)}},t.prototype._get_size=function(){var t=this.compute_legend_bbox();switch(this.model.panel.side){case\"above\":case\"below\":return t.height+2*this.model.margin;case\"left\":case\"right\":return t.width+2*this.model.margin}},t}(r.AnnotationView);i.LegendView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Legend\",this.prototype.default_view=s,this.mixins([\"text:label_\",\"fill:inactive_\",\"line:border_\",\"fill:background_\"]),this.define({orientation:[o.Orientation,\"vertical\"],location:[o.Any,\"top_right\"],label_standoff:[o.Number,5],glyph_height:[o.Number,20],glyph_width:[o.Number,20],label_height:[o.Number,20],label_width:[o.Number,20],margin:[o.Number,10],padding:[o.Number,10],spacing:[o.Number,3],items:[o.Array,[]],click_policy:[o.Any,\"none\"]}),this.override({border_line_color:\"#e5e5e5\",border_line_alpha:.5,border_line_width:1,background_fill_color:\"#ffffff\",background_fill_alpha:.95,inactive_fill_color:\"white\",inactive_fill_alpha:.7,label_text_font_size:\"10pt\",label_text_baseline:\"middle\"})},t.prototype.get_legend_names=function(){for(var t=[],e=0,i=this.items;e<i.length;e++){var n=i[e],r=n.get_labels_list_from_label_prop();t.push.apply(t,r)}return t},t}(r.Annotation);(i.Legend=a).initClass()},function(t,e,i){var n=t(387),r=t(57),o=t(191),s=t(47),a=t(15),l=t(14),h=t(21),c=function(i){function t(t){return i.call(this,t)||this}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"LegendItem\",this.define({label:[a.StringSpec,null],renderers:[a.Array,[]]})},t.prototype._check_data_sources_on_renderers=function(){var t=this.get_field_from_label_prop();if(null!=t){if(this.renderers.length<1)return!1;var e=this.renderers[0].data_source;if(null!=e)for(var i=0,n=this.renderers;i<n.length;i++){var r=n[i];if(r.data_source!=e)return!1}}return!0},t.prototype._check_field_label_on_data_source=function(){var t=this.get_field_from_label_prop();if(null!=t){if(this.renderers.length<1)return!1;var e=this.renderers[0].data_source;if(null!=e&&!h.includes(e.columns(),t))return!1}return!0},t.prototype.initialize=function(){i.prototype.initialize.call(this);var t=this._check_data_sources_on_renderers();t||l.logger.error(\"Non matching data sources on legend item renderers\");var e=this._check_field_label_on_data_source();e||l.logger.error(\"Bad column name on label: \"+this.label)},t.prototype.get_field_from_label_prop=function(){var t=this.label;return s.isField(t)?t.field:null},t.prototype.get_labels_list_from_label_prop=function(){if(s.isValue(this.label))return[this.label.value];var t=this.get_field_from_label_prop();if(null!=t){var e=void 0;if(!this.renderers[0]||null==this.renderers[0].data_source)return[\"No source found\"];if((e=this.renderers[0].data_source)instanceof o.ColumnarDataSource){var i=e.get_column(t);return null!=i?h.uniq(Array.from(i)):[\"Invalid field\"]}}return[]},t}(r.Model);(i.LegendItem=c).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(19),s=t(15),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.plot_view.request_render()}),this.connect(this.model.data_update,function(){return t.plot_view.request_render()})},t.prototype.render=function(){if(this.model.visible){var t=this.model,e=t.xs,i=t.ys;if(e.length==i.length&&!(e.length<3||i.length<3)){for(var n=this.plot_view.frame,r=this.plot_view.canvas_view.ctx,o=0,s=e.length;o<s;o++){var a=void 0;if(\"screen\"!=this.model.xs_units)throw new Error(\"not implemented\");a=this.model.screen?e[o]:n.xview.compute(e[o]);var l=void 0;if(\"screen\"!=this.model.ys_units)throw new Error(\"not implemented\");l=this.model.screen?i[o]:n.yview.compute(i[o]),0==o?(r.beginPath(),r.moveTo(a,l)):r.lineTo(a,l)}r.closePath(),this.visuals.line.doit&&(this.visuals.line.set_value(r),r.stroke()),this.visuals.fill.doit&&(this.visuals.fill.set_value(r),r.fill())}}},t}(r.AnnotationView);i.PolyAnnotationView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"PolyAnnotation\",this.prototype.default_view=a,this.mixins([\"line\",\"fill\"]),this.define({xs:[s.Array,[]],xs_units:[s.SpatialUnits,\"data\"],ys:[s.Array,[]],ys_units:[s.SpatialUnits,\"data\"],x_range_name:[s.String,\"default\"],y_range_name:[s.String,\"default\"]}),this.internal({screen:[s.Boolean,!1]}),this.override({fill_color:\"#fff9ba\",fill_alpha:.4,line_color:\"#cccccc\",line_alpha:.3})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.data_update=new o.Signal0(this,\"data_update\")},t.prototype.update=function(t){var e=t.xs,i=t.ys;this.setv({xs:e,ys:i,screen:!0},{silent:!0}),this.data_update.emit()},t}(r.Annotation);(i.PolyAnnotation=l).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(15),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.plot_view.request_render()})},t.prototype.render=function(){this.model.visible&&this._draw_slope()},t.prototype._draw_slope=function(){var t=this.model.gradient,e=this.model.y_intercept;if(null!=t&&null!=e){var i=this.plot_view.frame,n=i.xscales[this.model.x_range_name],r=i.yscales[this.model.y_range_name],o=i._top.value,s=o+i._height.value,a=r.invert(o),l=r.invert(s),h=(a-e)/t,c=(l-e)/t,u=n.compute(h),_=n.compute(c),p=this.plot_view.canvas_view.ctx;p.save(),p.beginPath(),this.visuals.line.set_value(p),p.moveTo(u,o),p.lineTo(_,s),p.stroke(),p.restore()}},t}(r.AnnotationView);i.SlopeView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Slope\",this.prototype.default_view=s,this.mixins([\"line\"]),this.define({gradient:[o.Number,null],y_intercept:[o.Number,null],x_range_name:[o.String,\"default\"],y_range_name:[o.String,\"default\"]}),this.override({line_color:\"black\"})},t}(r.Annotation);(i.Slope=a).initClass()},function(t,e,i){var n=t(387),r=t(58),u=t(5),o=t(15),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.plot_view.canvas_overlays.appendChild(this.el),this.el.style.position=\"absolute\",u.hide(this.el)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.model.for_hover?this.connect(this.model.properties.computed_location.change,function(){return t._draw_span()}):\"canvas\"==this.model.render_mode?(this.connect(this.model.change,function(){return t.plot_view.request_render()}),this.connect(this.model.properties.location.change,function(){return t.plot_view.request_render()})):(this.connect(this.model.change,function(){return t.render()}),this.connect(this.model.properties.location.change,function(){return t._draw_span()}))},t.prototype.render=function(){this.model.visible||\"css\"!=this.model.render_mode||u.hide(this.el),this.model.visible&&this._draw_span()},t.prototype._draw_span=function(){var i=this,n=this.model.for_hover?this.model.computed_location:this.model.location;if(null!=n){var t,e,r,o,s=this.plot_view.frame,a=s.xscales[this.model.x_range_name],l=s.yscales[this.model.y_range_name],h=function(t,e){return i.model.for_hover?i.model.computed_location:\"data\"==i.model.location_units?t.compute(n):e.compute(n)};if(\"width\"==this.model.dimension?(r=h(l,s.yview),e=s._left.value,o=s._width.value,t=this.model.properties.line_width.value()):(r=s._top.value,e=h(a,s.xview),o=this.model.properties.line_width.value(),t=s._height.value),\"css\"==this.model.render_mode)this.el.style.top=r+\"px\",this.el.style.left=e+\"px\",this.el.style.width=o+\"px\",this.el.style.height=t+\"px\",this.el.style.backgroundColor=this.model.properties.line_color.value(),this.el.style.opacity=this.model.properties.line_alpha.value(),u.show(this.el);else if(\"canvas\"==this.model.render_mode){var c=this.plot_view.canvas_view.ctx;c.save(),c.beginPath(),this.visuals.line.set_value(c),c.moveTo(e,r),\"width\"==this.model.dimension?c.lineTo(e+o,r):c.lineTo(e,r+t),c.stroke(),c.restore()}}else u.hide(this.el)},t}(r.AnnotationView);i.SpanView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Span\",this.prototype.default_view=s,this.mixins([\"line\"]),this.define({render_mode:[o.RenderMode,\"canvas\"],x_range_name:[o.String,\"default\"],y_range_name:[o.String,\"default\"],location:[o.Number,null],location_units:[o.SpatialUnits,\"data\"],dimension:[o.Dimension,\"width\"]}),this.override({line_color:\"black\"}),this.internal({for_hover:[o.Boolean,!1],computed_location:[o.Number,null]})},t}(r.Annotation);(i.Span=a).initClass()},function(t,e,i){var n=t(387),r=t(58),l=t(5),o=t(15),s=t(41),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),\"css\"==this.model.render_mode&&(this.el.classList.add(\"bk-annotation\"),this.plot_view.canvas_overlays.appendChild(this.el))},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),\"css\"==this.model.render_mode?this.connect(this.model.change,function(){return t.render()}):this.connect(this.model.change,function(){return t.plot_view.request_render()})},t.prototype._calculate_text_dimensions=function(t,e){var i=t.measureText(e).width,n=s.get_text_height(this.visuals.text.font_value()).height;return[i,n]},t.prototype._calculate_bounding_box_dimensions=function(t,e){var i,n,r=this._calculate_text_dimensions(t,e),o=r[0],s=r[1];switch(t.textAlign){case\"left\":i=0;break;case\"center\":i=-o/2;break;case\"right\":i=-o;break;default:throw new Error(\"unreachable code\")}switch(t.textBaseline){case\"top\":n=0;break;case\"middle\":n=-.5*s;break;case\"bottom\":n=-1*s;break;case\"alphabetic\":n=-.8*s;break;case\"hanging\":n=-.17*s;break;case\"ideographic\":n=-.83*s;break;default:throw new Error(\"unreachable code\")}return[i,n,o,s]},t.prototype._canvas_text=function(t,e,i,n,r){this.visuals.text.set_value(t);var o=this._calculate_bounding_box_dimensions(t,e);t.save(),t.beginPath(),t.translate(i,n),r&&t.rotate(r),t.rect(o[0],o[1],o[2],o[3]),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),t.fill()),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),t.stroke()),this.visuals.text.doit&&(this.visuals.text.set_value(t),t.fillText(e,0,0)),t.restore()},t.prototype._css_text=function(t,e,i,n,r){l.hide(this.el),this.visuals.text.set_value(t);var o=this._calculate_bounding_box_dimensions(t,e),s=this.visuals.border_line.line_dash.value(),a=s.length<2?\"solid\":\"dashed\";this.visuals.border_line.set_value(t),this.visuals.background_fill.set_value(t),this.el.style.position=\"absolute\",this.el.style.left=i+o[0]+\"px\",this.el.style.top=n+o[1]+\"px\",this.el.style.color=\"\"+this.visuals.text.text_color.value(),this.el.style.opacity=\"\"+this.visuals.text.text_alpha.value(),this.el.style.font=\"\"+this.visuals.text.font_value(),this.el.style.lineHeight=\"normal\",r&&(this.el.style.transform=\"rotate(\"+r+\"rad)\"),this.visuals.background_fill.doit&&(this.el.style.backgroundColor=\"\"+this.visuals.background_fill.color_value()),this.visuals.border_line.doit&&(this.el.style.borderStyle=\"\"+a,this.el.style.borderWidth=this.visuals.border_line.line_width.value()+\"px\",this.el.style.borderColor=\"\"+this.visuals.border_line.color_value()),this.el.textContent=e,l.show(this.el)},t}(r.AnnotationView);i.TextAnnotationView=a;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"TextAnnotation\",this.define({render_mode:[o.RenderMode,\"canvas\"]})},t}(r.Annotation);(i.TextAnnotation=h).initClass()},function(t,e,i){var n=t(387),r=t(72),s=t(5),o=t(15),a=t(49),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.visuals.text=new a.Text(this.model)},t.prototype._get_location=function(){var t,e,i=this.model.panel,n=this.model.offset;switch(i.side){case\"above\":case\"below\":switch(this.model.vertical_align){case\"top\":e=i._top.value+5;break;case\"middle\":e=i._vcenter.value;break;case\"bottom\":e=i._bottom.value-5;break;default:throw new Error(\"unreachable code\")}switch(this.model.align){case\"left\":t=i._left.value+n;break;case\"center\":t=i._hcenter.value;break;case\"right\":t=i._right.value-n;break;default:throw new Error(\"unreachable code\")}break;case\"left\":switch(this.model.vertical_align){case\"top\":t=i._left.value-5;break;case\"middle\":t=i._hcenter.value;break;case\"bottom\":t=i._right.value+5;break;default:throw new Error(\"unreachable code\")}switch(this.model.align){case\"left\":e=i._bottom.value-n;break;case\"center\":e=i._vcenter.value;break;case\"right\":e=i._top.value+n;break;default:throw new Error(\"unreachable code\")}break;case\"right\":switch(this.model.vertical_align){case\"top\":t=i._right.value-5;break;case\"middle\":t=i._hcenter.value;break;case\"bottom\":t=i._left.value+5;break;default:throw new Error(\"unreachable code\")}switch(this.model.align){case\"left\":e=i._top.value+n;break;case\"center\":e=i._vcenter.value;break;case\"right\":e=i._bottom.value-n;break;default:throw new Error(\"unreachable code\")}break;default:throw new Error(\"unreachable code\")}return[t,e]},t.prototype.render=function(){if(this.model.visible){var t=this.model.text;if(null!=t&&0!=t.length){this.model.text_baseline=this.model.vertical_align,this.model.text_align=this.model.align;var e=this._get_location(),i=e[0],n=e[1],r=this.model.panel.get_label_angle_heuristic(\"parallel\"),o=\"canvas\"==this.model.render_mode?this._canvas_text.bind(this):this._css_text.bind(this);o(this.plot_view.canvas_view.ctx,t,i,n,r)}}else\"css\"==this.model.render_mode&&s.hide(this.el)},t.prototype._get_size=function(){var t=this.model.text;if(null==t||0==t.length)return 0;var e=this.plot_view.canvas_view.ctx;return this.visuals.text.set_value(e),e.measureText(t).ascent+10},t}(r.TextAnnotationView);i.TitleView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Title\",this.prototype.default_view=l,this.mixins([\"line:border_\",\"fill:background_\"]),this.define({text:[o.String],text_font:[o.Font,\"helvetica\"],text_font_size:[o.FontSizeSpec,\"10pt\"],text_font_style:[o.FontStyle,\"bold\"],text_color:[o.ColorSpec,\"#444444\"],text_alpha:[o.NumberSpec,1],vertical_align:[o.VerticalAlign,\"bottom\"],align:[o.TextAlign,\"left\"],offset:[o.Number,0]}),this.override({background_fill_color:null,border_line_color:null}),this.internal({text_align:[o.TextAlign,\"left\"],text_baseline:[o.TextBaseline,\"bottom\"]})},t}(r.TextAnnotation);(i.Title=h).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(4),s=t(5),a=t(15),l=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return n.__extends(t,i),t.prototype.initialize=function(t){i.prototype.initialize.call(this,t),this.plot_view.canvas_events.appendChild(this.el),this._toolbar_views={},o.build_views(this._toolbar_views,[this.model.toolbar],{parent:this})},t.prototype.remove=function(){o.remove_views(this._toolbar_views),i.prototype.remove.call(this)},t.prototype.render=function(){if(i.prototype.render.call(this),this.model.visible){var t=this.model.panel;this.el.style.position=\"absolute\",this.el.style.left=t._left.value+\"px\",this.el.style.top=t._top.value+\"px\",this.el.style.width=t._width.value+\"px\",this.el.style.height=t._height.value+\"px\",this.el.style.overflow=\"hidden\";var e=this._toolbar_views[this.model.toolbar.id];e.render(),s.empty(this.el),this.el.appendChild(e.el),s.show(this.el)}else s.hide(this.el)},t.prototype._get_size=function(){return 30},t}(r.AnnotationView);i.ToolbarPanelView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ToolbarPanel\",this.prototype.default_view=l,this.define({toolbar:[a.Instance]})},t}(r.Annotation);(i.ToolbarPanel=h).initClass()},function(t,e,i){var n=t(387),r=t(58),f=t(5),o=t(15);function v(t,e,i,n,r){var o;switch(t){case\"horizontal\":o=e<n?\"right\":\"left\";break;case\"vertical\":o=i<r?\"below\":\"above\";break;default:o=t}return o}i.compute_side=v;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.plot_view.canvas_overlays.appendChild(this.el),f.hide(this.el)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.data.change,function(){return t._draw_tips()})},t.prototype.css_classes=function(){return e.prototype.css_classes.call(this).concat(\"bk-tooltip\")},t.prototype.render=function(){this.model.visible&&this._draw_tips()},t.prototype._draw_tips=function(){var t=this.model.data;if(f.empty(this.el),f.hide(this.el),this.model.custom?this.el.classList.add(\"bk-tooltip-custom\"):this.el.classList.remove(\"bk-tooltip-custom\"),0!=t.length){for(var e=this.plot_view.frame,i=0,n=t;i<n.length;i++){var r=n[i],o=r[0],s=r[1],a=r[2];if(!this.model.inner_only||e.bbox.contains(o,s)){var l=f.div({},a);this.el.appendChild(l)}}var h,c,u=t[t.length-1],_=u[0],p=u[1],d=v(this.model.attachment,_,p,e._hcenter.value,e._vcenter.value);switch(this.el.classList.remove(\"bk-right\"),this.el.classList.remove(\"bk-left\"),this.el.classList.remove(\"bk-above\"),this.el.classList.remove(\"bk-below\"),f.show(this.el),d){case\"right\":this.el.classList.add(\"bk-left\"),h=_+(this.el.offsetWidth-this.el.clientWidth)+10,c=p-this.el.offsetHeight/2;break;case\"left\":this.el.classList.add(\"bk-right\"),h=_-this.el.offsetWidth-10,c=p-this.el.offsetHeight/2;break;case\"below\":this.el.classList.add(\"bk-above\"),c=p+(this.el.offsetHeight-this.el.clientHeight)+10,h=Math.round(_-this.el.offsetWidth/2);break;case\"above\":this.el.classList.add(\"bk-below\"),c=p-this.el.offsetHeight-10,h=Math.round(_-this.el.offsetWidth/2);break;default:throw new Error(\"unreachable code\")}this.model.show_arrow&&this.el.classList.add(\"bk-tooltip-arrow\"),0<this.el.childNodes.length?(this.el.style.top=c+\"px\",this.el.style.left=h+\"px\"):f.hide(this.el)}},t}(r.AnnotationView);i.TooltipView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Tooltip\",this.prototype.default_view=s,this.define({attachment:[o.String,\"horizontal\"],inner_only:[o.Bool,!0],show_arrow:[o.Bool,!0]}),this.override({level:\"overlay\"}),this.internal({data:[o.Any,[]],custom:[o.Any]})},t.prototype.clear=function(){this.data=[]},t.prototype.add=function(t,e,i){this.data=this.data.concat([[t,e,i]])},t}(r.Annotation);(i.Tooltip=a).initClass()},function(t,e,i){var n=t(387),r=t(58),o=t(190),s=t(60),a=t(15),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.set_data(this.model.source)},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.source.streaming,function(){return t.set_data(t.model.source)}),this.connect(this.model.source.patching,function(){return t.set_data(t.model.source)}),this.connect(this.model.source.change,function(){return t.set_data(t.model.source)})},t.prototype.set_data=function(t){e.prototype.set_data.call(this,t),this.visuals.warm_cache(t),this.plot_view.request_render()},t.prototype._map_data=function(){var t,e,i,n=this.plot_model.frame,r=this.model.dimension,o=n.xscales[this.model.x_range_name],s=n.yscales[this.model.y_range_name],a=\"height\"==r?s:o,l=\"height\"==r?o:s,h=\"height\"==r?n.yview:n.xview,c=\"height\"==r?n.xview:n.yview;t=\"data\"==this.model.lower.units?a.v_compute(this._lower):h.v_compute(this._lower),e=\"data\"==this.model.upper.units?a.v_compute(this._upper):h.v_compute(this._upper),i=\"data\"==this.model.base.units?l.v_compute(this._base):c.v_compute(this._base);var u=\"height\"==r?[1,0]:[0,1],_=u[0],p=u[1],d=[t,i],f=[e,i];this._lower_sx=d[_],this._lower_sy=d[p],this._upper_sx=f[_],this._upper_sy=f[p]},t.prototype.render=function(){if(this.model.visible){this._map_data();var t=this.plot_view.canvas_view.ctx;if(this.visuals.line.doit)for(var e=0,i=this._lower_sx.length;e<i;e++)this.visuals.line.set_vectorize(t,e),t.beginPath(),t.moveTo(this._lower_sx[e],this._lower_sy[e]),t.lineTo(this._upper_sx[e],this._upper_sy[e]),t.stroke();var n=\"height\"==this.model.dimension?0:Math.PI/2;if(null!=this.model.lower_head)for(var e=0,i=this._lower_sx.length;e<i;e++)t.save(),t.translate(this._lower_sx[e],this._lower_sy[e]),t.rotate(n+Math.PI),this.model.lower_head.render(t,e),t.restore();if(null!=this.model.upper_head)for(var e=0,i=this._upper_sx.length;e<i;e++)t.save(),t.translate(this._upper_sx[e],this._upper_sy[e]),t.rotate(n),this.model.upper_head.render(t,e),t.restore()}},t}(r.AnnotationView);i.WhiskerView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Whisker\",this.prototype.default_view=l,this.mixins([\"line\"]),this.define({lower:[a.DistanceSpec],lower_head:[a.Instance,function(){return new s.TeeHead({level:\"underlay\",size:10})}],upper:[a.DistanceSpec],upper_head:[a.Instance,function(){return new s.TeeHead({level:\"underlay\",size:10})}],base:[a.DistanceSpec],dimension:[a.Dimension,\"height\"],source:[a.Instance,function(){return new o.ColumnDataSource}],x_range_name:[a.String,\"default\"],y_range_name:[a.String,\"default\"]}),this.override({level:\"underlay\"})},t}(r.Annotation);(i.Whisker=h).initClass()},function(t,e,i){var n=t(387),r=t(177),o=t(15),s=t(12),l=t(21),C=t(44),a=t(171),h=Math.abs,c=Math.min,u=Math.max,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){if(this.model.visible){var t={tick:this._tick_extent(),tick_label:this._tick_label_extents(),axis_label:this._axis_label_extent()},e=this.model.tick_coords,i=this.plot_view.canvas_view.ctx;i.save(),this._draw_rule(i,t),this._draw_major_ticks(i,t,e),this._draw_minor_ticks(i,t,e),this._draw_major_labels(i,t,e),this._draw_axis_label(i,t,e),null!=this._render&&this._render(i,t,e),i.restore()}},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.plot_view.request_render()})},t.prototype.get_size=function(){return this.model.visible?Math.round(this._get_size()):0},t.prototype._get_size=function(){return null!=this.model.fixed_location?0:this._tick_extent()+this._tick_label_extent()+this._axis_label_extent()},Object.defineProperty(t.prototype,\"needs_clip\",{get:function(){return null!=this.model.fixed_location},enumerable:!0,configurable:!0}),t.prototype._draw_rule=function(t,e){if(this.visuals.axis_line.doit){var i=this.model.rule_coords,n=i[0],r=i[1],o=this.plot_view.map_to_screen(n,r,this.model.x_range_name,this.model.y_range_name),s=o[0],a=o[1],l=this.model.normals,h=l[0],c=l[1],u=this.model.offsets,_=u[0],p=u[1];this.visuals.axis_line.set_value(t),t.beginPath(),t.moveTo(Math.round(s[0]+h*_),Math.round(a[0]+c*p));for(var d=1;d<s.length;d++){var f=Math.round(s[d]+h*_),v=Math.round(a[d]+c*p);t.lineTo(f,v)}t.stroke()}},t.prototype._draw_major_ticks=function(t,e,i){var n=this.model.major_tick_in,r=this.model.major_tick_out,o=this.visuals.major_tick_line;this._draw_ticks(t,i.major,n,r,o)},t.prototype._draw_minor_ticks=function(t,e,i){var n=this.model.minor_tick_in,r=this.model.minor_tick_out,o=this.visuals.minor_tick_line;this._draw_ticks(t,i.minor,n,r,o)},t.prototype._draw_major_labels=function(t,e,i){var n=i.major,r=this.model.compute_labels(n[this.model.dimension]),o=this.model.major_label_orientation,s=e.tick+this.model.major_label_standoff,a=this.visuals.major_label_text;this._draw_oriented_labels(t,r,n,o,this.model.panel.side,s,a)},t.prototype._draw_axis_label=function(t,e,i){if(null!=this.model.axis_label&&0!=this.model.axis_label.length&&null==this.model.fixed_location){var n,r;switch(this.model.panel.side){case\"above\":n=this.model.panel._hcenter.value,r=this.model.panel._bottom.value;break;case\"below\":n=this.model.panel._hcenter.value,r=this.model.panel._top.value;break;case\"left\":n=this.model.panel._right.value,r=this.model.panel._vcenter.value;break;case\"right\":n=this.model.panel._left.value,r=this.model.panel._vcenter.value;break;default:throw new Error(\"unknown side: \"+this.model.panel.side)}var o=[[n],[r]],s=e.tick+l.sum(e.tick_label)+this.model.axis_label_standoff,a=this.visuals.axis_label_text;this._draw_oriented_labels(t,[this.model.axis_label],o,\"parallel\",this.model.panel.side,s,a,\"screen\")}},t.prototype._draw_ticks=function(t,e,i,n,r){if(r.doit){var o=e[0],s=e[1],a=this.plot_view.map_to_screen(o,s,this.model.x_range_name,this.model.y_range_name),l=a[0],h=a[1],c=this.model.normals,u=c[0],_=c[1],p=this.model.offsets,d=p[0],f=p[1],v=[u*(d-i),_*(f-i)],m=v[0],g=v[1],y=[u*(d+n),_*(f+n)],b=y[0],x=y[1];r.set_value(t);for(var w=0;w<l.length;w++){var k=Math.round(l[w]+b),S=Math.round(h[w]+x),T=Math.round(l[w]+m),C=Math.round(h[w]+g);t.beginPath(),t.moveTo(k,S),t.lineTo(T,C),t.stroke()}}},t.prototype._draw_oriented_labels=function(t,e,i,n,r,o,s,a){var l,h,c;if(void 0===a&&(a=\"data\"),s.doit&&0!=e.length){var u,_,p,d;if(\"screen\"==a)u=i[0],_=i[1],p=(l=[0,0])[0],d=l[1];else{var f=i[0],v=i[1];h=this.plot_view.map_to_screen(f,v,this.model.x_range_name,this.model.y_range_name),u=h[0],_=h[1],c=this.model.offsets,p=c[0],d=c[1]}var m,g=this.model.normals,y=g[0],b=g[1],x=y*(p+o),w=b*(d+o);s.set_value(t),this.model.panel.apply_label_text_heuristics(t,n),m=C.isString(n)?this.model.panel.get_label_angle_heuristic(n):-n;for(var k=0;k<u.length;k++){var S=Math.round(u[k]+x),T=Math.round(_[k]+w);t.translate(S,T),t.rotate(m),t.fillText(e[k],0,0),t.rotate(-m),t.translate(-S,-T)}}},t.prototype._axis_label_extent=function(){if(null==this.model.axis_label||\"\"==this.model.axis_label)return 0;var t=this.model.axis_label_standoff,e=this.visuals.axis_label_text;return this._oriented_labels_extent([this.model.axis_label],\"parallel\",this.model.panel.side,t,e)},t.prototype._tick_extent=function(){return this.model.major_tick_out},t.prototype._tick_label_extent=function(){return l.sum(this._tick_label_extents())},t.prototype._tick_label_extents=function(){var t=this.model.tick_coords.major,e=this.model.compute_labels(t[this.model.dimension]),i=this.model.major_label_orientation,n=this.model.major_label_standoff,r=this.visuals.major_label_text;return[this._oriented_labels_extent(e,i,this.model.panel.side,n,r)]},t.prototype._oriented_labels_extent=function(t,e,i,n,r){if(0==t.length)return 0;var o,s,a=this.plot_view.canvas_view.ctx;r.set_value(a),C.isString(e)?(o=1,s=this.model.panel.get_label_angle_heuristic(e)):(o=2,s=-e),s=Math.abs(s);for(var l=Math.cos(s),h=Math.sin(s),c=0,u=0;u<t.length;u++){var _=1.1*a.measureText(t[u]).width,p=.9*a.measureText(t[u]).ascent,d=void 0;c<(d=\"above\"==i||\"below\"==i?_*h+p/o*l:_*l+p/o*h)&&(c=d)}return 0<c&&(c+=n),c},t}(r.GuideRendererView);i.AxisView=_;var p=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Axis\",this.prototype.default_view=_,this.mixins([\"line:axis_\",\"line:major_tick_\",\"line:minor_tick_\",\"text:major_label_\",\"text:axis_label_\"]),this.define({bounds:[o.Any,\"auto\"],ticker:[o.Instance,null],formatter:[o.Instance,null],x_range_name:[o.String,\"default\"],y_range_name:[o.String,\"default\"],axis_label:[o.String,\"\"],axis_label_standoff:[o.Int,5],major_label_standoff:[o.Int,5],major_label_orientation:[o.Any,\"horizontal\"],major_label_overrides:[o.Any,{}],major_tick_in:[o.Number,2],major_tick_out:[o.Number,6],minor_tick_in:[o.Number,0],minor_tick_out:[o.Number,4],fixed_location:[o.Any,null]}),this.override({axis_line_color:\"black\",major_tick_line_color:\"black\",minor_tick_line_color:\"black\",major_label_text_font_size:\"8pt\",major_label_text_align:\"center\",major_label_text_baseline:\"alphabetic\",axis_label_text_font_size:\"10pt\",axis_label_text_font_style:\"italic\"})},t.prototype.add_panel=function(t){this.panel=new s.SidePanel({side:t}),this.panel.attach_document(this.document)},Object.defineProperty(t.prototype,\"normals\",{get:function(){return this.panel.normals},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"dimension\",{get:function(){return this.panel.dimension},enumerable:!0,configurable:!0}),t.prototype.compute_labels=function(t){for(var e=this.formatter.doFormat(t,this),i=0;i<t.length;i++)t[i]in this.major_label_overrides&&(e[i]=this.major_label_overrides[t[i]]);return e},Object.defineProperty(t.prototype,\"offsets\",{get:function(){var t=this.plot.plot_canvas.frame,e=[0,0],i=e[0],n=e[1];switch(this.panel.side){case\"below\":n=h(this.panel._top.value-t._bottom.value);break;case\"above\":n=h(this.panel._bottom.value-t._top.value);break;case\"right\":i=h(this.panel._left.value-t._right.value);break;case\"left\":i=h(this.panel._right.value-t._left.value)}return[i,n]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"ranges\",{get:function(){var t=this.dimension,e=(t+1)%2,i=this.plot.plot_canvas.frame,n=[i.x_ranges[this.x_range_name],i.y_ranges[this.y_range_name]];return[n[t],n[e]]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"computed_bounds\",{get:function(){var t=this.ranges[0],e=this.bounds,i=[t.min,t.max];if(\"auto\"==e)return[t.min,t.max];if(C.isArray(e)){var n=void 0,r=void 0,o=e[0],s=e[1],a=i[0],l=i[1];return h(o-s)>h(a-l)?(n=u(c(o,s),a),r=c(u(o,s),l)):(n=c(o,s),r=u(o,s)),[n,r]}throw new Error(\"user bounds '\"+e+\"' not understood\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"rule_coords\",{get:function(){var t=this.dimension,e=(t+1)%2,i=this.ranges[0],n=this.computed_bounds,r=n[0],o=n[1],s=new Array(2),a=new Array(2),l=[s,a];return l[t][0]=Math.max(r,i.min),l[t][1]=Math.min(o,i.max),l[t][0]>l[t][1]&&(l[t][0]=l[t][1]=NaN),l[e][0]=this.loc,l[e][1]=this.loc,l},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"tick_coords\",{get:function(){for(var t=this.dimension,e=(t+1)%2,i=this.ranges[0],n=this.computed_bounds,r=n[0],o=n[1],s=this.ticker.get_ticks(r,o,i,this.loc,{}),a=s.major,l=s.minor,h=[[],[]],c=[[],[]],u=[i.min,i.max],_=u[0],p=u[1],d=0;d<a.length;d++)a[d]<_||a[d]>p||(h[t].push(a[d]),h[e].push(this.loc));for(var d=0;d<l.length;d++)l[d]<_||l[d]>p||(c[t].push(l[d]),c[e].push(this.loc));return{major:h,minor:c}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"loc\",{get:function(){if(null!=this.fixed_location){if(C.isNumber(this.fixed_location))return this.fixed_location;var t=this.ranges,e=t[1];if(e instanceof a.FactorRange)return e.synthetic(this.fixed_location);throw new Error(\"unexpected\")}var i=this.ranges,n=i[1];switch(this.panel.side){case\"left\":case\"below\":return n.start;case\"right\":case\"above\":return n.end}},enumerable:!0,configurable:!0}),t}(r.GuideRenderer);(i.Axis=p).initClass()},function(t,e,i){var n=t(387),r=t(77),o=t(198),s=t(103),a=t(15),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._render=function(t,e,i){this._draw_group_separators(t,e,i)},e.prototype._draw_group_separators=function(t,e,i){var n,r=this.model.ranges[0],o=this.model.computed_bounds,s=o[0],a=o[1];if(r.tops&&!(r.tops.length<2)&&this.visuals.separator_line.doit){for(var l=this.model.dimension,h=(l+1)%2,c=[[],[]],u=0,_=0;_<r.tops.length-1;_++){for(var p=void 0,d=void 0,f=u;f<r.factors.length;f++)if(r.factors[f][0]==r.tops[_+1]){n=[r.factors[f-1],r.factors[f]],p=n[0],d=n[1],u=f;break}var v=(r.synthetic(p)+r.synthetic(d))/2;s<v&&v<a&&(c[l].push(v),c[h].push(this.model.loc))}var m=this._tick_label_extent();this._draw_ticks(t,c,-3,m-6,this.visuals.separator_line)}},e.prototype._draw_major_labels=function(t,e,i){for(var n=this._get_factor_info(),r=e.tick+this.model.major_label_standoff,o=0;o<n.length;o++){var s=n[o],a=s[0],l=s[1],h=s[2],c=s[3];this._draw_oriented_labels(t,a,l,h,this.model.panel.side,r,c),r+=e.tick_label[o]}},e.prototype._tick_label_extents=function(){for(var t=this._get_factor_info(),e=[],i=0,n=t;i<n.length;i++){var r=n[i],o=r[0],s=r[2],a=r[3],l=this._oriented_labels_extent(o,s,this.model.panel.side,this.model.major_label_standoff,a);e.push(l)}return e},e.prototype._get_factor_info=function(){var t=this.model.ranges[0],e=this.model.computed_bounds,i=e[0],n=e[1],r=this.model.loc,o=this.model.ticker.get_ticks(i,n,t,r,{}),s=this.model.tick_coords,a=[];if(1==t.levels){var l=this.model.formatter.doFormat(o.major,this.model);a.push([l,s.major,this.model.major_label_orientation,this.visuals.major_label_text])}else if(2==t.levels){var l=this.model.formatter.doFormat(o.major.map(function(t){return t[1]}),this.model);a.push([l,s.major,this.model.major_label_orientation,this.visuals.major_label_text]),a.push([o.tops,s.tops,this.model.group_label_orientation,this.visuals.group_text])}else if(3==t.levels){var l=this.model.formatter.doFormat(o.major.map(function(t){return t[2]}),this.model),h=o.mids.map(function(t){return t[1]});a.push([l,s.major,this.model.major_label_orientation,this.visuals.major_label_text]),a.push([h,s.mids,this.model.subgroup_label_orientation,this.visuals.subgroup_text]),a.push([o.tops,s.tops,this.model.group_label_orientation,this.visuals.group_text])}return a},e}(r.AxisView);i.CategoricalAxisView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CategoricalAxis\",this.prototype.default_view=l,this.mixins([\"line:separator_\",\"text:group_\",\"text:subgroup_\"]),this.define({group_label_orientation:[a.Any,\"parallel\"],subgroup_label_orientation:[a.Any,\"parallel\"]}),this.override({ticker:function(){return new o.CategoricalTicker},formatter:function(){return new s.CategoricalTickFormatter},separator_line_color:\"lightgrey\",separator_line_width:2,group_text_font_style:\"bold\",group_text_font_size:\"8pt\",group_text_color:\"grey\",subgroup_text_font_style:\"bold\",subgroup_text_font_size:\"8pt\"})},Object.defineProperty(t.prototype,\"tick_coords\",{get:function(){var e=this,t=this.dimension,i=(t+1)%2,n=this.ranges[0],r=this.computed_bounds,o=r[0],s=r[1],a=this.ticker.get_ticks(o,s,n,this.loc,{}),l={major:[[],[]],mids:[[],[]],tops:[[],[]],minor:[[],[]]};return l.major[t]=a.major,l.major[i]=a.major.map(function(t){return e.loc}),3==n.levels&&(l.mids[t]=a.mids),l.mids[i]=a.mids.map(function(t){return e.loc}),1<n.levels&&(l.tops[t]=a.tops),l.tops[i]=a.tops.map(function(t){return e.loc}),l},enumerable:!0,configurable:!0}),t}(r.Axis);(i.CategoricalAxis=h).initClass()},function(t,e,i){var n=t(387),r=t(77),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ContinuousAxis\"},t}(r.Axis);(i.ContinuousAxis=o).initClass()},function(t,e,i){var n=t(387),r=t(82),o=t(104),s=t(201),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.LinearAxisView);i.DatetimeAxisView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"DatetimeAxis\",this.prototype.default_view=a,this.override({ticker:function(){return new s.DatetimeTicker},formatter:function(){return new o.DatetimeTickFormatter}})},t}(r.LinearAxis);(i.DatetimeAxis=l).initClass()},function(t,e,i){var n=t(77);i.Axis=n.Axis;var r=t(78);i.CategoricalAxis=r.CategoricalAxis;var o=t(79);i.ContinuousAxis=o.ContinuousAxis;var s=t(80);i.DatetimeAxis=s.DatetimeAxis;var a=t(82);i.LinearAxis=a.LinearAxis;var l=t(83);i.LogAxis=l.LogAxis;var h=t(84);i.MercatorAxis=h.MercatorAxis},function(t,e,i){var n=t(387),r=t(77),o=t(79),s=t(102),a=t(197),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.AxisView);i.LinearAxisView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LinearAxis\",this.prototype.default_view=l,this.override({ticker:function(){return new a.BasicTicker},formatter:function(){return new s.BasicTickFormatter}})},t}(o.ContinuousAxis);(i.LinearAxis=h).initClass()},function(t,e,i){var n=t(387),r=t(77),o=t(79),s=t(107),a=t(205),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.AxisView);i.LogAxisView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LogAxis\",this.prototype.default_view=l,this.override({ticker:function(){return new a.LogTicker},formatter:function(){return new s.LogTickFormatter}})},t}(o.ContinuousAxis);(i.LogAxis=h).initClass()},function(t,e,i){var n=t(387),r=t(77),o=t(82),s=t(108),a=t(206),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.AxisView);i.MercatorAxisView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"MercatorAxis\",this.prototype.default_view=l,this.override({ticker:function(){return new a.MercatorTicker({dimension:\"lat\"})},formatter:function(){return new s.MercatorTickFormatter({dimension:\"lat\"})}})},t}(o.LinearAxis);(i.MercatorAxis=h).initClass()},function(t,e,i){var n=t(387),r=t(57),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Callback\"},t}(r.Model);(i.Callback=o).initClass()},function(i,t,e){var n=i(387),r=i(85),o=i(15),s=i(32),a=i(38),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CustomJS\",this.define({args:[o.Any,{}],code:[o.String,\"\"],use_strict:[o.Boolean,!1]})},Object.defineProperty(t.prototype,\"names\",{get:function(){return s.keys(this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"values\",{get:function(){return s.values(this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"func\",{get:function(){var t=this.use_strict?a.use_strict(this.code):this.code;return new(Function.bind.apply(Function,[void 0].concat(this.names,[\"cb_obj\",\"cb_data\",\"require\",\"exports\",t])))},enumerable:!0,configurable:!0}),t.prototype.execute=function(t,e){return this.func.apply(t,this.values.concat(t,e,i,{}))},t}(r.Callback);(e.CustomJS=l).initClass()},function(t,e,i){var n=t(86);i.CustomJS=n.CustomJS;var r=t(88);i.OpenURL=r.OpenURL},function(t,e,i){var n=t(387),r=t(85),o=t(15),s=t(35),a=t(40),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"OpenURL\",this.define({url:[o.String,\"http://\"]})},t.prototype.execute=function(t,e){for(var i=0,n=s.get_indices(e.source);i<n.length;i++){var r=n[i],o=a.replace_placeholders(this.url,e.source,r);window.open(o)}return null},t}(r.Callback);(i.OpenURL=l).initClass()},function(t,e,i){var n=t(387),r=t(11),o=t(6),s=t(13),a=t(14),l=t(15),h=t(5),c=t(26);null!=window.CanvasPixelArray&&(window.CanvasPixelArray.prototype.set=function(t){for(var e=0;e<this.length;e++)this[e]=t[e]});var u=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return n.__extends(t,i),Object.defineProperty(t.prototype,\"ctx\",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),t.prototype.initialize=function(t){switch(i.prototype.initialize.call(this,t),this.map_el=this.model.map?this.el.appendChild(h.div({class:\"bk-canvas-map\"})):null,this.model.output_backend){case\"canvas\":case\"webgl\":this.canvas_el=this.el.appendChild(h.canvas({class:\"bk-canvas\"}));var e=this.canvas_el.getContext(\"2d\");if(null==e)throw new Error(\"unable to obtain 2D rendering context\");this._ctx=e;break;case\"svg\":var e=new c.SVGRenderingContext2D;this._ctx=e,this.canvas_el=this.el.appendChild(e.getSvg())}this.overlays_el=this.el.appendChild(h.div({class:\"bk-canvas-overlays\"})),this.events_el=this.el.appendChild(h.div({class:\"bk-canvas-events\"})),c.fixup_ctx(this._ctx),a.logger.debug(\"CanvasView initialized\")},t.prototype.css_classes=function(){return i.prototype.css_classes.call(this).concat(\"bk-canvas-wrapper\")},t.prototype.get_canvas_element=function(){return this.canvas_el},t.prototype.prepare_canvas=function(){var t=this.model._width.value,e=this.model._height.value;this.el.style.width=t+\"px\",this.el.style.height=e+\"px\";var i=c.get_scale_ratio(this.ctx,this.model.use_hidpi,this.model.output_backend);this.model.pixel_ratio=i,this.canvas_el.style.width=t+\"px\",this.canvas_el.style.height=e+\"px\",this.canvas_el.setAttribute(\"width\",\"\"+t*i),this.canvas_el.setAttribute(\"height\",\"\"+e*i),a.logger.debug(\"Rendering CanvasView with width: \"+t+\", height: \"+e+\", pixel ratio: \"+i)},t.prototype.set_dims=function(t){var e=t[0],i=t[1];e<=0||i<=0||(e!=this.model._width.value&&(null!=this._width_constraint&&this.solver.has_constraint(this._width_constraint)&&this.solver.remove_constraint(this._width_constraint),this._width_constraint=s.EQ(this.model._width,-e),this.solver.add_constraint(this._width_constraint)),i!=this.model._height.value&&(null!=this._height_constraint&&this.solver.has_constraint(this._height_constraint)&&this.solver.remove_constraint(this._height_constraint),this._height_constraint=s.EQ(this.model._height,-i),this.solver.add_constraint(this._height_constraint)),this.solver.update_variables())},t}(o.DOMView);i.CanvasView=u;var _=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Canvas\",this.prototype.default_view=u,this.internal({map:[l.Boolean,!1],use_hidpi:[l.Boolean,!0],pixel_ratio:[l.Number,1],output_backend:[l.OutputBackend,\"canvas\"]})},Object.defineProperty(t.prototype,\"panel\",{get:function(){return this},enumerable:!0,configurable:!0}),t}(r.LayoutCanvas);(i.Canvas=_).initClass()},function(t,e,i){var n=t(387),a=t(180),l=t(182),h=t(183),c=t(174),u=t(170),_=t(171),r=t(11),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CartesianFrame\",this.internal({extra_x_ranges:[o.Any,{}],extra_y_ranges:[o.Any,{}],x_range:[o.Instance],y_range:[o.Instance],x_scale:[o.Instance],y_scale:[o.Instance]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._configure_scales()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.change,function(){return t._configure_scales()})},Object.defineProperty(t.prototype,\"panel\",{get:function(){return this},enumerable:!0,configurable:!0}),t.prototype.get_editables=function(){return e.prototype.get_editables.call(this).concat([this._width,this._height])},t.prototype.map_to_screen=function(t,e,i,n){void 0===i&&(i=\"default\"),void 0===n&&(n=\"default\");var r=this.xscales[i].v_compute(t),o=this.yscales[n].v_compute(e);return[r,o]},t.prototype._get_ranges=function(t,e){var i={};if(i.default=t,null!=e)for(var n in e)i[n]=e[n];return i},t.prototype._get_scales=function(t,e,i){var n={};for(var r in e){var o=e[r];if(o instanceof u.DataRange1d||o instanceof c.Range1d){if(!(t instanceof h.LogScale||t instanceof l.LinearScale))throw new Error(\"Range \"+o.type+\" is incompatible is Scale \"+t.type);if(t instanceof a.CategoricalScale)throw new Error(\"Range \"+o.type+\" is incompatible is Scale \"+t.type)}if(o instanceof _.FactorRange&&!(t instanceof a.CategoricalScale))throw new Error(\"Range \"+o.type+\" is incompatible is Scale \"+t.type);t instanceof h.LogScale&&o instanceof u.DataRange1d&&(o.scale_hint=\"log\");var s=t.clone();s.setv({source_range:o,target_range:i}),n[r]=s}return n},t.prototype._configure_frame_ranges=function(){this._h_target=new c.Range1d({start:this._left.value,end:this._right.value}),this._v_target=new c.Range1d({start:this._bottom.value,end:this._top.value})},t.prototype._configure_scales=function(){this._configure_frame_ranges(),this._x_ranges=this._get_ranges(this.x_range,this.extra_x_ranges),this._y_ranges=this._get_ranges(this.y_range,this.extra_y_ranges),this._xscales=this._get_scales(this.x_scale,this._x_ranges,this._h_target),this._yscales=this._get_scales(this.y_scale,this._y_ranges,this._v_target)},t.prototype.update_scales=function(){for(var t in this._configure_frame_ranges(),this._xscales){var e=this._xscales[t];e.target_range=this._h_target}for(var i in this._yscales){var e=this._yscales[i];e.target_range=this._v_target}},Object.defineProperty(t.prototype,\"x_ranges\",{get:function(){return this._x_ranges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"y_ranges\",{get:function(){return this._y_ranges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"xscales\",{get:function(){return this._xscales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"yscales\",{get:function(){return this._yscales},enumerable:!0,configurable:!0}),t}(r.LayoutCanvas);(i.CartesianFrame=s).initClass()},function(t,e,i){var n=t(89);i.Canvas=n.Canvas;var r=t(90);i.CartesianFrame=r.CartesianFrame},function(t,e,i){var n=t(387),r=t(93),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CumSum\",this.define({field:[o.String],include_zero:[o.Boolean,!1]})},t.prototype._v_compute=function(t){var e=new Float64Array(t.get_length()||0),i=t.data[this.field],n=this.include_zero?1:0;e[0]=this.include_zero?0:i[0];for(var r=1;r<e.length;r++)e[r]=e[r-1]+i[r-n];return e},t}(r.Expression);(i.CumSum=s).initClass()},function(t,e,i){var n=t(387),r=t(57),o=function(i){function t(t){var e=i.call(this,t)||this;return e._connected={},e._result={},e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"Expression\"},t.prototype.initialize=function(){i.prototype.initialize.call(this),this._connected={},this._result={}},t.prototype.v_compute=function(t){var e=this;null==this._connected[t.id]&&(this.connect(t.change,function(){return delete e._result[t.id]}),this.connect(t.patching,function(){return delete e._result[t.id]}),this.connect(t.streaming,function(){return delete e._result[t.id]}),this._connected[t.id]=!0);var i=this._result[t.id];return null==i&&(this._result[t.id]=i=this._v_compute(t)),i},t}(r.Model);(i.Expression=o).initClass()},function(t,e,i){var n=t(93);i.Expression=n.Expression;var r=t(95);i.Stack=r.Stack;var o=t(92);i.CumSum=o.CumSum},function(t,e,i){var n=t(387),r=t(93),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Stack\",this.define({fields:[o.Array,[]]})},t.prototype._v_compute=function(t){for(var e=new Float64Array(t.get_length()||0),i=0,n=this.fields;i<n.length;i++)for(var r=n[i],o=0;o<t.data[r].length;o++){var s=t.data[r][o];e[o]+=s}return e},t}(r.Expression);(i.Stack=s).initClass()},function(t,e,i){var n=t(387),r=t(98),o=t(15),s=t(14),a=t(21),l=t(44),h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"BooleanFilter\",this.define({booleans:[o.Array,null]})},t.prototype.compute_indices=function(t){var e=this.booleans;return null!=e&&0<e.length?a.all(e,l.isBoolean)?(e.length!==t.get_length()&&s.logger.warn(\"BooleanFilter \"+this.id+\": length of booleans doesn't match data source\"),a.range(0,e.length).filter(function(t){return!0===e[t]})):(s.logger.warn(\"BooleanFilter \"+this.id+\": booleans should be array of booleans, defaulting to no filtering\"),null):(null!=e&&0==e.length?s.logger.warn(\"BooleanFilter \"+this.id+\": booleans is empty, defaulting to no filtering\"):s.logger.warn(\"BooleanFilter \"+this.id+\": booleans was not set, defaulting to no filtering\"),null)},t}(r.Filter);(i.BooleanFilter=h).initClass()},function(i,t,e){var n=i(387),r=i(98),o=i(15),s=i(32),a=i(38),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CustomJSFilter\",this.define({args:[o.Any,{}],code:[o.String,\"\"],use_strict:[o.Boolean,!1]})},Object.defineProperty(t.prototype,\"names\",{get:function(){return s.keys(this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"values\",{get:function(){return s.values(this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"func\",{get:function(){var t=this.use_strict?a.use_strict(this.code):this.code;return new(Function.bind.apply(Function,[void 0].concat(this.names,[\"source\",\"require\",\"exports\",t])))},enumerable:!0,configurable:!0}),t.prototype.compute_indices=function(t){return this.filter=this.func.apply(this,this.values.concat([t,i,{}])),e.prototype.compute_indices.call(this,t)},t}(r.Filter);(e.CustomJSFilter=l).initClass()},function(t,e,i){var n=t(387),r=t(57),o=t(15),s=t(44),a=t(21),l=t(14),h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Filter\",this.define({filter:[o.Array,null]})},t.prototype.compute_indices=function(t){var e=this.filter;return null!=e&&0<=e.length?s.isArrayOf(e,s.isBoolean)?a.range(0,e.length).filter(function(t){return!0===e[t]}):s.isArrayOf(e,s.isInteger)?e:(l.logger.warn(\"Filter \"+this.id+\": filter should either be array of only booleans or only integers, defaulting to no filtering\"),null):(l.logger.warn(\"Filter \"+this.id+\": filter was not set to be an array, defaulting to no filtering\"),null)},t}(r.Model);(i.Filter=h).initClass()},function(t,e,i){var n=t(387),r=t(98),o=t(15),s=t(14),a=t(21),l=function(i){function t(t){var e=i.call(this,t)||this;return e.indices=null,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"GroupFilter\",this.define({column_name:[o.String],group:[o.String]})},t.prototype.compute_indices=function(t){var e=this,i=t.get_column(this.column_name);return null==i?(s.logger.warn(\"group filter: groupby column not found in data source\"),null):(this.indices=a.range(0,t.get_length()||0).filter(function(t){return i[t]===e.group}),0===this.indices.length&&s.logger.warn(\"group filter: group '\"+this.group+\"' did not match any values in column '\"+this.column_name+\"'\"),this.indices)},t}(r.Filter);(i.GroupFilter=l).initClass()},function(t,e,i){var n=t(96);i.BooleanFilter=n.BooleanFilter;var r=t(97);i.CustomJSFilter=r.CustomJSFilter;var o=t(98);i.Filter=o.Filter;var s=t(99);i.GroupFilter=s.GroupFilter;var a=t(101);i.IndexFilter=a.IndexFilter},function(t,e,i){var n=t(387),r=t(98),o=t(15),s=t(14),a=t(44),l=t(21),h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"IndexFilter\",this.define({indices:[o.Array,null]})},t.prototype.compute_indices=function(t){return null!=this.indices&&0<=this.indices.length?l.all(this.indices,a.isInteger)?this.indices:(s.logger.warn(\"IndexFilter \"+this.id+\": indices should be array of integers, defaulting to no filtering\"),null):(s.logger.warn(\"IndexFilter \"+this.id+\": indices was not set, defaulting to no filtering\"),null)},t}(r.Filter);(i.IndexFilter=h).initClass()},function(t,e,i){var n=t(387),r=t(111),o=t(15),f=t(44),s=function(i){function t(t){var e=i.call(this,t)||this;return e.last_precision=3,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"BasicTickFormatter\",this.define({precision:[o.Any,\"auto\"],use_scientific:[o.Bool,!0],power_limit_high:[o.Number,5],power_limit_low:[o.Number,-3]})},Object.defineProperty(t.prototype,\"scientific_limit_low\",{get:function(){return Math.pow(10,this.power_limit_low)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"scientific_limit_high\",{get:function(){return Math.pow(10,this.power_limit_high)},enumerable:!0,configurable:!0}),t.prototype.doFormat=function(t,e){if(0==t.length)return[];var i=0;2<=t.length&&(i=Math.abs(t[1]-t[0])/1e4);var n=!1;if(this.use_scientific)for(var r=0,o=t;r<o.length;r++){var s=o[r],a=Math.abs(s);if(i<a&&(a>=this.scientific_limit_high||a<=this.scientific_limit_low)){n=!0;break}}var l=new Array(t.length),h=this.precision;if(null==h||f.isNumber(h))if(n)for(var c=0,u=t.length;c<u;c++)l[c]=t[c].toExponential(h||void 0);else for(var c=0,u=t.length;c<u;c++)l[c]=t[c].toFixed(h||void 0).replace(/(\\.[0-9]*?)0+$/,\"$1\").replace(/\\.$/,\"\");else for(var _=this.last_precision,p=this.last_precision<=15;p?_<=15:15<=_;p?_++:_--){var d=!0;if(n){for(var c=0,u=t.length;c<u;c++)if(l[c]=t[c].toExponential(_),0<c&&l[c]===l[c-1]){d=!1;break}if(d)break}else{for(var c=0,u=t.length;c<u;c++)if(l[c]=t[c].toFixed(_).replace(/(\\.[0-9]*?)0+$/,\"$1\").replace(/\\.$/,\"\"),0<c&&l[c]==l[c-1]){d=!1;break}if(d)break}if(d){this.last_precision=_;break}}return l},t}(r.TickFormatter);(i.BasicTickFormatter=s).initClass()},function(t,e,i){var n=t(387),r=t(111),o=t(21),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CategoricalTickFormatter\"},t.prototype.doFormat=function(t,e){return o.copy(t)},t}(r.TickFormatter);(i.CategoricalTickFormatter=s).initClass()},function(t,e,i){var n=t(387),r=t(385),w=t(386),o=t(111),k=t(14),s=t(15),a=t(21),l=t(44);function S(t,e){if(l.isFunction(e))return e(t);var i,n=r.sprintf(\"$1%06d\",(i=t,Math.round(i/1e3%1*1e6)));return-1==(e=e.replace(/((&#94;|[&#94;%])(%%)*)%f/,n)).indexOf(\"%\")?e:w(t,e)}var T=[\"microseconds\",\"milliseconds\",\"seconds\",\"minsec\",\"minutes\",\"hourmin\",\"hours\",\"days\",\"months\",\"years\"],h=function(i){function t(t){var e=i.call(this,t)||this;return e.strip_leading_zeros=!0,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"DatetimeTickFormatter\",this.define({microseconds:[s.Array,[\"%fus\"]],milliseconds:[s.Array,[\"%3Nms\",\"%S.%3Ns\"]],seconds:[s.Array,[\"%Ss\"]],minsec:[s.Array,[\":%M:%S\"]],minutes:[s.Array,[\":%M\",\"%Mm\"]],hourmin:[s.Array,[\"%H:%M\"]],hours:[s.Array,[\"%Hh\",\"%H:%M\"]],days:[s.Array,[\"%m/%d\",\"%a%d\"]],months:[s.Array,[\"%m/%Y\",\"%b %Y\"]],years:[s.Array,[\"%Y\"]]})},t.prototype.initialize=function(){i.prototype.initialize.call(this),this._update_width_formats()},t.prototype._update_width_formats=function(){var n=+w(new Date),t=function(t){var e=t.map(function(t){return S(n,t).length}),i=a.sortBy(a.zip(e,t),function(t){var e=t[0];return e});return a.unzip(i)};this._width_formats={microseconds:t(this.microseconds),milliseconds:t(this.milliseconds),seconds:t(this.seconds),minsec:t(this.minsec),minutes:t(this.minutes),hourmin:t(this.hourmin),hours:t(this.hours),days:t(this.days),months:t(this.months),years:t(this.years)}},t.prototype._get_resolution_str=function(t,e){var i=1.1*t;switch(!1){case!(i<.001):return\"microseconds\";case!(i<1):return\"milliseconds\";case!(i<60):return 60<=e?\"minsec\":\"seconds\";case!(i<3600):return 3600<=e?\"hourmin\":\"minutes\";case!(i<86400):return\"hours\";case!(i<2678400):return\"days\";case!(i<31536e3):return\"months\";default:return\"years\"}},t.prototype.doFormat=function(t,e){if(0==t.length)return[];for(var i=Math.abs(t[t.length-1]-t[0])/1e3,n=i/(t.length-1),r=this._get_resolution_str(n,i),o=this._width_formats[r],s=o[1][0],a=[],l=T.indexOf(r),h={},c=0,u=T;c<u.length;c++){var _=u[c];h[_]=0}h.seconds=5,h.minsec=4,h.minutes=4,h.hourmin=3,h.hours=3;for(var p=0,d=t;p<d.length;p++){var f=d[p],v=void 0,m=void 0;try{m=w(f,\"%Y %m %d %H %M %S\").split(/\\s+/).map(function(t){return parseInt(t,10)}),v=S(f,s)}catch(t){k.logger.warn(\"unable to format tick for timestamp value \"+f),k.logger.warn(\" - \"+t),a.push(\"ERR\");continue}for(var g=!1,y=l;0==m[h[T[y]]];){var b=void 0;if((y+=1)==T.length)break;if((\"minsec\"==r||\"hourmin\"==r)&&!g){if(\"minsec\"==r&&0==m[4]&&0!=m[5]||\"hourmin\"==r&&0==m[3]&&0!=m[4]){b=this._width_formats[T[l-1]][1][0],v=S(f,b);break}g=!0}b=this._width_formats[T[y]][1][0],v=S(f,b)}if(this.strip_leading_zeros){var x=v.replace(/&#94;0+/g,\"\");x!=v&&isNaN(parseInt(x))&&(x=\"0\"+x),a.push(x)}else a.push(v)}return a},t}(o.TickFormatter);(i.DatetimeTickFormatter=h).initClass()},function(o,t,e){var i=o(387),n=o(111),r=o(15),s=o(32),a=o(38),l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"FuncTickFormatter\",this.define({args:[r.Any,{}],code:[r.String,\"\"],use_strict:[r.Boolean,!1]})},Object.defineProperty(t.prototype,\"names\",{get:function(){return s.keys(this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"values\",{get:function(){return s.values(this.args)},enumerable:!0,configurable:!0}),t.prototype._make_func=function(){var t=this.use_strict?a.use_strict(this.code):this.code;return new(Function.bind.apply(Function,[void 0,\"tick\",\"index\",\"ticks\"].concat(this.names,[\"require\",\"exports\",t])))},t.prototype.doFormat=function(t,e){var n=this,r=this._make_func().bind({});return t.map(function(t,e,i){return r.apply(void 0,[t,e,i].concat(n.values,[o,{}]))})},t}(n.TickFormatter);(e.FuncTickFormatter=l).initClass()},function(t,e,i){var n=t(102);i.BasicTickFormatter=n.BasicTickFormatter;var r=t(103);i.CategoricalTickFormatter=r.CategoricalTickFormatter;var o=t(104);i.DatetimeTickFormatter=o.DatetimeTickFormatter;var s=t(105);i.FuncTickFormatter=s.FuncTickFormatter;var a=t(107);i.LogTickFormatter=a.LogTickFormatter;var l=t(108);i.MercatorTickFormatter=l.MercatorTickFormatter;var h=t(109);i.NumeralTickFormatter=h.NumeralTickFormatter;var c=t(110);i.PrintfTickFormatter=c.PrintfTickFormatter;var u=t(111);i.TickFormatter=u.TickFormatter},function(t,e,i){var n=t(387),r=t(111),o=t(102),s=t(14),a=t(15),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LogTickFormatter\",this.define({ticker:[a.Instance,null]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.basic_formatter=new o.BasicTickFormatter,null==this.ticker&&s.logger.warn(\"LogTickFormatter not configured with a ticker, using default base of 10 (labels will be incorrect if ticker base is not 10)\")},t.prototype.doFormat=function(t,e){if(0==t.length)return[];for(var i=null!=this.ticker?this.ticker.base:10,n=!1,r=new Array(t.length),o=0,s=t.length;o<s;o++)if(r[o]=i+\"&#94;\"+Math.round(Math.log(t[o])/Math.log(i)),0<o&&r[o]==r[o-1]){n=!0;break}return n?this.basic_formatter.doFormat(t,e):r},t}(r.TickFormatter);(i.LogTickFormatter=l).initClass()},function(t,e,i){var n=t(387),r=t(102),o=t(15),h=t(33),s=function(l){function t(t){return l.call(this,t)||this}return n.__extends(t,l),t.initClass=function(){this.prototype.type=\"MercatorTickFormatter\",this.define({dimension:[o.LatLon]})},t.prototype.doFormat=function(t,e){if(null==this.dimension)throw new Error(\"MercatorTickFormatter.dimension not configured\");if(0==t.length)return[];var i=t.length,n=new Array(i);if(\"lon\"==this.dimension)for(var r=0;r<i;r++){var o=h.wgs84_mercator.inverse([t[r],e.loc])[0];n[r]=o}else for(var r=0;r<i;r++){var s=h.wgs84_mercator.inverse([e.loc,t[r]]),a=s[1];n[r]=a}return l.prototype.doFormat.call(this,n,e)},t}(r.BasicTickFormatter);(i.MercatorTickFormatter=s).initClass()},function(t,e,i){var n=t(387),o=t(357),r=t(111),s=t(15),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"NumeralTickFormatter\",this.define({format:[s.String,\"0,0\"],language:[s.String,\"en\"],rounding:[s.String,\"round\"]})},Object.defineProperty(t.prototype,\"_rounding_fn\",{get:function(){switch(this.rounding){case\"round\":case\"nearest\":return Math.round;case\"floor\":case\"rounddown\":return Math.floor;case\"ceil\":case\"roundup\":return Math.ceil}},enumerable:!0,configurable:!0}),t.prototype.doFormat=function(t,e){var i=this.format,n=this.language,r=this._rounding_fn;return t.map(function(t){return o.format(t,i,n,r)})},t}(r.TickFormatter);(i.NumeralTickFormatter=a).initClass()},function(t,e,i){var n=t(387),r=t(385),o=t(111),s=t(15),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"PrintfTickFormatter\",this.define({format:[s.String,\"%s\"]})},t.prototype.doFormat=function(t,e){var i=this;return t.map(function(t){return r.sprintf(i.format,t)})},t}(o.TickFormatter);(i.PrintfTickFormatter=a).initClass()},function(t,e,i){var n=t(387),r=t(57),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"TickFormatter\"},t}(r.Model);(i.TickFormatter=o).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),z=t(9),s=t(15),P=t(31),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._map_data=function(){\"data\"==this.model.properties.inner_radius.units?this.sinner_radius=this.sdist(this.renderer.xscale,this._x,this._inner_radius):this.sinner_radius=this._inner_radius,\"data\"==this.model.properties.outer_radius.units?this.souter_radius=this.sdist(this.renderer.xscale,this._x,this._outer_radius):this.souter_radius=this._outer_radius,this._angle=new Float32Array(this._start_angle.length);for(var t=0,e=this._start_angle.length;t<e;t++)this._angle[t]=this._end_angle[t]-this._start_angle[t]},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i._start_angle,s=i._angle,a=i.sinner_radius,l=i.souter_radius,h=this.model.properties.direction.value(),c=0,u=e;c<u.length;c++){var _=u[c];isNaN(n[_]+r[_]+a[_]+l[_]+o[_]+s[_])||(t.translate(n[_],r[_]),t.rotate(o[_]),t.moveTo(l[_],0),t.beginPath(),t.arc(0,0,l[_],0,s[_],h),t.rotate(s[_]),t.lineTo(a[_],0),t.arc(0,0,a[_],0,-s[_],!h),t.closePath(),t.rotate(-s[_]-o[_]),t.translate(-n[_],-r[_]),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,_),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,_),t.stroke()))}},e.prototype._hit_point=function(t){var e,i,n,r,o,s,a=t.sx,l=t.sy,h=this.renderer.xscale.invert(a),c=this.renderer.yscale.invert(l);if(\"data\"==this.model.properties.outer_radius.units)n=h-this.max_outer_radius,o=h+this.max_outer_radius,r=c-this.max_outer_radius,s=c+this.max_outer_radius;else{var u=a-this.max_outer_radius,_=a+this.max_outer_radius;e=this.renderer.xscale.r_invert(u,_),n=e[0],o=e[1];var p=l-this.max_outer_radius,d=l+this.max_outer_radius;i=this.renderer.yscale.r_invert(p,d),r=i[0],s=i[1]}for(var f=[],v=z.validate_bbox_coords([n,o],[r,s]),m=0,g=this.index.indices(v);m<g.length;m++){var y=g[m],b=Math.pow(this.souter_radius[y],2),x=Math.pow(this.sinner_radius[y],2),w=this.renderer.xscale.r_compute(h,this._x[y]),u=w[0],_=w[1],k=this.renderer.yscale.r_compute(c,this._y[y]),p=k[0],d=k[1],S=Math.pow(u-_,2)+Math.pow(p-d,2);S<=b&&x<=S&&f.push([y,S])}for(var T=this.model.properties.direction.value(),C=[],A=0,E=f;A<E.length;A++){var M=E[A],y=M[0],S=M[1],O=Math.atan2(l-this.sy[y],a-this.sx[y]);P.angle_between(-O,-this._start_angle[y],-this._end_angle[y],T)&&C.push([y,S])}return z.create_hit_test_result_from_hits(C)},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_area_legend(this.visuals,t,e,i)},e.prototype._scenterxy=function(t){var e=(this.sinner_radius[t]+this.souter_radius[t])/2,i=(this._start_angle[t]+this._end_angle[t])/2;return{x:this.sx[t]+e*Math.cos(i),y:this.sy[t]+e*Math.sin(i)}},e.prototype.scenterx=function(t){return this._scenterxy(t).x},e.prototype.scentery=function(t){return this._scenterxy(t).y},e}(r.XYGlyphView);i.AnnularWedgeView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"AnnularWedge\",this.prototype.default_view=a,this.mixins([\"line\",\"fill\"]),this.define({direction:[s.Direction,\"anticlock\"],inner_radius:[s.DistanceSpec],outer_radius:[s.DistanceSpec],start_angle:[s.AngleSpec],end_angle:[s.AngleSpec]})},t}(r.XYGlyph);(i.AnnularWedge=l).initClass()},function(t,e,i){var n=t(387),r=t(141),k=t(9),o=t(15),p=t(28),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._map_data=function(){\"data\"==this.model.properties.inner_radius.units?this.sinner_radius=this.sdist(this.renderer.xscale,this._x,this._inner_radius):this.sinner_radius=this._inner_radius,\"data\"==this.model.properties.outer_radius.units?this.souter_radius=this.sdist(this.renderer.xscale,this._x,this._outer_radius):this.souter_radius=this._outer_radius},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i.sinner_radius,s=i.souter_radius,a=0,l=e;a<l.length;a++){var h=l[a];if(!isNaN(n[h]+r[h]+o[h]+s[h])){if(this.visuals.fill.doit){if(this.visuals.fill.set_vectorize(t,h),t.beginPath(),p.is_ie)for(var c=0,u=[!1,!0];c<u.length;c++){var _=u[c];t.arc(n[h],r[h],o[h],0,Math.PI,_),t.arc(n[h],r[h],s[h],Math.PI,0,!_)}else t.arc(n[h],r[h],o[h],0,2*Math.PI,!0),t.arc(n[h],r[h],s[h],2*Math.PI,0,!1);t.fill()}this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,h),t.beginPath(),t.arc(n[h],r[h],o[h],0,2*Math.PI),t.moveTo(n[h]+s[h],r[h]),t.arc(n[h],r[h],s[h],0,2*Math.PI),t.stroke())}}},e.prototype._hit_point=function(t){for(var e=t.sx,i=t.sy,n=this.renderer.xscale.invert(e),r=n-this.max_outer_radius,o=n+this.max_outer_radius,s=this.renderer.yscale.invert(i),a=s-this.max_outer_radius,l=s+this.max_outer_radius,h=[],c=k.validate_bbox_coords([r,o],[a,l]),u=0,_=this.index.indices(c);u<_.length;u++){var p=_[u],d=Math.pow(this.souter_radius[p],2),f=Math.pow(this.sinner_radius[p],2),v=this.renderer.xscale.r_compute(n,this._x[p]),m=v[0],g=v[1],y=this.renderer.yscale.r_compute(s,this._y[p]),b=y[0],x=y[1],w=Math.pow(m-g,2)+Math.pow(b-x,2);w<=d&&f<=w&&h.push([p,w])}return k.create_hit_test_result_from_hits(h)},e.prototype.draw_legend_for_index=function(t,e,i){var n=e.x0,r=e.y0,o=e.x1,s=e.y1,a=i+1,l=new Array(a);l[i]=(n+o)/2;var h=new Array(a);h[i]=(r+s)/2;var c=.5*Math.min(Math.abs(o-n),Math.abs(s-r)),u=new Array(a);u[i]=.4*c;var _=new Array(a);_[i]=.8*c,this._render(t,[i],{sx:l,sy:h,sinner_radius:u,souter_radius:_})},e}(r.XYGlyphView);i.AnnulusView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Annulus\",this.prototype.default_view=s,this.mixins([\"line\",\"fill\"]),this.define({inner_radius:[o.DistanceSpec],outer_radius:[o.DistanceSpec]})},t}(r.XYGlyph);(i.Annulus=a).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._map_data=function(){\"data\"==this.model.properties.radius.units?this.sradius=this.sdist(this.renderer.xscale,this._x,this._radius):this.sradius=this._radius},e.prototype._render=function(t,e,i){var n=i.sx,r=i.sy,o=i.sradius,s=i._start_angle,a=i._end_angle;if(this.visuals.line.doit)for(var l=this.model.properties.direction.value(),h=0,c=e;h<c.length;h++){var u=c[h];isNaN(n[u]+r[u]+o[u]+s[u]+a[u])||(t.beginPath(),t.arc(n[u],r[u],o[u],s[u],a[u],l),this.visuals.line.set_vectorize(t,u),t.stroke())}},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e}(r.XYGlyphView);i.ArcView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Arc\",this.prototype.default_view=a,this.mixins([\"line\"]),this.define({direction:[s.Direction,\"anticlock\"],radius:[s.DistanceSpec],start_angle:[s.AngleSpec],end_angle:[s.AngleSpec]})},t}(r.XYGlyph);(i.Arc=l).initClass()},function(t,e,i){var n=t(387),l=t(37),r=t(119),o=t(138);function h(t,e,i,n,r,o,s,a){for(var l=[],h=[[],[]],c=0;c<=2;c++){var u=void 0,_=void 0,p=void 0;if(0===c?(_=6*t-12*i+6*r,u=-3*t+9*i-9*r+3*s,p=3*i-3*t):(_=6*e-12*n+6*o,u=-3*e+9*n-9*o+3*a,p=3*n-3*e),Math.abs(u)<1e-12){if(Math.abs(_)<1e-12)continue;var d=-p/_;0<d&&d<1&&l.push(d)}else{var f=_*_-4*p*u,v=Math.sqrt(f);if(!(f<0)){var m=(-_+v)/(2*u);0<m&&m<1&&l.push(m);var g=(-_-v)/(2*u);0<g&&g<1&&l.push(g)}}}for(var y=l.length,b=y;y--;){var d=l[y],x=1-d,w=x*x*x*t+3*x*x*d*i+3*x*d*d*r+d*d*d*s;h[0][y]=w;var k=x*x*x*e+3*x*x*d*n+3*x*d*d*o+d*d*d*a;h[1][y]=k}return h[0][b]=t,h[1][b]=e,h[0][b+1]=s,h[1][b+1]=a,[Math.min.apply(Math,h[0]),Math.max.apply(Math,h[1]),Math.max.apply(Math,h[0]),Math.min.apply(Math,h[1])]}var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._index_data=function(){for(var t=[],e=0,i=this._x0.length;e<i;e++)if(!isNaN(this._x0[e]+this._x1[e]+this._y0[e]+this._y1[e]+this._cx0[e]+this._cy0[e]+this._cx1[e]+this._cy1[e])){var n=h(this._x0[e],this._y0[e],this._x1[e],this._y1[e],this._cx0[e],this._cy0[e],this._cx1[e],this._cy1[e]),r=n[0],o=n[1],s=n[2],a=n[3];t.push({minX:r,minY:o,maxX:s,maxY:a,i:e})}return new l.SpatialIndex(t)},e.prototype._render=function(t,e,i){var n=i.sx0,r=i.sy0,o=i.sx1,s=i.sy1,a=i.scx0,l=i.scy0,h=i.scx1,c=i.scy1;if(this.visuals.line.doit)for(var u=0,_=e;u<_.length;u++){var p=_[u];isNaN(n[p]+r[p]+o[p]+s[p]+a[p]+l[p]+h[p]+c[p])||(t.beginPath(),t.moveTo(n[p],r[p]),t.bezierCurveTo(a[p],l[p],h[p],c[p],o[p],s[p]),this.visuals.line.set_vectorize(t,p),t.stroke())}},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e.prototype.scenterx=function(){throw new Error(\"not implemented\")},e.prototype.scentery=function(){throw new Error(\"not implemented\")},e}(r.GlyphView);i.BezierView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Bezier\",this.prototype.default_view=s,this.coords([[\"x0\",\"y0\"],[\"x1\",\"y1\"],[\"cx0\",\"cy0\"],[\"cx1\",\"cy1\"]]),this.mixins([\"line\"])},t}(r.Glyph);(i.Bezier=a).initClass()},function(t,e,i){var n=t(387),l=t(37),r=t(119),o=t(138),f=t(9),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._index_box=function(t){for(var e=[],i=0;i<t;i++){var n=this._lrtb(i),r=n[0],o=n[1],s=n[2],a=n[3];!isNaN(r+o+s+a)&&isFinite(r+o+s+a)&&e.push({minX:r,minY:a,maxX:o,maxY:s,i:i})}return new l.SpatialIndex(e)},e.prototype._render=function(t,e,i){for(var n=i.sleft,r=i.sright,o=i.stop,s=i.sbottom,a=0,l=e;a<l.length;a++){var h=l[a];isNaN(n[h]+o[h]+r[h]+s[h])||(this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,h),t.fillRect(n[h],o[h],r[h]-n[h],s[h]-o[h])),this.visuals.line.doit&&(t.beginPath(),t.rect(n[h],o[h],r[h]-n[h],s[h]-o[h]),this.visuals.line.set_vectorize(t,h),t.stroke()))}},e.prototype._hit_rect=function(t){return this._hit_rect_against_index(t)},e.prototype._hit_point=function(t){var e=t.sx,i=t.sy,n=this.renderer.xscale.invert(e),r=this.renderer.yscale.invert(i),o=this.index.indices({minX:n,minY:r,maxX:n,maxY:r}),s=f.create_empty_hit_test_result();return s.indices=o,s},e.prototype._hit_span=function(t){var e,i=t.sx,n=t.sy;if(\"v\"==t.direction){var r=this.renderer.yscale.invert(n),o=this.renderer.plot_view.frame.bbox.h_range,s=this.renderer.xscale.r_invert(o.start,o.end),a=s[0],l=s[1];e=this.index.indices({minX:a,minY:r,maxX:l,maxY:r})}else{var h=this.renderer.xscale.invert(i),c=this.renderer.plot_view.frame.bbox.v_range,u=this.renderer.yscale.r_invert(c.start,c.end),_=u[0],p=u[1];e=this.index.indices({minX:h,minY:_,maxX:h,maxY:p})}var d=f.create_empty_hit_test_result();return d.indices=e,d},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_area_legend(this.visuals,t,e,i)},e}(r.GlyphView);i.BoxView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Box\",this.mixins([\"line\",\"fill\"])},t}(r.Glyph);(i.Box=a).initClass()},function(t,e,i){var n=t(387),r=t(141),M=t(9),o=t(15),h=t(21),s=t(22),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._map_data=function(){if(null!=this._radius)if(\"data\"==this.model.properties.radius.spec.units){var t=this.model.properties.radius_dimension.spec.value;switch(t){case\"x\":this.sradius=this.sdist(this.renderer.xscale,this._x,this._radius);break;case\"y\":this.sradius=this.sdist(this.renderer.yscale,this._y,this._radius)}}else this.sradius=this._radius,this.max_size=2*this.max_radius;else this.sradius=s.map(this._size,function(t){return t/2})},e.prototype._mask_data=function(){var t,e,i,n,r,o,s,a,l=this.renderer.plot_view.frame.bbox.ranges,h=l[0],c=l[1];if(null!=this._radius&&\"data\"==this.model.properties.radius.units){var u=h.start,_=h.end;t=this.renderer.xscale.r_invert(u,_),r=t[0],s=t[1],r-=this.max_radius,s+=this.max_radius;var p=c.start,d=c.end;e=this.renderer.yscale.r_invert(p,d),o=e[0],a=e[1],o-=this.max_radius,a+=this.max_radius}else{var u=h.start-this.max_size,_=h.end+this.max_size;i=this.renderer.xscale.r_invert(u,_),r=i[0],s=i[1];var p=c.start-this.max_size,d=c.end+this.max_size;n=this.renderer.yscale.r_invert(p,d),o=n[0],a=n[1]}var f=M.validate_bbox_coords([r,s],[o,a]);return this.index.indices(f)},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i.sradius,s=0,a=e;s<a.length;s++){var l=a[s];isNaN(n[l]+r[l]+o[l])||(t.beginPath(),t.arc(n[l],r[l],o[l],0,2*Math.PI,!1),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,l),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,l),t.stroke()))}},e.prototype._hit_point=function(t){var e,i,n,r,o,s,a,l,h,c,u,_,p,d,f,v,m=t.sx,g=t.sy,y=this.renderer.xscale.invert(m),b=this.renderer.yscale.invert(g);null!=this._radius&&\"data\"==this.model.properties.radius.units?(p=y-this.max_radius,d=y+this.max_radius,f=b-this.max_radius,v=b+this.max_radius):(h=m-this.max_size,c=m+this.max_size,e=this.renderer.xscale.r_invert(h,c),p=e[0],d=e[1],i=[Math.min(p,d),Math.max(p,d)],p=i[0],d=i[1],u=g-this.max_size,_=g+this.max_size,n=this.renderer.yscale.r_invert(u,_),f=n[0],v=n[1],r=[Math.min(f,v),Math.max(f,v)],f=r[0],v=r[1]);var x=M.validate_bbox_coords([p,d],[f,v]),w=this.index.indices(x),k=[];if(null!=this._radius&&\"data\"==this.model.properties.radius.units)for(var S=0,T=w;S<T.length;S++){var C=T[S];l=Math.pow(this.sradius[C],2),o=this.renderer.xscale.r_compute(y,this._x[C]),h=o[0],c=o[1],s=this.renderer.yscale.r_compute(b,this._y[C]),u=s[0],_=s[1],(a=Math.pow(h-c,2)+Math.pow(u-_,2))<=l&&k.push([C,a])}else for(var A=0,E=w;A<E.length;A++){var C=E[A];l=Math.pow(this.sradius[C],2),(a=Math.pow(this.sx[C]-m,2)+Math.pow(this.sy[C]-g,2))<=l&&k.push([C,a])}return M.create_hit_test_result_from_hits(k)},e.prototype._hit_span=function(t){var e,i,n,r,o,s,a,l,h,c=t.sx,u=t.sy,_=this.bounds(),p=_.minX,d=_.minY,f=_.maxX,v=_.maxY,m=M.create_empty_hit_test_result();if(\"h\"==t.direction){var g=void 0,y=void 0;l=d,h=v,null!=this._radius&&\"data\"==this.model.properties.radius.units?(g=c-this.max_radius,y=c+this.max_radius,e=this.renderer.xscale.r_invert(g,y),s=e[0],a=e[1]):(o=this.max_size/2,g=c-o,y=c+o,i=this.renderer.xscale.r_invert(g,y),s=i[0],a=i[1])}else{var b=void 0,x=void 0;s=p,a=f,null!=this._radius&&\"data\"==this.model.properties.radius.units?(b=u-this.max_radius,x=u+this.max_radius,n=this.renderer.yscale.r_invert(b,x),l=n[0],h=n[1]):(o=this.max_size/2,b=u-o,x=u+o,r=this.renderer.yscale.r_invert(b,x),l=r[0],h=r[1])}var w=M.validate_bbox_coords([s,a],[l,h]),k=this.index.indices(w);return m.indices=k,m},e.prototype._hit_rect=function(t){var e=t.sx0,i=t.sx1,n=t.sy0,r=t.sy1,o=this.renderer.xscale.r_invert(e,i),s=o[0],a=o[1],l=this.renderer.yscale.r_invert(n,r),h=l[0],c=l[1],u=M.validate_bbox_coords([s,a],[h,c]),_=M.create_empty_hit_test_result();return _.indices=this.index.indices(u),_},e.prototype._hit_poly=function(t){for(var e=t.sx,i=t.sy,n=h.range(0,this.sx.length),r=[],o=0,s=n.length;o<s;o++){var a=n[o];M.point_in_poly(this.sx[o],this.sy[o],e,i)&&r.push(a)}var l=M.create_empty_hit_test_result();return l.indices=r,l},e.prototype.draw_legend_for_index=function(t,e,i){var n=e.x0,r=e.y0,o=e.x1,s=e.y1,a=i+1,l=new Array(a);l[i]=(n+o)/2;var h=new Array(a);h[i]=(r+s)/2;var c=new Array(a);c[i]=.2*Math.min(Math.abs(o-n),Math.abs(s-r)),this._render(t,[i],{sx:l,sy:h,sradius:c})},e}(r.XYGlyphView);i.CircleView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Circle\",this.prototype.default_view=a,this.mixins([\"line\",\"fill\"]),this.define({angle:[o.AngleSpec,0],size:[o.DistanceSpec,{units:\"screen\",value:4}],radius:[o.DistanceSpec,null],radius_dimension:[o.String,\"x\"]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.properties.radius.optional=!0},t}(r.XYGlyph);(i.Circle=l).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._set_data=function(){this.max_w2=0,\"data\"==this.model.properties.width.units&&(this.max_w2=this.max_width/2),this.max_h2=0,\"data\"==this.model.properties.height.units&&(this.max_h2=this.max_height/2)},e.prototype._map_data=function(){\"data\"==this.model.properties.width.units?this.sw=this.sdist(this.renderer.xscale,this._x,this._width,\"center\"):this.sw=this._width,\"data\"==this.model.properties.height.units?this.sh=this.sdist(this.renderer.yscale,this._y,this._height,\"center\"):this.sh=this._height},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i.sw,s=i.sh,a=0,l=e;a<l.length;a++){var h=l[a];isNaN(n[h]+r[h]+o[h]+s[h]+this._angle[h])||(t.beginPath(),t.ellipse(n[h],r[h],o[h]/2,s[h]/2,this._angle[h],0,2*Math.PI),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,h),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,h),t.stroke()))}},e.prototype.draw_legend_for_index=function(t,e,i){var n=e.x0,r=e.y0,o=e.x1,s=e.y1,a=i+1,l=new Array(a);l[i]=(n+o)/2;var h=new Array(a);h[i]=(r+s)/2;var c=this.sw[i]/this.sh[i],u=.8*Math.min(Math.abs(o-n),Math.abs(s-r)),_=new Array(a),p=new Array(a);1<c?(_[i]=u,p[i]=u/c):(_[i]=u*c,p[i]=u),this._render(t,[i],{sx:l,sy:h,sw:_,sh:p})},e.prototype._bounds=function(t){var e=t.minX,i=t.maxX,n=t.minY,r=t.maxY;return{minX:e-this.max_w2,maxX:i+this.max_w2,minY:n-this.max_h2,maxY:r+this.max_h2}},e}(r.XYGlyphView);i.EllipseView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Ellipse\",this.prototype.default_view=s,this.mixins([\"line\",\"fill\"]),this.define({angle:[o.AngleSpec,0],width:[o.DistanceSpec],height:[o.DistanceSpec]})},t}(r.XYGlyph);(i.Ellipse=a).initClass()},function(o,t,e){var i=o(387),p=o(9),l=o(15),h=o(24),m=o(33),s=o(49),n=o(48),r=o(57),a=o(14),g=o(22),y=o(32),d=o(44),b=o(126),x=o(171),c=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t._nohit_warned={},t}return i.__extends(t,r),t.prototype.initialize=function(t){r.prototype.initialize.call(this,t),this._nohit_warned={},this.renderer=t.renderer,this.visuals=new s.Visuals(this.model);var e=this.renderer.plot_view.gl;if(null!=e){var i=null;try{i=o(448)}catch(t){if(\"MODULE_NOT_FOUND\"!==t.code)throw t;a.logger.warn(\"WebGL was requested and is supported, but bokeh-gl(.min).js is not available, falling back to 2D rendering.\")}if(null!=i){var n=i[this.model.type+\"GLGlyph\"];null!=n&&(this.glglyph=new n(e.ctx,this))}}},t.prototype.set_visuals=function(t){this.visuals.warm_cache(t),null!=this.glglyph&&this.glglyph.set_visuals_changed()},t.prototype.render=function(t,e,i){t.beginPath(),null!=this.glglyph&&this.glglyph.render(t,e,i)||this._render(t,e,i)},t.prototype.has_finished=function(){return!0},t.prototype.notify_finished=function(){this.renderer.notify_finished()},t.prototype._bounds=function(t){return t},t.prototype.bounds=function(){return this._bounds(this.index.bbox)},t.prototype.log_bounds=function(){for(var t=h.empty(),e=this.index.search(h.positive_x()),i=0,n=e;i<n.length;i++){var r=n[i];r.minX<t.minX&&(t.minX=r.minX),r.maxX>t.maxX&&(t.maxX=r.maxX)}for(var o=this.index.search(h.positive_y()),s=0,a=o;s<a.length;s++){var l=a[s];l.minY<t.minY&&(t.minY=l.minY),l.maxY>t.maxY&&(t.maxY=l.maxY)}return this._bounds(t)},t.prototype.get_anchor_point=function(t,e,i){var n=i[0],r=i[1];switch(t){case\"center\":return{x:this.scenterx(e,n,r),y:this.scentery(e,n,r)};default:return null}},t.prototype.sdist=function(t,e,i,n,r){var o,s;void 0===n&&(n=\"edge\"),void 0===r&&(r=!1);var a=e.length;if(\"center\"==n){var l=g.map(i,function(t){return t/2});o=new Float64Array(a);for(var h=0;h<a;h++)o[h]=e[h]-l[h];s=new Float64Array(a);for(var h=0;h<a;h++)s[h]=e[h]+l[h]}else{o=e,s=new Float64Array(a);for(var h=0;h<a;h++)s[h]=o[h]+i[h]}var c=t.v_compute(o),u=t.v_compute(s);return r?g.map(c,function(t,e){return Math.ceil(Math.abs(u[e]-c[e]))}):g.map(c,function(t,e){return Math.abs(u[e]-c[e])})},t.prototype.draw_legend_for_index=function(t,e,i){},t.prototype.hit_test=function(t){var e=null,i=\"_hit_\"+t.type;return null!=this[i]?e=this[i](t):null==this._nohit_warned[t.type]&&(a.logger.debug(\"'\"+t.type+\"' selection not available for \"+this.model.type),this._nohit_warned[t.type]=!0),e},t.prototype._hit_rect_against_index=function(t){var e=t.sx0,i=t.sx1,n=t.sy0,r=t.sy1,o=this.renderer.xscale.r_invert(e,i),s=o[0],a=o[1],l=this.renderer.yscale.r_invert(n,r),h=l[0],c=l[1],u=p.validate_bbox_coords([s,a],[h,c]),_=p.create_empty_hit_test_result();return _.indices=this.index.indices(u),_},t.prototype.set_data=function(t,i,e){var n,r,o=this.model.materialize_dataspecs(t);if(this.visuals.set_all_indices(i),i&&!(this instanceof b.LineView)){var s={},a=function(t){var e=o[t];\"_\"===t.charAt(0)?s[t]=i.map(function(t){return e[t]}):s[t]=e};for(var l in o)a(l);o=s}var h=this;if(y.extend(h,o),this.renderer.plot_view.model.use_map&&(null!=h._x&&(n=m.project_xy(h._x,h._y),h._x=n[0],h._y=n[1]),null!=h._xs&&(r=m.project_xsys(h._xs,h._ys),h._xs=r[0],h._ys=r[1])),null!=this.renderer.plot_view.frame.x_ranges)for(var c=this.renderer.plot_view.frame.x_ranges[this.model.x_range_name],u=this.renderer.plot_view.frame.y_ranges[this.model.y_range_name],_=0,p=this.model._coords;_<p.length;_++){var d=p[_],f=d[0],v=d[1];f=\"_\"+f,v=\"_\"+v,null!=h._xs?(c instanceof x.FactorRange&&(h[f]=g.map(h[f],function(t){return c.v_synthetic(t)})),u instanceof x.FactorRange&&(h[v]=g.map(h[v],function(t){return u.v_synthetic(t)}))):(c instanceof x.FactorRange&&(h[f]=c.v_synthetic(h[f])),u instanceof x.FactorRange&&(h[v]=u.v_synthetic(h[v])))}null!=this.glglyph&&this.glglyph.set_data_changed(h._x.length),this._set_data(e),this.index_data()},t.prototype._set_data=function(t){},t.prototype.index_data=function(){this.index=this._index_data()},t.prototype.mask_data=function(t){return null!=this.glglyph||null==this._mask_data?t:this._mask_data()},t.prototype.map_data=function(){for(var t,e=this,i=0,n=this.model._coords;i<n.length;i++){var r=n[i],o=r[0],s=r[1],a=\"s\"+o,l=\"s\"+s;if(s=\"_\"+s,null!=e[o=\"_\"+o]&&(d.isArray(e[o][0])||d.isTypedArray(e[o][0]))){var h=e[o].length;e[a]=new Array(h),e[l]=new Array(h);for(var c=0;c<h;c++){var u=this.map_to_screen(e[o][c],e[s][c]),_=u[0],p=u[1];e[a][c]=_,e[l][c]=p}}else t=this.map_to_screen(e[o],e[s]),e[a]=t[0],e[l]=t[1]}this._map_data()},t.prototype._map_data=function(){},t.prototype.map_to_screen=function(t,e){return this.renderer.plot_view.map_to_screen(t,e,this.model.x_range_name,this.model.y_range_name)},t}(n.View);e.GlyphView=c;var u=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Glyph\",this.prototype._coords=[],this.internal({x_range_name:[l.String,\"default\"],y_range_name:[l.String,\"default\"]})},t.coords=function(t){var e=this.prototype._coords.concat(t);this.prototype._coords=e;for(var i={},n=0,r=t;n<r.length;n++){var o=r[n],s=o[0],a=o[1];i[s]=[l.NumberSpec],i[a]=[l.NumberSpec]}this.define(i)},t}(r.Model);(e.Glyph=u).initClass()},function(t,e,i){var n=t(387),r=t(116),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.scenterx=function(t){return(this.sleft[t]+this.sright[t])/2},e.prototype.scentery=function(t){return this.sy[t]},e.prototype._index_data=function(){return this._index_box(this._y.length)},e.prototype._lrtb=function(t){var e=Math.min(this._left[t],this._right[t]),i=Math.max(this._left[t],this._right[t]),n=this._y[t]+.5*this._height[t],r=this._y[t]-.5*this._height[t];return[e,i,n,r]},e.prototype._map_data=function(){this.sy=this.renderer.yscale.v_compute(this._y),this.sh=this.sdist(this.renderer.yscale,this._y,this._height,\"center\"),this.sleft=this.renderer.xscale.v_compute(this._left),this.sright=this.renderer.xscale.v_compute(this._right);var t=this.sy.length;this.stop=new Float64Array(t),this.sbottom=new Float64Array(t);for(var e=0;e<t;e++)this.stop[e]=this.sy[e]-this.sh[e]/2,this.sbottom[e]=this.sy[e]+this.sh[e]/2},e}(r.BoxView);i.HBarView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"HBar\",this.prototype.default_view=s,this.coords([[\"left\",\"y\"]]),this.define({height:[o.DistanceSpec],right:[o.NumberSpec]}),this.override({left:0})},t}(r.Box);(i.HBar=a).initClass()},function(t,e,i){var n=t(387),r=t(119),f=t(9),o=t(15),a=t(37),s=t(138),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.scenterx=function(t){return this.sx[t]},e.prototype.scentery=function(t){return this.sy[t]},e.prototype._set_data=function(){var t=this._q.length,e=this.model.size,i=this.model.aspect_scale;if(this._x=new Float64Array(t),this._y=new Float64Array(t),\"pointytop\"==this.model.orientation)for(var n=0;n<t;n++)this._x[n]=e*Math.sqrt(3)*(this._q[n]+this._r[n]/2)/i,this._y[n]=3*-e/2*this._r[n];else for(var n=0;n<t;n++)this._x[n]=3*e/2*this._q[n],this._y[n]=-e*Math.sqrt(3)*(this._r[n]+this._q[n]/2)*i},e.prototype._index_data=function(){var t,e=this.model.size,i=Math.sqrt(3)*e/2;\"flattop\"==this.model.orientation?(i=(t=[e,i])[0],e=t[1],e*=this.model.aspect_scale):i/=this.model.aspect_scale;for(var n=[],r=0;r<this._x.length;r++){var o=this._x[r],s=this._y[r];!isNaN(o+s)&&isFinite(o+s)&&n.push({minX:o-i,minY:s-e,maxX:o+i,maxY:s+e,i:r})}return new a.SpatialIndex(n)},e.prototype.map_data=function(){var t,e;t=this.map_to_screen(this._x,this._y),this.sx=t[0],this.sy=t[1],e=this._get_unscaled_vertices(),this.svx=e[0],this.svy=e[1]},e.prototype._get_unscaled_vertices=function(){var t=this.model.size,e=this.model.aspect_scale;if(\"pointytop\"==this.model.orientation){var i=this.renderer.yscale,n=this.renderer.xscale,r=Math.abs(i.compute(0)-i.compute(t)),o=Math.sqrt(3)/2*Math.abs(n.compute(0)-n.compute(t))/e,s=r/2,a=[0,-o,-o,0,o,o],l=[r,s,-s,-r,-s,s];return[a,l]}var i=this.renderer.xscale,n=this.renderer.yscale,r=Math.abs(i.compute(0)-i.compute(t)),o=Math.sqrt(3)/2*Math.abs(n.compute(0)-n.compute(t))*e,s=r/2,a=[r,s,-s,-r,-s,s],l=[0,-o,-o,0,o,o];return[a,l]},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i.svx,s=i.svy,a=i._scale,l=0,h=e;l<h.length;l++){var c=h[l];if(!isNaN(n[c]+r[c]+a[c])){t.translate(n[c],r[c]),t.beginPath();for(var u=0;u<6;u++)t.lineTo(o[u]*a[c],s[u]*a[c]);t.closePath(),t.translate(-n[c],-r[c]),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,c),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,c),t.stroke())}}},e.prototype._hit_point=function(t){for(var e=t.sx,i=t.sy,n=this.renderer.xscale.invert(e),r=this.renderer.yscale.invert(i),o=this.index.indices({minX:n,minY:r,maxX:n,maxY:r}),s=[],a=0,l=o;a<l.length;a++){var h=l[a];f.point_in_poly(e-this.sx[h],i-this.sy[h],this.svx,this.svy)&&s.push(h)}var c=f.create_empty_hit_test_result();return c.indices=s,c},e.prototype._hit_span=function(t){var e,i=t.sx,n=t.sy;if(\"v\"==t.direction){var r=this.renderer.yscale.invert(n),o=this.renderer.plot_view.frame.bbox.h_range,s=this.renderer.xscale.r_invert(o.start,o.end),a=s[0],l=s[1];e=this.index.indices({minX:a,minY:r,maxX:l,maxY:r})}else{var h=this.renderer.xscale.invert(i),c=this.renderer.plot_view.frame.bbox.v_range,u=this.renderer.yscale.r_invert(c.start,c.end),_=u[0],p=u[1];e=this.index.indices({minX:h,minY:_,maxX:h,maxY:p})}var d=f.create_empty_hit_test_result();return d.indices=e,d},e.prototype._hit_rect=function(t){var e=t.sx0,i=t.sx1,n=t.sy0,r=t.sy1,o=this.renderer.xscale.r_invert(e,i),s=o[0],a=o[1],l=this.renderer.yscale.r_invert(n,r),h=l[0],c=l[1],u=f.validate_bbox_coords([s,a],[h,c]),_=f.create_empty_hit_test_result();return _.indices=this.index.indices(u),_},e.prototype.draw_legend_for_index=function(t,e,i){s.generic_area_legend(this.visuals,t,e,i)},e}(r.GlyphView);i.HexTileView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"HexTile\",this.prototype.default_view=l,this.coords([[\"r\",\"q\"]]),this.mixins([\"line\",\"fill\"]),this.define({size:[o.Number,1],aspect_scale:[o.Number,1],scale:[o.NumberSpec,1],orientation:[o.String,\"pointytop\"]}),this.override({line_color:null})},t}(r.Glyph);(i.HexTile=h).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(160),s=t(15),u=t(21),l=t(37),_=t(9),a=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return n.__extends(t,i),t.prototype.initialize=function(t){var e=this;i.prototype.initialize.call(this,t),this.connect(this.model.color_mapper.change,function(){return e._update_image()}),this.connect(this.model.properties.global_alpha.change,function(){return e.renderer.request_render()})},t.prototype._update_image=function(){null!=this.image_data&&(this._set_data(),this.renderer.plot_view.request_render())},t.prototype._index_data=function(){for(var t=[],e=0,i=this._x.length;e<i;e++){var n=this._lrtb(e),r=n[0],o=n[1],s=n[2],a=n[3];!isNaN(r+o+s+a)&&isFinite(r+o+s+a)&&t.push({minX:r,minY:a,maxX:o,maxY:s,i:e})}return new l.SpatialIndex(t)},t.prototype._lrtb=function(t){var e=this._x[t],i=e+this._dw[t],n=this._y[t],r=n+this._dh[t];return[e,i,r,n]},t.prototype._image_index=function(t,e,i){var n=this._lrtb(t),r=n[0],o=n[1],s=n[2],a=n[3],l=this._width[t],h=this._height[t],c=(o-r)/l,u=(s-a)/h,_=Math.floor((e-r)/c),p=Math.floor((i-a)/u);return{index:t,dim1:_,dim2:p,flat_index:p*l+_}},t.prototype._hit_point=function(t){var e=t.sx,i=t.sy,n=this.renderer.xscale.invert(e),r=this.renderer.yscale.invert(i),o=_.validate_bbox_coords([n,n],[r,r]),s=this.index.indices(o),a=_.create_empty_hit_test_result();a.image_indices=[];for(var l=0,h=s;l<h.length;l++){var c=h[l];e!=1/0&&i!=1/0&&a.image_indices.push(this._image_index(c,n,r))}return a},t.prototype._set_data=function(){null!=this.image_data&&this.image_data.length==this._image.length||(this.image_data=new Array(this._image.length)),null!=this._width&&this._width.length==this._image.length||(this._width=new Array(this._image.length)),null!=this._height&&this._height.length==this._image.length||(this._height=new Array(this._image.length));for(var t=this.model.color_mapper.rgba_mapper,e=0,i=this._image.length;e<i;e++){var n=void 0;if(null!=this._image_shape&&0<this._image_shape[e].length){n=this._image[e];var r=this._image_shape[e];this._height[e]=r[0],this._width[e]=r[1]}else{var o=this._image[e];n=u.concat(o),this._height[e]=o.length,this._width[e]=o[0].length}var s=this.image_data[e],a=void 0;null!=s&&s.width==this._width[e]&&s.height==this._height[e]?a=s:((a=document.createElement(\"canvas\")).width=this._width[e],a.height=this._height[e]);var l=a.getContext(\"2d\"),h=l.getImageData(0,0,this._width[e],this._height[e]),c=t.v_compute(n);h.data.set(c),l.putImageData(h,0,0),this.image_data[e]=a,this.max_dw=0,\"data\"==this.model.properties.dw.units&&(this.max_dw=u.max(this._dw)),this.max_dh=0,\"data\"==this.model.properties.dh.units&&(this.max_dh=u.max(this._dh))}},t.prototype._map_data=function(){switch(this.model.properties.dw.units){case\"data\":this.sw=this.sdist(this.renderer.xscale,this._x,this._dw,\"edge\",this.model.dilate);break;case\"screen\":this.sw=this._dw}switch(this.model.properties.dh.units){case\"data\":this.sh=this.sdist(this.renderer.yscale,this._y,this._dh,\"edge\",this.model.dilate);break;case\"screen\":this.sh=this._dh}},t.prototype._render=function(t,e,i){var n=i.image_data,r=i.sx,o=i.sy,s=i.sw,a=i.sh,l=t.getImageSmoothingEnabled();t.setImageSmoothingEnabled(!1),t.globalAlpha=this.model.global_alpha;for(var h=0,c=e;h<c.length;h++){var u=c[h];if(null!=n[u]&&!isNaN(r[u]+o[u]+s[u]+a[u])){var _=o[u];t.translate(0,_),t.scale(1,-1),t.translate(0,-_),t.drawImage(n[u],0|r[u],0|o[u],s[u],a[u]),t.translate(0,_),t.scale(1,-1),t.translate(0,-_)}}t.setImageSmoothingEnabled(l)},t.prototype.bounds=function(){var t=this.index.bbox;return t.maxX+=this.max_dw,t.maxY+=this.max_dh,t},t}(r.XYGlyphView);i.ImageView=a;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Image\",this.prototype.default_view=a,this.define({image:[s.NumberSpec],dw:[s.DistanceSpec],dh:[s.DistanceSpec],dilate:[s.Bool,!1],global_alpha:[s.Number,1],color_mapper:[s.Instance,function(){return new o.LinearColorMapper({palette:[\"#000000\",\"#252525\",\"#525252\",\"#737373\",\"#969696\",\"#bdbdbd\",\"#d9d9d9\",\"#f0f0f0\",\"#ffffff\"]})}]})},t}(r.XYGlyph);(i.Image=h).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(15),f=t(21),s=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return n.__extends(t,i),t.prototype.initialize=function(t){var e=this;i.prototype.initialize.call(this,t),this.connect(this.model.properties.global_alpha.change,function(){return e.renderer.request_render()})},t.prototype._set_data=function(t){null!=this.image_data&&this.image_data.length==this._image.length||(this.image_data=new Array(this._image.length)),null!=this._width&&this._width.length==this._image.length||(this._width=new Array(this._image.length)),null!=this._height&&this._height.length==this._image.length||(this._height=new Array(this._image.length));for(var e=0,i=this._image.length;e<i;e++)if(!(null!=t&&t.indexOf(e)<0)){var n=void 0;if(null!=this._image_shape&&0<this._image_shape[e].length){n=this._image[e].buffer;var r=this._image_shape[e];this._height[e]=r[0],this._width[e]=r[1]}else{var o=this._image[e],s=f.concat(o);n=new ArrayBuffer(4*s.length);for(var a=new Uint32Array(n),l=0,h=s.length;l<h;l++)a[l]=s[l];this._height[e]=o.length,this._width[e]=o[0].length}var c=this.image_data[e],u=void 0;null!=c&&c.width==this._width[e]&&c.height==this._height[e]?u=c:((u=document.createElement(\"canvas\")).width=this._width[e],u.height=this._height[e]);var _=u.getContext(\"2d\"),p=_.getImageData(0,0,this._width[e],this._height[e]),d=new Uint8Array(n);p.data.set(d),_.putImageData(p,0,0),this.image_data[e]=u,this.max_dw=0,\"data\"==this.model.properties.dw.units&&(this.max_dw=f.max(this._dw)),this.max_dh=0,\"data\"==this.model.properties.dh.units&&(this.max_dh=f.max(this._dh))}},t.prototype._map_data=function(){switch(this.model.properties.dw.units){case\"data\":this.sw=this.sdist(this.renderer.xscale,this._x,this._dw,\"edge\",this.model.dilate);break;case\"screen\":this.sw=this._dw}switch(this.model.properties.dh.units){case\"data\":this.sh=this.sdist(this.renderer.yscale,this._y,this._dh,\"edge\",this.model.dilate);break;case\"screen\":this.sh=this._dh}},t.prototype._render=function(t,e,i){var n=i.image_data,r=i.sx,o=i.sy,s=i.sw,a=i.sh,l=t.getImageSmoothingEnabled();t.setImageSmoothingEnabled(!1),t.globalAlpha=this.model.global_alpha;for(var h=0,c=e;h<c.length;h++){var u=c[h];if(!isNaN(r[u]+o[u]+s[u]+a[u])){var _=o[u];t.translate(0,_),t.scale(1,-1),t.translate(0,-_),t.drawImage(n[u],0|r[u],0|o[u],s[u],a[u]),t.translate(0,_),t.scale(1,-1),t.translate(0,-_)}}t.setImageSmoothingEnabled(l)},t.prototype.bounds=function(){var t=this.index.bbox;return t.maxX+=this.max_dw,t.maxY+=this.max_dh,t},t}(r.XYGlyphView);i.ImageRGBAView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ImageRGBA\",this.prototype.default_view=s,this.define({image:[o.NumberSpec],dw:[o.DistanceSpec],dh:[o.DistanceSpec],global_alpha:[o.Number,1],dilate:[o.Bool,!1]})},t}(r.XYGlyph);(i.ImageRGBA=a).initClass()},function(t,e,l){var n=t(387),i=t(141),h=t(14),r=t(15),c=t(22),o=t(37);l.CanvasImage=Image;var s=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t._images_rendered=!1,t}return n.__extends(t,i),t.prototype.initialize=function(t){var e=this;i.prototype.initialize.call(this,t),this.connect(this.model.properties.global_alpha.change,function(){return e.renderer.request_render()})},t.prototype._index_data=function(){return new o.SpatialIndex([])},t.prototype._set_data=function(){var n=this;null!=this.image&&this.image.length==this._url.length||(this.image=c.map(this._url,function(){return null}));var t=this.model,r=t.retry_attempts,o=t.retry_timeout;this.retries=c.map(this._url,function(){return r});for(var e=function(t,e){if(null==s._url[t])return\"continue\";var i=new l.CanvasImage;i.onerror=function(){0<n.retries[t]?(h.logger.trace(\"ImageURL failed to load \"+n._url[t]+\" image, retrying in \"+o+\" ms\"),setTimeout(function(){return i.src=n._url[t]},o)):h.logger.warn(\"ImageURL unable to load \"+n._url[t]+\" image after \"+r+\" retries\"),n.retries[t]-=1},i.onload=function(){n.image[t]=i,n.renderer.request_render()},i.src=s._url[t]},s=this,i=0,a=this._url.length;i<a;i++)e(i,a)},t.prototype.has_finished=function(){return i.prototype.has_finished.call(this)&&1==this._images_rendered},t.prototype._map_data=function(){var t=null!=this.model.w?this._w:c.map(this._x,function(){return NaN}),e=null!=this.model.h?this._h:c.map(this._x,function(){return NaN});switch(this.model.properties.w.units){case\"data\":this.sw=this.sdist(this.renderer.xscale,this._x,t,\"edge\",this.model.dilate);break;case\"screen\":this.sw=t}switch(this.model.properties.h.units){case\"data\":this.sh=this.sdist(this.renderer.yscale,this._y,e,\"edge\",this.model.dilate);break;case\"screen\":this.sh=e}},t.prototype._render=function(t,e,i){var n=i.image,r=i.sx,o=i.sy,s=i.sw,a=i.sh,l=i._angle,h=this.renderer.plot_view.frame;t.rect(h._left.value+1,h._top.value+1,h._width.value-2,h._height.value-2),t.clip();for(var c=!0,u=0,_=e;u<_.length;u++){var p=_[u];if(!isNaN(r[p]+o[p]+l[p])&&-1!=this.retries[p]){var d=n[p];null!=d?this._render_image(t,p,d,r,o,s,a,l):c=!1}}c&&!this._images_rendered&&(this._images_rendered=!0,this.notify_finished())},t.prototype._final_sx_sy=function(t,e,i,n,r){switch(t){case\"top_left\":return[e,i];case\"top_center\":return[e-n/2,i];case\"top_right\":return[e-n,i];case\"center_right\":return[e-n,i-r/2];case\"bottom_right\":return[e-n,i-r];case\"bottom_center\":return[e-n/2,i-r];case\"bottom_left\":return[e,i-r];case\"center_left\":return[e,i-r/2];case\"center\":return[e-n/2,i-r/2]}},t.prototype._render_image=function(t,e,i,n,r,o,s,a){isNaN(o[e])&&(o[e]=i.width),isNaN(s[e])&&(s[e]=i.height);var l=this.model.anchor,h=this._final_sx_sy(l,n[e],r[e],o[e],s[e]),c=h[0],u=h[1];t.save(),t.globalAlpha=this.model.global_alpha,a[e]?(t.translate(c,u),t.rotate(a[e]),t.drawImage(i,0,0,o[e],s[e]),t.rotate(-a[e]),t.translate(-c,-u)):t.drawImage(i,c,u,o[e],s[e]),t.restore()},t}(i.XYGlyphView);l.ImageURLView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ImageURL\",this.prototype.default_view=s,this.define({url:[r.StringSpec],anchor:[r.Anchor,\"top_left\"],global_alpha:[r.Number,1],angle:[r.AngleSpec,0],w:[r.DistanceSpec],h:[r.DistanceSpec],dilate:[r.Bool,!1],retry_attempts:[r.Number,0],retry_timeout:[r.Number,0]})},t}(i.XYGlyph);(l.ImageURL=a).initClass()},function(t,e,i){var n=t(112);i.AnnularWedge=n.AnnularWedge;var r=t(113);i.Annulus=r.Annulus;var o=t(114);i.Arc=o.Arc;var s=t(115);i.Bezier=s.Bezier;var a=t(117);i.Circle=a.Circle;var l=t(118);i.Ellipse=l.Ellipse;var h=t(119);i.Glyph=h.Glyph;var c=t(120);i.HBar=c.HBar;var u=t(121);i.HexTile=u.HexTile;var _=t(122);i.Image=_.Image;var p=t(123);i.ImageRGBA=p.ImageRGBA;var d=t(124);i.ImageURL=d.ImageURL;var f=t(126);i.Line=f.Line;var v=t(127);i.MultiLine=v.MultiLine;var m=t(128);i.Oval=m.Oval;var g=t(129);i.Patch=g.Patch;var y=t(130);i.Patches=y.Patches;var b=t(131);i.Quad=b.Quad;var x=t(132);i.Quadratic=x.Quadratic;var w=t(133);i.Ray=w.Ray;var k=t(134);i.Rect=k.Rect;var S=t(135);i.Segment=S.Segment;var T=t(136);i.Step=T.Step;var C=t(137);i.Text=C.Text;var A=t(139);i.VBar=A.VBar;var E=t(140);i.Wedge=E.Wedge;var M=t(141);i.XYGlyph=M.XYGlyph},function(t,e,i){var n=t(387),r=t(141),o=t(138),w=t(9),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._render=function(t,e,i){var n=i.sx,r=i.sy,o=!1,s=null;this.visuals.line.set_value(t);for(var a=0,l=e;a<l.length;a++){var h=l[a];if(o){if(!isFinite(n[h]+r[h])){t.stroke(),t.beginPath(),o=!1,s=h;continue}null!=s&&1<h-s&&(t.stroke(),o=!1)}o?t.lineTo(n[h],r[h]):(t.beginPath(),t.moveTo(n[h],r[h]),o=!0),s=h}o&&t.stroke()},e.prototype._hit_point=function(t){for(var e=this,i=w.create_empty_hit_test_result(),n={x:t.sx,y:t.sy},r=9999,o=Math.max(2,this.visuals.line.line_width.value()/2),s=0,a=this.sx.length-1;s<a;s++){var l={x:this.sx[s],y:this.sy[s]},h={x:this.sx[s+1],y:this.sy[s+1]},c=w.dist_to_segment(n,l,h);c<o&&c<r&&(r=c,i.add_to_selected_glyphs(this.model),i.get_view=function(){return e},i.line_indices=[s])}return i},e.prototype._hit_span=function(t){var e,i,n=this,r=t.sx,o=t.sy,s=w.create_empty_hit_test_result();\"v\"==t.direction?(e=this.renderer.yscale.invert(o),i=this._y):(e=this.renderer.xscale.invert(r),i=this._x);for(var a=0,l=i.length-1;a<l;a++)(i[a]<=e&&e<=i[a+1]||i[a+1]<=e&&e<=i[a])&&(s.add_to_selected_glyphs(this.model),s.get_view=function(){return n},s.line_indices.push(a));return s},e.prototype.get_interpolation_hit=function(t,e){var i,n,r,o,s,a,l,h,c,u,_=e.sx,p=e.sy,d=[this._x[t],this._y[t],this._x[t+1],this._y[t+1]],f=d[0],v=d[1],m=d[2],g=d[3];\"point\"==e.type?(i=this.renderer.yscale.r_invert(p-1,p+1),c=i[0],u=i[1],n=this.renderer.xscale.r_invert(_-1,_+1),l=n[0],h=n[1]):\"v\"==e.direction?(r=this.renderer.yscale.r_invert(p,p),c=r[0],u=r[1],l=(o=[f,m])[0],h=o[1]):(s=this.renderer.xscale.r_invert(_,_),l=s[0],h=s[1],c=(a=[v,g])[0],u=a[1]);var y=w.check_2_segments_intersect(l,c,h,u,f,v,m,g),b=y.x,x=y.y;return[b,x]},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e}(r.XYGlyphView);i.LineView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Line\",this.prototype.default_view=s,this.mixins([\"line\"])},t}(r.XYGlyph);(i.Line=a).initClass()},function(t,e,i){var n=t(387),m=t(37),w=t(9),d=t(32),g=t(21),y=t(44),r=t(119),o=t(138),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._index_data=function(){for(var t=[],e=0,i=this._xs.length;e<i;e++)if(null!=this._xs[e]&&0!==this._xs[e].length){for(var n=this._xs[e],r=[],o=0,s=n.length;o<s;o++){var a=n[o];y.isStrictNaN(a)||r.push(a)}for(var l=this._ys[e],h=[],o=0,s=l.length;o<s;o++){var c=l[o];y.isStrictNaN(c)||h.push(c)}var u=[g.min(r),g.max(r)],_=u[0],p=u[1],d=[g.min(h),g.max(h)],f=d[0],v=d[1];t.push({minX:_,minY:f,maxX:p,maxY:v,i:e})}return new m.SpatialIndex(t)},e.prototype._render=function(t,e,i){for(var n=i.sxs,r=i.sys,o=0,s=e;o<s.length;o++){var a=s[o],l=[n[a],r[a]],h=l[0],c=l[1];this.visuals.line.set_vectorize(t,a);for(var u=0,_=h.length;u<_;u++)0!=u?isNaN(h[u])||isNaN(c[u])?(t.stroke(),t.beginPath()):t.lineTo(h[u],c[u]):(t.beginPath(),t.moveTo(h[u],c[u]));t.stroke()}},e.prototype._hit_point=function(t){for(var e=w.create_empty_hit_test_result(),i={x:t.sx,y:t.sy},n=9999,r={},o=0,s=this.sxs.length;o<s;o++){for(var a=Math.max(2,this.visuals.line.cache_select(\"line_width\",o)/2),l=null,h=0,c=this.sxs[o].length-1;h<c;h++){var u={x:this.sxs[o][h],y:this.sys[o][h]},_={x:this.sxs[o][h+1],y:this.sys[o][h+1]},p=w.dist_to_segment(i,u,_);p<a&&p<n&&(n=p,l=[h])}l&&(r[o]=l)}return e.indices=d.keys(r).map(function(t){return parseInt(t,10)}),e.multiline_indices=r,e},e.prototype._hit_span=function(t){var e,i,n=t.sx,r=t.sy,o=w.create_empty_hit_test_result();\"v\"===t.direction?(e=this.renderer.yscale.invert(r),i=this._ys):(e=this.renderer.xscale.invert(n),i=this._xs);for(var s={},a=0,l=i.length;a<l;a++){for(var h=[],c=0,u=i[a].length-1;c<u;c++)i[a][c]<=e&&e<=i[a][c+1]&&h.push(c);0<h.length&&(s[a]=h)}return o.indices=d.keys(s).map(function(t){return parseInt(t,10)}),o.multiline_indices=s,o},e.prototype.get_interpolation_hit=function(t,e,i){var n,r,o,s,a,l,h,c,u,_,p=i.sx,d=i.sy,f=this._xs[t][e],v=this._ys[t][e],m=this._xs[t][e+1],g=this._ys[t][e+1];\"point\"==i.type?(n=this.renderer.yscale.r_invert(d-1,d+1),u=n[0],_=n[1],r=this.renderer.xscale.r_invert(p-1,p+1),h=r[0],c=r[1]):\"v\"==i.direction?(o=this.renderer.yscale.r_invert(d,d),u=o[0],_=o[1],h=(s=[f,m])[0],c=s[1]):(a=this.renderer.xscale.r_invert(p,p),h=a[0],c=a[1],u=(l=[v,g])[0],_=l[1]);var y=w.check_2_segments_intersect(h,u,c,_,f,v,m,g),b=y.x,x=y.y;return[b,x]},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e.prototype.scenterx=function(){throw new Error(\"not implemented\")},e.prototype.scentery=function(){throw new Error(\"not implemented\")},e}(r.GlyphView);i.MultiLineView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"MultiLine\",this.prototype.default_view=s,this.coords([[\"xs\",\"ys\"]]),this.mixins([\"line\"])},t}(r.Glyph);(i.MultiLine=a).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._set_data=function(){this.max_w2=0,\"data\"==this.model.properties.width.units&&(this.max_w2=this.max_width/2),this.max_h2=0,\"data\"==this.model.properties.height.units&&(this.max_h2=this.max_height/2)},e.prototype._map_data=function(){\"data\"==this.model.properties.width.units?this.sw=this.sdist(this.renderer.xscale,this._x,this._width,\"center\"):this.sw=this._width,\"data\"==this.model.properties.height.units?this.sh=this.sdist(this.renderer.yscale,this._y,this._height,\"center\"):this.sh=this._height},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i.sw,s=i.sh,a=i._angle,l=0,h=e;l<h.length;l++){var c=h[l];isNaN(n[c]+r[c]+o[c]+s[c]+a[c])||(t.translate(n[c],r[c]),t.rotate(a[c]),t.beginPath(),t.moveTo(0,-s[c]/2),t.bezierCurveTo(o[c]/2,-s[c]/2,o[c]/2,s[c]/2,0,s[c]/2),t.bezierCurveTo(-o[c]/2,s[c]/2,-o[c]/2,-s[c]/2,0,-s[c]/2),t.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,c),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,c),t.stroke()),t.rotate(-a[c]),t.translate(-n[c],-r[c]))}},e.prototype.draw_legend_for_index=function(t,e,i){var n=e.x0,r=e.y0,o=e.x1,s=e.y1,a=i+1,l=new Array(a);l[i]=(n+o)/2;var h=new Array(a);h[i]=(r+s)/2;var c=this.sw[i]/this.sh[i],u=.8*Math.min(Math.abs(o-n),Math.abs(s-r)),_=new Array(a),p=new Array(a);1<c?(_[i]=u,p[i]=u/c):(_[i]=u*c,p[i]=u),this._render(t,[i],{sx:l,sy:h,sw:_,sh:p})},e.prototype._bounds=function(t){var e=t.minX,i=t.maxX,n=t.minY,r=t.maxY;return{minX:e-this.max_w2,maxX:i+this.max_w2,minY:n-this.max_h2,maxY:r+this.max_h2}},e}(r.XYGlyphView);i.OvalView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Oval\",this.prototype.default_view=s,this.mixins([\"line\",\"fill\"]),this.define({angle:[o.AngleSpec,0],width:[o.DistanceSpec],height:[o.DistanceSpec]})},t}(r.XYGlyph);(i.Oval=a).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._render=function(t,e,i){var n=i.sx,r=i.sy;if(this.visuals.fill.doit){this.visuals.fill.set_value(t);for(var o=0,s=e;o<s.length;o++){var a=s[o];0!=a?isNaN(n[a]+r[a])?(t.closePath(),t.fill(),t.beginPath()):t.lineTo(n[a],r[a]):(t.beginPath(),t.moveTo(n[a],r[a]))}t.closePath(),t.fill()}if(this.visuals.line.doit){this.visuals.line.set_value(t);for(var l=0,h=e;l<h.length;l++){var a=h[l];0!=a?isNaN(n[a]+r[a])?(t.closePath(),t.stroke(),t.beginPath()):t.lineTo(n[a],r[a]):(t.beginPath(),t.moveTo(n[a],r[a]))}return t.closePath(),t.stroke()}},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_area_legend(this.visuals,t,e,i)},e}(r.XYGlyphView);i.PatchView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Patch\",this.prototype.default_view=s,this.mixins([\"line\",\"fill\"])},t}(r.XYGlyph);(i.Patch=a).initClass()},function(t,e,i){var n=t(387),h=t(37),r=t(119),o=t(138),c=t(21),s=t(22),l=t(44),f=t(9),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._build_discontinuous_object=function(t){for(var e=[],i=0,n=t.length;i<n;i++){e[i]=[];for(var r=c.copy(t[i]);0<r.length;){var o=c.findLastIndex(r,function(t){return l.isStrictNaN(t)}),s=void 0;0<=o?s=r.splice(o):(s=r,r=[]);var a=s.filter(function(t){return!l.isStrictNaN(t)});e[i].push(a)}}return e},e.prototype._index_data=function(){for(var t=this._build_discontinuous_object(this._xs),e=this._build_discontinuous_object(this._ys),i=[],n=0,r=this._xs.length;n<r;n++)for(var o=0,s=t[n].length;o<s;o++){var a=t[n][o],l=e[n][o];0!=a.length&&i.push({minX:c.min(a),minY:c.min(l),maxX:c.max(a),maxY:c.max(l),i:n})}return new h.SpatialIndex(i)},e.prototype._mask_data=function(){var t=this.renderer.plot_view.frame.x_ranges.default,e=[t.min,t.max],i=e[0],n=e[1],r=this.renderer.plot_view.frame.y_ranges.default,o=[r.min,r.max],s=o[0],a=o[1],l=f.validate_bbox_coords([i,n],[s,a]),h=this.index.indices(l);return h.sort(function(t,e){return t-e})},e.prototype._render=function(t,e,i){var n=i.sxs,r=i.sys;this.sxss=this._build_discontinuous_object(n),this.syss=this._build_discontinuous_object(r);for(var o=0,s=e;o<s.length;o++){var a=s[o],l=[n[a],r[a]],h=l[0],c=l[1];if(this.visuals.fill.doit){this.visuals.fill.set_vectorize(t,a);for(var u=0,_=h.length;u<_;u++)0!=u?isNaN(h[u]+c[u])?(t.closePath(),t.fill(),t.beginPath()):t.lineTo(h[u],c[u]):(t.beginPath(),t.moveTo(h[u],c[u]));t.closePath(),t.fill()}if(this.visuals.line.doit){this.visuals.line.set_vectorize(t,a);for(var u=0,_=h.length;u<_;u++)0!=u?isNaN(h[u]+c[u])?(t.closePath(),t.stroke(),t.beginPath()):t.lineTo(h[u],c[u]):(t.beginPath(),t.moveTo(h[u],c[u]));t.closePath(),t.stroke()}}},e.prototype._hit_point=function(t){for(var e=t.sx,i=t.sy,n=this.renderer.xscale.invert(e),r=this.renderer.yscale.invert(i),o=this.index.indices({minX:n,minY:r,maxX:n,maxY:r}),s=[],a=0,l=o.length;a<l;a++)for(var h=o[a],c=this.sxss[h],u=this.syss[h],_=0,p=c.length;_<p;_++)f.point_in_poly(e,i,c[_],u[_])&&s.push(h);var d=f.create_empty_hit_test_result();return d.indices=s,d},e.prototype._get_snap_coord=function(t){return s.sum(t)/t.length},e.prototype.scenterx=function(t,e,i){if(1==this.sxss[t].length)return this._get_snap_coord(this.sxs[t]);for(var n=this.sxss[t],r=this.syss[t],o=0,s=n.length;o<s;o++)if(f.point_in_poly(e,i,n[o],r[o]))return this._get_snap_coord(n[o]);throw new Error(\"unreachable code\")},e.prototype.scentery=function(t,e,i){if(1==this.syss[t].length)return this._get_snap_coord(this.sys[t]);for(var n=this.sxss[t],r=this.syss[t],o=0,s=n.length;o<s;o++)if(f.point_in_poly(e,i,n[o],r[o]))return this._get_snap_coord(r[o]);throw new Error(\"unreachable code\")},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_area_legend(this.visuals,t,e,i)},e}(r.GlyphView);i.PatchesView=a;var u=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Patches\",this.prototype.default_view=a,this.coords([[\"xs\",\"ys\"]]),this.mixins([\"line\",\"fill\"])},t}(r.Glyph);(i.Patches=u).initClass()},function(t,e,i){var n=t(387),r=t(116),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.get_anchor_point=function(t,e,i){var n=Math.min(this.sleft[e],this.sright[e]),r=Math.max(this.sright[e],this.sleft[e]),o=Math.min(this.stop[e],this.sbottom[e]),s=Math.max(this.sbottom[e],this.stop[e]);switch(t){case\"top_left\":return{x:n,y:o};case\"top_center\":return{x:(n+r)/2,y:o};case\"top_right\":return{x:r,y:o};case\"center_right\":return{x:r,y:(o+s)/2};case\"bottom_right\":return{x:r,y:s};case\"bottom_center\":return{x:(n+r)/2,y:s};case\"bottom_left\":return{x:n,y:s};case\"center_left\":return{x:n,y:(o+s)/2};case\"center\":return{x:(n+r)/2,y:(o+s)/2};default:return null}},e.prototype.scenterx=function(t){return(this.sleft[t]+this.sright[t])/2},e.prototype.scentery=function(t){return(this.stop[t]+this.sbottom[t])/2},e.prototype._index_data=function(){return this._index_box(this._right.length)},e.prototype._lrtb=function(t){var e=this._left[t],i=this._right[t],n=this._top[t],r=this._bottom[t];return[e,i,n,r]},e}(r.BoxView);i.QuadView=o;var s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Quad\",this.prototype.default_view=o,this.coords([[\"right\",\"bottom\"],[\"left\",\"top\"]])},t}(r.Box);(i.Quad=s).initClass()},function(t,e,i){var n=t(387),h=t(37),r=t(119),o=t(138);function c(t,e,i){if(e==(t+i)/2)return[t,i];var n=(t-e)/(t-2*e+i),r=t*Math.pow(1-n,2)+2*e*(1-n)*n+i*Math.pow(n,2);return[Math.min(t,i,r),Math.max(t,i,r)]}var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._index_data=function(){for(var t=[],e=0,i=this._x0.length;e<i;e++)if(!isNaN(this._x0[e]+this._x1[e]+this._y0[e]+this._y1[e]+this._cx[e]+this._cy[e])){var n=c(this._x0[e],this._cx[e],this._x1[e]),r=n[0],o=n[1],s=c(this._y0[e],this._cy[e],this._y1[e]),a=s[0],l=s[1];t.push({minX:r,minY:a,maxX:o,maxY:l,i:e})}return new h.SpatialIndex(t)},e.prototype._render=function(t,e,i){var n=i.sx0,r=i.sy0,o=i.sx1,s=i.sy1,a=i.scx,l=i.scy;if(this.visuals.line.doit)for(var h=0,c=e;h<c.length;h++){var u=c[h];isNaN(n[u]+r[u]+o[u]+s[u]+a[u]+l[u])||(t.beginPath(),t.moveTo(n[u],r[u]),t.quadraticCurveTo(a[u],l[u],o[u],s[u]),this.visuals.line.set_vectorize(t,u),t.stroke())}},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e.prototype.scenterx=function(){throw new Error(\"not implemented\")},e.prototype.scentery=function(){throw new Error(\"not implemented\")},e}(r.GlyphView);i.QuadraticView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Quadratic\",this.prototype.default_view=s,this.coords([[\"x0\",\"y0\"],[\"x1\",\"y1\"],[\"cx\",\"cy\"]]),this.mixins([\"line\"])},t}(r.Glyph);(i.Quadratic=a).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._map_data=function(){\"data\"==this.model.properties.length.units?this.slength=this.sdist(this.renderer.xscale,this._x,this._length):this.slength=this._length},e.prototype._render=function(t,e,i){var n=i.sx,r=i.sy,o=i.slength,s=i._angle;if(this.visuals.line.doit){for(var a=this.renderer.plot_view.frame._width.value,l=this.renderer.plot_view.frame._height.value,h=2*(a+l),c=0,u=o.length;c<u;c++)0==o[c]&&(o[c]=h);for(var _=0,p=e;_<p.length;_++){var c=p[_];isNaN(n[c]+r[c]+s[c]+o[c])||(t.translate(n[c],r[c]),t.rotate(s[c]),t.beginPath(),t.moveTo(0,0),t.lineTo(o[c],0),this.visuals.line.set_vectorize(t,c),t.stroke(),t.rotate(-s[c]),t.translate(-n[c],-r[c]))}}},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e}(r.XYGlyphView);i.RayView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Ray\",this.prototype.default_view=a,this.mixins([\"line\"]),this.define({length:[s.DistanceSpec],angle:[s.AngleSpec]})},t}(r.XYGlyph);(i.Ray=l).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),C=t(9),s=t(15),A=t(22),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._set_data=function(){this.max_w2=0,\"data\"==this.model.properties.width.units&&(this.max_w2=this.max_width/2),this.max_h2=0,\"data\"==this.model.properties.height.units&&(this.max_h2=this.max_height/2)},e.prototype._map_data=function(){var t,e;if(\"data\"==this.model.properties.width.units)t=this._map_dist_corner_for_data_side_length(this._x,this._width,this.renderer.xscale),this.sw=t[0],this.sx0=t[1];else{this.sw=this._width;var i=this.sx.length;this.sx0=new Float64Array(i);for(var n=0;n<i;n++)this.sx0[n]=this.sx[n]-this.sw[n]/2}if(\"data\"==this.model.properties.height.units)e=this._map_dist_corner_for_data_side_length(this._y,this._height,this.renderer.yscale),this.sh=e[0],this.sy1=e[1];else{this.sh=this._height;var r=this.sy.length;this.sy1=new Float64Array(r);for(var n=0;n<r;n++)this.sy1[n]=this.sy[n]-this.sh[n]/2}var o=this.sw.length;this.ssemi_diag=new Float64Array(o);for(var n=0;n<o;n++)this.ssemi_diag[n]=Math.sqrt(this.sw[n]/2*this.sw[n]/2+this.sh[n]/2*this.sh[n]/2)},e.prototype._render=function(t,e,i){var n=i.sx,r=i.sy,o=i.sx0,s=i.sy1,a=i.sw,l=i.sh,h=i._angle;if(this.visuals.fill.doit)for(var c=0,u=e;c<u.length;c++){var _=u[c];isNaN(n[_]+r[_]+o[_]+s[_]+a[_]+l[_]+h[_])||(this.visuals.fill.set_vectorize(t,_),h[_]?(t.translate(n[_],r[_]),t.rotate(h[_]),t.fillRect(-a[_]/2,-l[_]/2,a[_],l[_]),t.rotate(-h[_]),t.translate(-n[_],-r[_])):t.fillRect(o[_],s[_],a[_],l[_]))}if(this.visuals.line.doit){t.beginPath();for(var p=0,d=e;p<d.length;p++){var _=d[p];isNaN(n[_]+r[_]+o[_]+s[_]+a[_]+l[_]+h[_])||0!=a[_]&&0!=l[_]&&(h[_]?(t.translate(n[_],r[_]),t.rotate(h[_]),t.rect(-a[_]/2,-l[_]/2,a[_],l[_]),t.rotate(-h[_]),t.translate(-n[_],-r[_])):t.rect(o[_],s[_],a[_],l[_]),this.visuals.line.set_vectorize(t,_),t.stroke(),t.beginPath())}t.stroke()}},e.prototype._hit_rect=function(t){return this._hit_rect_against_index(t)},e.prototype._hit_point=function(t){for(var e=t.sx,i=t.sy,n=this.renderer.xscale.invert(e),r=this.renderer.yscale.invert(i),o=[],s=0,a=this.sx0.length;s<a;s++)o.push(this.sx0[s]+this.sw[s]/2);for(var l=[],s=0,a=this.sy1.length;s<a;s++)l.push(this.sy1[s]+this.sh[s]/2);for(var h=A.max(this._ddist(0,o,this.ssemi_diag)),c=A.max(this._ddist(1,l,this.ssemi_diag)),u=n-h,_=n+h,p=r-c,d=r+c,f=[],v=C.validate_bbox_coords([u,_],[p,d]),m=0,g=this.index.indices(v);m<g.length;m++){var s=g[m],y=void 0,b=void 0;if(this._angle[s]){var x=Math.sin(-this._angle[s]),w=Math.cos(-this._angle[s]),k=w*(e-this.sx[s])-x*(i-this.sy[s])+this.sx[s],S=x*(e-this.sx[s])+w*(i-this.sy[s])+this.sy[s];e=k,i=S,b=Math.abs(this.sx[s]-e)<=this.sw[s]/2,y=Math.abs(this.sy[s]-i)<=this.sh[s]/2}else b=e-this.sx0[s]<=this.sw[s]&&0<=e-this.sx0[s],y=i-this.sy1[s]<=this.sh[s]&&0<=i-this.sy1[s];y&&b&&f.push(s)}var T=C.create_empty_hit_test_result();return T.indices=f,T},e.prototype._map_dist_corner_for_data_side_length=function(t,e,i){for(var n=t.length,r=new Float64Array(n),o=new Float64Array(n),s=0;s<n;s++)r[s]=Number(t[s])-e[s]/2,o[s]=Number(t[s])+e[s]/2;for(var a=i.v_compute(r),l=i.v_compute(o),h=this.sdist(i,r,e,\"edge\",this.model.dilate),c=a,s=0,u=a.length;s<u;s++)if(a[s]!=l[s]){c=a[s]<l[s]?a:l;break}return[h,c]},e.prototype._ddist=function(t,e,i){for(var n=0==t?this.renderer.xscale:this.renderer.yscale,r=e,o=r.length,s=new Float64Array(o),a=0;a<o;a++)s[a]=r[a]+i[a];for(var l=n.v_invert(r),h=n.v_invert(s),c=l.length,u=new Float64Array(c),a=0;a<c;a++)u[a]=Math.abs(h[a]-l[a]);return u},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_area_legend(this.visuals,t,e,i)},e.prototype._bounds=function(t){var e=t.minX,i=t.maxX,n=t.minY,r=t.maxY;return{minX:e-this.max_w2,maxX:i+this.max_w2,minY:n-this.max_h2,maxY:r+this.max_h2}},e}(r.XYGlyphView);i.RectView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Rect\",this.prototype.default_view=a,this.mixins([\"line\",\"fill\"]),this.define({angle:[s.AngleSpec,0],width:[s.DistanceSpec],height:[s.DistanceSpec],dilate:[s.Bool,!1]})},t}(r.XYGlyph);(i.Rect=l).initClass()},function(t,e,i){var n=t(387),k=t(9),a=t(37),r=t(119),o=t(138),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._index_data=function(){for(var t=[],e=0,i=this._x0.length;e<i;e++){var n=this._x0[e],r=this._x1[e],o=this._y0[e],s=this._y1[e];isNaN(n+r+o+s)||t.push({minX:Math.min(n,r),minY:Math.min(o,s),maxX:Math.max(n,r),maxY:Math.max(o,s),i:e})}return new a.SpatialIndex(t)},e.prototype._render=function(t,e,i){var n=i.sx0,r=i.sy0,o=i.sx1,s=i.sy1;if(this.visuals.line.doit)for(var a=0,l=e;a<l.length;a++){var h=l[a];isNaN(n[h]+r[h]+o[h]+s[h])||(t.beginPath(),t.moveTo(n[h],r[h]),t.lineTo(o[h],s[h]),this.visuals.line.set_vectorize(t,h),t.stroke())}},e.prototype._hit_point=function(t){for(var e=t.sx,i=t.sy,n={x:e,y:i},r=[],o=this.renderer.xscale.r_invert(e-2,e+2),s=o[0],a=o[1],l=this.renderer.yscale.r_invert(i-2,i+2),h=l[0],c=l[1],u=this.index.indices({minX:s,minY:h,maxX:a,maxY:c}),_=0,p=u;_<p.length;_++){var d=p[_],f=Math.pow(Math.max(2,this.visuals.line.cache_select(\"line_width\",d)/2),2),v={x:this.sx0[d],y:this.sy0[d]},m={x:this.sx1[d],y:this.sy1[d]},g=k.dist_to_segment_squared(n,v,m);g<f&&r.push(d)}var y=k.create_empty_hit_test_result();return y.indices=r,y},e.prototype._hit_span=function(t){var e,i,n,r,o,s=this.renderer.plot_view.frame.bbox.ranges,a=s[0],l=s[1],h=t.sx,c=t.sy;\"v\"==t.direction?(o=this.renderer.yscale.invert(c),e=[this._y0,this._y1],n=e[0],r=e[1]):(o=this.renderer.xscale.invert(h),i=[this._x0,this._x1],n=i[0],r=i[1]);for(var u=[],_=this.renderer.xscale.r_invert(a.start,a.end),p=_[0],d=_[1],f=this.renderer.yscale.r_invert(l.start,l.end),v=f[0],m=f[1],g=this.index.indices({minX:p,minY:v,maxX:d,maxY:m}),y=0,b=g;y<b.length;y++){var x=b[y];(n[x]<=o&&o<=r[x]||r[x]<=o&&o<=n[x])&&u.push(x)}var w=k.create_empty_hit_test_result();return w.indices=u,w},e.prototype.scenterx=function(t){return(this.sx0[t]+this.sx1[t])/2},e.prototype.scentery=function(t){return(this.sy0[t]+this.sy1[t])/2},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e}(r.GlyphView);i.SegmentView=s;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Segment\",this.prototype.default_view=s,this.coords([[\"x0\",\"y0\"],[\"x1\",\"y1\"]]),this.mixins([\"line\"])},t}(r.Glyph);(i.Segment=l).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._render=function(t,e,i){var n,r,o,s,a,l,h=i.sx,c=i.sy;this.visuals.line.set_value(t);var u=e.length;if(!(u<2)){t.beginPath(),t.moveTo(h[0],c[0]);for(var _=1;_<u;_++){var p=void 0,d=void 0,f=void 0,v=void 0;switch(this.model.mode){case\"before\":n=[h[_-1],c[_]],p=n[0],f=n[1],r=[h[_],c[_]],d=r[0],v=r[1];break;case\"after\":o=[h[_],c[_-1]],p=o[0],f=o[1],s=[h[_],c[_]],d=s[0],v=s[1];break;case\"center\":var m=(h[_-1]+h[_])/2;a=[m,c[_-1]],p=a[0],f=a[1],l=[m,c[_]],d=l[0],v=l[1];break;default:throw new Error(\"unexpected\")}t.lineTo(p,f),t.lineTo(d,v)}t.lineTo(h[u-1],c[u-1]),t.stroke()}},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_line_legend(this.visuals,t,e,i)},e}(r.XYGlyphView);i.StepView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Step\",this.prototype.default_view=a,this.mixins([\"line\"]),this.define({mode:[s.StepMode,\"before\"]})},t}(r.XYGlyph);(i.Step=l).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(15),k=t(41),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i._x_offset,s=i._y_offset,a=i._angle,l=i._text,h=0,c=e;h<c.length;h++){var u=c[h];if(!isNaN(n[u]+r[u]+o[u]+s[u]+a[u])&&null!=l[u]&&this.visuals.text.doit){var _=\"\"+l[u];if(t.save(),t.translate(n[u]+o[u],r[u]+s[u]),t.rotate(a[u]),this.visuals.text.set_vectorize(t,u),-1==_.indexOf(\"\\n\"))t.fillText(_,0,0);else{var p=_.split(\"\\n\"),d=this.visuals.text.cache_select(\"font\",u),f=k.get_text_height(d).height,v=this.visuals.text.text_line_height.value()*f,m=v*p.length,g=this.visuals.text.cache_select(\"text_baseline\",u),y=void 0;switch(g){case\"top\":y=0;break;case\"middle\":y=-m/2+v/2;break;case\"bottom\":y=-m+v;break;default:y=0,console.warn(\"'\"+g+\"' baseline not supported with multi line text\")}for(var b=0,x=p;b<x.length;b++){var w=x[b];t.fillText(w,0,y),y+=v}}t.restore()}}},e}(r.XYGlyphView);i.TextView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Text\",this.prototype.default_view=s,this.mixins([\"text\"]),this.define({text:[o.StringSpec,{field:\"text\"}],angle:[o.AngleSpec,0],x_offset:[o.NumberSpec,0],y_offset:[o.NumberSpec,0]})},t}(r.XYGlyph);(i.Text=a).initClass()},function(t,e,i){i.generic_line_legend=function(t,e,i,n){var r=i.x0,o=i.x1,s=i.y0,a=i.y1;e.save(),e.beginPath(),e.moveTo(r,(s+a)/2),e.lineTo(o,(s+a)/2),t.line.doit&&(t.line.set_vectorize(e,n),e.stroke()),e.restore()},i.generic_area_legend=function(t,e,i,n){var r=i.x0,o=i.x1,s=i.y0,a=i.y1,l=.1*Math.abs(o-r),h=.1*Math.abs(a-s),c=r+l,u=o-l,_=s+h,p=a-h;t.fill.doit&&(t.fill.set_vectorize(e,n),e.fillRect(c,_,u-c,p-_)),t.line.doit&&(e.beginPath(),e.rect(c,_,u-c,p-_),t.line.set_vectorize(e,n),e.stroke())}},function(t,e,i){var n=t(387),r=t(116),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.scenterx=function(t){return this.sx[t]},e.prototype.scentery=function(t){return(this.stop[t]+this.sbottom[t])/2},e.prototype._index_data=function(){return this._index_box(this._x.length)},e.prototype._lrtb=function(t){var e=this._x[t]-this._width[t]/2,i=this._x[t]+this._width[t]/2,n=Math.max(this._top[t],this._bottom[t]),r=Math.min(this._top[t],this._bottom[t]);return[e,i,n,r]},e.prototype._map_data=function(){this.sx=this.renderer.xscale.v_compute(this._x),this.sw=this.sdist(this.renderer.xscale,this._x,this._width,\"center\"),this.stop=this.renderer.yscale.v_compute(this._top),this.sbottom=this.renderer.yscale.v_compute(this._bottom);var t=this.sx.length;this.sleft=new Float64Array(t),this.sright=new Float64Array(t);for(var e=0;e<t;e++)this.sleft[e]=this.sx[e]-this.sw[e]/2,this.sright[e]=this.sx[e]+this.sw[e]/2},e}(r.BoxView);i.VBarView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"VBar\",this.prototype.default_view=s,this.coords([[\"x\",\"bottom\"]]),this.define({width:[o.DistanceSpec],top:[o.NumberSpec]}),this.override({bottom:0})},t}(r.Box);(i.VBar=a).initClass()},function(t,e,i){var n=t(387),r=t(141),o=t(138),P=t(9),s=t(15),j=t(31),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._map_data=function(){\"data\"==this.model.properties.radius.units?this.sradius=this.sdist(this.renderer.xscale,this._x,this._radius):this.sradius=this._radius},e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i.sradius,s=i._start_angle,a=i._end_angle,l=this.model.properties.direction.value(),h=0,c=e;h<c.length;h++){var u=c[h];isNaN(n[u]+r[u]+o[u]+s[u]+a[u])||(t.beginPath(),t.arc(n[u],r[u],o[u],s[u],a[u],l),t.lineTo(n[u],r[u]),t.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,u),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,u),t.stroke()))}},e.prototype._hit_point=function(t){var e,i,n,r,o,s,a,l,h,c,u,_,p,d=t.sx,f=t.sy,v=this.renderer.xscale.invert(d),m=this.renderer.yscale.invert(f),g=2*this.max_radius;\"data\"===this.model.properties.radius.units?(c=v-g,u=v+g,_=m-g,p=m+g):(s=d-g,a=d+g,e=this.renderer.xscale.r_invert(s,a),c=e[0],u=e[1],l=f-g,h=f+g,i=this.renderer.yscale.r_invert(l,h),_=i[0],p=i[1]);for(var y=[],b=P.validate_bbox_coords([c,u],[_,p]),x=0,w=this.index.indices(b);x<w.length;x++){var k=w[x],S=Math.pow(this.sradius[k],2);n=this.renderer.xscale.r_compute(v,this._x[k]),s=n[0],a=n[1],r=this.renderer.yscale.r_compute(m,this._y[k]),l=r[0],h=r[1],(o=Math.pow(s-a,2)+Math.pow(l-h,2))<=S&&y.push([k,o])}for(var T=this.model.properties.direction.value(),C=[],A=0,E=y;A<E.length;A++){var M=E[A],k=M[0],O=M[1],z=Math.atan2(f-this.sy[k],d-this.sx[k]);j.angle_between(-z,-this._start_angle[k],-this._end_angle[k],T)&&C.push([k,O])}return P.create_hit_test_result_from_hits(C)},e.prototype.draw_legend_for_index=function(t,e,i){o.generic_area_legend(this.visuals,t,e,i)},e.prototype._scenterxy=function(t){var e=this.sradius[t]/2,i=(this._start_angle[t]+this._end_angle[t])/2;return{x:this.sx[t]+e*Math.cos(i),y:this.sy[t]+e*Math.sin(i)}},e.prototype.scenterx=function(t){return this._scenterxy(t).x},e.prototype.scentery=function(t){return this._scenterxy(t).y},e}(r.XYGlyphView);i.WedgeView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Wedge\",this.prototype.default_view=a,this.mixins([\"line\",\"fill\"]),this.define({direction:[s.Direction,\"anticlock\"],radius:[s.DistanceSpec],start_angle:[s.AngleSpec],end_angle:[s.AngleSpec]})},t}(r.XYGlyph);(i.Wedge=l).initClass()},function(t,e,i){var n=t(387),o=t(37),r=t(119),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._index_data=function(){for(var t=[],e=0,i=this._x.length;e<i;e++){var n=this._x[e],r=this._y[e];!isNaN(n+r)&&isFinite(n+r)&&t.push({minX:n,minY:r,maxX:n,maxY:r,i:e})}return new o.SpatialIndex(t)},e.prototype.scenterx=function(t){return this.sx[t]},e.prototype.scentery=function(t){return this.sy[t]},e}(r.GlyphView);i.XYGlyphView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"XYGlyph\",this.coords([[\"x\",\"y\"]])},t}(r.Glyph);(i.XYGlyph=a).initClass()},function(t,e,i){var n=t(387),r=t(57),c=t(22),u=t(21),_=t(9),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GraphHitTestPolicy\"},t.prototype._hit_test_nodes=function(t,e){if(!e.model.visible)return null;var i=e.node_view.glyph.hit_test(t);return null==i?null:e.node_view.model.view.convert_selection_from_subset(i)},t.prototype._hit_test_edges=function(t,e){if(!e.model.visible)return null;var i=e.edge_view.glyph.hit_test(t);return null==i?null:e.edge_view.model.view.convert_selection_from_subset(i)},t}(r.Model),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"NodesOnly\"},t.prototype.hit_test=function(t,e){return this._hit_test_nodes(t,e)},t.prototype.do_selection=function(t,e,i,n){if(null==t)return!1;var r=e.node_renderer.data_source.selected;return r.update(t,i,n),e.node_renderer.data_source._select.emit(),!r.is_empty()},t.prototype.do_inspection=function(t,e,i,n,r){if(null==t)return!1;var o=i.model.get_selection_manager().get_or_create_inspector(i.node_view.model);return o.update(t,n,r),i.node_view.model.data_source.setv({inspected:o},{silent:!0}),i.node_view.model.data_source.inspect.emit([i.node_view,{geometry:e}]),!o.is_empty()},t}(i.GraphHitTestPolicy=o);(i.NodesOnly=s).initClass();var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"NodesAndLinkedEdges\"},t.prototype.hit_test=function(t,e){return this._hit_test_nodes(t,e)},t.prototype.get_linked_edges=function(e,t,i){var n=[];\"selection\"==i?n=e.selected.indices.map(function(t){return e.data.index[t]}):\"inspection\"==i&&(n=e.inspected.indices.map(function(t){return e.data.index[t]}));for(var r=[],o=0;o<t.data.start.length;o++)(u.contains(n,t.data.start[o])||u.contains(n,t.data.end[o]))&&r.push(o);for(var s=_.create_empty_hit_test_result(),a=0,l=r;a<l.length;a++){var o=l[a];s.multiline_indices[o]=[0]}return s.indices=r,s},t.prototype.do_selection=function(t,e,i,n){if(null==t)return!1;var r=e.node_renderer.data_source.selected;r.update(t,i,n);var o=e.edge_renderer.data_source.selected,s=this.get_linked_edges(e.node_renderer.data_source,e.edge_renderer.data_source,\"selection\");return o.update(s,i,n),e.node_renderer.data_source._select.emit(),!r.is_empty()},t.prototype.do_inspection=function(t,e,i,n,r){if(null==t)return!1;var o=i.node_view.model.data_source.selection_manager.get_or_create_inspector(i.node_view.model);o.update(t,n,r),i.node_view.model.data_source.setv({inspected:o},{silent:!0});var s=i.edge_view.model.data_source.selection_manager.get_or_create_inspector(i.edge_view.model),a=this.get_linked_edges(i.node_view.model.data_source,i.edge_view.model.data_source,\"inspection\");return s.update(a,n,r),i.edge_view.model.data_source.setv({inspected:s},{silent:!0}),i.node_view.model.data_source.inspect.emit([i.node_view,{geometry:e}]),!o.is_empty()},t}(o);(i.NodesAndLinkedEdges=a).initClass();var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"EdgesAndLinkedNodes\"},t.prototype.hit_test=function(t,e){return this._hit_test_edges(t,e)},t.prototype.get_linked_nodes=function(e,t,i){var n=[];\"selection\"==i?n=t.selected.indices:\"inspection\"==i&&(n=t.inspected.indices);for(var r=[],o=0,s=n;o<s.length;o++){var a=s[o];r.push(t.data.start[a]),r.push(t.data.end[a])}var l=u.uniq(r).map(function(t){return c.indexOf(e.data.index,t)}),h=_.create_empty_hit_test_result();return h.indices=l,h},t.prototype.do_selection=function(t,e,i,n){if(null==t)return!1;var r=e.edge_renderer.data_source.selected;r.update(t,i,n);var o=e.node_renderer.data_source.selected,s=this.get_linked_nodes(e.node_renderer.data_source,e.edge_renderer.data_source,\"selection\");return o.update(s,i,n),e.edge_renderer.data_source._select.emit(),!r.is_empty()},t.prototype.do_inspection=function(t,e,i,n,r){if(null==t)return!1;var o=i.edge_view.model.data_source.selection_manager.get_or_create_inspector(i.edge_view.model);o.update(t,n,r),i.edge_view.model.data_source.setv({inspected:o},{silent:!0});var s=i.node_view.model.data_source.selection_manager.get_or_create_inspector(i.node_view.model),a=this.get_linked_nodes(i.node_view.model.data_source,i.edge_view.model.data_source,\"inspection\");return s.update(a,n,r),i.node_view.model.data_source.setv({inspected:s},{silent:!0}),i.edge_view.model.data_source.inspect.emit([i.edge_view,{geometry:e}]),!o.is_empty()},t}(o);(i.EdgesAndLinkedNodes=l).initClass()},function(t,e,i){var n=t(387);n.__exportStar(t(142),i),n.__exportStar(t(144),i),n.__exportStar(t(145),i)},function(t,e,i){var n=t(387),r=t(57),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LayoutProvider\"},t}(r.Model);(i.LayoutProvider=o).initClass()},function(t,e,i){var n=t(387),r=t(144),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"StaticLayoutProvider\",this.define({graph_layout:[o.Any,{}]})},t.prototype.get_node_coordinates=function(t){for(var e=[],i=[],n=t.data.index,r=0,o=n.length;r<o;r++){var s=this.graph_layout[n[r]],a=null!=s?s:[NaN,NaN],l=a[0],h=a[1];e.push(l),i.push(h)}return[e,i]},t.prototype.get_edge_coordinates=function(t){for(var e,i,n=[],r=[],o=t.data.start,s=t.data.end,a=null!=t.data.xs&&null!=t.data.ys,l=0,h=o.length;l<h;l++){var c=null!=this.graph_layout[o[l]]&&null!=this.graph_layout[s[l]];if(a&&c)n.push(t.data.xs[l]),r.push(t.data.ys[l]);else{var u=void 0,_=void 0;c?(e=[this.graph_layout[o[l]],this.graph_layout[s[l]]],_=e[0],u=e[1]):(_=(i=[[NaN,NaN],[NaN,NaN]])[0],u=i[1]),n.push([_[0],u[0]]),r.push([_[1],u[1]])}}return[n,r]},t}(r.LayoutProvider);(i.StaticLayoutProvider=s).initClass()},function(t,e,i){var n=t(387),h=t(77),r=t(177),o=t(15),c=t(44),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),Object.defineProperty(t.prototype,\"_x_range_name\",{get:function(){return this.model.x_range_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"_y_range_name\",{get:function(){return this.model.y_range_name},enumerable:!0,configurable:!0}),t.prototype.render=function(){if(this.model.visible){var t=this.plot_view.canvas_view.ctx;t.save(),this._draw_regions(t),this._draw_minor_grids(t),this._draw_grids(t),t.restore()}},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.request_render()})},t.prototype._draw_regions=function(t){if(this.visuals.band_fill.doit){var e=this.model.grid_coords(\"major\",!1),i=e[0],n=e[1];this.visuals.band_fill.set_value(t);for(var r=0;r<i.length-1;r++)if(r%2==1){var o=this.plot_view.map_to_screen(i[r],n[r],this._x_range_name,this._y_range_name),s=o[0],a=o[1],l=this.plot_view.map_to_screen(i[r+1],n[r+1],this._x_range_name,this._y_range_name),h=l[0],c=l[1];t.fillRect(s[0],a[0],h[1]-s[0],c[1]-a[0]),t.fill()}}},t.prototype._draw_grids=function(t){if(this.visuals.grid_line.doit){var e=this.model.grid_coords(\"major\"),i=e[0],n=e[1];this._draw_grid_helper(t,this.visuals.grid_line,i,n)}},t.prototype._draw_minor_grids=function(t){if(this.visuals.minor_grid_line.doit){var e=this.model.grid_coords(\"minor\"),i=e[0],n=e[1];this._draw_grid_helper(t,this.visuals.minor_grid_line,i,n)}},t.prototype._draw_grid_helper=function(t,e,i,n){e.set_value(t);for(var r=0;r<i.length;r++){var o=this.plot_view.map_to_screen(i[r],n[r],this._x_range_name,this._y_range_name),s=o[0],a=o[1];t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(a[0]));for(var l=1;l<s.length;l++)t.lineTo(Math.round(s[l]),Math.round(a[l]));t.stroke()}},t}(r.GuideRendererView);i.GridView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Grid\",this.prototype.default_view=s,this.mixins([\"line:grid_\",\"line:minor_grid_\",\"fill:band_\"]),this.define({bounds:[o.Any,\"auto\"],dimension:[o.Number,0],ticker:[o.Instance],x_range_name:[o.String,\"default\"],y_range_name:[o.String,\"default\"]}),this.override({level:\"underlay\",band_fill_color:null,band_fill_alpha:0,grid_line_color:\"#e5e5e5\",minor_grid_line_color:null})},t.prototype.ranges=function(){var t=this.dimension,e=(t+1)%2,i=this.plot.plot_canvas.frame,n=[i.x_ranges[this.x_range_name],i.y_ranges[this.y_range_name]];return[n[t],n[e]]},t.prototype.computed_bounds=function(){var t,e,i,n=this.ranges()[0],r=this.bounds,o=[n.min,n.max];if(c.isArray(r))e=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),e<o[0]&&(e=o[0]),o[1]<i&&(i=o[1]);else{e=o[0],i=o[1];for(var s=0,a=this.plot.select(h.Axis);s<a.length;s++){var l=a[s];l.dimension==this.dimension&&l.x_range_name==this.x_range_name&&l.y_range_name==this.y_range_name&&(t=l.computed_bounds,e=t[0],i=t[1])}}return[e,i]},t.prototype.grid_coords=function(t,e){var i;void 0===e&&(e=!0);var n=this.dimension,r=(n+1)%2,o=this.ranges(),s=o[0],a=o[1],l=this.computed_bounds(),h=l[0],c=l[1];i=[Math.min(h,c),Math.max(h,c)],h=i[0],c=i[1];var u=this.ticker.get_ticks(h,c,s,a.min,{})[t],_=s.min,p=s.max,d=a.min,f=a.max,v=[[],[]];e||(u[0]!=_&&u.splice(0,0,_),u[u.length-1]!=p&&u.push(p));for(var m=0;m<u.length;m++)if(u[m]!=_&&u[m]!=p||!e){for(var g=[],y=[],b=0;b<2;b++){var x=d+(f-d)/1*b;g.push(u[m]),y.push(x)}v[n].push(g),v[r].push(y)}return v},t}(r.GuideRenderer);(i.Grid=a).initClass()},function(t,e,i){var n=t(146);i.Grid=n.Grid},function(t,e,i){var n=t(387);n.__exportStar(t(64),i),n.__exportStar(t(81),i),n.__exportStar(t(87),i),n.__exportStar(t(91),i),n.__exportStar(t(94),i),n.__exportStar(t(100),i),n.__exportStar(t(106),i),n.__exportStar(t(125),i),n.__exportStar(t(143),i),n.__exportStar(t(147),i),n.__exportStar(t(151),i),n.__exportStar(t(159),i),n.__exportStar(t(261),i),n.__exportStar(t(162),i),n.__exportStar(t(166),i),n.__exportStar(t(172),i),n.__exportStar(t(178),i),n.__exportStar(t(181),i),n.__exportStar(t(185),i),n.__exportStar(t(194),i),n.__exportStar(t(204),i),n.__exportStar(t(214),i),n.__exportStar(t(247),i)},function(t,e,i){var n=t(387),p=t(13),r=t(15),s=t(21),o=t(152),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.children.change,function(){return t.rebuild_child_views()})},t.prototype.css_classes=function(){return e.prototype.css_classes.call(this).concat(\"bk-grid\")},t.prototype.get_height=function(){var t=this.model.get_layoutable_children(),e=t.map(function(t){return t._height.value});return this.model._horizontal?s.max(e):s.sum(e)},t.prototype.get_width=function(){var t=this.model.get_layoutable_children(),e=t.map(function(t){return t._width.value});return this.model._horizontal?s.sum(e):s.max(e)},t}(o.LayoutDOMView);i.BoxView=a;var l=function(_){function w(t){return _.call(this,t)||this}return n.__extends(w,_),w.initClass=function(){this.prototype.type=\"Box\",this.prototype.default_view=a,this.define({children:[r.Array,[]]}),this.internal({spacing:[r.Number,6]})},w.prototype.initialize=function(){_.prototype.initialize.call(this),this._child_equal_size_width=new p.Variable(this.toString()+\".child_equal_size_width\"),this._child_equal_size_height=new p.Variable(this.toString()+\".child_equal_size_height\"),this._box_equal_size_top=new p.Variable(this.toString()+\".box_equal_size_top\"),this._box_equal_size_bottom=new p.Variable(this.toString()+\".box_equal_size_bottom\"),this._box_equal_size_left=new p.Variable(this.toString()+\".box_equal_size_left\"),this._box_equal_size_right=new p.Variable(this.toString()+\".box_equal_size_right\"),this._box_cell_align_top=new p.Variable(this.toString()+\".box_cell_align_top\"),this._box_cell_align_bottom=new p.Variable(this.toString()+\".box_cell_align_bottom\"),this._box_cell_align_left=new p.Variable(this.toString()+\".box_cell_align_left\"),this._box_cell_align_right=new p.Variable(this.toString()+\".box_cell_align_right\")},w.prototype.get_layoutable_children=function(){return this.children},w.prototype.get_constrained_variables=function(){return n.__assign({},_.prototype.get_constrained_variables.call(this),{box_equal_size_top:this._box_equal_size_top,box_equal_size_bottom:this._box_equal_size_bottom,box_equal_size_left:this._box_equal_size_left,box_equal_size_right:this._box_equal_size_right,box_cell_align_top:this._box_cell_align_top,box_cell_align_bottom:this._box_cell_align_bottom,box_cell_align_left:this._box_cell_align_left,box_cell_align_right:this._box_cell_align_right})},w.prototype.get_constraints=function(){var i=_.prototype.get_constraints.call(this),t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i.push.apply(i,t)},e=this.get_layoutable_children();if(0==e.length)return i;for(var n=0,r=e;n<r.length;n++){var o=r[n],s=o.get_constrained_variables(),a=this._child_rect(s);this._horizontal?null!=s.height&&t(p.EQ(a.height,[-1,this._height])):null!=s.width&&t(p.EQ(a.width,[-1,this._width])),this._horizontal?null!=s.box_equal_size_left&&null!=s.box_equal_size_right&&null!=s.width&&t(p.EQ([-1,s.box_equal_size_left],[-1,s.box_equal_size_right],s.width,this._child_equal_size_width)):null!=s.box_equal_size_top&&null!=s.box_equal_size_bottom&&null!=s.height&&t(p.EQ([-1,s.box_equal_size_top],[-1,s.box_equal_size_bottom],s.height,this._child_equal_size_height))}var l=this._info(e[0].get_constrained_variables());t(p.EQ(l.span.start,0));for(var h=1;h<e.length;h++){var c=this._info(e[h].get_constrained_variables());l.span.size&&t(p.EQ(l.span.start,l.span.size,[-1,c.span.start])),t(p.WEAK_EQ(l.whitespace.after,c.whitespace.before,0-this.spacing)),t(p.GE(l.whitespace.after,c.whitespace.before,0-this.spacing)),l=c}var u=e[e.length-1].get_constrained_variables();return this._horizontal?null!=u.width&&t(p.EQ(l.span.start,l.span.size,[-1,this._width])):null!=u.height&&t(p.EQ(l.span.start,l.span.size,[-1,this._height])),i=i.concat(this._align_outer_edges_constraints(!0),this._align_outer_edges_constraints(!1),this._align_inner_cell_edges_constraints(),this._box_equal_size_bounds(!0),this._box_equal_size_bounds(!1),this._box_cell_align_bounds(!0),this._box_cell_align_bounds(!1),this._box_whitespace(!0),this._box_whitespace(!1))},w.prototype._child_rect=function(t){return{x:t.origin_x,y:t.origin_y,width:t.width,height:t.height}},w.prototype._span=function(t){return this._horizontal?{start:t.x,size:t.width}:{start:t.y,size:t.height}},w.prototype._info=function(t){var e;e=this._horizontal?{before:t.whitespace_left,after:t.whitespace_right}:{before:t.whitespace_top,after:t.whitespace_bottom};var i=this._span(this._child_rect(t));return{span:i,whitespace:e}},w.prototype._flatten_cell_edge_variables=function(t){var e;e=t?w._top_bottom_inner_cell_edge_variables:w._left_right_inner_cell_edge_variables;for(var i=t!=this._horizontal,n=this.get_layoutable_children(),r=n.length,o={},s=0,a=0,l=n;a<l.length;a++){var h=l[a],c=void 0;c=h instanceof w?h._flatten_cell_edge_variables(t):{};for(var u=h.get_constrained_variables(),_=0,p=e;_<p.length;_++){var d=p[_];d in u&&(c[d]=[u[d]])}for(var f in c){var v=c[f],m=void 0;if(i){var g=f.split(\" \"),y=g[0],b=1<g.length?g[1]:\"\",x=this._horizontal?\"row\":\"col\";m=y+\" \"+x+\"-\"+r+\"-\"+s+\"-\"+b}else m=f;o[m]=m in o?o[m].concat(v):v}s++}return o},w.prototype._align_inner_cell_edges_constraints=function(){var t=[];if(null!=this.document&&s.includes(this.document.roots(),this)){var e=this._flatten_cell_edge_variables(this._horizontal);for(var i in e){var n=e[i];if(1<n.length)for(var r=n[0],o=1;o<n.length;o++)t.push(p.EQ(n[o],[-1,r]))}}return t},w.prototype._find_edge_leaves=function(t){var e=this.get_layoutable_children(),i=[[],[]];if(0<e.length)if(this._horizontal==t){var n=e[0],r=e[e.length-1];n instanceof w?i[0]=i[0].concat(n._find_edge_leaves(t)[0]):i[0].push(n),r instanceof w?i[1]=i[1].concat(r._find_edge_leaves(t)[1]):i[1].push(r)}else for(var o=0,s=e;o<s.length;o++){var a=s[o];if(a instanceof w){var l=a._find_edge_leaves(t);i[0]=i[0].concat(l[0]),i[1]=i[1].concat(l[1])}else i[0].push(a),i[1].push(a)}return i},w.prototype._align_outer_edges_constraints=function(t){var e,i,n=this._find_edge_leaves(t),r=n[0],o=n[1];t?(e=\"on_edge_align_left\",i=\"on_edge_align_right\"):(e=\"on_edge_align_top\",i=\"on_edge_align_bottom\");var s=function(t,e){for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n],s=o.get_constrained_variables();e in s&&i.push(s[e])}return i},a=s(r,e),l=s(o,i),h=[],c=function(t){if(1<t.length)for(var e=t[0],i=1;i<t.length;i++){var n=t[i];h.push(p.EQ([-1,e],n))}};return c(a),c(l),h},w.prototype._box_insets_from_child_insets=function(t,e,i,a){var n,r,o,s,l=this._find_edge_leaves(t),h=l[0],c=l[1];t?(n=e+\"_left\",r=e+\"_right\",o=this[i+\"_left\"],s=this[i+\"_right\"]):(n=e+\"_top\",r=e+\"_bottom\",o=this[i+\"_top\"],s=this[i+\"_bottom\"]);var u=[],_=function(t,e,i){for(var n=0,r=e;n<r.length;n++){var o=r[n],s=o.get_constrained_variables();i in s&&(a?u.push(p.GE([-1,t],s[i])):u.push(p.EQ([-1,t],s[i])))}};return _(o,h,n),_(s,c,r),u},w.prototype._box_equal_size_bounds=function(t){return this._box_insets_from_child_insets(t,\"box_equal_size\",\"_box_equal_size\",!1)},w.prototype._box_cell_align_bounds=function(t){return this._box_insets_from_child_insets(t,\"box_cell_align\",\"_box_cell_align\",!1)},w.prototype._box_whitespace=function(t){return this._box_insets_from_child_insets(t,\"whitespace\",\"_whitespace\",!0)},w._left_right_inner_cell_edge_variables=[\"box_cell_align_left\",\"box_cell_align_right\"],w._top_bottom_inner_cell_edge_variables=[\"box_cell_align_top\",\"box_cell_align_bottom\"],w}(o.LayoutDOM);(i.Box=l).initClass()},function(t,e,i){var n=t(387),r=t(149),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-grid-column\")},e}(r.BoxView);i.ColumnView=o;var s=function(i){function t(t){var e=i.call(this,t)||this;return e._horizontal=!1,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"Column\",this.prototype.default_view=o},t}(r.Box);(i.Column=s).initClass()},function(t,e,i){var n=t(149);i.Box=n.Box;var r=t(150);i.Column=r.Column;var o=t(152);i.LayoutDOM=o.LayoutDOM;var s=t(153);i.Row=s.Row;var a=t(154);i.Spacer=a.Spacer;var l=t(155);i.WidgetBox=l.WidgetBox},function(t,e,i){var n=t(387),r=t(57),g=t(5),o=t(15),s=t(11),h=t(13),a=t(4),l=t(6),c=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t._solver_inited=!1,t._idle_notified=!1,t}return n.__extends(t,i),t.prototype.initialize=function(t){i.prototype.initialize.call(this,t),this.is_root&&(this._solver=new h.Solver),this.child_views={},this.build_child_views()},t.prototype.remove=function(){for(var t in this.child_views){var e=this.child_views[t];e.remove()}this.child_views={},i.prototype.remove.call(this)},t.prototype.has_finished=function(){if(!i.prototype.has_finished.call(this))return!1;for(var t in this.child_views){var e=this.child_views[t];if(!e.has_finished())return!1}return!0},t.prototype.notify_finished=function(){this.is_root?!this._idle_notified&&this.has_finished()&&null!=this.model.document&&(this._idle_notified=!0,this.model.document.notify_idle(this.model)):i.prototype.notify_finished.call(this)},t.prototype._calc_width_height=function(){for(var t=this.el;t=t.parentElement;)if(!t.classList.contains(\"bk-root\")){if(t==document.body){var e=g.margin(document.body),i=e.left,n=e.right,r=e.top,o=e.bottom,s=document.documentElement.clientWidth-i-n,a=document.documentElement.clientHeight-r-o;return[s,a]}var l=g.padding(t),h=l.left,c=l.right,u=l.top,_=l.bottom,p=t.getBoundingClientRect(),d=p.width,f=p.height,v=d-h-c,m=f-u-_;switch(this.model.sizing_mode){case\"scale_width\":if(0<v)return[v,0<m?m:null];break;case\"scale_height\":if(0<m)return[0<v?v:null,m];break;case\"scale_both\":case\"stretch_both\":if(0<v||0<m)return[0<v?v:null,0<m?m:null];break;default:throw new Error(\"unreachable\")}}return[null,null]},t.prototype._init_solver=function(){this._root_width=new h.Variable(this.toString()+\".root_width\"),this._root_height=new h.Variable(this.toString()+\".root_height\"),this._solver.add_edit_variable(this._root_width,NaN),this._solver.add_edit_variable(this._root_height,NaN);for(var t=this.model.get_all_editables(),e=0,i=t;e<i.length;e++){var n=i[e];this._solver.add_edit_variable(n,h.Strength.strong)}for(var r=this.model.get_all_constraints(),o=0,s=r;o<s.length;o++){var a=s[o];this._solver.add_constraint(a)}var l=this.model.get_constrained_variables();null!=l.width&&this._solver.add_constraint(h.EQ(l.width,this._root_width)),null!=l.height&&this._solver.add_constraint(h.EQ(l.height,this._root_height)),this._solver.update_variables(),this._solver_inited=!0},t.prototype._suggest_dims=function(t,e){var i,n=this.model.get_constrained_variables();null==n.width&&null==n.height||(null!=t&&null!=e||(i=this._calc_width_height(),t=i[0],e=i[1]),null!=n.width&&null!=t&&this._solver.suggest_value(this._root_width,t),null!=n.height&&null!=e&&this._solver.suggest_value(this._root_height,e),this._solver.update_variables())},t.prototype.resize=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.is_root?this._do_layout(!1,t,e):this.root.resize(t,e)},t.prototype.partial_layout=function(){this.is_root?this._do_layout(!1):this.root.partial_layout()},t.prototype.layout=function(){this.is_root?this._do_layout(!0):this.root.layout()},t.prototype._do_layout=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this._solver_inited&&!t||(this._solver.clear(),this._init_solver()),this._suggest_dims(e,i),this._layout(),this._layout(),this._layout(!0),this.notify_finished()},t.prototype._layout=function(t){void 0===t&&(t=!1);for(var e=0,i=this.model.get_layoutable_children();e<i.length;e++){var n=i[e],r=this.child_views[n.id];null!=r._layout&&r._layout(t)}this.render(),t&&(this._has_finished=!0)},t.prototype.rebuild_child_views=function(){this.solver.clear(),this.build_child_views(),this.layout()},t.prototype.build_child_views=function(){var t=this.model.get_layoutable_children();a.build_views(this.child_views,t,{parent:this}),g.empty(this.el);for(var e=0,i=t;e<i.length;e++){var n=i[e],r=this.child_views[n.id];this.el.appendChild(r.el)}},t.prototype.connect_signals=function(){var t=this;i.prototype.connect_signals.call(this),this.is_root&&window.addEventListener(\"resize\",function(){return t.resize()}),this.connect(this.model.properties.sizing_mode.change,function(){return t.layout()})},t.prototype._render_classes=function(){this.el.className=\"\";for(var t=0,e=this.css_classes();t<e.length;t++){var i=e[t];this.el.classList.add(i)}this.el.classList.add(\"bk-layout-\"+this.model.sizing_mode);for(var n=0,r=this.model.css_classes;n<r.length;n++){var o=r[n];this.el.classList.add(o)}},t.prototype.render=function(){switch(this._render_classes(),this.model.sizing_mode){case\"fixed\":var t=void 0;t=null!=this.model.width?this.model.width:this.get_width(),this.model.setv({width:t},{silent:!0});var e=void 0;e=null!=this.model.height?this.model.height:this.get_height(),this.model.setv({height:e},{silent:!0}),this.solver.suggest_value(this.model._width,t),this.solver.suggest_value(this.model._height,e);break;case\"scale_width\":var e=this.get_height();this.solver.suggest_value(this.model._height,e);break;case\"scale_height\":var t=this.get_width();this.solver.suggest_value(this.model._width,t);break;case\"scale_both\":var i=this.get_width_height(),t=i[0],e=i[1];this.solver.suggest_value(this.model._width,t),this.solver.suggest_value(this.model._height,e)}this.solver.update_variables(),this.position()},t.prototype.position=function(){switch(this.model.sizing_mode){case\"fixed\":case\"scale_width\":case\"scale_height\":this.el.style.position=\"relative\",this.el.style.left=\"\",this.el.style.top=\"\";break;case\"scale_both\":case\"stretch_both\":this.el.style.position=\"absolute\",this.el.style.left=this.model._dom_left.value+\"px\",this.el.style.top=this.model._dom_top.value+\"px\"}this.el.style.width=this.model._width.value+\"px\",this.el.style.height=this.model._height.value+\"px\"},t.prototype.get_width_height=function(){var t=this._calc_width_height(),e=t[0],i=t[1];if(null==e&&null==i)throw new Error(\"detached element\");var n=this.model.get_aspect_ratio();if(null!=e&&null==i)return[e,e/n];if(null==e&&null!=i)return[i*n,i];var r,o,s=e,a=e/n,l=i*n,h=i;return s<l?(r=s,o=a):(r=l,o=h),[r,o]},t}(l.DOMView);i.LayoutDOMView=c;var u=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LayoutDOM\",this.define({height:[o.Number],width:[o.Number],disabled:[o.Bool,!1],sizing_mode:[o.SizingMode,\"fixed\"],css_classes:[o.Array,[]]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._width=new h.Variable(this.toString()+\".width\"),this._height=new h.Variable(this.toString()+\".height\"),this._left=new h.Variable(this.toString()+\".left\"),this._right=new h.Variable(this.toString()+\".right\"),this._top=new h.Variable(this.toString()+\".top\"),this._bottom=new h.Variable(this.toString()+\".bottom\"),this._dom_top=new h.Variable(this.toString()+\".dom_top\"),this._dom_left=new h.Variable(this.toString()+\".dom_left\"),this._width_minus_right=new h.Variable(this.toString()+\".width_minus_right\"),this._height_minus_bottom=new h.Variable(this.toString()+\".height_minus_bottom\"),this._whitespace_top=new h.Variable(this.toString()+\".whitespace_top\"),this._whitespace_bottom=new h.Variable(this.toString()+\".whitespace_bottom\"),this._whitespace_left=new h.Variable(this.toString()+\".whitespace_left\"),this._whitespace_right=new h.Variable(this.toString()+\".whitespace_right\")},Object.defineProperty(t.prototype,\"layout_bbox\",{get:function(){return{top:this._top.value,left:this._left.value,width:this._width.value,height:this._height.value,right:this._right.value,bottom:this._bottom.value,dom_top:this._dom_top.value,dom_left:this._dom_left.value}},enumerable:!0,configurable:!0}),t.prototype.dump_layout=function(){for(var t,e={},i=[this];t=i.shift();)i.push.apply(i,t.get_layoutable_children()),e[t.toString()]=t.layout_bbox;console.table(e)},t.prototype.get_all_constraints=function(){for(var t=this.get_constraints(),e=0,i=this.get_layoutable_children();e<i.length;e++){var n=i[e];t=n instanceof s.LayoutCanvas?t.concat(n.get_constraints()):t.concat(n.get_all_constraints())}return t},t.prototype.get_all_editables=function(){for(var t=this.get_editables(),e=0,i=this.get_layoutable_children();e<i.length;e++){var n=i[e];t=n instanceof s.LayoutCanvas?t.concat(n.get_editables()):t.concat(n.get_all_editables())}return t},t.prototype.get_constraints=function(){return[h.GE(this._dom_left),h.GE(this._dom_top),h.GE(this._left),h.GE(this._width,[-1,this._right]),h.GE(this._top),h.GE(this._height,[-1,this._bottom]),h.EQ(this._width_minus_right,[-1,this._width],this._right),h.EQ(this._height_minus_bottom,[-1,this._height],this._bottom)]},t.prototype.get_layoutable_children=function(){return[]},t.prototype.get_editables=function(){switch(this.sizing_mode){case\"fixed\":return[this._height,this._width];case\"scale_width\":return[this._height];case\"scale_height\":return[this._width];case\"scale_both\":return[this._width,this._height];default:return[]}},t.prototype.get_constrained_variables=function(){var t={origin_x:this._dom_left,origin_y:this._dom_top,whitespace_top:this._whitespace_top,whitespace_bottom:this._whitespace_bottom,whitespace_left:this._whitespace_left,whitespace_right:this._whitespace_right};switch(this.sizing_mode){case\"stretch_both\":t.width=this._width,t.height=this._height;break;case\"scale_width\":t.width=this._width;break;case\"scale_height\":t.height=this._height}return t},t.prototype.get_aspect_ratio=function(){return this.width/this.height},t}(r.Model);(i.LayoutDOM=u).initClass()},function(t,e,i){var n=t(387),r=t(149),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-grid-row\")},e}(r.BoxView);i.RowView=o;var s=function(i){function t(t){var e=i.call(this,t)||this;return e._horizontal=!0,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"Row\",this.prototype.default_view=o},t}(r.Box);(i.Row=s).initClass()},function(t,e,i){var n=t(387),r=t(152),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),\"fixed\"==this.model.sizing_mode&&(this.el.style.width=this.model.width+\"px\",this.el.style.height=this.model.height+\"px\")},e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-spacer-box\")},e.prototype.get_width=function(){return 1},e.prototype.get_height=function(){return 1},e}(r.LayoutDOMView);i.SpacerView=o;var s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Spacer\",this.prototype.default_view=o},t.prototype.get_constrained_variables=function(){return n.__assign({},e.prototype.get_constrained_variables.call(this),{on_edge_align_top:this._top,on_edge_align_bottom:this._height_minus_bottom,on_edge_align_left:this._left,on_edge_align_right:this._width_minus_right,box_cell_align_top:this._top,box_cell_align_bottom:this._height_minus_bottom,box_cell_align_left:this._left,box_cell_align_right:this._width_minus_right,box_equal_size_top:this._top,box_equal_size_bottom:this._height_minus_bottom,box_equal_size_left:this._left,box_equal_size_right:this._width_minus_right})},t}(r.LayoutDOM);(i.Spacer=s).initClass()},function(t,e,i){var n=t(387),r=t(14),o=t(15),s=t(152),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.children.change,function(){return t.rebuild_child_views()})},t.prototype.css_classes=function(){return e.prototype.css_classes.call(this).concat(\"bk-widget-box\")},t.prototype.render=function(){if(this._render_classes(),\"fixed\"==this.model.sizing_mode||\"scale_height\"==this.model.sizing_mode){var t=this.get_width();this.model._width.value!=t&&this.solver.suggest_value(this.model._width,t)}if(\"fixed\"==this.model.sizing_mode||\"scale_width\"==this.model.sizing_mode){var e=this.get_height();this.model._height.value!=e&&this.solver.suggest_value(this.model._height,e)}if(this.solver.update_variables(),\"stretch_both\"==this.model.sizing_mode)this.el.style.position=\"absolute\",this.el.style.left=this.model._dom_left.value+\"px\",this.el.style.top=this.model._dom_top.value+\"px\",this.el.style.width=this.model._width.value+\"px\",this.el.style.height=this.model._height.value+\"px\";else{var i=void 0;i=0<this.model._width.value-20?this.model._width.value-20+\"px\":\"100%\",this.el.style.width=i}},t.prototype.get_height=function(){var t=0;for(var e in this.child_views){var i=this.child_views[e],n=i.el,r=getComputedStyle(n),o=parseInt(r.marginTop)||0,s=parseInt(r.marginBottom)||0;t+=n.offsetHeight+o+s}return t+20},t.prototype.get_width=function(){if(null!=this.model.width)return this.model.width;var t=this.el.scrollWidth+20;for(var e in this.child_views){var i=this.child_views[e],n=i.el.scrollWidth;t<n&&(t=n)}return t},t}(s.LayoutDOMView);i.WidgetBoxView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"WidgetBox\",this.prototype.default_view=a,this.define({children:[o.Array,[]]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),\"fixed\"==this.sizing_mode&&null==this.width&&(this.width=300,r.logger.info(\"WidgetBox mode is fixed, but no width specified. Using default of 300.\"))},t.prototype.get_constrained_variables=function(){var t=n.__assign({},e.prototype.get_constrained_variables.call(this),{on_edge_align_top:this._top,on_edge_align_bottom:this._height_minus_bottom,on_edge_align_left:this._left,on_edge_align_right:this._width_minus_right,box_cell_align_top:this._top,box_cell_align_bottom:this._height_minus_bottom,box_cell_align_left:this._left,box_cell_align_right:this._width_minus_right,box_equal_size_top:this._top,box_equal_size_bottom:this._height_minus_bottom});return\"fixed\"!=this.sizing_mode&&(t.box_equal_size_left=this._left,t.box_equal_size_right=this._width_minus_right),t},t.prototype.get_layoutable_children=function(){return this.children},t}(s.LayoutDOM);(i.WidgetBox=l).initClass()},function(t,e,i){var n=t(387),r=t(157),o=t(15),c=t(21),u=t(44),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CategoricalColorMapper\",this.define({factors:[o.Array],start:[o.Number,0],end:[o.Number]})},t.prototype._v_compute=function(o,s,a,t){for(var l=t.nan_color,e=function(t,e){var i=o[t],n=void 0;u.isString(i)?n=h.factors.indexOf(i):(null!=h.start?i=null!=h.end?i.slice(h.start,h.end):i.slice(h.start):null!=h.end&&(i=i.slice(0,h.end)),n=1==i.length?h.factors.indexOf(i[0]):c.findIndex(h.factors,function(t){return function(t,e){if(t.length!=e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}(t,i)}));var r=void 0;r=n<0||n>=a.length?l:a[n],s[t]=r},h=this,i=0,n=o.length;i<n;i++)e(i,n)},t}(r.ColorMapper);(i.CategoricalColorMapper=s).initClass()},function(t,e,i){var n=t(387),r=t(266),o=t(15),s=t(27),a=t(28);function l(t){return\"#\"!=t[0]&&(t=s.color2hex(t)),9!=t.length&&(t+=\"ff\"),parseInt(t.slice(1),16)}function h(t){for(var e=new Uint32Array(t.length),i=0,n=t.length;i<n;i++)e[i]=l(t[i]);return e}function c(t){if(a.is_little_endian)for(var e=new DataView(t.buffer),i=0,n=t.length;i<n;i++)e.setUint32(4*i,t[i]);return new Uint8Array(t.buffer)}i._convert_color=l,i._convert_palette=h,i._uint32_to_rgba=c;var u=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ColorMapper\",this.define({palette:[o.Any],nan_color:[o.Color,\"gray\"]})},t.prototype.compute=function(t){throw new Error(\"not supported\")},t.prototype.v_compute=function(t){var e=new Array(t.length);return this._v_compute(t,e,this.palette,this._colors(function(t){return t})),e},Object.defineProperty(t.prototype,\"rgba_mapper\",{get:function(){var i=this,n=h(this.palette),r=this._colors(l);return{v_compute:function(t){var e=new Uint32Array(t.length);return i._v_compute(t,e,n,r),c(e)}}},enumerable:!0,configurable:!0}),t.prototype._colors=function(t){return{nan_color:t(this.nan_color)}},t}(r.Transform);(i.ColorMapper=u).initClass()},function(t,e,i){var n=t(387),r=t(157),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ContinuousColorMapper\",this.define({high:[o.Number],low:[o.Number],high_color:[o.Color],low_color:[o.Color]})},t.prototype._colors=function(t){return n.__assign({},e.prototype._colors.call(this,t),{low_color:null!=this.low_color?t(this.low_color):void 0,high_color:null!=this.high_color?t(this.high_color):void 0})},t}(r.ColorMapper);(i.ContinuousColorMapper=s).initClass()},function(t,e,i){var n=t(156);i.CategoricalColorMapper=n.CategoricalColorMapper;var r=t(158);i.ContinuousColorMapper=r.ContinuousColorMapper;var o=t(157);i.ColorMapper=o.ColorMapper;var s=t(160);i.LinearColorMapper=s.LinearColorMapper;var a=t(161);i.LogColorMapper=a.LogColorMapper},function(t,e,i){var n=t(387),r=t(158),m=t(22),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LinearColorMapper\"},t.prototype._v_compute=function(t,e,i,n){for(var r=n.nan_color,o=n.low_color,s=n.high_color,a=null!=this.low?this.low:m.min(t),l=null!=this.high?this.high:m.max(t),h=i.length-1,c=1/(l-a),u=1/i.length,_=0,p=t.length;_<p;_++){var d=t[_];if(isNaN(d))e[_]=r;else if(d!=l){var f=(d-a)*c,v=Math.floor(f/u);e[_]=v<0?null!=o?o:i[0]:h<v?null!=s?s:i[h]:i[v]}else e[_]=i[h]}},t}(r.ContinuousColorMapper);(i.LinearColorMapper=o).initClass()},function(t,e,i){var n=t(387),r=t(158),m=t(22),g=null!=Math.log1p?Math.log1p:function(t){return Math.log(1+t)},o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LogColorMapper\"},t.prototype._v_compute=function(t,e,i,n){for(var r=n.nan_color,o=n.low_color,s=n.high_color,a=i.length,l=null!=this.low?this.low:m.min(t),h=null!=this.high?this.high:m.max(t),c=a/(g(h)-g(l)),u=i.length-1,_=0,p=t.length;_<p;_++){var d=t[_];if(isNaN(d))e[_]=r;else if(h<d)e[_]=null!=s?s:i[u];else if(d!=h)if(d<l)e[_]=null!=o?o:i[0];else{var f=g(d)-g(l),v=Math.floor(f*c);u<v&&(v=u),e[_]=i[v]}else e[_]=i[u]}},t}(r.ContinuousColorMapper);(i.LogColorMapper=o).initClass()},function(t,e,i){var o=t(387),s=t(163),h=Math.sqrt(3);function a(t,e){t.moveTo(-e,e),t.lineTo(e,-e),t.moveTo(-e,-e),t.lineTo(e,e)}function l(t,e){t.moveTo(0,e),t.lineTo(0,-e),t.moveTo(-e,0),t.lineTo(e,0)}function c(t,e){t.moveTo(0,e),t.lineTo(e/1.5,0),t.lineTo(0,-e),t.lineTo(-e/1.5,0),t.closePath()}function u(t,e){var i=e*h,n=i/3;t.moveTo(-e,n),t.lineTo(e,n),t.lineTo(0,n-i),t.closePath()}function n(i,n){var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.initClass=function(){this.prototype._render_one=n},e}(s.MarkerView);r.initClass();var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.initClass=function(){this.prototype.default_view=r,this.prototype.type=i},e}(s.Marker);return t.initClass(),t}i.Asterisk=n(\"Asterisk\",function(t,e,i,n,r){var o=.65*i;l(t,i),a(t,o),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.CircleCross=n(\"CircleCross\",function(t,e,i,n,r){t.arc(0,0,i,0,2*Math.PI,!1),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),l(t,i),t.stroke())}),i.CircleX=n(\"CircleX\",function(t,e,i,n,r){t.arc(0,0,i,0,2*Math.PI,!1),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),a(t,i),t.stroke())}),i.Cross=n(\"Cross\",function(t,e,i,n,r){l(t,i),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.Diamond=n(\"Diamond\",function(t,e,i,n,r){c(t,i),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.DiamondCross=n(\"DiamondCross\",function(t,e,i,n,r){c(t,i),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),l(t,i),t.stroke())}),i.Hex=n(\"Hex\",function(t,e,i,n,r){var o,s,a,l;l=h*(a=(s=i)/2),(o=t).moveTo(s,0),o.lineTo(a,-l),o.lineTo(-a,-l),o.lineTo(-s,0),o.lineTo(-a,l),o.lineTo(a,l),o.closePath(),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.InvertedTriangle=n(\"InvertedTriangle\",function(t,e,i,n,r){t.rotate(Math.PI),u(t,i),t.rotate(-Math.PI),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.Square=n(\"Square\",function(t,e,i,n,r){var o=2*i;t.rect(-i,-i,o,o),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.SquareCross=n(\"SquareCross\",function(t,e,i,n,r){var o=2*i;t.rect(-i,-i,o,o),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),l(t,i),t.stroke())}),i.SquareX=n(\"SquareX\",function(t,e,i,n,r){var o=2*i;t.rect(-i,-i,o,o),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),a(t,i),t.stroke())}),i.Triangle=n(\"Triangle\",function(t,e,i,n,r){u(t,i),r.doit&&(r.set_vectorize(t,e),t.fill()),n.doit&&(n.set_vectorize(t,e),t.stroke())}),i.X=n(\"X\",function(t,e,i,n,r){a(t,i),n.doit&&(n.set_vectorize(t,e),t.stroke())})},function(t,e,i){var n=t(387),r=t(141),w=t(9),o=t(15),h=t(21),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._render=function(t,e,i){for(var n=i.sx,r=i.sy,o=i._size,s=i._angle,a=0,l=e;a<l.length;a++){var h=l[a];if(!isNaN(n[h]+r[h]+o[h]+s[h])){var c=o[h]/2;t.beginPath(),t.translate(n[h],r[h]),s[h]&&t.rotate(s[h]),this._render_one(t,h,c,this.visuals.line,this.visuals.fill),s[h]&&t.rotate(-s[h]),t.translate(-n[h],-r[h])}}},e.prototype._mask_data=function(){var t=this.renderer.plot_view.frame.bbox.h_range,e=t.start-this.max_size,i=t.end+this.max_size,n=this.renderer.xscale.r_invert(e,i),r=n[0],o=n[1],s=this.renderer.plot_view.frame.bbox.v_range,a=s.start-this.max_size,l=s.end+this.max_size,h=this.renderer.yscale.r_invert(a,l),c=h[0],u=h[1],_=w.validate_bbox_coords([r,o],[c,u]);return this.index.indices(_)},e.prototype._hit_point=function(t){for(var e=t.sx,i=t.sy,n=e-this.max_size,r=e+this.max_size,o=this.renderer.xscale.r_invert(n,r),s=o[0],a=o[1],l=i-this.max_size,h=i+this.max_size,c=this.renderer.yscale.r_invert(l,h),u=c[0],_=c[1],p=w.validate_bbox_coords([s,a],[u,_]),d=this.index.indices(p),f=[],v=0,m=d;v<m.length;v++){var g=m[v],y=this._size[g]/2,b=Math.abs(this.sx[g]-e)+Math.abs(this.sy[g]-i);Math.abs(this.sx[g]-e)<=y&&Math.abs(this.sy[g]-i)<=y&&f.push([g,b])}return w.create_hit_test_result_from_hits(f)},e.prototype._hit_span=function(t){var e,i,n,r,o,s,a=t.sx,l=t.sy,h=this.bounds(),c=h.minX,u=h.minY,_=h.maxX,p=h.maxY,d=w.create_empty_hit_test_result();if(\"h\"==t.direction){o=u,s=p;var f=this.max_size/2,v=a-f,m=a+f;e=this.renderer.xscale.r_invert(v,m),n=e[0],r=e[1]}else{n=c,r=_;var f=this.max_size/2,g=l-f,y=l+f;i=this.renderer.yscale.r_invert(g,y),o=i[0],s=i[1]}var b=w.validate_bbox_coords([n,r],[o,s]),x=this.index.indices(b);return d.indices=x,d},e.prototype._hit_rect=function(t){var e=t.sx0,i=t.sx1,n=t.sy0,r=t.sy1,o=this.renderer.xscale.r_invert(e,i),s=o[0],a=o[1],l=this.renderer.yscale.r_invert(n,r),h=l[0],c=l[1],u=w.validate_bbox_coords([s,a],[h,c]),_=w.create_empty_hit_test_result();return _.indices=this.index.indices(u),_},e.prototype._hit_poly=function(t){for(var e=t.sx,i=t.sy,n=h.range(0,this.sx.length),r=[],o=0,s=n.length;o<s;o++){var a=n[o];w.point_in_poly(this.sx[o],this.sy[o],e,i)&&r.push(a)}var l=w.create_empty_hit_test_result();return l.indices=r,l},e.prototype.draw_legend_for_index=function(t,e,i){var n=e.x0,r=e.x1,o=e.y0,s=e.y1,a=i+1,l=new Array(a);l[i]=(n+r)/2;var h=new Array(a);h[i]=(o+s)/2;var c=new Array(a);c[i]=.4*Math.min(Math.abs(r-n),Math.abs(s-o));var u=new Array(a);u[i]=this._angle[i],this._render(t,[i],{sx:l,sy:h,_size:c,_angle:u})},e}(r.XYGlyphView);i.MarkerView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.mixins([\"line\",\"fill\"]),this.define({size:[o.DistanceSpec,{units:\"screen\",value:4}],angle:[o.AngleSpec,0]})},t}(r.XYGlyph);(i.Marker=a).initClass()},function(t,e,i){var n=t(387),r=t(14),o=t(165),s=t(167),a=t(15),l=t(57),h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"MapOptions\",this.define({lat:[a.Number],lng:[a.Number],zoom:[a.Number,12]})},t}(l.Model);(i.MapOptions=h).initClass();var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GMapOptions\",this.define({map_type:[a.String,\"roadmap\"],scale_control:[a.Bool,!1],styles:[a.String]})},t}(h);(i.GMapOptions=c).initClass();var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(s.PlotView);i.GMapPlotView=u;var _=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GMapPlot\",this.prototype.default_view=u,this.define({map_options:[a.Instance],api_key:[a.String]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.api_key||r.logger.error(\"api_key is required. See https://developers.google.com/maps/documentation/javascript/get-api-key for more information on how to obtain your own.\")},t.prototype._init_plot_canvas=function(){return new o.GMapPlotCanvas({plot:this})},t}(s.Plot);(i.GMapPlot=_).initClass()},function(t,e,i){var n=t(387),r=t(19),u=t(33),o=t(168),s=new r.Signal0({},\"gmaps_ready\"),a=function(a){function t(){return null!==a&&a.apply(this,arguments)||this}return n.__extends(t,a),t.prototype.initialize=function(t){var e=this;this.pause(),a.prototype.initialize.call(this,t),this._tiles_loaded=!1,this.zoom_count=0;var i=this.model.plot.map_options,n=i.zoom,r=i.lat,o=i.lng;this.initial_zoom=n,this.initial_lat=r,this.initial_lng=o,this.canvas_view.map_el.style.position=\"absolute\",\"undefined\"!=typeof google&&null!=google.maps||(\"undefined\"==typeof _bokeh_gmaps_callback&&function(t){_bokeh_gmaps_callback=function(){return s.emit()};var e=document.createElement(\"script\");e.type=\"text/javascript\",e.src=\"https://maps.googleapis.com/maps/api/js?key=\"+t+\"&callback=_bokeh_gmaps_callback\",document.body.appendChild(e)}(this.model.plot.api_key),s.connect(function(){return e.request_render()})),this.unpause()},t.prototype.update_range=function(t){if(null==t)this.map.setCenter({lat:this.initial_lat,lng:this.initial_lng}),this.map.setOptions({zoom:this.initial_zoom}),a.prototype.update_range.call(this,null);else if(null!=t.sdx||null!=t.sdy)this.map.panBy(t.sdx||0,t.sdy||0),a.prototype.update_range.call(this,t);else if(null!=t.factor){var e=void 0;if(10!==this.zoom_count)return void(this.zoom_count+=1);this.zoom_count=0,this.pause(),a.prototype.update_range.call(this,t),e=t.factor<0?-1:1;var i=this.map.getZoom(),n=i+e;if(2<=n){this.map.setZoom(n);var r=this._get_projected_bounds(),o=r[0],s=r[1];s-o<0&&this.map.setZoom(i)}this.unpause()}this._set_bokeh_ranges()},t.prototype._build_map=function(){var t=this,e=google.maps;this.map_types={satellite:e.MapTypeId.SATELLITE,terrain:e.MapTypeId.TERRAIN,roadmap:e.MapTypeId.ROADMAP,hybrid:e.MapTypeId.HYBRID};var i=this.model.plot.map_options,n={center:new e.LatLng(i.lat,i.lng),zoom:i.zoom,disableDefaultUI:!0,mapTypeId:this.map_types[i.map_type],scaleControl:i.scale_control};null!=i.styles&&(n.styles=JSON.parse(i.styles)),this.map=new e.Map(this.canvas_view.map_el,n),e.event.addListener(this.map,\"idle\",function(){return t._set_bokeh_ranges()}),e.event.addListener(this.map,\"bounds_changed\",function(){return t._set_bokeh_ranges()}),e.event.addListenerOnce(this.map,\"tilesloaded\",function(){return t._render_finished()}),this.connect(this.model.plot.properties.map_options.change,function(){return t._update_options()}),this.connect(this.model.plot.map_options.properties.styles.change,function(){return t._update_styles()}),this.connect(this.model.plot.map_options.properties.lat.change,function(){return t._update_center(\"lat\")}),this.connect(this.model.plot.map_options.properties.lng.change,function(){return t._update_center(\"lng\")}),this.connect(this.model.plot.map_options.properties.zoom.change,function(){return t._update_zoom()}),this.connect(this.model.plot.map_options.properties.map_type.change,function(){return t._update_map_type()}),this.connect(this.model.plot.map_options.properties.scale_control.change,function(){return t._update_scale_control()})},t.prototype._render_finished=function(){this._tiles_loaded=!0,this.notify_finished()},t.prototype.has_finished=function(){return a.prototype.has_finished.call(this)&&!0===this._tiles_loaded},t.prototype._get_latlon_bounds=function(){var t=this.map.getBounds(),e=t.getNorthEast(),i=t.getSouthWest(),n=i.lng(),r=e.lng(),o=i.lat(),s=e.lat();return[n,r,o,s]},t.prototype._get_projected_bounds=function(){var t=this._get_latlon_bounds(),e=t[0],i=t[1],n=t[2],r=t[3],o=u.wgs84_mercator.forward([e,n]),s=o[0],a=o[1],l=u.wgs84_mercator.forward([i,r]),h=l[0],c=l[1];return[s,h,a,c]},t.prototype._set_bokeh_ranges=function(){var t=this._get_projected_bounds(),e=t[0],i=t[1],n=t[2],r=t[3];this.frame.x_range.setv({start:e,end:i}),this.frame.y_range.setv({start:n,end:r})},t.prototype._update_center=function(t){var e=this.map.getCenter().toJSON();e[t]=this.model.plot.map_options[t],this.map.setCenter(e),this._set_bokeh_ranges()},t.prototype._update_map_type=function(){this.map.setOptions({mapTypeId:this.map_types[this.model.plot.map_options.map_type]})},t.prototype._update_scale_control=function(){this.map.setOptions({scaleControl:this.model.plot.map_options.scale_control})},t.prototype._update_options=function(){this._update_styles(),this._update_center(\"lat\"),this._update_center(\"lng\"),this._update_zoom(),this._update_map_type()},t.prototype._update_styles=function(){this.map.setOptions({styles:JSON.parse(this.model.plot.map_options.styles)})},t.prototype._update_zoom=function(){this.map.setOptions({zoom:this.model.plot.map_options.zoom}),this._set_bokeh_ranges()},t.prototype._map_hook=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3];this.canvas_view.map_el.style.top=n+\"px\",this.canvas_view.map_el.style.left=i+\"px\",this.canvas_view.map_el.style.width=r+\"px\",this.canvas_view.map_el.style.height=o+\"px\",null==this.map&&\"undefined\"!=typeof google&&null!=google.maps&&this._build_map()},t.prototype._paint_empty=function(t,e){var i=this.canvas._width.value,n=this.canvas._height.value,r=e[0],o=e[1],s=e[2],a=e[3];t.clearRect(0,0,i,n),t.beginPath(),t.moveTo(0,0),t.lineTo(0,n),t.lineTo(i,n),t.lineTo(i,0),t.lineTo(0,0),t.moveTo(r,o),t.lineTo(r+s,o),t.lineTo(r+s,o+a),t.lineTo(r,o+a),t.lineTo(r,o),t.closePath(),t.fillStyle=this.model.plot.border_fill_color,t.fill()},t}(o.PlotCanvasView);i.GMapPlotCanvasView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GMapPlotCanvas\",this.prototype.default_view=a},t.prototype.initialize=function(){this.use_map=!0,e.prototype.initialize.call(this)},t}(o.PlotCanvas);(i.GMapPlotCanvas=l).initClass()},function(t,e,i){var n=t(164);i.MapOptions=n.MapOptions;var r=t(164);i.GMapOptions=r.GMapOptions;var o=t(164);i.GMapPlot=o.GMapPlot;var s=t(165);i.GMapPlotCanvas=s.GMapPlotCanvas;var a=t(167);i.Plot=a.Plot;var l=t(168);i.PlotCanvas=l.PlotCanvas},function(t,e,i){var o=t(387),n=t(13),r=t(14),s=t(15),f=t(19),a=t(21),v=t(32),m=t(44),l=t(152),h=t(73),c=t(182),u=t(255),_=t(74),p=t(168),g=t(190),y=t(175),b=t(3),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.connect_signals=function(){t.prototype.connect_signals.call(this),this.connect(this.model.properties.title.change,function(){return r.logger.warn(\"Title object cannot be replaced. Try changing properties on title to update it after initialization.\")})},e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-plot-layout\")},e.prototype.get_height=function(){return this.model._width.value/this.model.get_aspect_ratio()},e.prototype.get_width=function(){return this.model._height.value*this.model.get_aspect_ratio()},e.prototype.save=function(t){this.plot_canvas_view.save(t)},Object.defineProperty(e.prototype,\"plot_canvas_view\",{get:function(){return this.child_views[this.model.plot_canvas.id]},enumerable:!0,configurable:!0}),e}(l.LayoutDOMView);i.PlotView=x;var d=function(d){function t(t){return d.call(this,t)||this}return o.__extends(t,d),t.initClass=function(){this.prototype.type=\"Plot\",this.prototype.default_view=x,this.mixins([\"line:outline_\",\"fill:background_\",\"fill:border_\"]),this.define({toolbar:[s.Instance,function(){return new u.Toolbar}],toolbar_location:[s.Location,\"right\"],toolbar_sticky:[s.Boolean,!0],plot_width:[s.Number,600],plot_height:[s.Number,600],title:[s.Any,function(){return new h.Title({text:\"\"})}],title_location:[s.Location,\"above\"],h_symmetry:[s.Bool,!0],v_symmetry:[s.Bool,!1],above:[s.Array,[]],below:[s.Array,[]],left:[s.Array,[]],right:[s.Array,[]],renderers:[s.Array,[]],x_range:[s.Instance],extra_x_ranges:[s.Any,{}],y_range:[s.Instance],extra_y_ranges:[s.Any,{}],x_scale:[s.Instance,function(){return new c.LinearScale}],y_scale:[s.Instance,function(){return new c.LinearScale}],lod_factor:[s.Number,10],lod_interval:[s.Number,300],lod_threshold:[s.Number,2e3],lod_timeout:[s.Number,500],hidpi:[s.Bool,!0],output_backend:[s.OutputBackend,\"canvas\"],min_border:[s.Number,5],min_border_top:[s.Number,null],min_border_left:[s.Number,null],min_border_bottom:[s.Number,null],min_border_right:[s.Number,null],inner_width:[s.Number],inner_height:[s.Number],layout_width:[s.Number],layout_height:[s.Number],match_aspect:[s.Bool,!1],aspect_scale:[s.Number,1]}),this.override({outline_line_color:\"#e5e5e5\",border_fill_color:\"#ffffff\",background_fill_color:\"#ffffff\"}),b.register_with_event(b.UIEvent,this)},t.prototype.initialize=function(){d.prototype.initialize.call(this),this.reset=new f.Signal0(this,\"reset\");for(var t=0,e=v.values(this.extra_x_ranges).concat(this.x_range);t<e.length;t++){var i=e[t],n=i.plots;m.isArray(n)&&(n=n.concat(this),i.setv({plots:n},{silent:!0}))}for(var r=0,o=v.values(this.extra_y_ranges).concat(this.y_range);r<o.length;r++){var s=o[r],n=s.plots;m.isArray(n)&&(n=n.concat(this),s.setv({plots:n},{silent:!0}))}null!=this.min_border&&(null==this.min_border_top&&(this.min_border_top=this.min_border),null==this.min_border_bottom&&(this.min_border_bottom=this.min_border),null==this.min_border_left&&(this.min_border_left=this.min_border),null==this.min_border_right&&(this.min_border_right=this.min_border));for(var a=0,l=[\"above\",\"below\",\"left\",\"right\"];a<l.length;a++)for(var h=l[a],c=this.getv(h),u=0,_=c;u<_.length;u++){var p=_[u];p.add_panel(h)}this._init_title_panel(),this._init_toolbar_panel(),this._plot_canvas=this._init_plot_canvas(),this.plot_canvas.toolbar=this.toolbar,null==this.width&&(this.width=this.plot_width),null==this.height&&(this.height=this.plot_height)},t.prototype._init_plot_canvas=function(){return new p.PlotCanvas({plot:this})},t.prototype._init_title_panel=function(){if(null!=this.title){var t=m.isString(this.title)?new h.Title({text:this.title}):this.title;this.add_layout(t,this.title_location)}},t.prototype._init_toolbar_panel=function(){var e=this,t=a.find(this.renderers,function(t){return t instanceof _.ToolbarPanel&&a.includes(t.tags,e.id)});switch(null!=t&&this.remove_layout(t),this.toolbar_location){case\"left\":case\"right\":case\"above\":case\"below\":if(t=new _.ToolbarPanel({toolbar:this.toolbar,tags:[this.id]}),this.toolbar.toolbar_location=this.toolbar_location,this.toolbar_sticky){var i=this.getv(this.toolbar_location),n=a.find(i,function(t){return t instanceof h.Title});if(null!=n)return t.set_panel(n.panel),void this.add_renderers(t)}this.add_layout(t,this.toolbar_location)}},t.prototype.connect_signals=function(){var t=this;d.prototype.connect_signals.call(this),this.connect(this.properties.toolbar_location.change,function(){return t._init_toolbar_panel()})},Object.defineProperty(t.prototype,\"plot_canvas\",{get:function(){return this._plot_canvas},enumerable:!0,configurable:!0}),t.prototype._doc_attached=function(){this.plot_canvas.attach_document(this.document),d.prototype._doc_attached.call(this)},t.prototype.add_renderers=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.renderers;i=i.concat(t),this.renderers=i},t.prototype.add_layout=function(t,e){if(void 0===e&&(e=\"center\"),null!=t.props.plot&&(t.plot=this),\"center\"!=e){var i=this.getv(e);i.push(t),t.add_panel(e)}this.add_renderers(t)},t.prototype.remove_layout=function(e){var t=function(t){a.removeBy(t,function(t){return t==e})};t(this.left),t(this.right),t(this.above),t(this.below),t(this.renderers)},t.prototype.add_glyph=function(t,e,i){void 0===e&&(e=new g.ColumnDataSource),void 0===i&&(i={});var n=o.__assign({},i,{data_source:e,glyph:t}),r=new y.GlyphRenderer(n);return this.add_renderers(r),r},t.prototype.add_tools=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t;i<n.length;i++){var r=n[i];null!=r.overlay&&this.add_renderers(r.overlay)}this.toolbar.tools=this.toolbar.tools.concat(t)},t.prototype.get_layoutable_children=function(){return[this.plot_canvas]},t.prototype.get_constraints=function(){var t=d.prototype.get_constraints.call(this);return t.push(n.EQ(this._width,[-1,this.plot_canvas._width])),t.push(n.EQ(this._height,[-1,this.plot_canvas._height])),t},t.prototype.get_constrained_variables=function(){var t=o.__assign({},d.prototype.get_constrained_variables.call(this),{on_edge_align_top:this.plot_canvas._top,on_edge_align_bottom:this.plot_canvas._height_minus_bottom,on_edge_align_left:this.plot_canvas._left,on_edge_align_right:this.plot_canvas._width_minus_right,box_cell_align_top:this.plot_canvas._top,box_cell_align_bottom:this.plot_canvas._height_minus_bottom,box_cell_align_left:this.plot_canvas._left,box_cell_align_right:this.plot_canvas._width_minus_right,box_equal_size_top:this.plot_canvas._top,box_equal_size_bottom:this.plot_canvas._height_minus_bottom});return\"fixed\"!=this.sizing_mode&&(t.box_equal_size_left=this.plot_canvas._left,t.box_equal_size_right=this.plot_canvas._width_minus_right),t},Object.defineProperty(t.prototype,\"all_renderers\",{get:function(){for(var t=this.renderers,e=0,i=this.toolbar.tools;e<i.length;e++){var n=i[e];t=t.concat(n.synthetic_renderers)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"webgl\",{get:function(){return r.logger.warn(\"webgl attr is deprecated, use output_backend\"),\"webgl\"==this.output_backend},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"tool_events\",{get:function(){return r.logger.warn(\"tool_events attr is deprecated, use SelectionGeometry Event\"),null},enumerable:!0,configurable:!0}),t}(l.LayoutDOM);(i.Plot=d).initClass()},function(t,e,i){var l=t(387),n=t(89),r=t(90),T=t(170),C=t(175),o=t(152),s=t(3),h=t(19),u=t(4),c=t(20),_=t(49),a=t(6),p=t(11),d=t(10),f=t(13),A=t(14),v=t(7),m=t(15),g=t(42),y=t(44),b=t(21),E=t(32),x=t(12),w=null,k=function(a){function t(){return null!==a&&a.apply(this,arguments)||this}return l.__extends(t,a),Object.defineProperty(t.prototype,\"frame\",{get:function(){return this.model.frame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"canvas\",{get:function(){return this.model.canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"canvas_overlays\",{get:function(){return this.canvas_view.overlays_el},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"canvas_events\",{get:function(){return this.canvas_view.events_el},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"is_paused\",{get:function(){return null!=this._is_paused&&0!==this._is_paused},enumerable:!0,configurable:!0}),t.prototype.view_options=function(){return{plot_view:this,parent:this}},t.prototype.pause=function(){null==this._is_paused?this._is_paused=1:this._is_paused+=1},t.prototype.unpause=function(t){if(void 0===t&&(t=!1),null==this._is_paused)throw new Error(\"wasn't paused\");this._is_paused-=1,0!=this._is_paused||t||this.request_render()},t.prototype.request_render=function(){this.request_paint()},t.prototype.request_paint=function(){this.is_paused||this.throttled_paint()},t.prototype.reset=function(){this.clear_state(),this.reset_range(),this.reset_selection(),this.model.plot.trigger_event(new s.Reset)},t.prototype.remove=function(){u.remove_views(this.renderer_views),u.remove_views(this.tool_views),this.canvas_view.remove(),a.prototype.remove.call(this)},t.prototype.css_classes=function(){return a.prototype.css_classes.call(this).concat(\"bk-plot-wrapper\")},t.prototype.initialize=function(t){var e=this;this.pause(),a.prototype.initialize.call(this,t),this.force_paint=new h.Signal0(this,\"force_paint\"),this.state_changed=new h.Signal0(this,\"state_changed\"),this.lod_started=!1,this.visuals=new _.Visuals(this.model.plot),this._initial_state_info={selection:{},dimensions:{width:this.model.canvas._width.value,height:this.model.canvas._height.value}},this.state={history:[],index:-1},this.canvas_view=new this.canvas.default_view({model:this.canvas,parent:this}),this.el.appendChild(this.canvas_view.el),this.canvas_view.render(),\"webgl\"==this.model.plot.output_backend&&this.init_webgl(),this.throttled_paint=g.throttle(function(){return e.force_paint.emit()},15),this.ui_event_bus=new c.UIEvents(this,this.model.toolbar,this.canvas_view.events_el,this.model.plot),this.levels={};for(var i=0,n=v.RenderLevel;i<n.length;i++){var r=n[i];this.levels[r]={}}this.renderer_views={},this.tool_views={},this.build_levels(),this.build_tools(),this.update_dataranges(),this.unpause(!0),A.logger.debug(\"PlotView initialized\")},t.prototype.set_cursor=function(t){void 0===t&&(t=\"default\"),this.canvas_view.el.style.cursor=t},t.prototype.init_webgl=function(){if(null==w){var t=document.createElement(\"canvas\"),e={premultipliedAlpha:!0},i=t.getContext(\"webgl\",e)||t.getContext(\"experimental-webgl\",e);null!=i&&(w={canvas:t,ctx:i})}null!=w?this.gl=w:A.logger.warn(\"WebGL is not supported, falling back to 2D canvas.\")},t.prototype.prepare_webgl=function(t,e){if(null!=this.gl){var i=this.canvas_view.get_canvas_element();this.gl.canvas.width=i.width,this.gl.canvas.height=i.height;var n=this.gl.ctx;n.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT||n.DEPTH_BUFFER_BIT),n.enable(n.SCISSOR_TEST);var r=e[0],o=e[1],s=e[2],a=e[3],l=this.model.canvas,h=l.xview,c=l.yview,u=h.compute(r),_=c.compute(o+a);n.scissor(t*u,t*_,t*s,t*a),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE_MINUS_DST_ALPHA,n.ONE)}},t.prototype.blit_webgl=function(t){var e=this.canvas_view.ctx;null!=this.gl&&(A.logger.debug(\"drawing with WebGL\"),e.restore(),e.drawImage(this.gl.canvas,0,0),e.save(),e.scale(t,t),e.translate(.5,.5))},t.prototype.update_dataranges=function(){for(var t=this.model.frame,e={},i={},n=!1,r=0,o=E.values(t.x_ranges).concat(E.values(t.y_ranges));r<o.length;r++){var s=o[r];s instanceof T.DataRange1d&&\"log\"==s.scale_hint&&(n=!0)}for(var a in this.renderer_views){var l=this.renderer_views[a];if(l instanceof C.GlyphRendererView){var h=l.glyph.bounds();if(null!=h&&(e[a]=h),n){var c=l.glyph.log_bounds();null!=c&&(i[a]=c)}}}var u,_=!1,p=!1;!1!==this.model.plot.match_aspect&&0!=this.frame._width.value&&0!=this.frame._height.value&&(u=1/this.model.plot.aspect_scale*(this.frame._width.value/this.frame._height.value));for(var d=0,f=E.values(t.x_ranges);d<f.length;d++){var v=f[d];if(v instanceof T.DataRange1d){var m=\"log\"==v.scale_hint?i:e;v.update(m,0,this.model.id,u),v.follow&&(_=!0)}null!=v.bounds&&(p=!0)}for(var g=0,y=E.values(t.y_ranges);g<y.length;g++){var b=y[g];if(b instanceof T.DataRange1d){var m=\"log\"==b.scale_hint?i:e;b.update(m,1,this.model.id,u),b.follow&&(_=!0)}null!=b.bounds&&(p=!0)}if(_&&p){A.logger.warn(\"Follow enabled so bounds are unset.\");for(var x=0,w=E.values(t.x_ranges);x<w.length;x++){var v=w[x];v.bounds=null}for(var k=0,S=E.values(t.y_ranges);k<S.length;k++){var b=S[k];b.bounds=null}}this.range_update_timestamp=Date.now()},t.prototype.map_to_screen=function(t,e,i,n){return void 0===i&&(i=\"default\"),void 0===n&&(n=\"default\"),this.frame.map_to_screen(t,e,i,n)},t.prototype.push_state=function(t,e){var i=this.state,n=i.history,r=i.index,o=null!=n[r]?n[r].info:{},s=l.__assign({},this._initial_state_info,o,e);this.state.history=this.state.history.slice(0,this.state.index+1),this.state.history.push({type:t,info:s}),this.state.index=this.state.history.length-1,this.state_changed.emit()},t.prototype.clear_state=function(){this.state={history:[],index:-1},this.state_changed.emit()},t.prototype.can_undo=function(){this.state.index},t.prototype.can_redo=function(){this.state.index,this.state.history.length},t.prototype.undo=function(){this.can_undo()&&(this.state.index-=1,this._do_state_change(this.state.index),this.state_changed.emit())},t.prototype.redo=function(){this.can_redo()&&(this.state.index+=1,this._do_state_change(this.state.index),this.state_changed.emit())},t.prototype._do_state_change=function(t){var e=null!=this.state.history[t]?this.state.history[t].info:this._initial_state_info;null!=e.range&&this.update_range(e.range),null!=e.selection&&this.update_selection(e.selection)},t.prototype.get_selection=function(){for(var t={},e=0,i=this.model.plot.renderers;e<i.length;e++){var n=i[e];if(n instanceof C.GlyphRenderer){var r=n.data_source.selected;t[n.id]=r}}return t},t.prototype.update_selection=function(t){for(var e=0,i=this.model.plot.renderers;e<i.length;e++){var n=i[e];if(n instanceof C.GlyphRenderer){var r=n.data_source;null!=t?null!=t[n.id]&&(r.selected=t[n.id]):r.selection_manager.clear()}}},t.prototype.reset_selection=function(){this.update_selection(null)},t.prototype._update_ranges_together=function(t){for(var e=1,i=0,n=t;i<n.length;i++){var r=n[i],o=r[0],s=r[1];e=Math.min(e,this._get_weight_to_constrain_interval(o,s))}if(e<1)for(var a=0,l=t;a<l.length;a++){var h=l[a],o=h[0],s=h[1];s.start=e*s.start+(1-e)*o.start,s.end=e*s.end+(1-e)*o.end}},t.prototype._update_ranges_individually=function(t,e,i,n){for(var r=!1,o=0,s=t;o<s.length;o++){var a=s[o],l=a[0],h=a[1],c=l.start>l.end;if(!i){var u=this._get_weight_to_constrain_interval(l,h);u<1&&(h.start=u*h.start+(1-u)*l.start,h.end=u*h.end+(1-u)*l.end)}if(null!=l.bounds&&\"auto\"!=l.bounds){var _=l.bounds,p=_[0],d=_[1],f=Math.abs(h.end-h.start);c?(null!=p&&p>=h.end&&(r=!0,h.end=p,(e||i)&&(h.start=p+f)),null!=d&&d<=h.start&&(r=!0,h.start=d,(e||i)&&(h.end=d-f))):(null!=p&&p>=h.start&&(r=!0,h.start=p,(e||i)&&(h.end=p+f)),null!=d&&d<=h.end&&(r=!0,h.end=d,(e||i)&&(h.start=d-f)))}}if(!(i&&r&&n))for(var v=0,m=t;v<m.length;v++){var g=m[v],l=g[0],h=g[1];l.have_updated_interactively=!0,l.start==h.start&&l.end==h.end||l.setv(h)}},t.prototype._get_weight_to_constrain_interval=function(t,e){var i=t.min_interval,n=t.max_interval;if(null!=t.bounds&&\"auto\"!=t.bounds){var r=t.bounds,o=r[0],s=r[1];if(null!=o&&null!=s){var a=Math.abs(s-o);n=null!=n?Math.min(n,a):a}}var l=1;if(null!=i||null!=n){var h=Math.abs(t.end-t.start),c=Math.abs(e.end-e.start);0<i&&c<i&&(l=(h-i)/(h-c)),0<n&&n<c&&(l=(n-h)/(c-h)),l=Math.max(0,Math.min(1,l))}return l},t.prototype.update_range=function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!0),this.pause();var r=this.frame,o=r.x_ranges,s=r.y_ranges;if(null==t){for(var a in o){var l=o[a];l.reset()}for(var h in s){var l=s[h];l.reset()}this.update_dataranges()}else{var c=[];for(var u in o){var l=o[u];c.push([l,t.xrs[u]])}for(var _ in s){var l=s[_];c.push([l,t.yrs[_]])}i&&this._update_ranges_together(c),this._update_ranges_individually(c,e,i,n)}this.unpause()},t.prototype.reset_range=function(){this.update_range(null)},t.prototype.build_levels=function(){var t=this.model.plot.all_renderers,e=E.keys(this.renderer_views),i=u.build_views(this.renderer_views,t,this.view_options()),n=b.difference(e,t.map(function(t){return t.id}));for(var r in this.levels)for(var o=0,s=n;o<s.length;o++){var a=s[o];delete this.levels[r][a]}for(var l=0,h=i;l<h.length;l++){var c=h[l];this.levels[c.model.level][c.model.id]=c}},t.prototype.get_renderer_views=function(){var e=this;return this.model.plot.renderers.map(function(t){return e.levels[t.level][t.id]})},t.prototype.build_tools=function(){var e=this,t=this.model.plot.toolbar.tools,i=u.build_views(this.tool_views,t,this.view_options());i.map(function(t){return e.ui_event_bus.register_tool(t)})},t.prototype.connect_signals=function(){var t=this;a.prototype.connect_signals.call(this),this.connect(this.force_paint,function(){return t.repaint()});var e=this.model.frame,i=e.x_ranges,n=e.y_ranges;for(var r in i){var o=i[r];this.connect(o.change,function(){return t.request_render()})}for(var s in n){var o=n[s];this.connect(o.change,function(){return t.request_render()})}this.connect(this.model.plot.properties.renderers.change,function(){return t.build_levels()}),this.connect(this.model.plot.toolbar.properties.tools.change,function(){t.build_levels(),t.build_tools()}),this.connect(this.model.plot.change,function(){return t.request_render()}),this.connect(this.model.plot.reset,function(){return t.reset()})},t.prototype.set_initial_range=function(){var t=!0,e=this.frame,i=e.x_ranges,n=e.y_ranges,r={},o={};for(var s in i){var a=i[s],l=a.start,h=a.end;if(null==l||null==h||y.isStrictNaN(l+h)){t=!1;break}r[s]={start:l,end:h}}if(t)for(var c in n){var u=n[c],l=u.start,h=u.end;if(null==l||null==h||y.isStrictNaN(l+h)){t=!1;break}o[c]={start:l,end:h}}t?(this._initial_state_info.range={xrs:r,yrs:o},A.logger.debug(\"initial ranges set\")):A.logger.warn(\"could not set initial ranges\")},t.prototype.update_constraints=function(){for(var t in this.solver.suggest_value(this.frame._width,this.canvas._width.value),this.solver.suggest_value(this.frame._height,this.canvas._height.value),this.renderer_views){var e=this.renderer_views[t];x.isSizeableView(e)&&null!=e.model.panel&&x.update_panel_constraints(e)}this.solver.update_variables()},t.prototype._layout=function(t){void 0===t&&(t=!1),this.render(),t&&(this.model.plot.setv({inner_width:Math.round(this.frame._width.value),inner_height:Math.round(this.frame._height.value),layout_width:Math.round(this.canvas._width.value),layout_height:Math.round(this.canvas._height.value)},{no_change:!0}),this.paint())},t.prototype.has_finished=function(){if(!a.prototype.has_finished.call(this))return!1;for(var t in this.levels){var e=this.levels[t];for(var i in e){var n=e[i];if(!n.has_finished())return!1}}return!0},t.prototype.render=function(){var t=this.model._width.value,e=this.model._height.value;this.canvas_view.set_dims([t,e]),this.update_constraints(),!1!==this.model.plot.match_aspect&&0!=this.frame._width.value&&0!=this.frame._height.value&&this.update_dataranges(),this.el.style.position=\"absolute\",this.el.style.left=this.model._dom_left.value+\"px\",this.el.style.top=this.model._dom_top.value+\"px\",this.el.style.width=this.model._width.value+\"px\",this.el.style.height=this.model._height.value+\"px\"},t.prototype._needs_layout=function(){for(var t in this.renderer_views){var e=this.renderer_views[t];if(x.isSizeableView(e)&&null!=e.model.panel&&x._view_sizes.get(e)!=e.get_size())return!0}return!1},t.prototype.repaint=function(){this._needs_layout()?this.parent.partial_layout():this.paint()},t.prototype.paint=function(){var t=this;if(!this.is_paused){A.logger.trace(\"PlotCanvas.render() for \"+this.model.id),this.canvas_view.prepare_canvas();var e=this.model.document;if(null!=e){var i=e.interactive_duration(),n=this.model.plot;0<=i&&i<n.lod_interval?setTimeout(function(){e.interactive_duration()>n.lod_timeout&&e.interactive_stop(n),t.request_render()},n.lod_timeout):e.interactive_stop(n)}for(var r in this.renderer_views){var o=this.renderer_views[r];if(null==this.range_update_timestamp||o instanceof C.GlyphRendererView&&o.set_data_timestamp>this.range_update_timestamp){this.update_dataranges();break}}this.model.frame.update_scales();var s=this.canvas_view.ctx,a=this.canvas.pixel_ratio;s.save(),s.scale(a,a),s.translate(.5,.5);var l=[this.frame._left.value,this.frame._top.value,this.frame._width.value,this.frame._height.value];if(this._map_hook(s,l),this._paint_empty(s,l),this.prepare_webgl(a,l),s.save(),this.visuals.outline_line.doit){this.visuals.outline_line.set_value(s);var h=l[0],c=l[1],u=l[2],_=l[3];h+u==this.canvas._width.value&&(u-=1),c+_==this.canvas._height.value&&(_-=1),s.strokeRect(h,c,u,_)}s.restore(),this._paint_levels(s,[\"image\",\"underlay\",\"glyph\"],l,!0),this.blit_webgl(a),this._paint_levels(s,[\"annotation\"],l,!0),this._paint_levels(s,[\"overlay\"],l,!1),null==this._initial_state_info.range&&this.set_initial_range(),s.restore(),this._has_finished||(this._has_finished=!0,this.notify_finished())}},t.prototype._paint_levels=function(t,e,i,n){t.save(),n&&(t.beginPath(),t.rect.apply(t,i),t.clip());for(var r={},o=0;o<this.model.plot.renderers.length;o++){var s=this.model.plot.renderers[o];r[s.id]=o}for(var a=function(t){return r[t.model.id]},l=0,h=e;l<h.length;l++)for(var c=h[l],u=b.sortBy(E.values(this.levels[c]),a),_=0,p=u;_<p.length;_++){var d=p[_];!n&&d.needs_clip&&(t.save(),t.beginPath(),t.rect.apply(t,i),t.clip()),d.render(),!n&&d.needs_clip&&t.restore()}t.restore()},t.prototype._map_hook=function(t,e){},t.prototype._paint_empty=function(t,e){var i=[0,0,this.canvas_view.model._width.value,this.canvas_view.model._height.value],n=i[0],r=i[1],o=i[2],s=i[3],a=e[0],l=e[1],h=e[2],c=e[3];t.clearRect(n,r,o,s),this.visuals.border_fill.doit&&(this.visuals.border_fill.set_value(t),t.fillRect(n,r,o,s),t.clearRect(a,l,h,c)),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),t.fillRect(a,l,h,c))},t.prototype.save=function(t){switch(this.model.plot.output_backend){case\"canvas\":case\"webgl\":var e=this.canvas_view.get_canvas_element();if(null!=e.msToBlob){var i=e.msToBlob();window.navigator.msSaveBlob(i,t)}else{var n=document.createElement(\"a\");n.href=e.toDataURL(\"image/png\"),n.download=t+\".png\",n.target=\"_blank\",n.dispatchEvent(new MouseEvent(\"click\"))}break;case\"svg\":var r=this.canvas_view._ctx,o=r.getSerializedSvg(!0),s=new Blob([o],{type:\"text/plain\"}),a=document.createElement(\"a\");a.download=t+\".svg\",a.innerHTML=\"Download svg\",a.href=window.URL.createObjectURL(s),a.onclick=function(t){return document.body.removeChild(t.target)},a.style.display=\"none\",document.body.appendChild(a),a.click()}},t}(a.DOMView);i.PlotCanvasView=k;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l.__extends(e,t),e.initClass=function(){this.prototype.type=\"AbovePanel\"},e}(p.LayoutCanvas);(i.AbovePanel=S).initClass();var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l.__extends(e,t),e.initClass=function(){this.prototype.type=\"BelowPanel\"},e}(p.LayoutCanvas);(i.BelowPanel=M).initClass();var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l.__extends(e,t),e.initClass=function(){this.prototype.type=\"LeftPanel\"},e}(p.LayoutCanvas);(i.LeftPanel=O).initClass();var z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l.__extends(e,t),e.initClass=function(){this.prototype.type=\"RightPanel\"},e}(p.LayoutCanvas);(i.RightPanel=z).initClass();var P=function(e){function t(t){return e.call(this,t)||this}return l.__extends(t,e),t.initClass=function(){this.prototype.type=\"PlotCanvas\",this.prototype.default_view=k,this.internal({plot:[m.Instance],toolbar:[m.Instance],canvas:[m.Instance],frame:[m.Instance]}),this.override({sizing_mode:\"stretch_both\"})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.canvas=new n.Canvas({map:null!=this.use_map&&this.use_map,use_hidpi:this.plot.hidpi,output_backend:this.plot.output_backend}),this.frame=new r.CartesianFrame({x_range:this.plot.x_range,extra_x_ranges:this.plot.extra_x_ranges,x_scale:this.plot.x_scale,y_range:this.plot.y_range,extra_y_ranges:this.plot.extra_y_ranges,y_scale:this.plot.y_scale}),this.above_panel=new S,this.below_panel=new M,this.left_panel=new O,this.right_panel=new z,A.logger.debug(\"PlotCanvas initialized\")},t.prototype._doc_attached=function(){this.canvas.attach_document(this.document),this.frame.attach_document(this.document),this.above_panel.attach_document(this.document),this.below_panel.attach_document(this.document),this.left_panel.attach_document(this.document),this.right_panel.attach_document(this.document),e.prototype._doc_attached.call(this),A.logger.debug(\"PlotCanvas attached to document\")},t.prototype.get_layoutable_children=function(){var r=[this.above_panel,this.below_panel,this.left_panel,this.right_panel,this.canvas,this.frame],t=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];x.isSizeable(n)&&null!=n.panel&&r.push(n.panel)}};return t(this.plot.above),t(this.plot.below),t(this.plot.left),t(this.plot.right),r},t.prototype.get_constraints=function(){return e.prototype.get_constraints.call(this).concat(this._get_constant_constraints(),this._get_side_constraints())},t.prototype._get_constant_constraints=function(){return[f.EQ(this.canvas._left,0),f.EQ(this.canvas._top,0),f.GE(this.above_panel._top,[-1,this.canvas._top]),f.EQ(this.above_panel._bottom,[-1,this.frame._top]),f.EQ(this.above_panel._left,[-1,this.left_panel._right]),f.EQ(this.above_panel._right,[-1,this.right_panel._left]),f.EQ(this.below_panel._top,[-1,this.frame._bottom]),f.LE(this.below_panel._bottom,[-1,this.canvas._bottom]),f.EQ(this.below_panel._left,[-1,this.left_panel._right]),f.EQ(this.below_panel._right,[-1,this.right_panel._left]),f.EQ(this.left_panel._top,[-1,this.above_panel._bottom]),f.EQ(this.left_panel._bottom,[-1,this.below_panel._top]),f.GE(this.left_panel._left,[-1,this.canvas._left]),f.EQ(this.left_panel._right,[-1,this.frame._left]),f.EQ(this.right_panel._top,[-1,this.above_panel._bottom]),f.EQ(this.right_panel._bottom,[-1,this.below_panel._top]),f.EQ(this.right_panel._left,[-1,this.frame._right]),f.LE(this.right_panel._right,[-1,this.canvas._right]),f.EQ(this._top,[-1,this.above_panel._bottom]),f.EQ(this._left,[-1,this.left_panel._right]),f.EQ(this._height,[-1,this._bottom],[-1,this.canvas._bottom],this.below_panel._top),f.EQ(this._width,[-1,this._right],[-1,this.canvas._right],this.right_panel._left),f.GE(this._top,-this.plot.min_border_top),f.GE(this._left,-this.plot.min_border_left),f.GE(this._height,[-1,this._bottom],-this.plot.min_border_bottom),f.GE(this._width,[-1,this._right],-this.plot.min_border_right)]},t.prototype._get_side_constraints=function(){var t=function(t){return t.map(function(t){return t.panel})},e=d.vstack(this.above_panel,t(this.plot.above)),i=d.vstack(this.below_panel,b.reversed(t(this.plot.below))),n=d.hstack(this.left_panel,t(this.plot.left)),r=d.hstack(this.right_panel,b.reversed(t(this.plot.right)));return b.concat([e,i,n,r])},t}(o.LayoutDOM);(i.PlotCanvas=P).initClass()},function(t,e,i){var n=t(387),r=t(173),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"DataRange\",this.define({names:[o.Array,[]],renderers:[o.Array,[]]})},t}(r.Range);(i.DataRange=s).initClass()},function(t,e,i){var n=t(387),r=t(169),h=t(175),_=t(14),o=t(15),c=t(24),u=t(21),s=function(i){function t(t){var e=i.call(this,t)||this;return e._plot_bounds={},e.have_updated_interactively=!1,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"DataRange1d\",this.define({start:[o.Number],end:[o.Number],range_padding:[o.Number,.1],range_padding_units:[o.PaddingUnits,\"percent\"],flipped:[o.Bool,!1],follow:[o.StartEnd],follow_interval:[o.Number],default_span:[o.Number,2]}),this.internal({scale_hint:[o.String,\"auto\"]})},t.prototype.initialize=function(){i.prototype.initialize.call(this),this._initial_start=this.start,this._initial_end=this.end,this._initial_range_padding=this.range_padding,this._initial_range_padding_units=this.range_padding_units,this._initial_follow=this.follow,this._initial_follow_interval=this.follow_interval,this._initial_default_span=this.default_span},Object.defineProperty(t.prototype,\"min\",{get:function(){return Math.min(this.start,this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"max\",{get:function(){return Math.max(this.start,this.end)},enumerable:!0,configurable:!0}),t.prototype.computed_renderers=function(){var e=this.names,t=this.renderers;if(0==t.length)for(var i=0,n=this.plots;i<n.length;i++){var r=n[i],o=r.renderers.filter(function(t){return t instanceof h.GlyphRenderer});t=t.concat(o)}0<e.length&&(t=t.filter(function(t){return u.includes(e,t.name)})),_.logger.debug(\"computed \"+t.length+\" renderers for DataRange1d \"+this.id);for(var s=0,a=t;s<a.length;s++){var l=a[s];_.logger.trace(\" - \"+l.type+\" \"+l.id)}return t},t.prototype._compute_plot_bounds=function(t,e){for(var i=c.empty(),n=0,r=t;n<r.length;n++){var o=r[n];null!=e[o.id]&&(i=c.union(i,e[o.id]))}return i},t.prototype.adjust_bounds_for_aspect=function(t,e){var i=c.empty(),n=t.maxX-t.minX;n<=0&&(n=1);var r=t.maxY-t.minY;r<=0&&(r=1);var o=.5*(t.maxX+t.minX),s=.5*(t.maxY+t.minY);return n<e*r?n=e*r:r=n/e,i.maxX=o+.5*n,i.minX=o-.5*n,i.maxY=s+.5*r,i.minY=s-.5*r,i},t.prototype._compute_min_max=function(t,e){var i,n,r,o,s=c.empty();for(var a in t){var l=t[a];s=c.union(s,l)}return 0==e?(i=[s.minX,s.maxX],r=i[0],o=i[1]):(n=[s.minY,s.maxY],r=n[0],o=n[1]),[r,o]},t.prototype._compute_range=function(t,e){var i,n,r,o=this.range_padding;if(\"log\"==this.scale_hint){(isNaN(t)||!isFinite(t)||t<=0)&&(t=isNaN(e)||!isFinite(e)||e<=0?.1:e/100,_.logger.warn(\"could not determine minimum data value for log axis, DataRange1d using value \"+t)),(isNaN(e)||!isFinite(e)||e<=0)&&(e=isNaN(t)||!isFinite(t)||t<=0?10:100*t,_.logger.warn(\"could not determine maximum data value for log axis, DataRange1d using value \"+e));var s=void 0,a=void 0;if(e==t)a=this.default_span+.001,s=Math.log(t)/Math.log(10);else{var l=void 0,h=void 0;\"percent\"==this.range_padding_units?(l=Math.log(t)/Math.log(10),h=Math.log(e)/Math.log(10),a=(h-l)*(1+o)):(l=Math.log(t-o)/Math.log(10),h=Math.log(e+o)/Math.log(10),a=h-l),s=(l+h)/2}n=Math.pow(10,s-a/2),r=Math.pow(10,s+a/2)}else{var a=void 0;a=e==t?this.default_span:\"percent\"==this.range_padding_units?(e-t)*(1+o):e-t+2*o;var s=(e+t)/2;n=s-a/2,r=s+a/2}var c=1;this.flipped&&(n=(i=[r,n])[0],r=i[1],c=-1);var u=this.follow_interval;return null!=u&&Math.abs(n-r)>u&&(\"start\"==this.follow?r=n+c*u:\"end\"==this.follow&&(n=r-c*u)),[n,r]},t.prototype.update=function(t,e,i,n){if(!this.have_updated_interactively){var r=this.computed_renderers(),o=this._compute_plot_bounds(r,t);null!=n&&(o=this.adjust_bounds_for_aspect(o,n)),this._plot_bounds[i]=o;var s=this._compute_min_max(this._plot_bounds,e),a=s[0],l=s[1],h=this._compute_range(a,l),c=h[0],u=h[1];null!=this._initial_start&&(\"log\"==this.scale_hint?0<this._initial_start&&(c=this._initial_start):c=this._initial_start),null!=this._initial_end&&(\"log\"==this.scale_hint?0<this._initial_end&&(u=this._initial_end):u=this._initial_end);var _=[this.start,this.end],p=_[0],d=_[1];if(c!=p||u!=d){var f={};c!=p&&(f.start=c),u!=d&&(f.end=u),this.setv(f)}\"auto\"==this.bounds&&this.setv({bounds:[c,u]},{silent:!0}),this.change.emit()}},t.prototype.reset=function(){this.have_updated_interactively=!1,this.setv({range_padding:this._initial_range_padding,range_padding_units:this._initial_range_padding_units,follow:this._initial_follow,follow_interval:this._initial_follow_interval,default_span:this._initial_default_span},{silent:!0}),this.change.emit()},t}(r.DataRange);(i.DataRange1d=s).initClass()},function(t,e,i){var n=t(387),r=t(173),o=t(15),s=t(22),b=t(21),l=t(44);function m(t,e,i){void 0===i&&(i=0);for(var n={},r=0;r<t.length;r++){var o=t[r];if(o in n)throw new Error(\"duplicate factor or subfactor: \"+o);n[o]={value:.5+r*(1+e)+i}}return[n,(t.length-1)*e]}function x(t,s,a,e){void 0===e&&(e=0);for(var l={},h={},i=[],n=0,r=t;n<r.length;n++){var o=r[n],c=o[0],u=o[1];c in h||(h[c]=[],i.push(c)),h[c].push(u)}for(var _=e,p=0,d=function(t){var e=h[t].length,i=m(h[t],a,_),n=i[0],r=i[1];p+=r;var o=b.sum(h[t].map(function(t){return n[t].value}));l[t]={value:o/e,mapping:n},_+=e+s+r},f=0,v=i;f<v.length;f++){var c=v[f];d(c)}return[l,i,(i.length-1)*s+p]}function h(t,c,u,_,e){void 0===e&&(e=0);for(var p={},d={},i=[],n=0,r=t;n<r.length;n++){var o=r[n],s=o[0],a=o[1],l=o[2];s in d||(d[s]=[],i.push(s)),d[s].push([a,l])}for(var f=[],v=e,m=0,h=function(t){for(var e=d[t].length,i=x(d[t],u,_,v),n=i[0],r=i[1],o=i[2],s=0,a=r;s<a.length;s++){var l=a[s];f.push([t,l])}m+=o;var h=b.sum(d[t].map(function(t){var e=t[0];return n[e].value}));p[t]={value:h/e,mapping:n},v+=e+c+o},g=0,y=i;g<y.length;g++){var s=y[g];h(s)}return[p,i,f,(i.length-1)*c+m]}i.map_one_level=m,i.map_two_levels=x,i.map_three_levels=h;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"FactorRange\",this.define({factors:[o.Array,[]],factor_padding:[o.Number,0],subgroup_padding:[o.Number,.8],group_padding:[o.Number,1.4],range_padding:[o.Number,0],range_padding_units:[o.PaddingUnits,\"percent\"],start:[o.Number],end:[o.Number]}),this.internal({levels:[o.Number],mids:[o.Array],tops:[o.Array],tops_groups:[o.Array]})},Object.defineProperty(t.prototype,\"min\",{get:function(){return this.start},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"max\",{get:function(){return this.end},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){e.prototype.initialize.call(this),this._init()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.properties.factors.change,function(){return t.reset()}),this.connect(this.properties.factor_padding.change,function(){return t.reset()}),this.connect(this.properties.group_padding.change,function(){return t.reset()}),this.connect(this.properties.subgroup_padding.change,function(){return t.reset()}),this.connect(this.properties.range_padding.change,function(){return t.reset()}),this.connect(this.properties.range_padding_units.change,function(){return t.reset()})},t.prototype.reset=function(){this._init(),this.change.emit()},t.prototype._lookup=function(t){if(1==t.length){var e=this._mapping;return e.hasOwnProperty(t[0])?e[t[0]].value:NaN}if(2==t.length){var e=this._mapping;return e.hasOwnProperty(t[0])&&e[t[0]].mapping.hasOwnProperty(t[1])?e[t[0]].mapping[t[1]].value:NaN}if(3==t.length){var e=this._mapping;return e.hasOwnProperty(t[0])&&e[t[0]].mapping.hasOwnProperty(t[1])&&e[t[0]].mapping[t[1]].mapping.hasOwnProperty(t[2])?e[t[0]].mapping[t[1]].mapping[t[2]].value:NaN}throw new Error(\"unreachable code\")},t.prototype.synthetic=function(t){if(l.isNumber(t))return t;if(l.isString(t))return this._lookup([t]);var e=0,i=t[t.length-1];return l.isNumber(i)&&(e=i,t=t.slice(0,-1)),this._lookup(t)+e},t.prototype.v_synthetic=function(t){var e=this;return s.map(t,function(t){return e.synthetic(t)})},t.prototype._init=function(){var t,e,i,n,r;if(b.all(this.factors,l.isString))n=1,t=m(this.factors,this.factor_padding),this._mapping=t[0],r=t[1];else if(b.all(this.factors,function(t){return l.isArray(t)&&2==t.length&&l.isString(t[0])&&l.isString(t[1])}))n=2,e=x(this.factors,this.group_padding,this.factor_padding),this._mapping=e[0],this.tops=e[1],r=e[2];else{if(!b.all(this.factors,function(t){return l.isArray(t)&&3==t.length&&l.isString(t[0])&&l.isString(t[1])&&l.isString(t[2])}))throw new Error(\"???\");n=3,i=h(this.factors,this.group_padding,this.subgroup_padding,this.factor_padding),this._mapping=i[0],this.tops=i[1],this.mids=i[2],r=i[3]}var o=0,s=this.factors.length+r;if(\"percent\"==this.range_padding_units){var a=(s-o)*this.range_padding/2;o-=a,s+=a}else o-=this.range_padding,s+=this.range_padding;this.setv({start:o,end:s,levels:n},{silent:!0}),\"auto\"==this.bounds&&this.setv({bounds:[o,s]},{silent:!0})},t}(r.Range);(i.FactorRange=a).initClass()},function(t,e,i){var n=t(169);i.DataRange=n.DataRange;var r=t(170);i.DataRange1d=r.DataRange1d;var o=t(171);i.FactorRange=o.FactorRange;var s=t(173);i.Range=s.Range;var a=t(174);i.Range1d=a.Range1d},function(t,e,i){var n=t(387),r=t(57),o=t(15),s=t(44),a=function(i){function t(t){var e=i.call(this,t)||this;return e.have_updated_interactively=!1,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"Range\",this.define({callback:[o.Any],bounds:[o.Any],min_interval:[o.Any],max_interval:[o.Any]}),this.internal({plots:[o.Array,[]]})},t.prototype.connect_signals=function(){var t=this;i.prototype.connect_signals.call(this),this.connect(this.change,function(){return t._emit_callback()})},t.prototype.reset=function(){this.change.emit()},t.prototype._emit_callback=function(){null!=this.callback&&(s.isFunction(this.callback)?this.callback(this):this.callback.execute(this,{}))},t}(r.Model);(i.Range=a).initClass()},function(t,e,i){var n=t(387),r=t(173),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Range1d\",this.define({start:[o.Number,0],end:[o.Number,1],reset_start:[o.Number],reset_end:[o.Number]})},t.prototype._set_auto_bounds=function(){if(\"auto\"==this.bounds){var t=Math.min(this.reset_start,this.reset_end),e=Math.max(this.reset_start,this.reset_end);this.setv({bounds:[t,e]},{silent:!0})}},t.prototype.initialize=function(){e.prototype.initialize.call(this),null==this.reset_start&&(this.reset_start=this.start),null==this.reset_end&&(this.reset_end=this.end),this._set_auto_bounds()},Object.defineProperty(t.prototype,\"min\",{get:function(){return Math.min(this.start,this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"max\",{get:function(){return Math.max(this.start,this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"is_reversed\",{get:function(){return this.start>this.end},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this._set_auto_bounds(),this.start!=this.reset_start||this.end!=this.reset_end?this.setv({start:this.reset_start,end:this.reset_end}):this.change.emit()},t}(r.Range);(i.Range1d=s).initClass()},function(t,e,i){var n=t(387),r=t(179),P=t(126),o=t(189),j=t(14),s=t(15),a=t(22),N=t(21),_=t(32),l=t(171),p={fill:{},line:{}},d={fill:{fill_alpha:.3,fill_color:\"grey\"},line:{line_alpha:.3,line_color:\"grey\"}},f={fill:{fill_alpha:.2},line:{}},h=function(u){function t(){return null!==u&&u.apply(this,arguments)||this}return n.__extends(t,u),t.prototype.initialize=function(t){u.prototype.initialize.call(this,t);var i=this.model.glyph,n=N.includes(i.mixins,\"fill\"),r=N.includes(i.mixins,\"line\"),o=_.clone(i.attributes);function e(t){var e=_.clone(o);return n&&_.extend(e,t.fill),r&&_.extend(e,t.line),new i.constructor(e)}delete o.id,this.glyph=this.build_glyph_view(i);var s=this.model.selection_glyph;null==s?s=e({fill:{},line:{}}):\"auto\"===s&&(s=e(p)),this.selection_glyph=this.build_glyph_view(s);var a=this.model.nonselection_glyph;null==a?a=e({fill:{},line:{}}):\"auto\"===a&&(a=e(f)),this.nonselection_glyph=this.build_glyph_view(a);var l=this.model.hover_glyph;null!=l&&(this.hover_glyph=this.build_glyph_view(l));var h=this.model.muted_glyph;null!=h&&(this.muted_glyph=this.build_glyph_view(h));var c=e(d);this.decimated_glyph=this.build_glyph_view(c),this.xscale=this.plot_view.frame.xscales[this.model.x_range_name],this.yscale=this.plot_view.frame.yscales[this.model.y_range_name],this.set_data(!1)},t.prototype.build_glyph_view=function(t){return new t.default_view({model:t,renderer:this,plot_view:this.plot_view,parent:this})},t.prototype.connect_signals=function(){var e=this;u.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return e.request_render()}),this.connect(this.model.glyph.change,function(){return e.set_data()}),this.connect(this.model.data_source.change,function(){return e.set_data()}),this.connect(this.model.data_source.streaming,function(){return e.set_data()}),this.connect(this.model.data_source.patching,function(t){return e.set_data(!0,t)}),this.connect(this.model.data_source.selected.change,function(){return e.request_render()}),this.connect(this.model.data_source._select,function(){return e.request_render()}),null!=this.hover_glyph&&this.connect(this.model.data_source.inspect,function(){return e.request_render()}),this.connect(this.model.properties.view.change,function(){return e.set_data()}),this.connect(this.model.view.change,function(){return e.set_data()});var t=this.plot_model.frame,i=t.x_ranges,n=t.y_ranges;for(var r in i){var o=i[r];o instanceof l.FactorRange&&this.connect(o.change,function(){return e.set_data()})}for(var s in n){var o=n[s];o instanceof l.FactorRange&&this.connect(o.change,function(){return e.set_data()})}this.connect(this.model.glyph.transformchange,function(){return e.set_data()})},t.prototype.have_selection_glyphs=function(){return null!=this.selection_glyph&&null!=this.nonselection_glyph},t.prototype.set_data=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=null);var i=Date.now(),n=this.model.data_source;this.all_indices=this.model.view.indices,this.glyph.model.setv({x_range_name:this.model.x_range_name,y_range_name:this.model.y_range_name},{silent:!0}),this.glyph.set_data(n,this.all_indices,e),this.glyph.set_visuals(n),this.decimated_glyph.set_visuals(n),this.have_selection_glyphs()&&(this.selection_glyph.set_visuals(n),this.nonselection_glyph.set_visuals(n)),null!=this.hover_glyph&&this.hover_glyph.set_visuals(n),null!=this.muted_glyph&&this.muted_glyph.set_visuals(n);var r=this.plot_model.plot.lod_factor;this.decimated=[];for(var o=0,s=Math.floor(this.all_indices.length/r);o<s;o++)this.decimated.push(o*r);var a=Date.now()-i;j.logger.debug(this.glyph.model.type+\" GlyphRenderer (\"+this.model.id+\"): set_data finished in \"+a+\"ms\"),this.set_data_timestamp=Date.now(),t&&this.request_render()},t.prototype.render=function(){var r=this;if(this.model.visible){var t=Date.now(),e=this.glyph.glglyph;this.glyph.map_data();var i=Date.now()-t,n=Date.now(),o=this.glyph.mask_data(this.all_indices);o.length===this.all_indices.length&&(o=N.range(0,this.all_indices.length));var s=Date.now()-n,a=this.plot_view.canvas_view.ctx;a.save();var l,h=this.model.data_source.selected;l=!h||h.is_empty()?[]:this.glyph instanceof P.LineView&&h.selected_glyph===this.glyph.model?this.model.view.convert_indices_from_subset(o):h.indices;var c,u=this.model.data_source.inspected;c=u&&0!==u.length?u[\"0d\"].glyph?this.model.view.convert_indices_from_subset(o):0<u[\"1d\"].indices.length?u[\"1d\"].indices:function(){for(var t=[],e=0,i=Object.keys(u[\"2d\"].indices);e<i.length;e++){var n=i[e];t.push(parseInt(n))}return t}():[];var _,p,d,f=function(){for(var t=[],e=0,i=o;e<i.length;e++){var n=i[e];N.includes(c,r.all_indices[n])&&t.push(n)}return t}(),v=this.plot_model.plot.lod_threshold;null!=this.model.document&&0<this.model.document.interactive_duration()&&!e&&null!=v&&this.all_indices.length>v?(o=this.decimated,_=this.decimated_glyph,p=this.decimated_glyph):(_=this.model.muted&&null!=this.muted_glyph?this.muted_glyph:this.glyph,p=this.nonselection_glyph),d=this.selection_glyph,null!=this.hover_glyph&&f.length&&(o=N.difference(o,f));var m,g=null;if(l.length&&this.have_selection_glyphs()){for(var y=Date.now(),b={},x=0,w=l;x<w.length;x++){var k=w[x];b[k]=!0}var S=new Array,T=new Array;if(this.glyph instanceof P.LineView)for(var C=0,A=this.all_indices;C<A.length;C++){var k=A[C];null!=b[k]?S.push(k):T.push(k)}else for(var E=0,M=o;E<M.length;E++){var k=M[E];null!=b[this.all_indices[k]]?S.push(k):T.push(k)}g=Date.now()-y,m=Date.now(),p.render(a,T,this.glyph),d.render(a,S,this.glyph),null!=this.hover_glyph&&(this.glyph instanceof P.LineView?this.hover_glyph.render(a,this.model.view.convert_indices_from_subset(f),this.glyph):this.hover_glyph.render(a,f,this.glyph))}else m=Date.now(),this.glyph instanceof P.LineView?this.hover_glyph&&f.length?this.hover_glyph.render(a,this.model.view.convert_indices_from_subset(f),this.glyph):_.render(a,this.all_indices,this.glyph):(_.render(a,o,this.glyph),this.hover_glyph&&f.length&&this.hover_glyph.render(a,f,this.glyph));var O=Date.now()-m;this.last_dtrender=O;var z=Date.now()-t;return j.logger.debug(this.glyph.model.type+\" GlyphRenderer (\"+this.model.id+\"): render finished in \"+z+\"ms\"),j.logger.trace(\" - map_data finished in : \"+i+\"ms\"),j.logger.trace(\" - mask_data finished in : \"+s+\"ms\"),null!=g&&j.logger.trace(\" - selection mask finished in : \"+g+\"ms\"),j.logger.trace(\" - glyph renders finished in : \"+O+\"ms\"),a.restore()}},t.prototype.draw_legend=function(t,e,i,n,r,o,s){var a=this.model.get_reference_point(o,s);this.glyph.draw_legend_for_index(t,{x0:e,x1:i,y0:n,y1:r},a)},t.prototype.hit_test=function(t){if(!this.model.visible)return null;var e=this.glyph.hit_test(t);return null==e?null:this.model.view.convert_selection_from_subset(e)},t}(r.RendererView);i.GlyphRendererView=h;var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GlyphRenderer\",this.prototype.default_view=h,this.define({x_range_name:[s.String,\"default\"],y_range_name:[s.String,\"default\"],data_source:[s.Instance],view:[s.Instance,function(){return new o.CDSView}],glyph:[s.Instance],hover_glyph:[s.Instance],nonselection_glyph:[s.Any,\"auto\"],selection_glyph:[s.Any,\"auto\"],muted_glyph:[s.Instance],muted:[s.Bool,!1]}),this.override({level:\"glyph\"})},t.prototype.initialize=function(){e.prototype.initialize.call(this),null==this.view.source&&(this.view.source=this.data_source,this.view.compute_indices())},t.prototype.get_reference_point=function(t,e){var i=0;if(null!=t){var n=this.data_source.get_column(t);if(null!=n){var r=a.indexOf(n,e);-1!=r&&(i=r)}}return i},t.prototype.get_selection_manager=function(){return this.data_source.selection_manager},t}(r.Renderer);(i.GlyphRenderer=c).initClass()},function(t,e,i){var n=t(387),r=t(179),o=t(142),s=t(15),l=t(4),a=function(a){function t(){return null!==a&&a.apply(this,arguments)||this}return n.__extends(t,a),t.prototype.initialize=function(t){var e;a.prototype.initialize.call(this,t),this.xscale=this.plot_view.frame.xscales.default,this.yscale=this.plot_view.frame.yscales.default,this._renderer_views={},e=l.build_views(this._renderer_views,[this.model.node_renderer,this.model.edge_renderer],this.plot_view.view_options()),this.node_view=e[0],this.edge_view=e[1],this.set_data()},t.prototype.connect_signals=function(){var t=this;a.prototype.connect_signals.call(this),this.connect(this.model.layout_provider.change,function(){return t.set_data()}),this.connect(this.model.node_renderer.data_source._select,function(){return t.set_data()}),this.connect(this.model.node_renderer.data_source.inspect,function(){return t.set_data()}),this.connect(this.model.node_renderer.data_source.change,function(){return t.set_data()}),this.connect(this.model.edge_renderer.data_source._select,function(){return t.set_data()}),this.connect(this.model.edge_renderer.data_source.inspect,function(){return t.set_data()}),this.connect(this.model.edge_renderer.data_source.change,function(){return t.set_data()});var e=this.plot_model.frame,i=e.x_ranges,n=e.y_ranges;for(var r in i){var o=i[r];this.connect(o.change,function(){return t.set_data()})}for(var s in n){var o=n[s];this.connect(o.change,function(){return t.set_data()})}},t.prototype.set_data=function(t){var e,i;void 0===t&&(t=!0),this.node_view.glyph.model.setv({x_range_name:this.model.x_range_name,y_range_name:this.model.y_range_name},{silent:!0}),this.edge_view.glyph.model.setv({x_range_name:this.model.x_range_name,y_range_name:this.model.y_range_name},{silent:!0});var n=this.node_view.glyph;e=this.model.layout_provider.get_node_coordinates(this.model.node_renderer.data_source),n._x=e[0],n._y=e[1];var r=this.edge_view.glyph;i=this.model.layout_provider.get_edge_coordinates(this.model.edge_renderer.data_source),r._xs=i[0],r._ys=i[1],n.index_data(),r.index_data(),t&&this.request_render()},t.prototype.render=function(){this.edge_view.render(),this.node_view.render()},t}(r.RendererView);i.GraphRendererView=a;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GraphRenderer\",this.prototype.default_view=a,this.define({x_range_name:[s.String,\"default\"],y_range_name:[s.String,\"default\"],layout_provider:[s.Instance],node_renderer:[s.Instance],edge_renderer:[s.Instance],selection_policy:[s.Instance,function(){return new o.NodesOnly}],inspection_policy:[s.Instance,function(){return new o.NodesOnly}]}),this.override({level:\"glyph\"})},t.prototype.get_selection_manager=function(){return this.node_renderer.data_source.selection_manager},t}(r.Renderer);(i.GraphRenderer=h).initClass()},function(t,e,i){var n=t(387),r=t(179),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.RendererView);i.GuideRendererView=s;var a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GuideRenderer\",this.define({plot:[o.Instance]}),this.override({level:\"overlay\"})},t}(r.Renderer);(i.GuideRenderer=a).initClass()},function(t,e,i){var n=t(175);i.GlyphRenderer=n.GlyphRenderer;var r=t(176);i.GraphRenderer=r.GraphRenderer;var o=t(177);i.GuideRenderer=o.GuideRenderer;var s=t(179);i.Renderer=s.Renderer},function(t,e,i){var n=t(387),r=t(6),o=t(49),s=t(15),a=t(57),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.plot_view=t.plot_view,this.visuals=new o.Visuals(this.model),this._has_finished=!0},Object.defineProperty(t.prototype,\"plot_model\",{get:function(){return this.plot_view.model},enumerable:!0,configurable:!0}),t.prototype.request_render=function(){this.plot_view.request_render()},t.prototype.map_to_screen=function(t,e){return this.plot_view.map_to_screen(t,e,this.model.x_range_name,this.model.y_range_name)},Object.defineProperty(t.prototype,\"needs_clip\",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(r.DOMView);i.RendererView=l;var h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Renderer\",this.define({level:[s.RenderLevel],visible:[s.Bool,!0]})},t}(a.Model);(i.Renderer=h).initClass()},function(t,e,i){var n=t(387),r=t(182),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CategoricalScale\"},t.prototype.compute=function(t){return e.prototype.compute.call(this,this.source_range.synthetic(t))},t.prototype.v_compute=function(t){return e.prototype.v_compute.call(this,this.source_range.v_synthetic(t))},t}(r.LinearScale);(i.CategoricalScale=o).initClass()},function(t,e,i){var n=t(180);i.CategoricalScale=n.CategoricalScale;var r=t(182);i.LinearScale=r.LinearScale;var o=t(183);i.LogScale=o.LogScale;var s=t(184);i.Scale=s.Scale},function(t,e,i){var n=t(387),r=t(184),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LinearScale\"},t.prototype.compute=function(t){var e=this._compute_state(),i=e[0],n=e[1];return i*t+n},t.prototype.v_compute=function(t){for(var e=this._compute_state(),i=e[0],n=e[1],r=new Float64Array(t.length),o=0;o<t.length;o++)r[o]=i*t[o]+n;return r},t.prototype.invert=function(t){var e=this._compute_state(),i=e[0],n=e[1];return(t-n)/i},t.prototype.v_invert=function(t){for(var e=this._compute_state(),i=e[0],n=e[1],r=new Float64Array(t.length),o=0;o<t.length;o++)r[o]=(t[o]-n)/i;return r},t.prototype._compute_state=function(){var t=this.source_range.start,e=this.source_range.end,i=this.target_range.start,n=this.target_range.end,r=(n-i)/(e-t),o=-r*t+i;return[r,o]},t}(r.Scale);(i.LinearScale=o).initClass()},function(t,e,i){var n=t(387),r=t(184),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LogScale\"},t.prototype.compute=function(t){var e,i=this._compute_state(),n=i[0],r=i[1],o=i[2],s=i[3];if(0==o)e=0;else{var a=(Math.log(t)-s)/o;e=isFinite(a)?a*n+r:NaN}return e},t.prototype.v_compute=function(t){var e=this._compute_state(),i=e[0],n=e[1],r=e[2],o=e[3],s=new Float64Array(t.length);if(0==r)for(var a=0;a<t.length;a++)s[a]=0;else for(var a=0;a<t.length;a++){var l=(Math.log(t[a])-o)/r,h=void 0;h=isFinite(l)?l*i+n:NaN,s[a]=h}return s},t.prototype.invert=function(t){var e=this._compute_state(),i=e[0],n=e[1],r=e[2],o=e[3],s=(t-n)/i;return Math.exp(r*s+o)},t.prototype.v_invert=function(t){for(var e=this._compute_state(),i=e[0],n=e[1],r=e[2],o=e[3],s=new Float64Array(t.length),a=0;a<t.length;a++){var l=(t[a]-n)/i;s[a]=Math.exp(r*l+o)}return s},t.prototype._get_safe_factor=function(t,e){var i,n=t<0?0:t,r=e<0?0:e;if(n==r)if(0==n)n=(i=[1,10])[0],r=i[1];else{var o=Math.log(n)/Math.log(10);n=Math.pow(10,Math.floor(o)),r=Math.ceil(o)!=Math.floor(o)?Math.pow(10,Math.ceil(o)):Math.pow(10,Math.ceil(o)+1)}return[n,r]},t.prototype._compute_state=function(){var t,e,i=this.source_range.start,n=this.source_range.end,r=this.target_range.start,o=this.target_range.end,s=o-r,a=this._get_safe_factor(i,n),l=a[0],h=a[1];0==l?(t=Math.log(h),e=0):(t=Math.log(h)-Math.log(l),e=Math.log(l));var c=s,u=r;return[c,u,t,e]},t}(r.Scale);(i.LogScale=o).initClass()},function(t,e,i){var n=t(387),r=t(261),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Scale\",this.internal({source_range:[o.Any],target_range:[o.Any]})},t.prototype.r_compute=function(t,e){return this.target_range.is_reversed?[this.compute(e),this.compute(t)]:[this.compute(t),this.compute(e)]},t.prototype.r_invert=function(t,e){return this.target_range.is_reversed?[this.invert(e),this.invert(t)]:[this.invert(t),this.invert(e)]},t}(r.Transform);(i.Scale=s).initClass()},function(t,e,i){var n=t(387);n.__exportStar(t(186),i);var r=t(187);i.Selection=r.Selection},function(t,e,i){var n=t(387),r=t(57),o=t(187),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.do_selection=function(t,e,i,n){if(null===t)return!1;e.selected.update(t,i,n);var r=new o.Selection;return r.update(e.selected,i,!1),e.selected=r,e._select.emit(),!e.selected.is_empty()},e}(r.Model);(i.SelectionPolicy=s).prototype.type=\"SelectionPolicy\";var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.hit_test=function(t,e){for(var i=[],n=0,r=e;n<r.length;n++){var o=r[n],s=o.hit_test(t);null!==s&&i.push(s)}if(0<i.length){for(var a=i[0],l=0,h=i;l<h.length;l++){var c=h[l];a.update_through_intersection(c)}return a}return null},e}(s);(i.IntersectRenderers=a).prototype.type=\"IntersectRenderers\";var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.hit_test=function(t,e){for(var i=[],n=0,r=e;n<r.length;n++){var o=r[n],s=o.hit_test(t);null!==s&&i.push(s)}if(0<i.length){for(var a=i[0],l=0,h=i;l<h.length;l++){var c=h[l];a.update_through_union(c)}return a}return null},e}(s);(i.UnionRenderers=l).prototype.type=\"UnionRenderers\"},function(t,e,i){var n=t(387),r=t(57),o=t(15),s=t(21),a=t(32),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Selection\",this.define({indices:[o.Array,[]],line_indices:[o.Array,[]],multiline_indices:[o.Any,{}]}),this.internal({final:[o.Boolean],selected_glyphs:[o.Array,[]],get_view:[o.Any],image_indices:[o.Array,[]]})},t.prototype.initialize=function(){var t=this;e.prototype.initialize.call(this),this[\"0d\"]={glyph:null,indices:[],flag:!1,get_view:function(){return null}},this[\"2d\"]={indices:{}},this[\"1d\"]={indices:this.indices},this.get_view=function(){return null},this.connect(this.properties.indices.change,function(){return t[\"1d\"].indices=t.indices}),this.connect(this.properties.line_indices.change,function(){t[\"0d\"].indices=t.line_indices,0==t.line_indices.length?t[\"0d\"].flag=!1:t[\"0d\"].flag=!0}),this.connect(this.properties.selected_glyphs.change,function(){return t[\"0d\"].glyph=t.selected_glyph}),this.connect(this.properties.get_view.change,function(){return t[\"0d\"].get_view=t.get_view}),this.connect(this.properties.multiline_indices.change,function(){return t[\"2d\"].indices=t.multiline_indices})},Object.defineProperty(t.prototype,\"selected_glyph\",{get:function(){return 0<this.selected_glyphs.length?this.selected_glyphs[0]:null},enumerable:!0,configurable:!0}),t.prototype.add_to_selected_glyphs=function(t){this.selected_glyphs.push(t)},t.prototype.update=function(t,e,i){this.final=e,i?this.update_through_union(t):(this.indices=t.indices,this.line_indices=t.line_indices,this.selected_glyphs=t.selected_glyphs,this.get_view=t.get_view,this.multiline_indices=t.multiline_indices,this.image_indices=t.image_indices)},t.prototype.clear=function(){this.final=!0,this.indices=[],this.line_indices=[],this.multiline_indices={},this.get_view=function(){return null},this.selected_glyphs=[]},t.prototype.is_empty=function(){return 0==this.indices.length&&0==this.line_indices.length&&0==this.image_indices.length},t.prototype.update_through_union=function(t){this.indices=s.union(t.indices,this.indices),this.selected_glyphs=s.union(t.selected_glyphs,this.selected_glyphs),this.line_indices=s.union(t.line_indices,this.line_indices),this.get_view()||(this.get_view=t.get_view),this.multiline_indices=a.merge(t.multiline_indices,this.multiline_indices)},t.prototype.update_through_intersection=function(t){this.indices=s.intersection(t.indices,this.indices),this.selected_glyphs=s.union(t.selected_glyphs,this.selected_glyphs),this.line_indices=s.union(t.line_indices,this.line_indices),this.get_view()||(this.get_view=t.get_view),this.multiline_indices=a.merge(t.multiline_indices,this.multiline_indices)},t}(r.Model);(i.Selection=l).initClass()},function(t,e,i){var n=t(387),r=t(195),o=t(14),s=t(15),a=function(i){function t(t){var e=i.call(this,t)||this;return e.initialized=!1,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"AjaxDataSource\",this.define({mode:[s.String,\"replace\"],content_type:[s.String,\"application/json\"],http_headers:[s.Any,{}],max_size:[s.Number],method:[s.String,\"POST\"],if_modified:[s.Bool,!1]})},t.prototype.destroy=function(){null!=this.interval&&clearInterval(this.interval),i.prototype.destroy.call(this)},t.prototype.setup=function(){var t=this;!this.initialized&&(this.initialized=!0,this.get_data(this.mode),this.polling_interval)&&(this.interval=setInterval(function(){return t.get_data(t.mode,t.max_size,t.if_modified)},this.polling_interval))},t.prototype.get_data=function(t,e,i){var n=this;void 0===e&&(e=0),void 0===i&&(i=!1);var r=this.prepare_request();r.addEventListener(\"load\",function(){return n.do_load(r,t,e)}),r.addEventListener(\"error\",function(){return n.do_error(r)}),r.send()},t.prototype.prepare_request=function(){var t=new XMLHttpRequest;t.open(this.method,this.data_url,!0),t.withCredentials=!1,t.setRequestHeader(\"Content-Type\",this.content_type);var e=this.http_headers;for(var i in e){var n=e[i];t.setRequestHeader(i,n)}return t},t.prototype.do_load=function(t,e,i){if(200===t.status){var n=JSON.parse(t.responseText);switch(e){case\"replace\":this.data=n;break;case\"append\":for(var r=this.data,o=0,s=this.columns();o<s.length;o++){var a=s[o],l=Array.from(r[a]),h=Array.from(n[a]);n[a]=l.concat(h).slice(-i)}this.data=n}}},t.prototype.do_error=function(t){o.logger.error(\"Failed to fetch JSON from \"+this.data_url+\" with code \"+t.status)},t}(r.RemoteDataSource);(i.AjaxDataSource=a).initClass()},function(t,e,i){var n=t(387),r=t(57),o=t(15),s=t(187),a=t(21),l=t(191),h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CDSView\",this.define({filters:[o.Array,[]],source:[o.Instance]}),this.internal({indices:[o.Array,[]],indices_map:[o.Any,{}]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.compute_indices()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.properties.filters.change,function(){t.compute_indices(),t.change.emit()}),null!=this.source&&(null!=this.source.change&&this.connect(this.source.change,function(){return t.compute_indices()}),null!=this.source.streaming&&this.connect(this.source.streaming,function(){return t.compute_indices()}),null!=this.source.patching&&this.connect(this.source.patching,function(){return t.compute_indices()}))},t.prototype.compute_indices=function(){var e=this,r=this.filters.map(function(t){return t.compute_indices(e.source)});0<(r=function(){for(var t=[],e=0,i=r;e<i.length;e++){var n=i[e];null!=n&&t.push(n)}return t}()).length?this.indices=a.intersection.apply(this,r):this.source instanceof l.ColumnarDataSource&&(this.indices=this.source.get_indices()),this.indices_map_to_subset()},t.prototype.indices_map_to_subset=function(){this.indices_map={};for(var t=0;t<this.indices.length;t++)this.indices_map[this.indices[t]]=t},t.prototype.convert_selection_from_subset=function(t){var e=this,i=new s.Selection;i.update_through_union(t);var n=t.indices.map(function(t){return e.indices[t]});return i.indices=n,i.image_indices=t.image_indices,i},t.prototype.convert_selection_to_subset=function(t){var e=this,i=new s.Selection;i.update_through_union(t);var n=t.indices.map(function(t){return e.indices_map[t]});return i.indices=n,i.image_indices=t.image_indices,i},t.prototype.convert_indices_from_subset=function(t){var e=this;return t.map(function(t){return e.indices[t]})},t}(r.Model);(i.CDSView=h).initClass()},function(t,e,i){var n=t(387),r=t(191),o=t(8),s=t(15),k=t(29),h=t(36),S=t(44),c=t(43),u=t(32);function a(t,e,i){if(S.isArray(t)){var n=t.concat(e);return null!=i&&n.length>i?n.slice(-i):n}if(S.isTypedArray(t)){var r=t.length+e.length;if(null!=i&&i<r){var o=r-i,s=t.length,n=void 0;t.length<i?(n=new t.constructor(i)).set(t,0):n=t;for(var a=o,l=s;a<l;a++)n[a-o]=n[a];for(var a=0,l=e.length;a<l;a++)n[a+(s-o)]=e[a];return n}var h=new t.constructor(e);return c.concat(t,h)}throw new Error(\"unsupported array types\")}function T(t,e){var i,n,r;return S.isNumber(t)?(r=(i=t)+1,n=1):(i=null!=t.start?t.start:0,r=null!=t.stop?t.stop:e,n=null!=t.step?t.step:1),[i,r,n]}function _(t,e,i){for(var n=new k.Set,r=!1,o=0,s=e;o<s.length;o++){var a=s[o],l=a[0],h=a[1],c=void 0,u=void 0;if(S.isArray(l)){var _=l[0];n.push(_),u=i[_],c=t[_]}else S.isNumber(l)?(h=[h],n.push(l)):r=!0,l=[0,0,l],u=[1,t.length],c=t;2===l.length&&(u=[1,u[0]],l=[l[0],0,l[1]]);for(var p=0,d=T(l[1],u[0]),f=d[0],v=d[1],m=d[2],g=T(l[2],u[1]),y=g[0],b=g[1],x=g[2],_=f;_<v;_+=m)for(var w=y;w<b;w+=x)r&&n.push(w),c[_*u[1]+w]=h[p],p++}return n}i.stream_to_column=a,i.slice=T,i.patch_to_column=_;var l=function(e){function l(t){return e.call(this,t)||this}return n.__extends(l,e),l.initClass=function(){this.prototype.type=\"ColumnDataSource\",this.define({data:[s.Any,{}]})},l.prototype.initialize=function(){var t;e.prototype.initialize.call(this),t=h.decode_column_data(this.data),this.data=t[0],this._shapes=t[1]},l.prototype.attributes_as_json=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=l._value_to_json);for(var i={},n=this.serializable_attributes(),r=0,o=u.keys(n);r<o.length;r++){var s=o[r],a=n[s];\"data\"===s&&(a=h.encode_column_data(a,this._shapes)),t?i[s]=a:s in this._set_after_defaults&&(i[s]=a)}return e(\"attributes\",i,this)},l._value_to_json=function(t,e,i){return S.isObject(e)&&\"data\"===t?h.encode_column_data(e,i._shapes):o.HasProps._value_to_json(t,e,i)},l.prototype.stream=function(t,e){var i=this.data;for(var n in t)i[n]=a(i[n],t[n],e);this.setv({data:i},{silent:!0}),this.streaming.emit()},l.prototype.patch=function(t){var e=this.data,i=new k.Set;for(var n in t){var r=t[n];i=i.union(_(e[n],r,this._shapes[n]))}this.setv({data:e},{silent:!0}),this.patching.emit(i.values)},l}(r.ColumnarDataSource);(i.ColumnDataSource=l).initClass()},function(t,e,i){var n=t(387),r=t(192),o=t(19),s=t(14),a=t(17),l=t(15),h=t(44),c=t(21),u=t(32),_=t(187),p=t(186),d=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),Object.defineProperty(t.prototype,\"column_names\",{get:function(){return u.keys(this.data)},enumerable:!0,configurable:!0}),t.prototype.get_array=function(t){var e=this.data[t];return null==e?this.data[t]=e=[]:h.isArray(e)||(this.data[t]=e=Array.from(e)),e},t.initClass=function(){this.prototype.type=\"ColumnarDataSource\",this.define({selection_policy:[l.Instance,function(){return new p.UnionRenderers}]}),this.internal({selection_manager:[l.Instance,function(t){return new a.SelectionManager({source:t})}],inspected:[l.Instance,function(){return new _.Selection}],_shapes:[l.Any,{}]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._select=new o.Signal0(this,\"select\"),this.inspect=new o.Signal(this,\"inspect\"),this.streaming=new o.Signal0(this,\"streaming\"),this.patching=new o.Signal(this,\"patching\")},t.prototype.get_column=function(t){var e=this.data[t];return null!=e?e:null},t.prototype.columns=function(){return u.keys(this.data)},t.prototype.get_length=function(t){void 0===t&&(t=!0);var e=c.uniq(u.values(this.data).map(function(t){return t.length}));switch(e.length){case 0:return null;case 1:return e[0];default:var i=\"data source has columns of inconsistent lengths\";if(t)return s.logger.warn(i),e.sort()[0];throw new Error(i)}},t.prototype.get_indices=function(){var t=this.get_length();return c.range(0,null!=t?t:1)},t}(r.DataSource);(i.ColumnarDataSource=d).initClass()},function(t,e,i){var n=t(387),r=t(57),o=t(15),s=t(44),a=t(187),l=function(i){function t(t){return i.call(this,t)||this}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"DataSource\",this.define({selected:[o.Instance,function(){return new a.Selection}],callback:[o.Any]})},t.prototype.connect_signals=function(){var e=this;i.prototype.connect_signals.call(this),this.connect(this.properties.selected.change,function(){var t=e.callback;null!=t&&(s.isFunction(t)?t(e):t.execute(e))})},t}(r.Model);(i.DataSource=l).initClass()},function(t,e,i){var n=t(387),r=t(191),b=t(14),o=t(15),s=t(21),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"GeoJSONDataSource\",this.define({geojson:[o.Any]}),this.internal({data:[o.Any,{}]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._update_data()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.properties.geojson.change,function(){return t._update_data()})},t.prototype._update_data=function(){this.data=this.geojson_to_column_data()},t.prototype._get_new_list_array=function(t){return s.range(0,t).map(function(t){return[]})},t.prototype._get_new_nan_array=function(t){return s.range(0,t).map(function(t){return NaN})},t.prototype._add_properties=function(t,e,i,n){var r=t.properties||{};for(var o in r)e.hasOwnProperty(o)||(e[o]=this._get_new_nan_array(n)),e[o][i]=r[o]},t.prototype._add_geometry=function(t,e,i){function n(t){return null!=t?t:NaN}function r(t,e){return t.concat([[NaN,NaN,NaN]]).concat(e)}switch(t.type){case\"Point\":var o=t.coordinates,s=o[0],a=o[1],l=o[2];e.x[i]=s,e.y[i]=a,e.z[i]=n(l);break;case\"LineString\":for(var h=t.coordinates,c=0;c<h.length;c++){var u=h[c],s=u[0],a=u[1],l=u[2];e.xs[i][c]=s,e.ys[i][c]=a,e.zs[i][c]=n(l)}break;case\"Polygon\":1<t.coordinates.length&&b.logger.warn(\"Bokeh does not support Polygons with holes in, only exterior ring used.\");for(var _=t.coordinates[0],c=0;c<_.length;c++){var p=_[c],s=p[0],a=p[1],l=p[2];e.xs[i][c]=s,e.ys[i][c]=a,e.zs[i][c]=n(l)}break;case\"MultiPoint\":b.logger.warn(\"MultiPoint not supported in Bokeh\");break;case\"MultiLineString\":for(var h=t.coordinates.reduce(r),c=0;c<h.length;c++){var d=h[c],s=d[0],a=d[1],l=d[2];e.xs[i][c]=s,e.ys[i][c]=a,e.zs[i][c]=n(l)}break;case\"MultiPolygon\":for(var f=[],v=0,m=t.coordinates;v<m.length;v++){var g=m[v];1<g.length&&b.logger.warn(\"Bokeh does not support Polygons with holes in, only exterior ring used.\"),f.push(g[0])}for(var h=f.reduce(r),c=0;c<h.length;c++){var y=h[c],s=y[0],a=y[1],l=y[2];e.xs[i][c]=s,e.ys[i][c]=a,e.zs[i][c]=n(l)}break;default:throw new Error(\"Invalid GeoJSON geometry type: \"+t.type)}},t.prototype.geojson_to_column_data=function(){var t,e=JSON.parse(this.geojson);switch(e.type){case\"GeometryCollection\":if(null==e.geometries)throw new Error(\"No geometries found in GeometryCollection\");if(0===e.geometries.length)throw new Error(\"geojson.geometries must have one or more items\");t=e.geometries;break;case\"FeatureCollection\":if(null==e.features)throw new Error(\"No features found in FeaturesCollection\");if(0==e.features.length)throw new Error(\"geojson.features must have one or more items\");t=e.features;break;default:throw new Error(\"Bokeh only supports type GeometryCollection and FeatureCollection at top level\")}for(var i=0,n=0,r=t;n<r.length;n++){var o=r[n],s=\"Feature\"===o.type?o.geometry:o;\"GeometryCollection\"==s.type?i+=s.geometries.length:i+=1}for(var a={x:this._get_new_nan_array(i),y:this._get_new_nan_array(i),z:this._get_new_nan_array(i),xs:this._get_new_list_array(i),ys:this._get_new_list_array(i),zs:this._get_new_list_array(i)},l=0,h=0,c=t;h<c.length;h++){var o=c[h],s=\"Feature\"==o.type?o.geometry:o;if(\"GeometryCollection\"==s.type)for(var u=0,_=s.geometries;u<_.length;u++){var p=_[u];this._add_geometry(p,a,l),\"Feature\"===o.type&&this._add_properties(o,a,l,i),l+=1}else this._add_geometry(s,a,l),\"Feature\"===o.type&&this._add_properties(o,a,l,i),l+=1}return a},t}(r.ColumnarDataSource);(i.GeoJSONDataSource=a).initClass()},function(t,e,i){var n=t(188);i.AjaxDataSource=n.AjaxDataSource;var r=t(190);i.ColumnDataSource=r.ColumnDataSource;var o=t(191);i.ColumnarDataSource=o.ColumnarDataSource;var s=t(189);i.CDSView=s.CDSView;var a=t(192);i.DataSource=a.DataSource;var l=t(193);i.GeoJSONDataSource=l.GeoJSONDataSource;var h=t(195);i.RemoteDataSource=h.RemoteDataSource},function(t,e,i){var n=t(387),r=t(190),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.get_column=function(t){var e=this.data[t];return null!=e?e:[]},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.setup()},t.initClass=function(){this.prototype.type=\"RemoteDataSource\",this.define({data_url:[o.String],polling_interval:[o.Number]})},t}(r.ColumnDataSource);(i.RemoteDataSource=s).initClass()},function(t,e,i){var n=t(387),r=t(200),o=t(15),v=t(21),s=function(i){function t(t){return i.call(this,t)||this}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"AdaptiveTicker\",this.define({base:[o.Number,10],mantissas:[o.Array,[1,2,5]],min_interval:[o.Number,0],max_interval:[o.Number]})},t.prototype.initialize=function(){i.prototype.initialize.call(this);var t=v.nth(this.mantissas,-1)/this.base,e=v.nth(this.mantissas,0)*this.base;this.extended_mantissas=[t].concat(this.mantissas,[e]),this.base_factor=0===this.get_min_interval()?1:this.get_min_interval()},t.prototype.get_interval=function(t,e,i){var n,r,o,s,a,l=e-t,h=this.get_ideal_interval(t,e,i),c=Math.floor((s=h/this.base_factor,void 0===(a=this.base)&&(a=Math.E),Math.log(s)/Math.log(a))),u=Math.pow(this.base,c)*this.base_factor,_=this.extended_mantissas,p=_.map(function(t){return Math.abs(i-l/(t*u))}),d=_[v.argmin(p)],f=d*u;return n=f,r=this.get_min_interval(),o=this.get_max_interval(),Math.max(r,Math.min(o,n))},t}(r.ContinuousTicker);(i.AdaptiveTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(196),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"BasicTicker\"},t}(r.AdaptiveTicker);(i.BasicTicker=o).initClass()},function(t,e,i){var n=t(387),r=t(209),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CategoricalTicker\"},t.prototype.get_ticks=function(t,e,i,n,r){var o=this._collect(i.factors,i,t,e),s=this._collect(i.tops||[],i,t,e),a=this._collect(i.mids||[],i,t,e);return{major:o,minor:[],tops:s,mids:a}},t.prototype._collect=function(t,e,i,n){for(var r=[],o=0,s=t;o<s.length;o++){var a=s[o],l=e.synthetic(a);i<l&&l<n&&r.push(a)}return r},t}(r.Ticker);(i.CategoricalTicker=o).initClass()},function(t,e,i){var n=t(387),r=t(200),o=t(15),u=t(21),_=t(32),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CompositeTicker\",this.define({tickers:[o.Array,[]]})},Object.defineProperty(t.prototype,\"min_intervals\",{get:function(){return this.tickers.map(function(t){return t.get_min_interval()})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"max_intervals\",{get:function(){return this.tickers.map(function(t){return t.get_max_interval()})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"min_interval\",{get:function(){return this.min_intervals[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"max_interval\",{get:function(){return this.max_intervals[0]},enumerable:!0,configurable:!0}),t.prototype.get_best_ticker=function(t,e,i){var n,r=e-t,o=this.get_ideal_interval(t,e,i),s=[u.sortedIndex(this.min_intervals,o)-1,u.sortedIndex(this.max_intervals,o)],a=[this.min_intervals[s[0]],this.max_intervals[s[1]]],l=a.map(function(t){return Math.abs(i-r/t)});if(_.isEmpty(l.filter(function(t){return!isNaN(t)})))n=this.tickers[0];else{var h=u.argmin(l),c=s[h];n=this.tickers[c]}return n},t.prototype.get_interval=function(t,e,i){var n=this.get_best_ticker(t,e,i);return n.get_interval(t,e,i)},t.prototype.get_ticks_no_defaults=function(t,e,i,n){var r=this.get_best_ticker(t,e,n);return r.get_ticks_no_defaults(t,e,i,n)},t}(r.ContinuousTicker);(i.CompositeTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(209),o=t(15),x=t(21),w=t(44),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ContinuousTicker\",this.define({num_minor_ticks:[o.Number,5],desired_num_ticks:[o.Number,6]})},t.prototype.get_ticks=function(t,e,i,n,r){return this.get_ticks_no_defaults(t,e,n,this.desired_num_ticks)},t.prototype.get_ticks_no_defaults=function(e,i,t,n){var r=this.get_interval(e,i,n),o=Math.floor(e/r),s=Math.ceil(i/r),a=(w.isStrictNaN(o)||w.isStrictNaN(s)?[]:x.range(o,s+1)).map(function(t){return t*r}).filter(function(t){return e<=t&&t<=i}),l=this.num_minor_ticks,h=[];if(0<l&&0<a.length){for(var c=r/l,u=x.range(0,l).map(function(t){return t*c}),_=0,p=u.slice(1);_<p.length;_++){var d=p[_],f=a[0]-d;e<=f&&f<=i&&h.push(f)}for(var v=0,m=a;v<m.length;v++)for(var g=m[v],y=0,b=u;y<b.length;y++){var d=b[y],f=g+d;e<=f&&f<=i&&h.push(f)}}return{major:a,minor:h}},t.prototype.get_min_interval=function(){return this.min_interval},t.prototype.get_max_interval=function(){return null!=this.max_interval?this.max_interval:1/0},t.prototype.get_ideal_interval=function(t,e,i){var n=e-t;return n/i},t}(r.Ticker);(i.ContinuousTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(21),o=t(196),s=t(199),a=t(202),l=t(207),h=t(211),c=t(210),u=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"DatetimeTicker\",this.override({num_minor_ticks:0,tickers:function(){return[new o.AdaptiveTicker({mantissas:[1,2,5],base:10,min_interval:0,max_interval:500*c.ONE_MILLI,num_minor_ticks:0}),new o.AdaptiveTicker({mantissas:[1,2,5,10,15,20,30],base:60,min_interval:c.ONE_SECOND,max_interval:30*c.ONE_MINUTE,num_minor_ticks:0}),new o.AdaptiveTicker({mantissas:[1,2,4,6,8,12],base:24,min_interval:c.ONE_HOUR,max_interval:12*c.ONE_HOUR,num_minor_ticks:0}),new a.DaysTicker({days:r.range(1,32)}),new a.DaysTicker({days:r.range(1,31,3)}),new a.DaysTicker({days:[1,8,15,22]}),new a.DaysTicker({days:[1,15]}),new l.MonthsTicker({months:r.range(0,12,1)}),new l.MonthsTicker({months:r.range(0,12,2)}),new l.MonthsTicker({months:r.range(0,12,4)}),new l.MonthsTicker({months:r.range(0,12,6)}),new h.YearsTicker({})]}})},t}(s.CompositeTicker);(i.DatetimeTicker=u).initClass()},function(t,e,i){var n=t(387),r=t(208),c=t(210),o=t(15),u=t(21),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"DaysTicker\",this.define({days:[o.Array,[]]}),this.override({num_minor_ticks:0})},t.prototype.initialize=function(){e.prototype.initialize.call(this);var t=this.days;1<t.length?this.interval=(t[1]-t[0])*c.ONE_DAY:this.interval=31*c.ONE_DAY},t.prototype.get_ticks_no_defaults=function(e,i,t,n){var r=function(t,e){var i=c.last_month_no_later_than(new Date(t)),n=c.last_month_no_later_than(new Date(e));n.setUTCMonth(n.getUTCMonth()+1);for(var r=[],o=i;r.push(c.copy_date(o)),o.setUTCMonth(o.getUTCMonth()+1),!(n<o););return r}(e,i),l=this.days,o=this.interval,s=u.concat(r.map(function(t){return function(t,e){for(var i=[],n=0,r=l;n<r.length;n++){var o=r[n],s=c.copy_date(t);s.setUTCDate(o);var a=new Date(s.getTime()+e/2);a.getUTCMonth()==t.getUTCMonth()&&i.push(s)}return i}(t,o)})),a=s.map(function(t){return t.getTime()}),h=a.filter(function(t){return e<=t&&t<=i});return{major:h,minor:[]}},t}(r.SingleIntervalTicker);(i.DaysTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(200),o=t(15),s=function(i){function t(t){var e=i.call(this,t)||this;return e.min_interval=0,e.max_interval=0,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"FixedTicker\",this.define({ticks:[o.Array,[]]})},t.prototype.get_ticks_no_defaults=function(t,e,i,n){return{major:this.ticks,minor:[]}},t.prototype.get_interval=function(t,e,i){return 0},t}(r.ContinuousTicker);(i.FixedTicker=s).initClass()},function(t,e,i){var n=t(196);i.AdaptiveTicker=n.AdaptiveTicker;var r=t(197);i.BasicTicker=r.BasicTicker;var o=t(198);i.CategoricalTicker=o.CategoricalTicker;var s=t(199);i.CompositeTicker=s.CompositeTicker;var a=t(200);i.ContinuousTicker=a.ContinuousTicker;var l=t(201);i.DatetimeTicker=l.DatetimeTicker;var h=t(202);i.DaysTicker=h.DaysTicker;var c=t(203);i.FixedTicker=c.FixedTicker;var u=t(205);i.LogTicker=u.LogTicker;var _=t(206);i.MercatorTicker=_.MercatorTicker;var p=t(207);i.MonthsTicker=p.MonthsTicker;var d=t(208);i.SingleIntervalTicker=d.SingleIntervalTicker;var f=t(209);i.Ticker=f.Ticker;var v=t(211);i.YearsTicker=v.YearsTicker},function(t,e,i){var n=t(387),r=t(196),N=t(21),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LogTicker\",this.override({mantissas:[1,5]})},t.prototype.get_ticks_no_defaults=function(e,i,t,n){var r,o=this.num_minor_ticks,s=[],a=this.base,l=Math.log(e)/Math.log(a),h=Math.log(i)/Math.log(a),c=h-l;if(isFinite(c))if(c<2){var u=this.get_interval(e,i,n),_=Math.floor(e/u),p=Math.ceil(i/u);if(r=N.range(_,p+1).filter(function(t){return 0!=t}).map(function(t){return t*u}).filter(function(t){return e<=t&&t<=i}),0<o&&0<r.length){for(var d=u/o,f=N.range(0,o).map(function(t){return t*d}),v=0,m=f.slice(1);v<m.length;v++){var g=m[v];s.push(r[0]-g)}for(var y=0,b=r;y<b.length;y++)for(var x=b[y],w=0,k=f;w<k.length;w++){var g=k[w];s.push(x+g)}}}else{var S=Math.ceil(.999999*l),T=Math.floor(1.000001*h),C=Math.ceil((T-S)/9);if(r=N.range(S,T+1,C).map(function(t){return Math.pow(a,t)}).filter(function(t){return e<=t&&t<=i}),0<o&&0<r.length){for(var A=Math.pow(a,C)/o,f=N.range(1,o+1).map(function(t){return t*A}),E=0,M=f;E<M.length;E++){var g=M[E];s.push(r[0]/g)}s.push(r[0]);for(var O=0,z=r;O<z.length;O++)for(var x=z[O],P=0,j=f;P<j.length;P++){var g=j[P];s.push(x*g)}}}else r=[];return{major:r,minor:s}},t}(r.AdaptiveTicker);(i.LogTicker=o).initClass()},function(t,e,i){var n=t(387),r=t(197),o=t(15),M=t(33),s=function(E){function t(t){return E.call(this,t)||this}return n.__extends(t,E),t.initClass=function(){this.prototype.type=\"MercatorTicker\",this.define({dimension:[o.LatLon]})},t.prototype.get_ticks_no_defaults=function(t,e,i,n){var r,o,s,a,l,h,c,u;if(null==this.dimension)throw new Error(\"MercatorTicker.dimension not configured\");r=M.clip_mercator(t,e,this.dimension),t=r[0],e=r[1],\"lon\"===this.dimension?(o=M.wgs84_mercator.inverse([t,i]),h=o[0],u=o[1],s=M.wgs84_mercator.inverse([e,i]),c=s[0],u=s[1]):(a=M.wgs84_mercator.inverse([i,t]),u=a[0],h=a[1],l=M.wgs84_mercator.inverse([i,e]),u=l[0],c=l[1]);var _=E.prototype.get_ticks_no_defaults.call(this,h,c,i,n),p=[],d=[];if(\"lon\"===this.dimension){for(var f=0,v=_.major;f<v.length;f++){var m=v[f];if(M.in_bounds(m,\"lon\")){var g=M.wgs84_mercator.forward([m,u])[0];p.push(g)}}for(var y=0,b=_.minor;y<b.length;y++){var m=b[y];if(M.in_bounds(m,\"lon\")){var g=M.wgs84_mercator.forward([m,u])[0];d.push(g)}}}else{for(var x=0,w=_.major;x<w.length;x++){var m=w[x];if(M.in_bounds(m,\"lat\")){var k=M.wgs84_mercator.forward([u,m]),S=k[1];p.push(S)}}for(var T=0,C=_.minor;T<C.length;T++){var m=C[T];if(M.in_bounds(m,\"lat\")){var A=M.wgs84_mercator.forward([u,m]),S=A[1];d.push(S)}}}return{major:p,minor:d}},t}(r.BasicTicker);(i.MercatorTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(208),h=t(210),o=t(15),c=t(21),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"MonthsTicker\",this.define({months:[o.Array,[]]})},t.prototype.initialize=function(){e.prototype.initialize.call(this);var t=this.months;1<t.length?this.interval=(t[1]-t[0])*h.ONE_MONTH:this.interval=12*h.ONE_MONTH},t.prototype.get_ticks_no_defaults=function(e,i,t,n){var r=function(t,e){var i=h.last_year_no_later_than(new Date(t)),n=h.last_year_no_later_than(new Date(e));n.setUTCFullYear(n.getUTCFullYear()+1);for(var r=[],o=i;r.push(h.copy_date(o)),o.setUTCFullYear(o.getUTCFullYear()+1),!(n<o););return r}(e,i),o=this.months,s=c.concat(r.map(function(i){return o.map(function(t){var e=h.copy_date(i);return e.setUTCMonth(t),e})})),a=s.map(function(t){return t.getTime()}),l=a.filter(function(t){return e<=t&&t<=i});return{major:l,minor:[]}},t}(r.SingleIntervalTicker);(i.MonthsTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(200),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"SingleIntervalTicker\",this.define({interval:[o.Number]})},t.prototype.get_interval=function(t,e,i){return this.interval},Object.defineProperty(t.prototype,\"min_interval\",{get:function(){return this.interval},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"max_interval\",{get:function(){return this.interval},enumerable:!0,configurable:!0}),t}(r.ContinuousTicker);(i.SingleIntervalTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(57),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Ticker\"},t}(r.Model);(i.Ticker=o).initClass()},function(t,e,i){function n(t){return new Date(t.getTime())}function r(t){var e=n(t);return e.setUTCDate(1),e.setUTCHours(0),e.setUTCMinutes(0),e.setUTCSeconds(0),e.setUTCMilliseconds(0),e}i.ONE_MILLI=1,i.ONE_SECOND=1e3,i.ONE_MINUTE=60*i.ONE_SECOND,i.ONE_HOUR=60*i.ONE_MINUTE,i.ONE_DAY=24*i.ONE_HOUR,i.ONE_MONTH=30*i.ONE_DAY,i.ONE_YEAR=365*i.ONE_DAY,i.copy_date=n,i.last_month_no_later_than=r,i.last_year_no_later_than=function(t){var e=r(t);return e.setUTCMonth(0),e}},function(t,e,i){var n=t(387),r=t(197),o=t(208),h=t(210),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"YearsTicker\"},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.interval=h.ONE_YEAR,this.basic_ticker=new r.BasicTicker({num_minor_ticks:0})},t.prototype.get_ticks_no_defaults=function(e,i,t,n){var r=h.last_year_no_later_than(new Date(e)).getUTCFullYear(),o=h.last_year_no_later_than(new Date(i)).getUTCFullYear(),s=this.basic_ticker.get_ticks_no_defaults(r,o,t,n).major,a=s.map(function(t){return Date.UTC(t,0,1)}),l=a.filter(function(t){return e<=t&&t<=i});return{major:l,minor:[]}},t}(o.SingleIntervalTicker);(i.YearsTicker=s).initClass()},function(t,e,i){var n=t(387),r=t(215),o=t(15),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"BBoxTileSource\",this.define({use_latlon:[o.Bool,!1]})},t.prototype.get_image_url=function(t,e,i){var n,r,o,s,a,l,h=this.string_lookup_replace(this.url,this.extra_url_vars);return this.use_latlon?(n=this.get_tile_geographic_bounds(t,e,i),s=n[0],l=n[1],o=n[2],a=n[3]):(r=this.get_tile_meter_bounds(t,e,i),s=r[0],l=r[1],o=r[2],a=r[3]),h.replace(\"{XMIN}\",s.toString()).replace(\"{YMIN}\",l.toString()).replace(\"{XMAX}\",o.toString()).replace(\"{YMAX}\",a.toString())},t}(r.MercatorTileSource);(i.BBoxTileSource=s).initClass()},function(t,e,i){var n=t(44),r=function(){function t(){this.images=[]}return t.prototype.pop=function(){var t=this.images.pop();return null!=t?t:new Image},t.prototype.push=function(t){var e;50<this.images.length||(n.isArray(t)?(e=this.images).push.apply(e,t):this.images.push(t))},t}();i.ImagePool=r},function(t,e,i){var n=t(212);i.BBoxTileSource=n.BBoxTileSource;var r=t(215);i.MercatorTileSource=r.MercatorTileSource;var o=t(216);i.QUADKEYTileSource=o.QUADKEYTileSource;var s=t(217);i.TileRenderer=s.TileRenderer;var a=t(218);i.TileSource=a.TileSource;var l=t(220);i.TMSTileSource=l.TMSTileSource;var h=t(221);i.WMTSTileSource=h.WMTSTileSource},function(t,e,i){var n=t(387),r=t(218),o=t(15),s=t(21),h=t(219),a=function(i){function t(t){return i.call(this,t)||this}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"MercatorTileSource\",this.define({snap_to_zoom:[o.Bool,!1],wrap_around:[o.Bool,!0]}),this.override({x_origin_offset:20037508.34,y_origin_offset:20037508.34,initial_resolution:156543.03392804097})},t.prototype.initialize=function(){var e=this;i.prototype.initialize.call(this),this._resolutions=s.range(this.min_zoom,this.max_zoom+1).map(function(t){return e.get_resolution(t)})},t.prototype._computed_initial_resolution=function(){return null!=this.initial_resolution?this.initial_resolution:2*Math.PI*6378137/this.tile_size},t.prototype.is_valid_tile=function(t,e,i){return!(!this.wrap_around&&(t<0||t>=Math.pow(2,i))||e<0||e>=Math.pow(2,i))},t.prototype.parent_by_tile_xyz=function(t,e,i){var n=this.tile_xyz_to_quadkey(t,e,i),r=n.substring(0,n.length-1);return this.quadkey_to_tile_xyz(r)},t.prototype.get_resolution=function(t){return this._computed_initial_resolution()/Math.pow(2,t)},t.prototype.get_resolution_by_extent=function(t,e,i){var n=(t[2]-t[0])/i,r=(t[3]-t[1])/e;return[n,r]},t.prototype.get_level_by_extent=function(t,e,i){for(var n=(t[2]-t[0])/i,r=(t[3]-t[1])/e,o=Math.max(n,r),s=0,a=0,l=this._resolutions;a<l.length;a++){var h=l[a];if(h<o){if(0==s)return 0;if(0<s)return s-1}s+=1}return s-1},t.prototype.get_closest_level_by_extent=function(t,e,i){var n=(t[2]-t[0])/i,r=(t[3]-t[1])/e,o=Math.max(n,r),s=this._resolutions.reduce(function(t,e){return Math.abs(e-o)<Math.abs(t-o)?e:t});return this._resolutions.indexOf(s)},t.prototype.snap_to_zoom_level=function(t,e,i,n){var r=t[0],o=t[1],s=t[2],a=t[3],l=this._resolutions[n],h=i*l,c=e*l;if(!this.snap_to_zoom){var u=(s-r)/h,_=(a-o)/c;_<u?(h=s-r,c*=u):(h*=_,c=a-o)}var p=(h-(s-r))/2,d=(c-(a-o))/2;return[r-p,o-d,s+p,a+d]},t.prototype.tms_to_wmts=function(t,e,i){\"Note this works both ways\";return[t,Math.pow(2,i)-1-e,i]},t.prototype.wmts_to_tms=function(t,e,i){\"Note this works both ways\";return[t,Math.pow(2,i)-1-e,i]},t.prototype.pixels_to_meters=function(t,e,i){var n=this.get_resolution(i),r=t*n-this.x_origin_offset,o=e*n-this.y_origin_offset;return[r,o]},t.prototype.meters_to_pixels=function(t,e,i){var n=this.get_resolution(i),r=(t+this.x_origin_offset)/n,o=(e+this.y_origin_offset)/n;return[r,o]},t.prototype.pixels_to_tile=function(t,e){var i=Math.ceil(t/this.tile_size);i=0===i?i:i-1;var n=Math.max(Math.ceil(e/this.tile_size)-1,0);return[i,n]},t.prototype.pixels_to_raster=function(t,e,i){var n=this.tile_size<<i;return[t,n-e]},t.prototype.meters_to_tile=function(t,e,i){var n=this.meters_to_pixels(t,e,i),r=n[0],o=n[1];return this.pixels_to_tile(r,o)},t.prototype.get_tile_meter_bounds=function(t,e,i){var n=this.pixels_to_meters(t*this.tile_size,e*this.tile_size,i),r=n[0],o=n[1],s=this.pixels_to_meters((t+1)*this.tile_size,(e+1)*this.tile_size,i),a=s[0],l=s[1];return[r,o,a,l]},t.prototype.get_tile_geographic_bounds=function(t,e,i){var n=this.get_tile_meter_bounds(t,e,i),r=h.meters_extent_to_geographic(n),o=r[0],s=r[1],a=r[2],l=r[3];return[o,s,a,l]},t.prototype.get_tiles_by_extent=function(t,e,i){void 0===i&&(i=1);var n=t[0],r=t[1],o=t[2],s=t[3],a=this.meters_to_tile(n,r,e),l=a[0],h=a[1],c=this.meters_to_tile(o,s,e),u=c[0],_=c[1];l-=i,h-=i,u+=i;for(var p=[],d=_+=i;h<=d;d--)for(var f=l;f<=u;f++)this.is_valid_tile(f,d,e)&&p.push([f,d,e,this.get_tile_meter_bounds(f,d,e)]);return this.sort_tiles_from_center(p,[l,h,u,_]),p},t.prototype.quadkey_to_tile_xyz=function(t){for(var e=0,i=0,n=t.length,r=n;0<r;r--){var o=t.charAt(n-r),s=1<<r-1;switch(o){case\"0\":continue;case\"1\":e|=s;break;case\"2\":i|=s;break;case\"3\":e|=s,i|=s;break;default:throw new TypeError(\"Invalid Quadkey: \"+t)}}return[e,i,n]},t.prototype.tile_xyz_to_quadkey=function(t,e,i){for(var n=\"\",r=i;0<r;r--){var o=1<<r-1,s=0;0!=(t&o)&&(s+=1),0!=(e&o)&&(s+=2),n+=s.toString()}return n},t.prototype.children_by_tile_xyz=function(t,e,i){for(var n=this.tile_xyz_to_quadkey(t,e,i),r=[],o=0;o<=3;o++){var s=this.quadkey_to_tile_xyz(n+o.toString()),a=s[0],l=s[1],h=s[2],c=this.get_tile_meter_bounds(a,l,h);r.push([a,l,h,c])}return r},t.prototype.get_closest_parent_by_tile_xyz=function(t,e,i){var n,r,o,s=this.calculate_world_x_by_tile_xyz(t,e,i);n=this.normalize_xyz(t,e,i),t=n[0],e=n[1],i=n[2];for(var a=this.tile_xyz_to_quadkey(t,e,i);0<a.length;)if(a=a.substring(0,a.length-1),r=this.quadkey_to_tile_xyz(a),t=r[0],e=r[1],i=r[2],o=this.denormalize_xyz(t,e,i,s),t=o[0],e=o[1],i=o[2],this.tile_xyz_to_key(t,e,i)in this.tiles)return[t,e,i];return[0,0,0]},t.prototype.normalize_xyz=function(t,e,i){if(this.wrap_around){var n=Math.pow(2,i);return[(t%n+n)%n,e,i]}return[t,e,i]},t.prototype.denormalize_xyz=function(t,e,i,n){return[t+n*Math.pow(2,i),e,i]},t.prototype.denormalize_meters=function(t,e,i,n){return[t+2*n*Math.PI*6378137,e]},t.prototype.calculate_world_x_by_tile_xyz=function(t,e,i){return Math.floor(t/Math.pow(2,i))},t}(r.TileSource);(i.MercatorTileSource=a).initClass()},function(t,e,i){var n=t(387),r=t(215),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"QUADKEYTileSource\"},t.prototype.get_image_url=function(t,e,i){var n=this.string_lookup_replace(this.url,this.extra_url_vars),r=this.tms_to_wmts(t,e,i),o=r[0],s=r[1],a=r[2],l=this.tile_xyz_to_quadkey(o,s,a);return n.replace(\"{Q}\",l)},t}(r.MercatorTileSource);(i.QUADKEYTileSource=o).initClass()},function(t,e,i){var r=t(387),o=t(213),n=t(221),s=t(179),a=t(174),l=t(5),h=t(15),I=t(21),c=t(44),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r.__extends(t,n),t.prototype.initialize=function(t){this.attributionEl=null,this._tiles=[],n.prototype.initialize.call(this,t)},t.prototype.connect_signals=function(){var t=this;n.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.request_render()})},t.prototype.get_extent=function(){return[this.x_range.start,this.y_range.start,this.x_range.end,this.y_range.end]},Object.defineProperty(t.prototype,\"map_plot\",{get:function(){return this.plot_model.plot},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"map_canvas\",{get:function(){return this.plot_view.canvas_view.ctx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"map_frame\",{get:function(){return this.plot_model.frame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"x_range\",{get:function(){return this.map_plot.x_range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"y_range\",{get:function(){return this.map_plot.y_range},enumerable:!0,configurable:!0}),t.prototype._set_data=function(){this.pool=new o.ImagePool,this.extent=this.get_extent(),this._last_height=void 0,this._last_width=void 0},t.prototype._add_attribution=function(){var t=this.model.tile_source.attribution;if(c.isString(t)&&0<t.length){if(null==this.attributionEl){var e=this.plot_model.canvas._right.value-this.plot_model.frame._right.value,i=this.plot_model.canvas._bottom.value-this.plot_model.frame._bottom.value,n=this.map_frame._width.value;this.attributionEl=l.div({class:\"bk-tile-attribution\",style:{position:\"absolute\",bottom:i+\"px\",right:e+\"px\",\"max-width\":n-4+\"px\",padding:\"2px\",\"background-color\":\"rgba(255,255,255,0.5)\",\"font-size\":\"7pt\",\"font-family\":\"sans-serif\",\"line-height\":\"1.05\",\"white-space\":\"nowrap\",overflow:\"hidden\",\"text-overflow\":\"ellipsis\"}});var r=this.plot_view.canvas_view.events_el;r.appendChild(this.attributionEl)}this.attributionEl.innerHTML=t,this.attributionEl.title=this.attributionEl.textContent.replace(/\\s*\\n\\s*/g,\" \")}},t.prototype._map_data=function(){this.initial_extent=this.get_extent();var t=this.model.tile_source.get_level_by_extent(this.initial_extent,this.map_frame._height.value,this.map_frame._width.value),e=this.model.tile_source.snap_to_zoom_level(this.initial_extent,this.map_frame._height.value,this.map_frame._width.value,t);this.x_range.start=e[0],this.y_range.start=e[1],this.x_range.end=e[2],this.y_range.end=e[3],this.x_range instanceof a.Range1d&&(this.x_range.reset_start=e[0],this.x_range.reset_end=e[2]),this.y_range instanceof a.Range1d&&(this.y_range.reset_start=e[1],this.y_range.reset_end=e[3]),this._add_attribution()},t.prototype._on_tile_load=function(t,e){t.img=e.target,t.loaded=!0,this.request_render()},t.prototype._on_tile_cache_load=function(t,e){t.img=e.target,t.loaded=!0,t.finished=!0,this.notify_finished()},t.prototype._on_tile_error=function(t){t.finished=!0},t.prototype._create_tile=function(t,e,i,n,r){void 0===r&&(r=!1);var o=this.model.tile_source.normalize_xyz(t,e,i),s=o[0],a=o[1],l=o[2],h=this.pool.pop(),c={img:h,tile_coords:[t,e,i],normalized_coords:[s,a,l],quadkey:this.model.tile_source.tile_xyz_to_quadkey(t,e,i),cache_key:this.model.tile_source.tile_xyz_to_key(t,e,i),bounds:n,loaded:!1,finished:!1,x_coord:n[0],y_coord:n[3]};h.onload=r?this._on_tile_cache_load.bind(this,c):this._on_tile_load.bind(this,c),h.onerror=this._on_tile_error.bind(this,c),h.alt=\"\",h.src=this.model.tile_source.get_image_url(s,a,l),this.model.tile_source.tiles[c.cache_key]=c,this._tiles.push(c)},t.prototype._enforce_aspect_ratio=function(){if(this._last_height!==this.map_frame._height.value||this._last_width!==this.map_frame._width.value){var t=this.get_extent(),e=this.model.tile_source.get_level_by_extent(t,this.map_frame._height.value,this.map_frame._width.value),i=this.model.tile_source.snap_to_zoom_level(t,this.map_frame._height.value,this.map_frame._width.value,e);return this.x_range.setv({start:i[0],end:i[2]}),this.y_range.setv({start:i[1],end:i[3]}),this.extent=i,this._last_height=this.map_frame._height.value,this._last_width=this.map_frame._width.value,!0}return!1},t.prototype.has_finished=function(){if(!n.prototype.has_finished.call(this))return!1;if(0===this._tiles.length)return!1;for(var t=0,e=this._tiles;t<e.length;t++){var i=e[t];if(!i.finished)return!1}return!0},t.prototype.render=function(){null==this.map_initialized&&(this._set_data(),this._map_data(),this.map_initialized=!0),this._enforce_aspect_ratio()||(this._update(),null!=this.prefetch_timer&&clearTimeout(this.prefetch_timer),this.prefetch_timer=setTimeout(this._prefetch_tiles.bind(this),500),this.has_finished()&&this.notify_finished())},t.prototype._draw_tile=function(t){var e=this.model.tile_source.tiles[t];if(null!=e){var i=this.plot_view.map_to_screen([e.bounds[0]],[e.bounds[3]]),n=i[0][0],r=i[1][0],o=this.plot_view.map_to_screen([e.bounds[2]],[e.bounds[1]]),s=o[0][0],a=o[1][0],l=s-n,h=a-r,c=n,u=r;this.map_canvas.drawImage(e.img,c,u,l,h),e.finished=!0}},t.prototype._set_rect=function(){var t=this.plot_model.plot.properties.outline_line_width.value(),e=this.map_frame._left.value+t/2,i=this.map_frame._top.value+t/2,n=this.map_frame._width.value-t,r=this.map_frame._height.value-t;this.map_canvas.rect(e,i,n,r),this.map_canvas.clip()},t.prototype._render_tiles=function(t){this.map_canvas.save(),this._set_rect(),this.map_canvas.globalAlpha=this.model.alpha;for(var e=0,i=t;e<i.length;e++){var n=i[e];this._draw_tile(n)}this.map_canvas.restore()},t.prototype._prefetch_tiles=function(){for(var t=this.model.tile_source,e=this.get_extent(),i=this.map_frame._height.value,n=this.map_frame._width.value,r=this.model.tile_source.get_level_by_extent(e,i,n),o=this.model.tile_source.get_tiles_by_extent(e,r),s=0,a=Math.min(10,o.length);s<a;s++)for(var l=o[s],h=l[0],c=l[1],u=l[2],_=this.model.tile_source.children_by_tile_xyz(h,c,u),p=0,d=_;p<d.length;p++){var f=d[p],v=f[0],m=f[1],g=f[2],y=f[3];t.tile_xyz_to_key(v,m,g)in t.tiles||this._create_tile(v,m,g,y,!0)}},t.prototype._fetch_tiles=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e],r=n[0],o=n[1],s=n[2],a=n[3];this._create_tile(r,o,s,a)}},t.prototype._update=function(){var t=this,e=this.model.tile_source,i=e.min_zoom,n=e.max_zoom,r=this.get_extent(),o=this.extent[2]-this.extent[0]<r[2]-r[0],s=this.map_frame._height.value,a=this.map_frame._width.value,l=e.get_level_by_extent(r,s,a),h=!1;l<i?(r=this.extent,l=i,h=!0):n<l&&(r=this.extent,l=n,h=!0),h&&(this.x_range.setv({x_range:{start:r[0],end:r[2]}}),this.y_range.setv({start:r[1],end:r[3]}),this.extent=r),this.extent=r;for(var c=e.get_tiles_by_extent(r,l),u=[],_=[],p=[],d=[],f=0,v=c;f<v.length;f++){var m=v[f],g=m[0],y=m[1],b=m[2],x=e.tile_xyz_to_key(g,y,b),w=e.tiles[x];if(null!=w&&w.loaded)_.push(x);else if(this.model.render_parents){var k=e.get_closest_parent_by_tile_xyz(g,y,b),S=k[0],T=k[1],C=k[2],A=e.tile_xyz_to_key(S,T,C),E=e.tiles[A];if(null!=E&&E.loaded&&!I.includes(p,A)&&p.push(A),o)for(var M=e.children_by_tile_xyz(g,y,b),O=0,z=M;O<z.length;O++){var P=z[O],j=P[0],N=P[1],F=P[2],D=e.tile_xyz_to_key(j,N,F);D in e.tiles&&d.push(D)}}null==w&&u.push(m)}this._render_tiles(p),this._render_tiles(d),this._render_tiles(_),null!=this.render_timer&&clearTimeout(this.render_timer),this.render_timer=setTimeout(function(){return t._fetch_tiles(u)},65)},t}(s.RendererView);i.TileRendererView=u;var _=function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.initClass=function(){this.prototype.type=\"TileRenderer\",this.prototype.default_view=u,this.define({alpha:[h.Number,1],x_range_name:[h.String,\"default\"],y_range_name:[h.String,\"default\"],tile_source:[h.Instance,function(){return new n.WMTSTileSource}],render_parents:[h.Bool,!0]}),this.override({level:\"underlay\"})},t}(s.Renderer);(i.TileRenderer=_).initClass()},function(t,e,i){var n=t(387),r=t(57),o=t(213),s=t(15),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"TileSource\",this.define({url:[s.String,\"\"],tile_size:[s.Number,256],max_zoom:[s.Number,30],min_zoom:[s.Number,0],extra_url_vars:[s.Any,{}],attribution:[s.String,\"\"],x_origin_offset:[s.Number],y_origin_offset:[s.Number],initial_resolution:[s.Number]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.tiles={},this.pool=new o.ImagePool,this._normalize_case()},t.prototype.string_lookup_replace=function(t,e){var i=t;for(var n in e){var r=e[n];i=i.replace(\"{\"+n+\"}\",r)}return i},t.prototype._normalize_case=function(){var t=this.url.replace(\"{x}\",\"{X}\").replace(\"{y}\",\"{Y}\").replace(\"{z}\",\"{Z}\").replace(\"{q}\",\"{Q}\").replace(\"{xmin}\",\"{XMIN}\").replace(\"{ymin}\",\"{YMIN}\").replace(\"{xmax}\",\"{XMAX}\").replace(\"{ymax}\",\"{YMAX}\");this.url=t},t.prototype.tile_xyz_to_key=function(t,e,i){return t+\":\"+e+\":\"+i},t.prototype.key_to_tile_xyz=function(t){var e=t.split(\":\").map(function(t){return parseInt(t)}),i=e[0],n=e[1],r=e[2];return[i,n,r]},t.prototype.sort_tiles_from_center=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=(r-i)/2+i,a=(o-n)/2+n;t.sort(function(t,e){var i=Math.sqrt(Math.pow(s-t[0],2)+Math.pow(a-t[1],2)),n=Math.sqrt(Math.pow(s-e[0],2)+Math.pow(a-e[1],2));return i-n})},t.prototype.get_image_url=function(t,e,i){var n=this.string_lookup_replace(this.url,this.extra_url_vars);return n.replace(\"{X}\",t.toString()).replace(\"{Y}\",e.toString()).replace(\"{Z}\",i.toString())},t}(r.Model);(i.TileSource=a).initClass()},function(t,e,i){var n=t(33);function u(t,e){return n.wgs84_mercator.forward([t,e])}function _(t,e){return n.wgs84_mercator.inverse([t,e])}i.geographic_to_meters=u,i.meters_to_geographic=_,i.geographic_extent_to_meters=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=u(e,i),s=o[0],a=o[1],l=u(n,r),h=l[0],c=l[1];return[s,a,h,c]},i.meters_extent_to_geographic=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=_(e,i),s=o[0],a=o[1],l=_(n,r),h=l[0],c=l[1];return[s,a,h,c]}},function(t,e,i){var n=t(387),r=t(215),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"TMSTileSource\"},t.prototype.get_image_url=function(t,e,i){var n=this.string_lookup_replace(this.url,this.extra_url_vars);return n.replace(\"{X}\",t.toString()).replace(\"{Y}\",e.toString()).replace(\"{Z}\",i.toString())},t}(r.MercatorTileSource);(i.TMSTileSource=o).initClass()},function(t,e,i){var n=t(387),r=t(215),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"WMTSTileSource\"},t.prototype.get_image_url=function(t,e,i){var n=this.string_lookup_replace(this.url,this.extra_url_vars),r=this.tms_to_wmts(t,e,i),o=r[0],s=r[1],a=r[2];return n.replace(\"{X}\",o.toString()).replace(\"{Y}\",s.toString()).replace(\"{Z}\",a.toString())},t}(r.MercatorTileSource);(i.WMTSTileSource=o).initClass()},function(t,e,i){var n=t(387),r=t(230),o=t(19),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._clicked=function(){this.model.do.emit()},e}(r.ButtonToolButtonView);i.ActionToolButtonView=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.do,function(){return t.doit()})},t}(r.ButtonToolView);i.ActionToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.button_view=s,e.do=new o.Signal0(e,\"do\"),e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"ActionTool\"},t}(r.ButtonTool);(i.ActionTool=l).initClass()},function(t,e,i){var n=t(387),r=t(222),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.doit=function(){window.open(this.model.redirect)},e}(r.ActionToolView);i.HelpToolView=s;var a=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Help\",e.icon=\"bk-tool-icon-help\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"HelpTool\",this.prototype.default_view=s,this.define({help_tooltip:[o.String,\"Click the question mark to learn more about Bokeh plot tools.\"],redirect:[o.String,\"https://bokeh.pydata.org/en/latest/docs/user_guide/tools.html#built-in-tools\"]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this.help_tooltip},enumerable:!0,configurable:!0}),t}(r.ActionTool);(i.HelpTool=a).initClass()},function(t,e,i){var n=t(387),r=t(222),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.plot_view.state_changed,function(){return t.model.disabled=!t.plot_view.can_redo()})},t.prototype.doit=function(){this.plot_view.redo()},t}(r.ActionToolView);i.RedoToolView=o;var s=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Redo\",e.icon=\"bk-tool-icon-redo\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"RedoTool\",this.prototype.default_view=o,this.override({disabled:!0})},t}(r.ActionTool);(i.RedoTool=s).initClass()},function(t,e,i){var n=t(387),r=t(222),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.doit=function(){this.plot_view.reset()},e}(r.ActionToolView);i.ResetToolView=o;var s=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Reset\",e.icon=\"bk-tool-icon-reset\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"ResetTool\",this.prototype.default_view=o},t}(r.ActionTool);(i.ResetTool=s).initClass()},function(t,e,i){var n=t(387),r=t(222),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.doit=function(){this.plot_view.save(\"bokeh_plot\")},e}(r.ActionToolView);i.SaveToolView=o;var s=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Save\",e.icon=\"bk-tool-icon-save\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"SaveTool\",this.prototype.default_view=o},t}(r.ActionTool);(i.SaveTool=s).initClass()},function(t,e,i){var n=t(387),r=t(222),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.plot_view.state_changed,function(){return t.model.disabled=!t.plot_view.can_undo()})},t.prototype.doit=function(){this.plot_view.undo()},t}(r.ActionToolView);i.UndoToolView=o;var s=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Undo\",e.icon=\"bk-tool-icon-undo\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"UndoTool\",this.prototype.default_view=o,this.override({disabled:!0})},t}(r.ActionTool);(i.UndoTool=s).initClass()},function(t,e,i){var n=t(387),r=t(222),o=t(46),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.doit=function(){var t=this.plot_model.frame,e=this.model.dimensions,i=\"width\"==e||\"both\"==e,n=\"height\"==e||\"both\"==e,r=o.scale_range(t,this.model.factor,i,n);this.plot_view.push_state(\"zoom_out\",{range:r}),this.plot_view.update_range(r,!1,!0),this.model.document&&this.model.document.interactive_start(this.plot_model.plot)},e}(r.ActionToolView);i.ZoomInToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Zoom In\",e.icon=\"bk-tool-icon-zoom-in\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"ZoomInTool\",this.prototype.default_view=a,this.define({factor:[s.Percent,.1],dimensions:[s.Dimensions,\"both\"]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(this.tool_name,this.dimensions)},enumerable:!0,configurable:!0}),t}(r.ActionTool);(i.ZoomInTool=l).initClass()},function(t,e,i){var n=t(387),r=t(222),o=t(46),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.doit=function(){var t=this.plot_model.frame,e=this.model.dimensions,i=\"width\"==e||\"both\"==e,n=\"height\"==e||\"both\"==e,r=o.scale_range(t,-this.model.factor,i,n);this.plot_view.push_state(\"zoom_out\",{range:r}),this.plot_view.update_range(r,!1,!0),this.model.document&&this.model.document.interactive_start(this.plot_model.plot)},e}(r.ActionToolView);i.ZoomOutToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Zoom Out\",e.icon=\"bk-tool-icon-zoom-out\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"ZoomOutTool\",this.prototype.default_view=a,this.define({factor:[s.Percent,.1],dimensions:[s.Dimensions,\"both\"]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(this.tool_name,this.dimensions)},enumerable:!0,configurable:!0}),t}(r.ActionTool);(i.ZoomOutTool=l).initClass()},function(t,e,i){var n=t(387),r=t(6),o=t(253),s=t(5),a=t(15),l=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return n.__extends(t,i),t.prototype.initialize=function(t){var e=this;i.prototype.initialize.call(this,t),this.connect(this.model.change,function(){return e.render()}),this.el.addEventListener(\"click\",function(){return e._clicked()}),this.render()},t.prototype.css_classes=function(){return i.prototype.css_classes.call(this).concat(\"bk-toolbar-button\")},t.prototype.render=function(){s.empty(this.el),this.el.classList.add(this.model.icon),this.el.title=this.model.tooltip},t}(r.DOMView);i.ButtonToolButtonView=l;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(o.ToolView);i.ButtonToolView=h;var c=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ButtonTool\",this.internal({disabled:[a.Boolean,!1]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this.tool_name},enumerable:!0,configurable:!0}),t}(o.Tool);(i.ButtonTool=c).initClass()},function(t,e,i){var n=t(387),o=t(5),r=t(15),s=t(232),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._tap=function(t){if(null==this._draw_basepoint&&null==this._basepoint){var e=t.shiftKey;this._select_event(t,e,this.model.renderers)}},e.prototype._keyup=function(t){if(this.model.active&&this._mouse_in_frame)for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];if(t.keyCode===o.Keys.Backspace)this._delete_selected(n);else if(t.keyCode==o.Keys.Esc){var r=n.data_source;r.selection_manager.clear()}}},e.prototype._set_extent=function(t,e,i,n){var r=t[0],o=t[1],s=e[0],a=e[1];void 0===n&&(n=!1);var l=this.model.renderers[0],h=this.plot_model.frame,c=l.glyph,u=l.data_source,_=h.xscales[l.x_range_name],p=h.yscales[l.y_range_name],d=_.r_invert(r,o),f=d[0],v=d[1],m=p.r_invert(s,a),g=m[0],y=m[1],b=[(f+v)/2,(g+y)/2],x=b[0],w=b[1],k=[v-f,y-g],S=k[0],T=k[1],C=[c.x.field,c.y.field],A=C[0],E=C[1],M=[c.width.field,c.height.field],O=M[0],z=M[1];if(i)A&&u.get_array(A).push(x),E&&u.get_array(E).push(w),O&&u.get_array(O).push(S),z&&u.get_array(z).push(T),this._pad_empty_columns(u,[A,E,O,z]);else{var P=u.data[A].length-1;A&&(u.data[A][P]=x),E&&(u.data[E][P]=w),O&&(u.data[O][P]=S),z&&(u.data[z][P]=T)}u.change.emit(),n&&u.properties.data.change.emit()},e.prototype._update_box=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),null!=this._draw_basepoint){var n=[t.sx,t.sy],r=this.plot_model.frame,o=this.model.dimensions,s=this.model._get_dim_limits(this._draw_basepoint,n,r,o);if(null!=s){var a=s[0],l=s[1];this._set_extent(a,l,e,i)}}},e.prototype._doubletap=function(t){if(null!=this._draw_basepoint){this._update_box(t,!1,!0),this._draw_basepoint=null;for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];n.data_source.selected.indices=[],n.data_source.properties.data.change.emit()}}else this._draw_basepoint=[t.sx,t.sy],this._select_event(t,!0,this.model.renderers),this._update_box(t,!0,!1)},e.prototype._move=function(t){this._update_box(t,!1,!1)},e.prototype._pan_start=function(t){if(t.shiftKey){if(null!=this._draw_basepoint)return;this._draw_basepoint=[t.sx,t.sy],this._update_box(t,!0,!1)}else{if(null!=this._basepoint)return;this._select_event(t,!0,this.model.renderers),this._basepoint=[t.sx,t.sy]}},e.prototype._pan=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),t.shiftKey){if(null==this._draw_basepoint)return;this._update_box(t,e,i)}else{if(null==this._basepoint)return;this._drag_points(t,this.model.renderers)}},e.prototype._pan_end=function(t){this._pan(t,!1,!0),t.shiftKey?this._draw_basepoint=null:this._basepoint=null;for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];n.data_source.selected.indices=[],n.data_source.properties.data.change.emit()}},e}(s.EditToolView);i.BoxEditToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Box Edit Tool\",e.icon=\"bk-tool-icon-box-edit\",e.event_type=[\"tap\",\"pan\",\"move\"],e.default_order=1,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"BoxEditTool\",this.prototype.default_view=a,this.define({dimensions:[r.Dimensions,\"both\"]})},t}(s.EditTool);(i.BoxEditTool=l).initClass()},function(t,e,i){var n=t(387),r=t(15),o=t(21),s=t(238),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mouse_in_frame=!0,t}return n.__extends(t,e),t.prototype._move_enter=function(t){this._mouse_in_frame=!0},t.prototype._move_exit=function(t){this._mouse_in_frame=!1},t.prototype._map_drag=function(t,e,i){var n=this.plot_model.frame;if(!n.bbox.contains(t,e))return null;var r=n.xscales[i.x_range_name].invert(t),o=n.yscales[i.y_range_name].invert(e);return[r,o]},t.prototype._delete_selected=function(t){var e=t.data_source,i=e.selected.indices;i.sort();for(var n=0,r=e.columns();n<r.length;n++)for(var o=r[n],s=e.get_array(o),a=0;a<i.length;a++){var l=i[a];s.splice(l-a,1)}e.change.emit(),e.properties.data.change.emit(),e.selection_manager.clear()},t.prototype._drag_points=function(t,e){if(null!=this._basepoint){for(var i=this._basepoint,n=i[0],r=i[1],o=0,s=e;o<s.length;o++){var a=s[o],l=this._map_drag(n,r,a),h=this._map_drag(t.sx,t.sy,a);if(null!=h&&null!=l)for(var c=h[0],u=h[1],_=l[0],p=l[1],d=[c-_,u-p],f=d[0],v=d[1],m=a.glyph,g=a.data_source,y=[m.x.field,m.y.field],b=y[0],x=y[1],w=0,k=g.selected.indices;w<k.length;w++){var S=k[w];b&&(g.data[b][S]+=f),x&&(g.data[x][S]+=v)}}for(var T=0,C=e;T<C.length;T++){var a=C[T];a.data_source.change.emit(),a.data_source.properties.data.change.emit()}this._basepoint=[t.sx,t.sy]}},t.prototype._pad_empty_columns=function(t,e){for(var i=0,n=t.columns();i<n.length;i++){var r=n[i];o.includes(e,r)||t.get_array(r).push(this.model.empty_value)}},t.prototype._select_event=function(t,e,i){var n=this.plot_model.frame,r=t.sx,o=t.sy;if(!n.bbox.contains(r,o))return[];for(var s={type:\"point\",sx:r,sy:o},a=[],l=0,h=i;l<h.length;l++){var c=h[l],u=c.get_selection_manager(),_=c.data_source,p=[this.plot_view.renderer_views[c.id]],d=u.select(p,s,!0,e);d&&a.push(c),_.properties.selected.change.emit()}return a},t}(s.GestureToolView);i.EditToolView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"EditTool\",this.define({empty_value:[r.Any],renderers:[r.Array,[]]})},t}(s.GestureTool);(i.EditTool=l).initClass()},function(t,e,i){var n=t(387),o=t(5),r=t(15),s=t(232),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._tap=function(t){var e=t.shiftKey,i=this._select_event(t,e,this.model.renderers);if(!i.length&&this.model.add){var n=this.model.renderers[0],r=this._map_drag(t.sx,t.sy,n);if(null!=r){var o=n.glyph,s=n.data_source,a=[o.x.field,o.y.field],l=a[0],h=a[1],c=r[0],u=r[1];l&&s.get_array(l).push(c),h&&s.get_array(h).push(u),this._pad_empty_columns(s,[l,h]),s.change.emit(),s.properties.data.change.emit()}}},e.prototype._keyup=function(t){if(this.model.active&&this._mouse_in_frame)for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];if(t.keyCode===o.Keys.Backspace)this._delete_selected(n);else if(t.keyCode==o.Keys.Esc){var r=n.data_source;r.selection_manager.clear()}}},e.prototype._pan_start=function(t){this.model.drag&&(this._select_event(t,!0,this.model.renderers),this._basepoint=[t.sx,t.sy])},e.prototype._pan=function(t){this.model.drag&&null!=this._basepoint&&this._drag_points(t,this.model.renderers)},e.prototype._pan_end=function(t){if(this.model.drag){this._pan(t);for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];n.data_source.selected.indices=[],n.data_source.data=n.data_source.data,n.data_source.properties.data.change.emit()}this._basepoint=null}},e}(s.EditToolView);i.PointDrawToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Point Draw Tool\",e.icon=\"bk-tool-icon-point-draw\",e.event_type=[\"tap\",\"pan\",\"move\"],e.default_order=2,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"PointDrawTool\",this.prototype.default_view=a,this.define({add:[r.Bool,!0],drag:[r.Bool,!0]})},t}(s.EditTool);(i.PointDrawTool=l).initClass()},function(t,e,i){var n=t(387),o=t(5),r=t(15),m=t(44),s=t(232),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._drawing=!1,t}return n.__extends(t,e),t.prototype._tap=function(t){if(this._drawing)this._draw(t,\"add\"),this.model.renderers[0].data_source.properties.data.change.emit();else{var e=t.shiftKey;this._select_event(t,e,this.model.renderers)}},t.prototype._draw=function(t,e){var i=this.model.renderers[0],n=this._map_drag(t.sx,t.sy,i);if(null!=n){var r=n[0],o=n[1],s=i.data_source,a=i.glyph,l=[a.xs.field,a.ys.field],h=l[0],c=l[1];if(\"new\"==e)h&&s.get_array(h).push([r,r]),c&&s.get_array(c).push([o,o]),this._pad_empty_columns(s,[h,c]);else if(\"edit\"==e){if(h){var u=s.data[h][s.data[h].length-1];u[u.length-1]=r}if(c){var _=s.data[c][s.data[c].length-1];_[_.length-1]=o}}else if(\"add\"==e){if(h){var p=s.data[h].length-1,u=s.get_array(h)[p],d=u[u.length-1];u[u.length-1]=r,m.isArray(u)||(u=Array.from(u),s.data[h][p]=u),u.push(d)}if(c){var f=s.data[c].length-1,_=s.get_array(c)[f],v=_[_.length-1];_[_.length-1]=o,m.isArray(_)||(_=Array.from(_),s.data[c][f]=_),_.push(v)}}s.change.emit()}},t.prototype._doubletap=function(t){this.model.active&&(this._drawing?(this._drawing=!1,this._draw(t,\"edit\")):(this._drawing=!0,this._draw(t,\"new\")),this.model.renderers[0].data_source.properties.data.change.emit())},t.prototype._move=function(t){this._drawing&&this._draw(t,\"edit\")},t.prototype._remove=function(){var t=this.model.renderers[0],e=t.data_source,i=t.glyph,n=[i.xs.field,i.ys.field],r=n[0],o=n[1];if(r){var s=e.data[r].length-1,a=e.get_array(r)[s];a.splice(a.length-1,1)}if(o){var l=e.data[o].length-1,h=e.get_array(o)[l];h.splice(h.length-1,1)}e.change.emit(),e.properties.data.change.emit()},t.prototype._keyup=function(t){if(this.model.active&&this._mouse_in_frame)for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];if(t.keyCode===o.Keys.Backspace)this._delete_selected(n);else if(t.keyCode==o.Keys.Esc){this._drawing&&(this._remove(),this._drawing=!1);var r=n.data_source;r.selection_manager.clear()}}},t.prototype._pan_start=function(t){this.model.drag&&(this._select_event(t,!0,this.model.renderers),this._basepoint=[t.sx,t.sy])},t.prototype._pan=function(t){if(null!=this._basepoint&&this.model.drag){for(var e=this._basepoint,i=e[0],n=e[1],r=0,o=this.model.renderers;r<o.length;r++){var s=o[r],a=this._map_drag(i,n,s),l=this._map_drag(t.sx,t.sy,s);if(null!=l&&null!=a){var h=s.data_source,c=s.glyph,u=[c.xs.field,c.ys.field],_=u[0],p=u[1];if(_||p){for(var d=l[0],f=l[1],v=a[0],m=a[1],g=[d-v,f-m],y=g[0],b=g[1],x=0,w=h.selected.indices;x<w.length;x++){var k=w[x],S=void 0,T=void 0,C=void 0;_&&(T=h.data[_][k]),p?(C=h.data[p][k],S=C.length):S=T.length;for(var A=0;A<S;A++)T&&(T[A]+=y),C&&(C[A]+=b)}h.change.emit()}}}this._basepoint=[t.sx,t.sy]}},t.prototype._pan_end=function(t){if(this.model.drag){this._pan(t);for(var e=0,i=this.model.renderers;e<i.length;e++){var n=i[e];n.data_source.selected.indices=[],n.data_source.properties.data.change.emit()}this._basepoint=null}},t.prototype.deactivate=function(){this._drawing&&(this._remove(),this._drawing=!1)},t}(s.EditToolView);i.PolyDrawToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Polygon Draw Tool\",e.icon=\"bk-tool-icon-poly-draw\",e.event_type=[\"pan\",\"tap\",\"move\"],e.default_order=3,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"PolyDrawTool\",this.prototype.default_view=a,this.define({drag:[r.Bool,!0]})},t}(s.EditTool);(i.PolyDrawTool=l).initClass()},function(t,e,i){var n=t(387),s=t(5),r=t(15),o=t(232),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._drawing=!1,t}return n.__extends(t,e),t.prototype._doubletap=function(t){if(this.model.active){var e=this._map_drag(t.sx,t.sy,this.model.vertex_renderer);if(null!=e){var i=e[0],n=e[1],r=this._select_event(t,!1,this.model.renderers),o=this._select_event(t,!1,[this.model.vertex_renderer]),s=this.model.vertex_renderer.data_source,a=this.model.vertex_renderer.glyph,l=[a.x.field,a.y.field],h=l[0],c=l[1];if(o.length&&null!=this._selected_renderer){var u=s.selected.indices[0];return this._drawing?(s.selected.indices=[],h&&(s.data[h][u]=i),c&&(s.data[c][u]=n),this._drawing=!1,this._selected_renderer.data_source.properties.data.change.emit()):(s.selected.indices=[u+1],h&&s.get_array(h).splice(u+1,0,i),c&&s.get_array(c).splice(u+1,0,n),this._drawing=!0),s.change.emit(),void this._selected_renderer.data_source.change.emit()}if(!r.length)return h&&(s.data[h]=[]),c&&(s.data[c]=[]),this._selected_renderer=null,this._drawing=!1,void s.change.emit();var _=r[0],p=_.glyph,d=_.data_source,f=d.selected.indices[0],v=[p.xs.field,p.ys.field],m=v[0],g=v[1];if(m){var y=d.data[m][f];h&&(s.data[h]=y)}else a.x={value:p.xs.value};if(g){var b=d.data[g][f];c&&(s.data[c]=b)}else a.y={value:p.ys.value};s.selected.indices=[],this._selected_renderer=_,s.change.emit(),s.properties.data.change.emit()}}},t.prototype._move=function(t){if(this._drawing&&null!=this._selected_renderer){var e=this.model.vertex_renderer,i=this._map_drag(t.sx,t.sy,e);if(null==i)return;var n=i[0],r=i[1],o=e.data_source,s=e.glyph,a=[s.x.field,s.y.field],l=a[0],h=a[1],c=o.selected.indices[0];l&&(o.data[l][c]=n),h&&(o.data[h][c]=r),o.change.emit(),this._selected_renderer.data_source.change.emit()}},t.prototype._tap=function(t){var e=this.model.vertex_renderer,i=this._map_drag(t.sx,t.sy,e);if(null!=i){if(this._drawing&&this._selected_renderer){var n=i[0],r=i[1],o=e.data_source,s=e.glyph,a=[s.x.field,s.y.field],l=a[0],h=a[1],c=o.selected.indices[0];if(o.selected.indices=[c+1],l){var u=o.get_array(l),_=u[c];u[c]=n,u.splice(c+1,0,_)}if(h){var p=o.get_array(h),d=p[c];p[c]=r,p.splice(c+1,0,d)}o.change.emit();var f=this._selected_renderer.data_source;return f.change.emit(),void f.properties.data.change.emit()}var v=t.shiftKey;this._select_event(t,v,[e]),this._select_event(t,v,this.model.renderers)}},t.prototype._remove_vertex=function(t){if(void 0===t&&(t=!0),this._drawing&&this._selected_renderer){var e=this.model.vertex_renderer,i=e.data_source,n=e.glyph,r=i.selected.indices[0],o=[n.x.field,n.y.field],s=o[0],a=o[1];s&&i.get_array(s).splice(r,1),a&&i.get_array(a).splice(r,1),t&&(i.change.emit(),i.properties.data.change.emit())}},t.prototype._pan_start=function(t){this._select_event(t,!0,[this.model.vertex_renderer]),this._basepoint=[t.sx,t.sy]},t.prototype._pan=function(t){null!=this._basepoint&&(this._drag_points(t,[this.model.vertex_renderer]),this._selected_renderer&&this._selected_renderer.data_source.change.emit())},t.prototype._pan_end=function(t){this.model.vertex_renderer.data_source.selected.indices=[],this._selected_renderer&&this._selected_renderer.data_source.properties.data.change.emit(),this._basepoint=null},t.prototype._keyup=function(t){if(this.model.active&&this._mouse_in_frame){var e;e=this._selected_renderer?[this.model.vertex_renderer]:this.model.renderers;for(var i=0,n=e;i<n.length;i++){var r=n[i];if(t.keyCode===s.Keys.Backspace)this._delete_selected(r);else if(t.keyCode==s.Keys.Esc){this._drawing&&(this._remove_vertex(),this._drawing=!1);var o=r.data_source;o.selection_manager.clear()}}}},t.prototype.deactivate=function(){if(this._selected_renderer){this._drawing&&(this._remove_vertex(!1),this._drawing=!1);var t=this.model.vertex_renderer,e=t.data_source,i=t.glyph,n=[i.x.field,i.y.field],r=n[0],o=n[1];r&&(e.data[r]=[]),o&&(e.data[o]=[]),e.selection_manager.clear(),e.change.emit(),this._selected_renderer.data_source.change.emit(),e.properties.data.change.emit(),this._selected_renderer.data_source.properties.data.change.emit(),this._selected_renderer=null}},t}(o.EditToolView);i.PolyEditToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Poly Edit Tool\",e.icon=\"bk-tool-icon-poly-edit\",e.event_type=[\"tap\",\"pan\",\"move\"],e.default_order=4,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"PolyEditTool\",this.prototype.default_view=a,this.define({vertex_renderer:[r.Instance]})},t}(o.EditTool);(i.PolyEditTool=l).initClass()},function(t,e,i){var v=t(387),n=t(243),r=t(62),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v.__extends(e,t),e.prototype._compute_limits=function(t){var e=this.plot_model.frame,i=this.model.dimensions,n=this._base_point;if(\"center\"==this.model.origin){var r=n[0],o=n[1],s=t[0],a=t[1];n=[r-(s-r),o-(a-o)]}return this.model._get_dim_limits(n,t,e,i)},e.prototype._pan_start=function(t){var e=t.sx,i=t.sy;this._base_point=[e,i]},e.prototype._pan=function(t){var e=t.sx,i=t.sy,n=[e,i],r=this._compute_limits(n),o=r[0],s=r[1];if(this.model.overlay.update({left:o[0],right:o[1],top:s[0],bottom:s[1]}),this.model.select_every_mousemove){var a=t.shiftKey;this._do_select(o,s,!1,a)}},e.prototype._pan_end=function(t){var e=t.sx,i=t.sy,n=[e,i],r=this._compute_limits(n),o=r[0],s=r[1],a=t.shiftKey;this._do_select(o,s,!0,a),this.model.overlay.update({left:null,right:null,top:null,bottom:null}),this._base_point=null,this.plot_view.push_state(\"box_select\",{selection:this.plot_view.get_selection()})},e.prototype._do_select=function(t,e,i,n){var r=t[0],o=t[1],s=e[0],a=e[1];void 0===n&&(n=!1);var l={type:\"rect\",sx0:r,sx1:o,sy0:s,sy1:a};this._select(l,i,n)},e.prototype._emit_callback=function(t){var e=this.computed_renderers[0],i=this.plot_model.frame,n=i.xscales[e.x_range_name],r=i.yscales[e.y_range_name],o=t.sx0,s=t.sx1,a=t.sy0,l=t.sy1,h=n.r_invert(o,s),c=h[0],u=h[1],_=r.r_invert(a,l),p=_[0],d=_[1],f=v.__assign({x0:c,y0:p,x1:u,y1:d},t);this.model.callback.execute(this.model,{geometry:f})},e}(n.SelectToolView);i.BoxSelectToolView=s;var a=function(){return new r.BoxAnnotation({level:\"overlay\",render_mode:\"css\",top_units:\"screen\",left_units:\"screen\",bottom_units:\"screen\",right_units:\"screen\",fill_color:{value:\"lightgrey\"},fill_alpha:{value:.5},line_color:{value:\"black\"},line_alpha:{value:1},line_width:{value:2},line_dash:{value:[4,4]}})},l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Box Select\",e.icon=\"bk-tool-icon-box-select\",e.event_type=\"pan\",e.default_order=30,e}return v.__extends(t,i),t.initClass=function(){this.prototype.type=\"BoxSelectTool\",this.prototype.default_view=s,this.define({dimensions:[o.Dimensions,\"both\"],select_every_mousemove:[o.Bool,!1],callback:[o.Instance],overlay:[o.Instance,a],origin:[o.String,\"corner\"]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(this.tool_name,this.dimensions)},enumerable:!0,configurable:!0}),t}(n.SelectTool);(i.BoxSelectTool=l).initClass()},function(t,e,i){var n=t(387),r=t(238),o=t(62),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._match_aspect=function(t,e,i){var n,r,o,s,a=i.bbox.aspect,l=i.bbox.h_range.end,h=i.bbox.h_range.start,c=i.bbox.v_range.end,u=i.bbox.v_range.start,_=Math.abs(t[0]-e[0]),p=Math.abs(t[1]-e[1]),d=0==p?0:_/p,f=(a<=d?[1,d/a]:[a/d,1])[0];return t[0]<=e[0]?(n=t[0],r=t[0]+_*f,l<r&&(r=l)):(r=t[0],(n=t[0]-_*f)<h&&(n=h)),_=Math.abs(r-n),t[1]<=e[1]?(s=t[1],o=t[1]+_/a,c<o&&(o=c)):(o=t[1],(s=t[1]-_/a)<u&&(s=u)),p=Math.abs(o-s),t[0]<=e[0]?r=t[0]+a*p:n=t[0]-a*p,[[n,r],[s,o]]},e.prototype._compute_limits=function(t){var e,i,n,r,o=this.plot_model.frame,s=this.model.dimensions,a=this._base_point;if(\"center\"==this.model.origin){var l=a[0],h=a[1],c=t[0],u=t[1];a=[l-(c-l),h-(u-h)]}return this.model.match_aspect&&\"both\"==s?(e=this._match_aspect(a,t,o),n=e[0],r=e[1]):(i=this.model._get_dim_limits(a,t,o,s),n=i[0],r=i[1]),[n,r]},e.prototype._pan_start=function(t){this._base_point=[t.sx,t.sy]},e.prototype._pan=function(t){var e=[t.sx,t.sy],i=this._compute_limits(e),n=i[0],r=i[1];this.model.overlay.update({left:n[0],right:n[1],top:r[0],bottom:r[1]})},e.prototype._pan_end=function(t){var e=[t.sx,t.sy],i=this._compute_limits(e),n=i[0],r=i[1];this._update(n,r),this.model.overlay.update({left:null,right:null,top:null,bottom:null}),this._base_point=null},e.prototype._update=function(t,e){var i=t[0],n=t[1],r=e[0],o=e[1];if(!(Math.abs(n-i)<=5||Math.abs(o-r)<=5)){var s=this.plot_model.frame,a=s.xscales,l=s.yscales,h={};for(var c in a){var u=a[c],_=u.r_invert(i,n),p=_[0],d=_[1];h[c]={start:p,end:d}}var f={};for(var v in l){var u=l[v],m=u.r_invert(r,o),p=m[0],d=m[1];f[v]={start:p,end:d}}var g={xrs:h,yrs:f};this.plot_view.push_state(\"box_zoom\",{range:g}),this.plot_view.update_range(g)}},e}(r.GestureToolView);i.BoxZoomToolView=a;var l=function(){return new o.BoxAnnotation({level:\"overlay\",render_mode:\"css\",top_units:\"screen\",left_units:\"screen\",bottom_units:\"screen\",right_units:\"screen\",fill_color:{value:\"lightgrey\"},fill_alpha:{value:.5},line_color:{value:\"black\"},line_alpha:{value:1},line_width:{value:2},line_dash:{value:[4,4]}})},h=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Box Zoom\",e.icon=\"bk-tool-icon-box-zoom\",e.event_type=\"pan\",e.default_order=20,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"BoxZoomTool\",this.prototype.default_view=a,this.define({dimensions:[s.Dimensions,\"both\"],overlay:[s.Instance,l],match_aspect:[s.Bool,!1],origin:[s.String,\"corner\"]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(this.tool_name,this.dimensions)},enumerable:!0,configurable:!0}),t}(r.GestureTool);(i.BoxZoomTool=h).initClass()},function(t,e,i){var n=t(387),r=t(230),o=t(252),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.ButtonToolView);i.GestureToolView=s;var a=function(i){function t(t){var e=i.call(this,t)||this;return e.button_view=o.OnOffButtonView,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"GestureTool\"},t}(r.ButtonTool);(i.GestureTool=a).initClass()},function(t,e,i){var l=t(387),n=t(243),r=t(69),o=t(5),s=t(15),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.data=null},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.active.change,function(){return t._active_change()})},t.prototype._active_change=function(){this.model.active||this._clear_overlay()},t.prototype._keyup=function(t){t.keyCode==o.Keys.Enter&&this._clear_overlay()},t.prototype._pan_start=function(t){var e=t.sx,i=t.sy;this.data={sx:[e],sy:[i]}},t.prototype._pan=function(t){var e=t.sx,i=t.sy,n=this.plot_model.frame.bbox.clip(e,i),r=n[0],o=n[1];this.data.sx.push(r),this.data.sy.push(o);var s=this.model.overlay;if(s.update({xs:this.data.sx,ys:this.data.sy}),this.model.select_every_mousemove){var a=t.shiftKey;this._do_select(this.data.sx,this.data.sy,!1,a)}},t.prototype._pan_end=function(t){this._clear_overlay();var e=t.shiftKey;this._do_select(this.data.sx,this.data.sy,!0,e),this.plot_view.push_state(\"lasso_select\",{selection:this.plot_view.get_selection()})},t.prototype._clear_overlay=function(){this.model.overlay.update({xs:[],ys:[]})},t.prototype._do_select=function(t,e,i,n){var r={type:\"poly\",sx:t,sy:e};this._select(r,i,n)},t.prototype._emit_callback=function(t){var e=this.computed_renderers[0],i=this.plot_model.frame,n=i.xscales[e.x_range_name],r=i.yscales[e.y_range_name],o=n.v_invert(t.sx),s=r.v_invert(t.sy),a=l.__assign({x:o,y:s},t);this.model.callback.execute(this.model,{geometry:a})},t}(n.SelectToolView);i.LassoSelectToolView=a;var h=function(){return new r.PolyAnnotation({level:\"overlay\",xs_units:\"screen\",ys_units:\"screen\",fill_color:{value:\"lightgrey\"},fill_alpha:{value:.5},line_color:{value:\"black\"},line_alpha:{value:1},line_width:{value:2},line_dash:{value:[4,4]}})},c=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Lasso Select\",e.icon=\"bk-tool-icon-lasso-select\",e.event_type=\"pan\",e.default_order=12,e}return l.__extends(t,i),t.initClass=function(){this.prototype.type=\"LassoSelectTool\",this.prototype.default_view=a,this.define({select_every_mousemove:[s.Bool,!0],callback:[s.Instance],overlay:[s.Instance,h]})},t}(n.SelectTool);(i.LassoSelectTool=c).initClass()},function(t,e,i){var n=t(387),r=t(238),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._pan_start=function(t){this.last_dx=0,this.last_dy=0;var e=t.sx,i=t.sy,n=this.plot_model.frame.bbox;if(!n.contains(e,i)){var r=n.h_range,o=n.v_range;(e<r.start||e>r.end)&&(this.v_axis_only=!0),(i<o.start||i>o.end)&&(this.h_axis_only=!0)}null!=this.model.document&&this.model.document.interactive_start(this.plot_model.plot)},e.prototype._pan=function(t){this._update(t.deltaX,t.deltaY),null!=this.model.document&&this.model.document.interactive_start(this.plot_model.plot)},e.prototype._pan_end=function(t){this.h_axis_only=!1,this.v_axis_only=!1,null!=this.pan_info&&this.plot_view.push_state(\"pan\",{range:this.pan_info})},e.prototype._update=function(t,e){var i,n,r,o,s,a,l=this.plot_model.frame,h=t-this.last_dx,c=e-this.last_dy,u=l.bbox.h_range,_=u.start-h,p=u.end-h,d=l.bbox.v_range,f=d.start-c,v=d.end-c,m=this.model.dimensions;\"width\"!=m&&\"both\"!=m||this.v_axis_only?(i=u.start,n=u.end,r=0):(i=_,n=p,r=-h),\"height\"!=m&&\"both\"!=m||this.h_axis_only?(o=d.start,s=d.end,a=0):(o=f,s=v,a=-c),this.last_dx=t,this.last_dy=e;var g=l.xscales,y=l.yscales,b={};for(var x in g){var w=g[x],k=w.r_invert(i,n),S=k[0],T=k[1];b[x]={start:S,end:T}}var C={};for(var A in y){var w=y[A],E=w.r_invert(o,s),S=E[0],T=E[1];C[A]={start:S,end:T}}this.pan_info={xrs:b,yrs:C,sdx:r,sdy:a},this.plot_view.update_range(this.pan_info,!0)},e}(r.GestureToolView);i.PanToolView=s;var a=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Pan\",e.event_type=\"pan\",e.default_order=10,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"PanTool\",this.prototype.default_view=s,this.define({dimensions:[o.Dimensions,\"both\"]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(\"Pan\",this.dimensions)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"icon\",{get:function(){switch(this.dimensions){case\"both\":return\"bk-tool-icon-pan\";case\"width\":return\"bk-tool-icon-xpan\";case\"height\":return\"bk-tool-icon-ypan\"}},enumerable:!0,configurable:!0}),t}(r.GestureTool);(i.PanTool=a).initClass()},function(t,e,i){var l=t(387),n=t(243),r=t(69),o=t(5),s=t(15),a=t(21),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.data={sx:[],sy:[]}},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.active.change,function(){return t._active_change()})},t.prototype._active_change=function(){this.model.active||this._clear_data()},t.prototype._keyup=function(t){t.keyCode==o.Keys.Enter&&this._clear_data()},t.prototype._doubletap=function(t){var e=t.shiftKey;this._do_select(this.data.sx,this.data.sy,!0,e),this.plot_view.push_state(\"poly_select\",{selection:this.plot_view.get_selection()}),this._clear_data()},t.prototype._clear_data=function(){this.data={sx:[],sy:[]},this.model.overlay.update({xs:[],ys:[]})},t.prototype._tap=function(t){var e=t.sx,i=t.sy,n=this.plot_model.frame;n.bbox.contains(e,i)&&(this.data.sx.push(e),this.data.sy.push(i),this.model.overlay.update({xs:a.copy(this.data.sx),ys:a.copy(this.data.sy)}))},t.prototype._do_select=function(t,e,i,n){var r={type:\"poly\",sx:t,sy:e};this._select(r,i,n)},t.prototype._emit_callback=function(t){var e=this.computed_renderers[0],i=this.plot_model.frame,n=i.xscales[e.x_range_name],r=i.yscales[e.y_range_name],o=n.v_invert(t.sx),s=r.v_invert(t.sy),a=l.__assign({x:o,y:s},t);this.model.callback.execute(this.model,{geometry:a})},t}(n.SelectToolView);i.PolySelectToolView=h;var c=function(){return new r.PolyAnnotation({level:\"overlay\",xs_units:\"screen\",ys_units:\"screen\",fill_color:{value:\"lightgrey\"},fill_alpha:{value:.5},line_color:{value:\"black\"},line_alpha:{value:1},line_width:{value:2},line_dash:{value:[4,4]}})},u=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Poly Select\",e.icon=\"bk-tool-icon-polygon-select\",e.event_type=\"tap\",e.default_order=11,e}return l.__extends(t,i),t.initClass=function(){this.prototype.type=\"PolySelectTool\",this.prototype.default_view=h,this.define({callback:[s.Instance],overlay:[s.Instance,c]})},t}(n.SelectTool);(i.PolySelectTool=u).initClass()},function(t,e,i){var n=t(387),_=t(62),r=t(14),o=t(15),s=t(238);function p(t,e,i,n){if(null==e)return!1;var r=i.compute(e);return Math.abs(t-r)<n}function d(t,e,i,n,r){var o=!0;if(null!=r.left&&null!=r.right){var s=i.invert(t);(s<r.left||s>r.right)&&(o=!1)}if(null!=r.bottom&&null!=r.top){var a=n.invert(e);(a<r.bottom||a>r.top)&&(o=!1)}return o}function l(t,e,i,n){var r=e.compute(t),o=e.invert(r+i);return o>=n.start&&o<=n.end?o:t}function h(t,e,i,n){var r=e.r_compute(t.start,t.end),o=r[0],s=r[1],a=e.r_invert(o+i,s+i),l=a[0],h=a[1];l>=n.start&&l<=n.end&&h>=n.start&&h<=n.end&&(t.start=l,t.end=h)}i.is_near=p,i.is_inside=d,i.compute_value=l,i.update_range=h;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.side=0,this.model.update_overlay_from_ranges()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),null!=this.model.x_range&&this.connect(this.model.x_range.change,function(){return t.model.update_overlay_from_ranges()}),null!=this.model.y_range&&this.connect(this.model.y_range.change,function(){return t.model.update_overlay_from_ranges()})},t.prototype._pan_start=function(t){this.last_dx=0,this.last_dy=0;var e=this.model.x_range,i=this.model.y_range,n=this.plot_model.frame,r=n.xscales.default,o=n.yscales.default,s=this.model.overlay,a=s.left,l=s.right,h=s.top,c=s.bottom,u=this.model.overlay.properties.line_width.value()+_.EDGE_TOLERANCE;null!=e&&this.model.x_interaction&&(p(t.sx,a,r,u)?this.side=1:p(t.sx,l,r,u)?this.side=2:d(t.sx,t.sy,r,o,s)&&(this.side=3)),null!=i&&this.model.y_interaction&&(0==this.side&&p(t.sy,c,o,u)&&(this.side=4),0==this.side&&p(t.sy,h,o,u)?this.side=5:d(t.sx,t.sy,r,o,this.model.overlay)&&(3==this.side?this.side=7:this.side=6))},t.prototype._pan=function(t){var e=this.plot_model.frame,i=t.deltaX-this.last_dx,n=t.deltaY-this.last_dy,r=this.model.x_range,o=this.model.y_range,s=e.xscales.default,a=e.yscales.default;null!=r&&(3==this.side||7==this.side?h(r,s,i,e.x_range):1==this.side?r.start=l(r.start,s,i,e.x_range):2==this.side&&(r.end=l(r.end,s,i,e.x_range))),null!=o&&(6==this.side||7==this.side?h(o,a,n,e.y_range):4==this.side?o.start=l(o.start,a,n,e.y_range):5==this.side&&(o.end=l(o.end,a,n,e.y_range))),this.last_dx=t.deltaX,this.last_dy=t.deltaY},t.prototype._pan_end=function(t){this.side=0},t}(s.GestureToolView);i.RangeToolView=a;var c=function(){return new _.BoxAnnotation({level:\"overlay\",render_mode:\"css\",fill_color:\"lightgrey\",fill_alpha:{value:.5},line_color:{value:\"black\"},line_alpha:{value:1},line_width:{value:.5},line_dash:[2,2]})},u=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Range Tool\",e.icon=\"bk-tool-icon-range\",e.event_type=\"pan\",e.default_order=1,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"RangeTool\",this.prototype.default_view=a,this.define({x_range:[o.Instance,null],x_interaction:[o.Bool,!0],y_range:[o.Instance,null],y_interaction:[o.Bool,!0],overlay:[o.Instance,c]})},t.prototype.initialize=function(){i.prototype.initialize.call(this),this.overlay.in_cursor=\"grab\",this.overlay.ew_cursor=null!=this.x_range&&this.x_interaction?\"ew-resize\":null,this.overlay.ns_cursor=null!=this.y_range&&this.y_interaction?\"ns-resize\":null},t.prototype.update_overlay_from_ranges=function(){null==this.x_range&&null==this.y_range&&(this.overlay.left=null,this.overlay.right=null,this.overlay.bottom=null,this.overlay.top=null,r.logger.warn(\"RangeTool not configured with any Ranges.\")),null==this.x_range?(this.overlay.left=null,this.overlay.right=null):(this.overlay.left=this.x_range.start,this.overlay.right=this.x_range.end),null==this.y_range?(this.overlay.bottom=null,this.overlay.top=null):(this.overlay.bottom=this.y_range.start,this.overlay.top=this.y_range.end)},t}(s.GestureTool);(i.RangeTool=u).initClass()},function(t,e,i){var y=t(387),n=t(238),o=t(176),r=t(258),s=t(15),a=t(5),b=t(3),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y.__extends(e,t),Object.defineProperty(e.prototype,\"computed_renderers\",{get:function(){var t=this.model.renderers,e=this.plot_model.plot.renderers,i=this.model.names;return r.compute_renderers(t,e,i)},enumerable:!0,configurable:!0}),e.prototype._computed_renderers_by_data_source=function(){for(var t={},e=0,i=this.computed_renderers;e<i.length;e++){var n=i[e],r=void 0;(r=n instanceof o.GraphRenderer?n.node_renderer.data_source.id:n.data_source.id)in t||(t[r]=[]),t[r].push(n)}return t},e.prototype._keyup=function(t){if(t.keyCode==a.Keys.Esc)for(var e=0,i=this.computed_renderers;e<i.length;e++){var n=i[e],r=n.data_source,o=r.selection_manager;o.clear()}},e.prototype._select=function(t,e,i){var n=this._computed_renderers_by_data_source();for(var r in n){for(var o=n[r],s=o[0].get_selection_manager(),a=[],l=0,h=o;l<h.length;l++){var c=h[l];c.id in this.plot_view.renderer_views&&a.push(this.plot_view.renderer_views[c.id])}s.select(a,t,e,i)}null!=this.model.callback&&this._emit_callback(t),this._emit_selection_event(t,e)},e.prototype._emit_selection_event=function(t,e){void 0===e&&(e=!0);var i,n=this.plot_model.frame.xscales.default,r=this.plot_model.frame.yscales.default;switch(t.type){case\"point\":var o=t.sx,s=t.sy,a=n.invert(o),l=r.invert(s);i=y.__assign({},t,{x:a,y:l});break;case\"rect\":var h=t.sx0,c=t.sx1,u=t.sy0,_=t.sy1,p=n.r_invert(h,c),d=p[0],f=p[1],v=r.r_invert(u,_),m=v[0],g=v[1];i=y.__assign({},t,{x0:d,y0:m,x1:f,y1:g});break;case\"poly\":var o=t.sx,s=t.sy,a=n.v_invert(o),l=r.v_invert(s);i=y.__assign({},t,{x:a,y:l});break;default:throw new Error(\"Unrecognized selection geometry type: '\"+t.type+\"'\")}this.plot_model.plot.trigger_event(new b.SelectionGeometry({geometry:i,final:e}))},e}(n.GestureToolView);i.SelectToolView=l;var h=function(e){function t(t){return e.call(this,t)||this}return y.__extends(t,e),t.initClass=function(){this.prototype.type=\"SelectTool\",this.define({renderers:[s.Any,\"auto\"],names:[s.Array,[]]})},t}(n.GestureTool);(i.SelectTool=h).initClass()},function(t,e,i){var n=t(387),r=t(243),o=t(15),f=t(44),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._tap=function(t){var e=t.sx,i=t.sy,n={type:\"point\",sx:e,sy:i},r=t.shiftKey;this._select(n,!0,r)},e.prototype._select=function(t,e,i){var n=this,r=this.model.callback,o={geometries:t,source:null};if(\"select\"==this.model.behavior){var s=this._computed_renderers_by_data_source();for(var a in s){var l=s[a],h=l[0].get_selection_manager(),c=l.map(function(t){return n.plot_view.renderer_views[t.id]}),u=h.select(c,t,e,i);u&&null!=r&&(o.source=h.source,f.isFunction(r)?r(this,o):r.execute(this,o))}this._emit_selection_event(t),this.plot_view.push_state(\"tap\",{selection:this.plot_view.get_selection()})}else for(var _=0,p=this.computed_renderers;_<p.length;_++){var d=p[_],h=d.get_selection_manager(),u=h.inspect(this.plot_view.renderer_views[d.id],t);u&&null!=r&&(o.source=h.source,f.isFunction(r)?r(this,o):r.execute(this,o))}},e}(r.SelectToolView);i.TapToolView=s;var a=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Tap\",e.icon=\"bk-tool-icon-tap-select\",e.event_type=\"tap\",e.default_order=10,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"TapTool\",this.prototype.default_view=s,this.define({behavior:[o.String,\"select\"],callback:[o.Any]})},t}(r.SelectTool);(i.TapTool=a).initClass()},function(t,e,i){var n=t(387),r=t(238),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._scroll=function(t){var e=this.model.speed*t.delta;.9<e?e=.9:e<-.9&&(e=-.9),this._update_ranges(e)},e.prototype._update_ranges=function(t){var e,i,n,r,o=this.plot_model.frame,s=o.bbox.h_range,a=o.bbox.v_range,l=[s.start,s.end],h=l[0],c=l[1],u=[a.start,a.end],_=u[0],p=u[1];switch(this.model.dimension){case\"height\":var d=Math.abs(p-_);e=h,i=c,n=_-d*t,r=p-d*t;break;case\"width\":var f=Math.abs(c-h);e=h-f*t,i=c-f*t,n=_,r=p;break;default:throw new Error(\"this shouldn't have happened\")}var v=o.xscales,m=o.yscales,g={};for(var y in v){var b=v[y],x=b.r_invert(e,i),w=x[0],k=x[1];g[y]={start:w,end:k}}var S={};for(var T in m){var b=m[T],C=b.r_invert(n,r),w=C[0],k=C[1];S[T]={start:w,end:k}}var A={xrs:g,yrs:S,factor:t};this.plot_view.push_state(\"wheel_pan\",{range:A}),this.plot_view.update_range(A,!1,!0),null!=this.model.document&&this.model.document.interactive_start(this.plot_model.plot)},e}(r.GestureToolView);i.WheelPanToolView=s;var a=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Wheel Pan\",e.icon=\"bk-tool-icon-wheel-pan\",e.event_type=\"scroll\",e.default_order=12,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"WheelPanTool\",this.prototype.default_view=s,this.define({dimension:[o.Dimension,\"width\"]}),this.internal({speed:[o.Number,.001]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(this.tool_name,this.dimension)},enumerable:!0,configurable:!0}),t}(r.GestureTool);(i.WheelPanTool=a).initClass()},function(t,e,i){var n=t(387),r=t(238),u=t(46),o=t(15),s=t(20),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._pinch=function(t){var e,i=t.sx,n=t.sy,r=t.scale;e=1<=r?20*(r-1):-20/r,this._scroll({type:\"mousewheel\",sx:i,sy:n,delta:e})},e.prototype._scroll=function(t){var e=this.plot_model.frame,i=e.bbox.h_range,n=e.bbox.v_range,r=t.sx,o=t.sy,s=this.model.dimensions,a=(\"width\"==s||\"both\"==s)&&i.start<r&&r<i.end,l=(\"height\"==s||\"both\"==s)&&n.start<o&&o<n.end;if(a&&l||this.model.zoom_on_axis){var h=this.model.speed*t.delta,c=u.scale_range(e,h,a,l,{x:r,y:o});this.plot_view.push_state(\"wheel_zoom\",{range:c}),this.plot_view.update_range(c,!1,!0,this.model.maintain_focus),null!=this.model.document&&this.model.document.interactive_start(this.plot_model.plot)}},e}(r.GestureToolView);i.WheelZoomToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Wheel Zoom\",e.icon=\"bk-tool-icon-wheel-zoom\",e.event_type=s.is_mobile?\"pinch\":\"scroll\",e.default_order=10,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"WheelZoomTool\",this.prototype.default_view=a,this.define({dimensions:[o.Dimensions,\"both\"],maintain_focus:[o.Boolean,!0],zoom_on_axis:[o.Boolean,!0],speed:[o.Number,1/600]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(this.tool_name,this.dimensions)},enumerable:!0,configurable:!0}),t}(r.GestureTool);(i.WheelZoomTool=l).initClass()},function(t,e,i){var n=t(222);i.ActionTool=n.ActionTool;var r=t(223);i.HelpTool=r.HelpTool;var o=t(224);i.RedoTool=o.RedoTool;var s=t(225);i.ResetTool=s.ResetTool;var a=t(226);i.SaveTool=a.SaveTool;var l=t(227);i.UndoTool=l.UndoTool;var h=t(228);i.ZoomInTool=h.ZoomInTool;var c=t(229);i.ZoomOutTool=c.ZoomOutTool;var u=t(230);i.ButtonTool=u.ButtonTool;var _=t(232);i.EditTool=_.EditTool;var p=t(231);i.BoxEditTool=p.BoxEditTool;var d=t(233);i.PointDrawTool=d.PointDrawTool;var f=t(234);i.PolyDrawTool=f.PolyDrawTool;var v=t(235);i.PolyEditTool=v.PolyEditTool;var m=t(236);i.BoxSelectTool=m.BoxSelectTool;var g=t(237);i.BoxZoomTool=g.BoxZoomTool;var y=t(238);i.GestureTool=y.GestureTool;var b=t(239);i.LassoSelectTool=b.LassoSelectTool;var x=t(240);i.PanTool=x.PanTool;var w=t(241);i.PolySelectTool=w.PolySelectTool;var k=t(242);i.RangeTool=k.RangeTool;var S=t(243);i.SelectTool=S.SelectTool;var T=t(244);i.TapTool=T.TapTool;var C=t(245);i.WheelPanTool=C.WheelPanTool;var A=t(246);i.WheelZoomTool=A.WheelZoomTool;var E=t(248);i.CrosshairTool=E.CrosshairTool;var M=t(249);i.CustomJSHover=M.CustomJSHover;var O=t(250);i.HoverTool=O.HoverTool;var z=t(251);i.InspectTool=z.InspectTool;var P=t(253);i.Tool=P.Tool;var j=t(254);i.ToolProxy=j.ToolProxy;var N=t(255);i.Toolbar=N.Toolbar;var F=t(256);i.ToolbarBase=F.ToolbarBase;var D=t(257);i.ProxyToolbar=D.ProxyToolbar;var I=t(257);i.ToolbarBox=I.ToolbarBox},function(t,e,i){var n=t(387),r=t(251),o=t(71),s=t(15),a=t(32),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype._move=function(t){if(this.model.active){var e=t.sx,i=t.sy;this.plot_model.frame.bbox.contains(e,i)?this._update_spans(e,i):this._update_spans(null,null)}},e.prototype._move_exit=function(t){this._update_spans(null,null)},e.prototype._update_spans=function(t,e){var i=this.model.dimensions;\"width\"!=i&&\"both\"!=i||(this.model.spans.width.computed_location=e),\"height\"!=i&&\"both\"!=i||(this.model.spans.height.computed_location=t)},e}(r.InspectToolView);i.CrosshairToolView=l;var h=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Crosshair\",e.icon=\"bk-tool-icon-crosshair\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"CrosshairTool\",this.prototype.default_view=l,this.define({dimensions:[s.Dimensions,\"both\"],line_color:[s.Color,\"black\"],line_width:[s.Number,1],line_alpha:[s.Number,1]}),this.internal({location_units:[s.SpatialUnits,\"screen\"],render_mode:[s.RenderMode,\"css\"],spans:[s.Any]})},Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this._get_dim_tooltip(\"Crosshair\",this.dimensions)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"synthetic_renderers\",{get:function(){return a.values(this.spans)},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){i.prototype.initialize.call(this),this.spans={width:new o.Span({for_hover:!0,dimension:\"width\",render_mode:this.render_mode,location_units:this.location_units,line_color:this.line_color,line_width:this.line_width,line_alpha:this.line_alpha}),height:new o.Span({for_hover:!0,dimension:\"height\",render_mode:this.render_mode,location_units:this.location_units,line_color:this.line_color,line_width:this.line_width,line_alpha:this.line_alpha})}},t}(r.InspectTool);(i.CrosshairTool=h).initClass()},function(r,t,o){var i=r(387),e=r(57),n=r(15),s=r(32),a=r(38),l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"CustomJSHover\",this.define({args:[n.Any,{}],code:[n.String,\"\"]})},Object.defineProperty(t.prototype,\"values\",{get:function(){return s.values(this.args)},enumerable:!0,configurable:!0}),t.prototype._make_code=function(t,e,i,n){return new(Function.bind.apply(Function,[void 0].concat(s.keys(this.args),[t,e,i,\"require\",\"exports\",a.use_strict(n)])))},t.prototype.format=function(t,e,i){var n=this._make_code(\"value\",\"format\",\"special_vars\",this.code);return n.apply(void 0,this.values.concat([t,e,i,r,o]))},t}(e.Model);(o.CustomJSHover=l).initClass()},function(t,e,i){var f=t(387),n=t(251),s=t(75),Z=t(175),tt=t(176),o=t(258),u=t(9),k=t(40),S=t(5),r=t(15),T=t(27),et=t(32),C=t(44),a=t(4);function it(t,e,i,n,r,o){var s,a,l={x:r[t],y:o[t]},h={x:r[t+1],y:o[t+1]};if(\"span\"==e.type)\"h\"==e.direction?(s=Math.abs(l.x-i),a=Math.abs(h.x-i)):(s=Math.abs(l.y-n),a=Math.abs(h.y-n));else{var c={x:i,y:n};s=u.dist_2_pts(l,c),a=u.dist_2_pts(h,c)}return s<a?[[l.x,l.y],t]:[[h.x,h.y],t+1]}function nt(t,e,i){return[[t[i],e[i]],i]}i._nearest_line_hit=it,i._line_hit=nt;var l=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return f.__extends(t,r),t.prototype.initialize=function(t){r.prototype.initialize.call(this,t),this.ttviews={}},t.prototype.remove=function(){a.remove_views(this.ttviews),r.prototype.remove.call(this)},t.prototype.connect_signals=function(){var t=this;r.prototype.connect_signals.call(this);for(var e=0,i=this.computed_renderers;e<i.length;e++){var n=i[e];n instanceof Z.GlyphRenderer?this.connect(n.data_source.inspect,this._update):(this.connect(n.node_renderer.data_source.inspect,this._update),this.connect(n.edge_renderer.data_source.inspect,this._update))}this.connect(this.model.properties.renderers.change,function(){return t._computed_renderers=t._ttmodels=null}),this.connect(this.model.properties.names.change,function(){return t._computed_renderers=t._ttmodels=null}),this.connect(this.model.properties.tooltips.change,function(){return t._ttmodels=null})},t.prototype._compute_ttmodels=function(){var t={},e=this.model.tooltips;if(null!=e)for(var i=0,n=this.computed_renderers;i<n.length;i++){var r=n[i];if(r instanceof Z.GlyphRenderer){var o=new s.Tooltip({custom:C.isString(e)||C.isFunction(e),attachment:this.model.attachment,show_arrow:this.model.show_arrow});t[r.id]=o}else{var o=new s.Tooltip({custom:C.isString(e)||C.isFunction(e),attachment:this.model.attachment,show_arrow:this.model.show_arrow});t[r.node_renderer.id]=o,t[r.edge_renderer.id]=o}}return a.build_views(this.ttviews,et.values(t),{parent:this,plot_view:this.plot_view}),t},Object.defineProperty(t.prototype,\"computed_renderers\",{get:function(){if(null==this._computed_renderers){var t=this.model.renderers,e=this.plot_model.plot.renderers,i=this.model.names;this._computed_renderers=o.compute_renderers(t,e,i)}return this._computed_renderers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"ttmodels\",{get:function(){return null==this._ttmodels&&(this._ttmodels=this._compute_ttmodels()),this._ttmodels},enumerable:!0,configurable:!0}),t.prototype._clear=function(){for(var t in this._inspect(1/0,1/0),this.ttmodels){var e=this.ttmodels[t];e.clear()}},t.prototype._move=function(t){if(this.model.active){var e=t.sx,i=t.sy;this.plot_model.frame.bbox.contains(e,i)?this._inspect(e,i):this._clear()}},t.prototype._move_exit=function(){this._clear()},t.prototype._inspect=function(t,e){var i;if(\"mouse\"==this.model.mode)i={type:\"point\",sx:t,sy:e};else{var n=\"vline\"==this.model.mode?\"h\":\"v\";i={type:\"span\",direction:n,sx:t,sy:e}}for(var r=0,o=this.computed_renderers;r<o.length;r++){var s=o[r],a=s.get_selection_manager();a.inspect(this.plot_view.renderer_views[s.id],i)}null!=this.model.callback&&this._emit_callback(i)},t.prototype._update=function(t){var e,i,n,r,o,s,a,l,h,c,u,_,p,d,f,v,m=t[0],g=t[1].geometry;if(this.model.active&&(m instanceof Z.GlyphRendererView||m instanceof tt.GraphRendererView)){var y=m.model,b=this.ttmodels[y.id];if(null!=b){b.clear();var x=y.get_selection_manager(),w=x.inspectors[y.id];if(y instanceof Z.GlyphRenderer&&(w=y.view.convert_selection_to_subset(w)),!w.is_empty()){for(var k=x.source,S=this.plot_model.frame,T=g.sx,C=g.sy,A=S.xscales[y.x_range_name],E=S.yscales[y.y_range_name],M=A.invert(T),O=E.invert(C),z=m.glyph,P=0,j=w.line_indices;P<j.length;P++){var N=j[P],F=z._x[N+1],D=z._y[N+1],I=N,R=void 0,B=void 0;switch(this.model.line_policy){case\"interp\":e=z.get_interpolation_hit(N,g),F=e[0],D=e[1],R=A.compute(F),B=E.compute(D);break;case\"prev\":i=nt(z.sx,z.sy,N),n=i[0],R=n[0],B=n[1],I=i[1];break;case\"next\":r=nt(z.sx,z.sy,N+1),o=r[0],R=o[0],B=o[1],I=r[1];break;case\"nearest\":s=it(N,g,T,C,z.sx,z.sy),a=s[0],R=a[0],B=a[1],I=s[1],F=z._x[I],D=z._y[I];break;default:R=(l=[T,C])[0],B=l[1]}var L={index:I,x:M,y:O,sx:T,sy:C,data_x:F,data_y:D,rx:R,ry:B,indices:w.line_indices,name:m.model.name};b.add(R,B,this._render_tooltips(k,I,L))}for(var V=0,G=w.image_indices;V<G.length;V++){var U=G[V],L={index:U.index,x:M,y:O,sx:T,sy:C},q=this._render_tooltips(k,U,L);b.add(T,C,q)}for(var Y=0,X=w.indices;Y<X.length;Y++){var N=X[Y];if(et.isEmpty(w.multiline_indices)){var F=null!=z._x?z._x[N]:void 0,D=null!=z._y?z._y[N]:void 0,R=void 0,B=void 0;if(\"snap_to_data\"==this.model.point_policy){var H=z.get_anchor_point(this.model.anchor,N,[T,C]);null==H&&(H=z.get_anchor_point(\"center\",N,[T,C])),R=H.x,B=H.y}else R=(v=[T,C])[0],B=v[1];var W=void 0,L={index:W=y instanceof Z.GlyphRenderer?y.view.convert_indices_from_subset([N])[0]:N,x:M,y:O,sx:T,sy:C,data_x:F,data_y:D,indices:w.indices,name:m.model.name};b.add(R,B,this._render_tooltips(k,W,L))}else for(var J=0,Q=w.multiline_indices[N.toString()];J<Q.length;J++){var $=Q[J],F=z._xs[N][$],D=z._ys[N][$],K=$,R=void 0,B=void 0;switch(this.model.line_policy){case\"interp\":h=z.get_interpolation_hit(N,$,g),F=h[0],D=h[1],R=A.compute(F),B=E.compute(D);break;case\"prev\":c=nt(z.sxs[N],z.sys[N],$),u=c[0],R=u[0],B=u[1],K=c[1];break;case\"next\":_=nt(z.sxs[N],z.sys[N],$+1),p=_[0],R=p[0],B=p[1],K=_[1];break;case\"nearest\":d=it($,g,T,C,z.sxs[N],z.sys[N]),f=d[0],R=f[0],B=f[1],K=d[1],F=z._xs[N][K],D=z._ys[N][K];break;default:throw new Error(\"should't have happened\")}var W=void 0,L={index:W=y instanceof Z.GlyphRenderer?y.view.convert_indices_from_subset([N])[0]:N,segment_index:K,x:M,y:O,sx:T,sy:C,data_x:F,data_y:D,indices:w.multiline_indices,name:m.model.name};b.add(R,B,this._render_tooltips(k,W,L))}}}}}},t.prototype._emit_callback=function(t){for(var e=0,i=this.computed_renderers;e<i.length;e++){var n=i[e],r=n.data_source.inspected,o=this.plot_model.frame,s=o.xscales[n.x_range_name],a=o.yscales[n.y_range_name],l=s.invert(t.sx),h=a.invert(t.sy),c=f.__assign({x:l,y:h},t),u=this.model.callback,_=[u,{index:r,geometry:c,renderer:n}],p=_[0],d=_[1];C.isFunction(u)?u(p,d):u.execute(p,d)}},t.prototype._render_tooltips=function(t,e,i){var n=this.model.tooltips;if(C.isString(n)){var r=S.div();return r.innerHTML=k.replace_placeholders(n,t,e,this.model.formatters,i),r}if(C.isFunction(n))return n(t,i);for(var o=S.div({style:{display:\"table\",borderSpacing:\"2px\"}}),s=0,a=n;s<a.length;s++){var l=a[s],h=l[0],c=l[1],u=S.div({style:{display:\"table-row\"}});o.appendChild(u);var _=void 0;if(_=S.div({style:{display:\"table-cell\"},class:\"bk-tooltip-row-label\"},h+\": \"),u.appendChild(_),_=S.div({style:{display:\"table-cell\"},class:\"bk-tooltip-row-value\"}),u.appendChild(_),0<=c.indexOf(\"$color\")){var p=c.match(/\\$color(\\[.*\\])?:(\\w*)/),d=p[1],f=void 0===d?\"\":d,v=p[2],m=t.get_column(v);if(null==m){var g=S.span({},v+\" unknown\");_.appendChild(g);continue}var y=0<=f.indexOf(\"hex\"),b=0<=f.indexOf(\"swatch\"),x=C.isNumber(e)?m[e]:null;if(null==x){var w=S.span({},\"(null)\");_.appendChild(w);continue}y&&(x=T.color2hex(x));var r=S.span({},x);_.appendChild(r),b&&(r=S.span({class:\"bk-tooltip-color-block\",style:{backgroundColor:x}},\" \"),_.appendChild(r))}else{var r=S.span();r.innerHTML=k.replace_placeholders(c.replace(\"$~\",\"$data_\"),t,e,this.model.formatters,i),_.appendChild(r)}}return o},t}(n.InspectToolView);i.HoverToolView=l;var h=function(i){function t(t){var e=i.call(this,t)||this;return e.tool_name=\"Hover\",e.icon=\"bk-tool-icon-hover\",e}return f.__extends(t,i),t.initClass=function(){this.prototype.type=\"HoverTool\",this.prototype.default_view=l,this.define({tooltips:[r.Any,[[\"index\",\"$index\"],[\"data (x, y)\",\"($x, $y)\"],[\"screen (x, y)\",\"($sx, $sy)\"]]],formatters:[r.Any,{}],renderers:[r.Any,\"auto\"],names:[r.Array,[]],mode:[r.String,\"mouse\"],point_policy:[r.String,\"snap_to_data\"],line_policy:[r.String,\"nearest\"],show_arrow:[r.Boolean,!0],anchor:[r.String,\"center\"],attachment:[r.String,\"horizontal\"],callback:[r.Any]})},t}(n.InspectTool);(i.HoverTool=h).initClass()},function(t,e,i){var n=t(387),r=t(230),o=t(252),s=t(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e}(r.ButtonToolView);i.InspectToolView=a;var l=function(i){function t(t){var e=i.call(this,t)||this;return e.event_type=\"move\",e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"InspectTool\",this.prototype.button_view=o.OnOffButtonView,this.define({toggleable:[s.Bool,!0]}),this.override({active:!0})},t}(r.ButtonTool);(i.InspectTool=l).initClass()},function(t,e,i){var n=t(387),r=t(230),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),this.model.active?this.el.classList.add(\"bk-active\"):this.el.classList.remove(\"bk-active\")},e.prototype._clicked=function(){var t=this.model.active;this.model.active=!t},e}(r.ButtonToolButtonView);i.OnOffButtonView=o},function(t,e,i){var n=t(387),r=t(15),o=t(48),_=t(21),s=t(57),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.plot_view=t.plot_view},Object.defineProperty(t.prototype,\"plot_model\",{get:function(){return this.plot_view.model},enumerable:!0,configurable:!0}),t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.active.change,function(){t.model.active?t.activate():t.deactivate()})},t.prototype.activate=function(){},t.prototype.deactivate=function(){},t}(o.View);i.ToolView=a;var l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Tool\",this.internal({active:[r.Boolean,!1]})},Object.defineProperty(t.prototype,\"synthetic_renderers\",{get:function(){return[]},enumerable:!0,configurable:!0}),t.prototype._get_dim_tooltip=function(t,e){switch(e){case\"width\":return t+\" (x-axis)\";case\"height\":return t+\" (y-axis)\";case\"both\":return t}},t.prototype._get_dim_limits=function(t,e,i,n){var r,o=t[0],s=t[1],a=e[0],l=e[1],h=i.bbox.h_range;\"width\"==n||\"both\"==n?(r=[_.min([o,a]),_.max([o,a])],r=[_.max([r[0],h.start]),_.min([r[1],h.end])]):r=[h.start,h.end];var c,u=i.bbox.v_range;return\"height\"==n||\"both\"==n?(c=[_.min([s,l]),_.max([s,l])],c=[_.max([c[0],u.start]),_.min([c[1],u.end])]):c=[u.start,u.end],[r,c]},t}(s.Model);(i.Tool=l).initClass()},function(t,e,i){var n=t(387),r=t(15),o=t(19),s=t(57),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ToolProxy\",this.define({tools:[r.Array,[]],active:[r.Bool,!1],disabled:[r.Bool,!1]})},Object.defineProperty(t.prototype,\"button_view\",{get:function(){return this.tools[0].button_view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"event_type\",{get:function(){return this.tools[0].event_type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"tooltip\",{get:function(){return this.tools[0].tool_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"tool_name\",{get:function(){return this.tools[0].tool_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"icon\",{get:function(){return this.tools[0].icon},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.do=new o.Signal0(this,\"do\")},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.do,function(){return t.doit()}),this.connect(this.properties.active.change,function(){return t.set_active()})},t.prototype.doit=function(){for(var t=0,e=this.tools;t<e.length;t++){var i=e[t];i.do.emit()}},t.prototype.set_active=function(){for(var t=0,e=this.tools;t<e.length;t++){var i=e[t];i.active=this.active}},t}(s.Model);(i.ToolProxy=a).initClass()},function(t,e,i){var n=t(387),r=t(15),v=t(14),m=t(44),g=t(21),y=t(222),b=t(223),x=t(238),w=t(251),o=t(256),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Toolbar\",this.prototype.default_view=o.ToolbarBaseView,this.define({active_drag:[r.Any,\"auto\"],active_inspect:[r.Any,\"auto\"],active_scroll:[r.Any,\"auto\"],active_tap:[r.Any,\"auto\"],active_multi:[r.Any,null]})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._init_tools()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.properties.tools.change,function(){return t._init_tools()})},t.prototype._init_tools=function(){for(var e=this,t=function(e){if(e instanceof w.InspectTool)g.any(s.inspectors,function(t){return t.id==e.id})||(s.inspectors=s.inspectors.concat([e]));else if(e instanceof b.HelpTool)g.any(s.help,function(t){return t.id==e.id})||(s.help=s.help.concat([e]));else if(e instanceof y.ActionTool)g.any(s.actions,function(t){return t.id==e.id})||(s.actions=s.actions.concat([e]));else if(e instanceof x.GestureTool){var t=void 0,i=void 0;m.isString(e.event_type)?(t=[e.event_type],i=!1):(t=e.event_type||[],i=!0);for(var n=0,r=t;n<r.length;n++){var o=r[n];o in s.gestures?(i&&(o=\"multi\"),g.any(s.gestures[o].tools,function(t){return t.id==e.id})||(s.gestures[o].tools=s.gestures[o].tools.concat([e])),s.connect(e.properties.active.change,s._active_change.bind(s,e))):v.logger.warn(\"Toolbar: unknown event type '\"+o+\"' for tool: \"+e.type+\" (\"+e.id+\")\")}}},s=this,i=0,n=this.tools;i<n.length;i++){var r=n[i];t(r)}if(\"auto\"==this.active_inspect);else if(this.active_inspect instanceof w.InspectTool)for(var o=0,a=this.inspectors;o<a.length;o++){var l=a[o];l!=this.active_inspect&&(l.active=!1)}else if(m.isArray(this.active_inspect))for(var h=0,c=this.inspectors;h<c.length;h++){var l=c[h];g.includes(this.active_inspect,l)||(l.active=!1)}else if(null==this.active_inspect)for(var u=0,_=this.inspectors;u<_.length;u++){var l=_[u];l.active=!1}var p=function(t){t.active?e._active_change(t):t.active=!0};for(var d in this.gestures){var f=this.gestures[d];if(0!=f.tools.length){if(f.tools=g.sortBy(f.tools,function(t){return t.default_order}),\"tap\"==d){if(null==this.active_tap)continue;\"auto\"==this.active_tap?p(f.tools[0]):p(this.active_tap)}if(\"pan\"==d){if(null==this.active_drag)continue;\"auto\"==this.active_drag?p(f.tools[0]):p(this.active_drag)}if(\"pinch\"==d||\"scroll\"==d){if(null==this.active_scroll||\"auto\"==this.active_scroll)continue;p(this.active_scroll)}null!=this.active_multi&&p(this.active_multi)}}},t}(o.ToolbarBase);(i.Toolbar=s).initClass()},function(t,e,i){var n=t(387),a=t(14),u=t(5),r=t(4),o=t(15),s=t(6),l=t(44),h=t(57),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this._tool_button_views={},this._build_tool_button_views()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.properties.tools.change,function(){return t._build_tool_button_views()})},t.prototype.remove=function(){r.remove_views(this._tool_button_views),e.prototype.remove.call(this)},t.prototype._build_tool_button_views=function(){var t=null!=this.model._proxied_tools?this.model._proxied_tools:this.model.tools;r.build_views(this._tool_button_views,t,{parent:this},function(t){return t.button_view})},t.prototype.render=function(){var e=this;if(u.empty(this.el),this.el.classList.add(\"bk-toolbar\"),this.el.classList.add(\"bk-toolbar-\"+this.model.toolbar_location),null!=this.model.logo){var t=\"grey\"===this.model.logo?\"bk-grey\":null,i=u.a({href:\"https://bokeh.pydata.org/\",target:\"_blank\",class:[\"bk-logo\",\"bk-logo-small\",t]});this.el.appendChild(i)}var n=[],r=function(t){return e._tool_button_views[t.id].el},o=this.model.gestures;for(var s in o)n.push(o[s].tools.map(r));n.push(this.model.actions.map(r)),n.push(this.model.inspectors.filter(function(t){return t.toggleable}).map(r)),n.push(this.model.help.map(r));for(var a=0,l=n;a<l.length;a++){var h=l[a];if(0!==h.length){var c=u.div({class:\"bk-button-bar\"},h);this.el.appendChild(c)}}},t}(s.DOMView);i.ToolbarBaseView=c;var _=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ToolbarBase\",this.prototype.default_view=c,this.define({tools:[o.Array,[]],logo:[o.String,\"normal\"]}),this.internal({gestures:[o.Any,function(){return{pan:{tools:[],active:null},scroll:{tools:[],active:null},pinch:{tools:[],active:null},tap:{tools:[],active:null},doubletap:{tools:[],active:null},press:{tools:[],active:null},rotate:{tools:[],active:null},move:{tools:[],active:null},multi:{tools:[],active:null}}}],actions:[o.Array,[]],inspectors:[o.Array,[]],help:[o.Array,[]],toolbar_location:[o.Location,\"right\"]})},Object.defineProperty(t.prototype,\"horizontal\",{get:function(){return\"above\"===this.toolbar_location||\"below\"===this.toolbar_location},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"vertical\",{get:function(){return\"left\"===this.toolbar_location||\"right\"===this.toolbar_location},enumerable:!0,configurable:!0}),t.prototype._active_change=function(t){var e=t.event_type;if(null!=e)for(var i=l.isString(e)?[e]:e,n=0,r=i;n<r.length;n++){var o=r[n];if(t.active){var s=this.gestures[o].active;null!=s&&t!=s&&(a.logger.debug(\"Toolbar: deactivating tool: \"+s.type+\" (\"+s.id+\") for event type '\"+o+\"'\"),s.active=!1),this.gestures[o].active=t,a.logger.debug(\"Toolbar: activating tool: \"+t.type+\" (\"+t.id+\") for event type '\"+o+\"'\")}else this.gestures[o].active=null}},t}(h.Model);(i.ToolbarBase=_).initClass()},function(t,e,i){var n=t(387),r=t(15),o=t(5),a=t(14),l=t(44),S=t(21),h=t(222),c=t(223),u=t(238),_=t(251),s=t(256),T=t(254),p=t(152),d=t(4),f=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ProxyToolbar\"},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._init_tools(),this._merge_tools()},t.prototype._init_tools=function(){for(var t=function(e){if(e instanceof _.InspectTool)S.any(s.inspectors,function(t){return t.id==e.id})||(s.inspectors=s.inspectors.concat([e]));else if(e instanceof c.HelpTool)S.any(s.help,function(t){return t.id==e.id})||(s.help=s.help.concat([e]));else if(e instanceof h.ActionTool)S.any(s.actions,function(t){return t.id==e.id})||(s.actions=s.actions.concat([e]));else if(e instanceof u.GestureTool){var t=void 0,i=void 0;l.isString(e.event_type)?(t=[e.event_type],i=!1):(t=e.event_type||[],i=!0);for(var n=0,r=t;n<r.length;n++){var o=r[n];o in s.gestures?(i&&(o=\"multi\"),S.any(s.gestures[o].tools,function(t){return t.id==e.id})||(s.gestures[o].tools=s.gestures[o].tools.concat([e]))):a.logger.warn(\"Toolbar: unknown event type '\"+o+\"' for tool: \"+e.type+\" (\"+e.id+\")\")}}},s=this,e=0,i=this.tools;e<i.length;e++){var n=i[e];t(n)}},t.prototype._merge_tools=function(){var t,n=this;this._proxied_tools=[];for(var e={},i={},r={},o=[],s=[],a=0,l=this.help;a<l.length;a++){var h=l[a];S.includes(s,h.redirect)||(o.push(h),s.push(h.redirect))}for(var c in(t=this._proxied_tools).push.apply(t,o),this.help=o,this.gestures){var u=this.gestures[c];c in r||(r[c]={});for(var _=0,p=u.tools;_<p.length;_++){var d=p[_];d.type in r[c]||(r[c][d.type]=[]),r[c][d.type].push(d)}}for(var f=0,v=this.inspectors;f<v.length;f++){var d=v[f];d.type in e||(e[d.type]=[]),e[d.type].push(d)}for(var m=0,g=this.actions;m<g.length;m++){var d=g[m];d.type in i||(i[d.type]=[]),i[d.type].push(d)}var y=function(t,e){void 0===e&&(e=!1);var i=new T.ToolProxy({tools:t,active:e});return n._proxied_tools.push(i),i};for(var c in r){var u=this.gestures[c];for(var b in u.tools=[],r[c]){var x=r[c][b];if(0<x.length){var w=y(x);u.tools.push(w),this.connect(w.properties.active.change,this._active_change.bind(this,w))}}}for(var b in this.actions=[],i){var x=i[b];0<x.length&&this.actions.push(y(x))}for(var b in this.inspectors=[],e){var x=e[b];0<x.length&&this.inspectors.push(y(x,!0))}for(var k in this.gestures){var u=this.gestures[k];0!=u.tools.length&&(u.tools=S.sortBy(u.tools,function(t){return t.default_order}),\"pinch\"!=k&&\"scroll\"!=k&&\"multi\"!=k&&(u.tools[0].active=!0))}},t}(s.ToolbarBase);(i.ProxyToolbar=f).initClass();var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.model.toolbar.toolbar_location=this.model.toolbar_location,this._toolbar_views={},d.build_views(this._toolbar_views,[this.model.toolbar],{parent:this})},t.prototype.remove=function(){d.remove_views(this._toolbar_views),e.prototype.remove.call(this)},t.prototype.css_classes=function(){return e.prototype.css_classes.call(this).concat(\"bk-toolbar-box\")},t.prototype.render=function(){e.prototype.render.call(this);var t=this._toolbar_views[this.model.toolbar.id];t.render(),o.empty(this.el),this.el.appendChild(t.el)},t.prototype.get_width=function(){return this.model.toolbar.vertical?30:null},t.prototype.get_height=function(){return this.model.toolbar.horizontal?30:null},t}(p.LayoutDOMView);i.ToolbarBoxView=v;var m=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"ToolbarBox\",this.prototype.default_view=v,this.define({toolbar:[r.Instance],toolbar_location:[r.Location,\"right\"]})},Object.defineProperty(t.prototype,\"sizing_mode\",{get:function(){switch(this.toolbar_location){case\"above\":case\"below\":return\"scale_width\";case\"left\":case\"right\":return\"scale_height\"}},enumerable:!0,configurable:!0}),t}(p.LayoutDOM);(i.ToolbarBox=m).initClass()},function(t,e,i){var r=t(21),o=t(175),s=t(176);i.compute_renderers=function(t,e,i){return null==t?[]:(n=\"auto\"==t?e.filter(function(t){return t instanceof o.GlyphRenderer||t instanceof s.GraphRenderer}):t,0<i.length&&(n=n.filter(function(t){return r.includes(i,t.name)})),n);var n}},function(i,t,e){var n=i(387),r=i(266),o=i(15),s=i(32),a=i(38),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"CustomJSTransform\",this.define({args:[o.Any,{}],func:[o.String,\"\"],v_func:[o.String,\"\"],use_strict:[o.Boolean,!1]})},Object.defineProperty(t.prototype,\"names\",{get:function(){return s.keys(this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"values\",{get:function(){return s.values(this.args)},enumerable:!0,configurable:!0}),t.prototype._make_transform=function(t,e){var i=this.use_strict?a.use_strict(e):e;return new(Function.bind.apply(Function,[void 0].concat(this.names,[t,\"require\",\"exports\",i])))},Object.defineProperty(t.prototype,\"scalar_transform\",{get:function(){return this._make_transform(\"x\",this.func)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"vector_transform\",{get:function(){return this._make_transform(\"xs\",this.v_func)},enumerable:!0,configurable:!0}),t.prototype.compute=function(t){return this.scalar_transform.apply(this,this.values.concat([t,i,{}]))},t.prototype.v_compute=function(t){return this.vector_transform.apply(this,this.values.concat([t,i,{}]))},t}(r.Transform);(e.CustomJSTransform=l).initClass()},function(t,e,i){var n=t(387),r=t(266),o=t(171),s=t(15),a=t(44),l=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Dodge\",this.define({value:[s.Number,0],range:[s.Instance]})},t.prototype.v_compute=function(t){var e;if(this.range instanceof o.FactorRange)e=this.range.v_synthetic(t);else{if(!a.isArrayableOf(t,a.isNumber))throw new Error(\"unexpected\");e=t}for(var i=new Float64Array(e.length),n=0;n<e.length;n++){var r=e[n];i[n]=this._compute(r)}return i},t.prototype.compute=function(t){if(this.range instanceof o.FactorRange)return this._compute(this.range.synthetic(t));if(a.isNumber(t))return this._compute(t);throw new Error(\"unexpected\")},t.prototype._compute=function(t){return t+this.value},t}(r.Transform);(i.Dodge=l).initClass()},function(t,e,i){var n=t(259);i.CustomJSTransform=n.CustomJSTransform;var r=t(260);i.Dodge=r.Dodge;var o=t(262);i.Interpolator=o.Interpolator;var s=t(263);i.Jitter=s.Jitter;var a=t(264);i.LinearInterpolator=a.LinearInterpolator;var l=t(265);i.StepInterpolator=l.StepInterpolator;var h=t(266);i.Transform=h.Transform},function(t,e,i){var n=t(387),r=t(266),o=t(15),u=t(21),_=t(44),s=function(i){function t(t){var e=i.call(this,t)||this;return e._sorted_dirty=!0,e}return n.__extends(t,i),t.initClass=function(){this.prototype.type=\"Interpolator\",this.define({x:[o.Any],y:[o.Any],data:[o.Any],clip:[o.Bool,!0]})},t.prototype.connect_signals=function(){var t=this;i.prototype.connect_signals.call(this),this.connect(this.change,function(){return t._sorted_dirty=!0})},t.prototype.v_compute=function(t){for(var e=new Float64Array(t.length),i=0;i<t.length;i++){var n=t[i];e[i]=this.compute(n)}return e},t.prototype.sort=function(t){if(void 0===t&&(t=!1),this._sorted_dirty){var e,i;if(_.isString(this.x)&&_.isString(this.y)&&null!=this.data){var n=this.data.columns();if(!u.includes(n,this.x))throw new Error(\"The x parameter does not correspond to a valid column name defined in the data parameter\");if(!u.includes(n,this.y))throw new Error(\"The y parameter does not correspond to a valid column name defined in the data parameter\");e=this.data.get_column(this.x),i=this.data.get_column(this.y)}else{if(!_.isArray(this.x)||!_.isArray(this.y))throw new Error(\"parameters 'x' and 'y' must be both either string fields or arrays\");e=this.x,i=this.y}if(e.length!==i.length)throw new Error(\"The length for x and y do not match\");if(e.length<2)throw new Error(\"x and y must have at least two elements to support interpolation\");var r=[];for(var o in e)r.push({x:e[o],y:i[o]});t?r.sort(function(t,e){return t.x>e.x?-1:t.x==e.x?0:1}):r.sort(function(t,e){return t.x<e.x?-1:t.x==e.x?0:1}),this._x_sorted=[],this._y_sorted=[];for(var s=0,a=r;s<a.length;s++){var l=a[s],h=l.x,c=l.y;this._x_sorted.push(h),this._y_sorted.push(c)}this._sorted_dirty=!1}},t}(r.Transform);(i.Interpolator=s).initClass()},function(t,e,i){var n=t(387),r=t(266),o=t(171),s=t(44),a=t(15),l=t(31),h=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Jitter\",this.define({mean:[a.Number,0],width:[a.Number,1],distribution:[a.Distribution,\"uniform\"],range:[a.Instance]}),this.internal({previous_values:[a.Array]})},t.prototype.v_compute=function(t){if(null!=this.previous_values&&this.previous_values.length==t.length)return this.previous_values;var e;if(this.range instanceof o.FactorRange)e=this.range.v_synthetic(t);else{if(!s.isArrayableOf(t,s.isNumber))throw new Error(\"unexpected\");e=t}for(var i=new Float64Array(e.length),n=0;n<e.length;n++){var r=e[n];i[n]=this._compute(r)}return this.previous_values=i},t.prototype.compute=function(t){if(this.range instanceof o.FactorRange)return this._compute(this.range.synthetic(t));if(s.isNumber(t))return this._compute(t);throw new Error(\"unexpected\")},t.prototype._compute=function(t){switch(this.distribution){case\"uniform\":return t+this.mean+(l.random()-.5)*this.width;case\"normal\":return t+l.rnorm(this.mean,this.width)}},t}(r.Transform);(i.Jitter=h).initClass()},function(t,e,i){var n=t(387),s=t(21),r=t(262),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"LinearInterpolator\"},t.prototype.compute=function(e){if(this.sort(!1),this.clip){if(e<this._x_sorted[0]||e>this._x_sorted[this._x_sorted.length-1])return NaN}else{if(e<this._x_sorted[0])return this._y_sorted[0];if(e>this._x_sorted[this._x_sorted.length-1])return this._y_sorted[this._y_sorted.length-1]}if(e==this._x_sorted[0])return this._y_sorted[0];var t=s.findLastIndex(this._x_sorted,function(t){return t<e}),i=this._x_sorted[t],n=this._x_sorted[t+1],r=this._y_sorted[t],o=this._y_sorted[t+1];return r+(e-i)/(n-i)*(o-r)},t}(r.Interpolator);(i.LinearInterpolator=o).initClass()},function(t,e,i){var n=t(387),r=t(262),o=t(15),s=t(21),a=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"StepInterpolator\",this.define({mode:[o.StepMode,\"after\"]})},t.prototype.compute=function(e){if(this.sort(!1),this.clip){if(e<this._x_sorted[0]||e>this._x_sorted[this._x_sorted.length-1])return NaN}else{if(e<this._x_sorted[0])return this._y_sorted[0];if(e>this._x_sorted[this._x_sorted.length-1])return this._y_sorted[this._y_sorted.length-1]}var t;switch(this.mode){case\"after\":t=s.findLastIndex(this._x_sorted,function(t){return t<=e});break;case\"before\":t=s.findIndex(this._x_sorted,function(t){return e<=t});break;case\"center\":var i=this._x_sorted.map(function(t){return Math.abs(t-e)}),n=s.min(i);t=s.findIndex(i,function(t){return n===t});break;default:throw new Error(\"unknown mode: \"+this.mode)}return-1!=t?this._y_sorted[t]:NaN},t}(r.Interpolator);(i.StepInterpolator=a).initClass()},function(t,e,i){var n=t(387),r=t(57),o=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.initClass=function(){this.prototype.type=\"Transform\"},t}(r.Model);(i.Transform=o).initClass()},function(t,e,i){\"function\"!=typeof WeakMap&&t(337),\"function\"!=typeof Set&&t(327),Number.isInteger||(Number.isInteger=function(t){return\"number\"==typeof t&&isFinite(t)&&Math.floor(t)===t});var n,l,r,h,o=String.prototype;o.repeat||(o.repeat=function(t){if(null==this)throw new TypeError(\"can't convert \"+this+\" to object\");var e=\"\"+this;if((t=+t)!=t&&(t=0),t<0)throw new RangeError(\"repeat count must be non-negative\");if(t==1/0)throw new RangeError(\"repeat count must be less than infinity\");if(t=Math.floor(t),0==e.length||0==t)return\"\";if(e.length*t>=1<<28)throw new RangeError(\"repeat count must not overflow maximum string size\");for(var i=\"\";1==(1&t)&&(i+=e),0!=(t>>>=1);)e+=e;return i}),Array.from||(Array.from=(n=Object.prototype.toString,l=function(t){return\"function\"==typeof t||\"[object Function]\"===n.call(t)},r=Math.pow(2,53)-1,h=function(t){var e,i=(e=Number(t),isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e);return Math.min(Math.max(i,0),r)},function(t){var e=Object(t);if(null==t)throw new TypeError(\"Array.from requires an array-like object - not null or undefined\");var i,n=1<arguments.length?arguments[1]:void 0;if(void 0!==n){if(!l(n))throw new TypeError(\"Array.from: when provided, the second argument must be a function\");2<arguments.length&&(i=arguments[2])}for(var r=h(e.length),o=l(this)?Object(new this(r)):new Array(r),s=0 // 13. If IsConstructor(C) is true, then ;s<r;){var a=e[s];o[s]=n?void 0===i?n(a,s):n.call(i,a,s):a,s+=1}return o.length=r,o}))},function(t,e,i){var n=t(387);n.__exportStar(t(269),i),n.__exportStar(t(270),i)},function(t,e,i){var n=t(38),r=function(){function s(t,e,i){this.header=t,this.metadata=e,this.content=i,this.buffers=[]}return s.assemble=function(t,e,i){var n=JSON.parse(t),r=JSON.parse(e),o=JSON.parse(i);return new s(n,r,o)},s.prototype.assemble_buffer=function(t,e){var i=null!=this.header.num_buffers?this.header.num_buffers:0;if(i<=this.buffers.length)throw new Error(\"too many buffers received, expecting #{nb}\");this.buffers.push([t,e])},s.create=function(t,e,i){void 0===i&&(i={});var n=s.create_header(t);return new s(n,e,i)},s.create_header=function(t){return{msgid:n.uniqueId(),msgtype:t}},s.prototype.complete=function(){return!(null==this.header||null==this.metadata||null==this.content||\"num_buffers\"in this.header&&this.buffers.length!==this.header.num_buffers)},s.prototype.send=function(t){var e=null!=this.header.num_buffers?this.header.num_buffers:0;if(0<e)throw new Error(\"BokehJS only supports receiving buffers, not sending\");var i=JSON.stringify(this.header),n=JSON.stringify(this.metadata),r=JSON.stringify(this.content);t.send(i),t.send(n),t.send(r)},s.prototype.msgid=function(){return this.header.msgid},s.prototype.msgtype=function(){return this.header.msgtype},s.prototype.reqid=function(){return this.header.reqid},s.prototype.problem=function(){return\"msgid\"in this.header?\"msgtype\"in this.header?null:\"No msgtype in header\":\"No msgid in header\"},s}();i.Message=r},function(t,e,i){var o=t(269),n=function(){function t(){this.message=null,this._partial=null,this._fragments=[],this._buf_header=null,this._current_consumer=this._HEADER}return t.prototype.consume=function(t){this._current_consumer(t)},t.prototype._HEADER=function(t){this._assume_text(t),this.message=null,this._partial=null,this._fragments=[t],this._buf_header=null,this._current_consumer=this._METADATA},t.prototype._METADATA=function(t){this._assume_text(t),this._fragments.push(t),this._current_consumer=this._CONTENT},t.prototype._CONTENT=function(t){this._assume_text(t),this._fragments.push(t);var e=this._fragments.slice(0,3),i=e[0],n=e[1],r=e[2];this._partial=o.Message.assemble(i,n,r),this._check_complete()},t.prototype._BUFFER_HEADER=function(t){this._assume_text(t),this._buf_header=t,this._current_consumer=this._BUFFER_PAYLOAD},t.prototype._BUFFER_PAYLOAD=function(t){this._assume_binary(t),this._partial.assemble_buffer(this._buf_header,t),this._check_complete()},t.prototype._assume_text=function(t){if(t instanceof ArrayBuffer)throw new Error(\"Expected text fragment but received binary fragment\")},t.prototype._assume_binary=function(t){if(!(t instanceof ArrayBuffer))throw new Error(\"Expected binary fragment but received text fragment\")},t.prototype._check_complete=function(){this._partial.complete()?(this.message=this._partial,this._current_consumer=this._HEADER):this._current_consumer=this._BUFFER_HEADER},t}();i.Receiver=n},function(t,e,i){i.safely=function(t,e){void 0===e&&(e=!1);try{return t()}catch(t){if(function(t){var e=document.createElement(\"div\");e.style.backgroundColor=\"#f2dede\",e.style.border=\"1px solid #a94442\",e.style.borderRadius=\"4px\",e.style.display=\"inline-block\",e.style.fontFamily=\"sans-serif\",e.style.marginTop=\"5px\",e.style.minWidth=\"200px\",e.style.padding=\"5px 5px 5px 10px\",e.classList.add(\"bokeh-error-box-into-flames\");var i=document.createElement(\"span\");i.style.backgroundColor=\"#a94442\",i.style.borderRadius=\"0px 4px 0px 0px\",i.style.color=\"white\",i.style.cursor=\"pointer\",i.style.cssFloat=\"right\",i.style.fontSize=\"0.8em\",i.style.margin=\"-6px -6px 0px 0px\",i.style.padding=\"2px 5px 4px 5px\",i.title=\"close\",i.setAttribute(\"aria-label\",\"close\"),i.appendChild(document.createTextNode(\"x\")),i.addEventListener(\"click\",function(){return s.removeChild(e)});var n=document.createElement(\"h3\");n.style.color=\"#a94442\",n.style.margin=\"8px 0px 0px 0px\",n.style.padding=\"0px\",n.appendChild(document.createTextNode(\"Bokeh Error\"));var r=document.createElement(\"pre\");r.style.whiteSpace=\"unset\",r.style.overflowX=\"auto\";var o=t instanceof Error?t.message:t;r.appendChild(document.createTextNode(o)),e.appendChild(i),e.appendChild(n),e.appendChild(r);var s=document.getElementsByTagName(\"body\")[0];s.insertBefore(e,s.firstChild)}(t),e)return;throw t}}},function(t,e,i){i.version=\"0.13.0\"},function(t,e,i){!function(){\"use strict\";var _,x,p,d,a;function f(t,e){var i,n=Object.keys(e);for(i=0;i<n.length;i++)t=t.replace(new RegExp(\"\\\\{\"+n[i]+\"\\\\}\",\"gi\"),e[n[i]]);return t}function l(t){var e,i,n;if(!t)throw new Error(\"cannot create a random attribute name for an undefined object\");e=\"ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz\",i=\"\";do{for(i=\"\",n=0;n<12;n++)i+=e[Math.floor(Math.random()*e.length)]}while(t[i]);return i}a=function(t,e){var i,n,r,o={};for(t=t.split(\",\"),e=e||10,i=0;i<t.length;i+=2)n=\"&\"+t[i+1]+\";\",r=parseInt(t[i],e),o[n]=\"&#\"+r+\";\";return o[\"\\\\xa0\"]=\"&#160;\",o}(\"50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro\",32),_={strokeStyle:{svgAttr:\"stroke\",canvas:\"#000000\",svg:\"none\",apply:\"stroke\"},fillStyle:{svgAttr:\"fill\",canvas:\"#000000\",svg:null,apply:\"fill\"},lineCap:{svgAttr:\"stroke-linecap\",canvas:\"butt\",svg:\"butt\",apply:\"stroke\"},lineJoin:{svgAttr:\"stroke-linejoin\",canvas:\"miter\",svg:\"miter\",apply:\"stroke\"},miterLimit:{svgAttr:\"stroke-miterlimit\",canvas:10,svg:4,apply:\"stroke\"},lineWidth:{svgAttr:\"stroke-width\",canvas:1,svg:1,apply:\"stroke\"},globalAlpha:{svgAttr:\"opacity\",canvas:1,svg:1,apply:\"fill stroke\"},font:{canvas:\"10px sans-serif\"},shadowColor:{canvas:\"#000000\"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:\"start\"},textBaseline:{canvas:\"alphabetic\"},lineDash:{svgAttr:\"stroke-dasharray\",canvas:[],svg:null,apply:\"stroke\"}},(p=function(t,e){this.__root=t,this.__ctx=e}).prototype.addColorStop=function(t,e){var i,n=this.__ctx.__createElement(\"stop\");n.setAttribute(\"offset\",t),-1!==e.indexOf(\"rgba\")?(i=/rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d?\\.?\\d*)\\s*\\)/gi.exec(e),n.setAttribute(\"stop-color\",f(\"rgb({r},{g},{b})\",{r:i[1],g:i[2],b:i[3]})),n.setAttribute(\"stop-opacity\",i[4])):n.setAttribute(\"stop-color\",e),this.__root.appendChild(n)},d=function(t,e){this.__root=t,this.__ctx=e},(x=function(t){var e,i={width:500,height:500,enableMirroring:!1};if(1<arguments.length?((e=i).width=t,e.height=arguments[1]):e=t||i,!(this instanceof x))return new x(e);this.width=e.width||i.width,this.height=e.height||i.height,this.enableMirroring=void 0!==e.enableMirroring?e.enableMirroring:i.enableMirroring,(this.canvas=this).__document=e.document||document,e.ctx?this.__ctx=e.ctx:(this.__canvas=this.__document.createElement(\"canvas\"),this.__ctx=this.__canvas.getContext(\"2d\")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\"),this.__root.setAttribute(\"version\",1.1),this.__root.setAttribute(\"xmlns\",\"http://www.w3.org/2000/svg\"),this.__root.setAttributeNS(\"http://www.w3.org/2000/xmlns/\",\"xmlns:xlink\",\"http://www.w3.org/1999/xlink\"),this.__root.setAttribute(\"width\",this.width),this.__root.setAttribute(\"height\",this.height),this.__ids={},this.__defs=this.__document.createElementNS(\"http://www.w3.org/2000/svg\",\"defs\"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"),this.__root.appendChild(this.__currentElement)}).prototype.__createElement=function(t,e,i){void 0===e&&(e={});var n,r,o=this.__document.createElementNS(\"http://www.w3.org/2000/svg\",t),s=Object.keys(e);for(i&&(o.setAttribute(\"fill\",\"none\"),o.setAttribute(\"stroke\",\"none\")),n=0;n<s.length;n++)r=s[n],o.setAttribute(r,e[r]);return o},x.prototype.__setDefaultStyles=function(){var t,e,i=Object.keys(_);for(t=0;t<i.length;t++)this[e=i[t]]=_[e].canvas},x.prototype.__applyStyleState=function(t){var e,i,n=Object.keys(t);for(e=0;e<n.length;e++)this[i=n[e]]=t[i]},x.prototype.__getStyleState=function(){var t,e,i={},n=Object.keys(_);for(t=0;t<n.length;t++)e=n[t],i[e]=this[e];return i},x.prototype.__applyStyleToCurrentElement=function(e){var t=this.__currentElement,i=this.__currentElementsToStyle;i&&(t.setAttribute(e,\"\"),t=i.element,i.children.forEach(function(t){t.setAttribute(e,\"\")}));var n,r,o,s,a,l=Object.keys(_);for(n=0;n<l.length;n++)if(r=_[l[n]],o=this[l[n]],r.apply)if(o instanceof d){if(o.__ctx)for(;o.__ctx.__defs.childNodes.length;)s=o.__ctx.__defs.childNodes[0].getAttribute(\"id\"),this.__ids[s]=s,this.__defs.appendChild(o.__ctx.__defs.childNodes[0]);t.setAttribute(r.apply,f(\"url(#{id})\",{id:o.__root.getAttribute(\"id\")}))}else if(o instanceof p)t.setAttribute(r.apply,f(\"url(#{id})\",{id:o.__root.getAttribute(\"id\")}));else if(-1!==r.apply.indexOf(e)&&r.svg!==o)if(\"stroke\"!==r.svgAttr&&\"fill\"!==r.svgAttr||-1===o.indexOf(\"rgba\")){var h=r.svgAttr;if(\"globalAlpha\"===l[n]&&(h=e+\"-\"+r.svgAttr,t.getAttribute(h)))continue;t.setAttribute(h,o)}else{a=/rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d?\\.?\\d*)\\s*\\)/gi.exec(o),t.setAttribute(r.svgAttr,f(\"rgb({r},{g},{b})\",{r:a[1],g:a[2],b:a[3]}));var c=a[4],u=this.globalAlpha;null!=u&&(c*=u),t.setAttribute(r.svgAttr+\"-opacity\",c)}},x.prototype.__closestGroupOrSvg=function(t){return\"g\"===(t=t||this.__currentElement).nodeName||\"svg\"===t.nodeName?t:this.__closestGroupOrSvg(t.parentNode)},x.prototype.getSerializedSvg=function(t){var e,i,n,r,o,s=(new XMLSerializer).serializeToString(this.__root);if(/xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg\".+xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg/gi.test(s)&&(s=s.replace('xmlns=\"http://www.w3.org/2000/svg','xmlns:xlink=\"http://www.w3.org/1999/xlink')),t)for(e=Object.keys(a),i=0;i<e.length;i++)n=e[i],r=a[n],(o=new RegExp(n,\"gi\")).test(s)&&(s=s.replace(o,r));return s},x.prototype.getSvg=function(){return this.__root},x.prototype.save=function(){var t=this.__createElement(\"g\"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(t),this.__currentElement=t,this.__stack.push(this.__getStyleState())},x.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var t=this.__stack.pop();this.__applyStyleState(t)},x.prototype.__addTransform=function(t){var e=this.__closestGroupOrSvg();if(0<e.childNodes.length){\"path\"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var i=this.__createElement(\"g\");e.appendChild(i),this.__currentElement=i}var n=this.__currentElement.getAttribute(\"transform\");n?n+=\" \":n=\"\",n+=t,this.__currentElement.setAttribute(\"transform\",n)},x.prototype.scale=function(t,e){void 0===e&&(e=t),this.__addTransform(f(\"scale({x},{y})\",{x:t,y:e}))},x.prototype.rotate=function(t){var e=180*t/Math.PI;this.__addTransform(f(\"rotate({angle},{cx},{cy})\",{angle:e,cx:0,cy:0}))},x.prototype.translate=function(t,e){this.__addTransform(f(\"translate({x},{y})\",{x:t,y:e}))},x.prototype.transform=function(t,e,i,n,r,o){this.__addTransform(f(\"matrix({a},{b},{c},{d},{e},{f})\",{a:t,b:e,c:i,d:n,e:r,f:o}))},x.prototype.beginPath=function(){var t;this.__currentDefaultPath=\"\",this.__currentPosition={},t=this.__createElement(\"path\",{},!0),this.__closestGroupOrSvg().appendChild(t),this.__currentElement=t},x.prototype.__applyCurrentDefaultPath=function(){var t=this.__currentElement;\"path\"===t.nodeName?t.setAttribute(\"d\",this.__currentDefaultPath):console.error(\"Attempted to apply path command to node\",t.nodeName)},x.prototype.__addPathCommand=function(t){this.__currentDefaultPath+=\" \",this.__currentDefaultPath+=t},x.prototype.moveTo=function(t,e){\"path\"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:t,y:e},this.__addPathCommand(f(\"M {x} {y}\",{x:t,y:e}))},x.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand(\"Z\")},x.prototype.lineTo=function(t,e){this.__currentPosition={x:t,y:e},-1<this.__currentDefaultPath.indexOf(\"M\")?this.__addPathCommand(f(\"L {x} {y}\",{x:t,y:e})):this.__addPathCommand(f(\"M {x} {y}\",{x:t,y:e}))},x.prototype.bezierCurveTo=function(t,e,i,n,r,o){this.__currentPosition={x:r,y:o},this.__addPathCommand(f(\"C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}\",{cp1x:t,cp1y:e,cp2x:i,cp2y:n,x:r,y:o}))},x.prototype.quadraticCurveTo=function(t,e,i,n){this.__currentPosition={x:i,y:n},this.__addPathCommand(f(\"Q {cpx} {cpy} {x} {y}\",{cpx:t,cpy:e,x:i,y:n}))};var b=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]};x.prototype.arcTo=function(t,e,i,n,r){var o=this.__currentPosition&&this.__currentPosition.x,s=this.__currentPosition&&this.__currentPosition.y;if(void 0!==o&&void 0!==s){if(r<0)throw new Error(\"IndexSizeError: The radius provided (\"+r+\") is negative.\");if(o===t&&s===e||t===i&&e===n||0===r)this.lineTo(t,e);else{var a=b([o-t,s-e]),l=b([i-t,n-e]);if(a[0]*l[1]!=a[1]*l[0]){var h=a[0]*l[0]+a[1]*l[1],c=Math.acos(Math.abs(h)),u=b([a[0]+l[0],a[1]+l[1]]),_=r/Math.sin(c/2),p=t+_*u[0],d=e+_*u[1],f=[-a[1],a[0]],v=[l[1],-l[0]],m=function(t){var e=t[0],i=t[1];return 0<=i?Math.acos(e):-Math.acos(e)},g=m(f),y=m(v);this.lineTo(p+f[0]*r,d+f[1]*r),this.arc(p,d,r,g,y)}else this.lineTo(t,e)}}},x.prototype.stroke=function(){\"path\"===this.__currentElement.nodeName&&this.__currentElement.setAttribute(\"paint-order\",\"fill stroke markers\"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement(\"stroke\")},x.prototype.fill=function(){\"path\"===this.__currentElement.nodeName&&this.__currentElement.setAttribute(\"paint-order\",\"stroke fill markers\"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement(\"fill\")},x.prototype.rect=function(t,e,i,n){\"path\"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.lineTo(t,e),this.closePath()},x.prototype.fillRect=function(t,e,i,n){var r;r=this.__createElement(\"rect\",{x:t,y:e,width:i,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement(\"fill\")},x.prototype.strokeRect=function(t,e,i,n){var r;r=this.__createElement(\"rect\",{x:t,y:e,width:i,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement(\"stroke\")},x.prototype.__clearCanvas=function(){for(var t=this.__closestGroupOrSvg(),e=t.getAttribute(\"transform\"),i=this.__root.childNodes[1],n=i.childNodes,r=n.length-1;0<=r;r--)n[r]&&i.removeChild(n[r]);this.__currentElement=i,this.__groupStack=[],e&&this.__addTransform(e)},x.prototype.clearRect=function(t,e,i,n){if(0!==t||0!==e||i!==this.width||n!==this.height){var r,o=this.__closestGroupOrSvg();r=this.__createElement(\"rect\",{x:t,y:e,width:i,height:n,fill:\"#FFFFFF\"},!0),o.appendChild(r)}else this.__clearCanvas()},x.prototype.createLinearGradient=function(t,e,i,n){var r=this.__createElement(\"linearGradient\",{id:l(this.__ids),x1:t+\"px\",x2:i+\"px\",y1:e+\"px\",y2:n+\"px\",gradientUnits:\"userSpaceOnUse\"},!1);return this.__defs.appendChild(r),new p(r,this)},x.prototype.createRadialGradient=function(t,e,i,n,r,o){var s=this.__createElement(\"radialGradient\",{id:l(this.__ids),cx:n+\"px\",cy:r+\"px\",r:o+\"px\",fx:t+\"px\",fy:e+\"px\",gradientUnits:\"userSpaceOnUse\"},!1);return this.__defs.appendChild(s),new p(s,this)},x.prototype.__parseFont=function(){var t=/&#94;\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:\\s*\\/\\s*(normal|[.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])))?\\s*([-,\\'\\\"\\sa-z0-9]+?)\\s*$/i.exec(this.font),e={style:t[1]||\"normal\",size:t[4]||\"10px\",family:t[6]||\"sans-serif\",weight:t[3]||\"normal\",decoration:t[2]||\"normal\",href:null};return\"underline\"===this.__fontUnderline&&(e.decoration=\"underline\"),this.__fontHref&&(e.href=this.__fontHref),e},x.prototype.__wrapTextLink=function(t,e){if(t.href){var i=this.__createElement(\"a\");return i.setAttributeNS(\"http://www.w3.org/1999/xlink\",\"xlink:href\",t.href),i.appendChild(e),i}return e},x.prototype.__applyText=function(t,e,i,n){var r,o,s,a,l=this.__parseFont(),h=this.__closestGroupOrSvg(),c=this.__createElement(\"text\",{\"font-family\":l.family,\"font-size\":l.size,\"font-style\":l.style,\"font-weight\":l.weight,\"text-decoration\":l.decoration,x:e,y:i,\"text-anchor\":(s=this.textAlign,a={left:\"start\",right:\"end\",center:\"middle\",start:\"start\",end:\"end\"},a[s]||a.start),\"dominant-baseline\":(r=this.textBaseline,o={alphabetic:\"alphabetic\",hanging:\"hanging\",top:\"text-before-edge\",bottom:\"text-after-edge\",middle:\"central\"},o[r]||o.alphabetic)},!0);c.appendChild(this.__document.createTextNode(t)),this.__currentElement=c,this.__applyStyleToCurrentElement(n),h.appendChild(this.__wrapTextLink(l,c))},x.prototype.fillText=function(t,e,i){this.__applyText(t,e,i,\"fill\")},x.prototype.strokeText=function(t,e,i){this.__applyText(t,e,i,\"stroke\")},x.prototype.measureText=function(t){return this.__ctx.font=this.font,this.__ctx.measureText(t)},x.prototype.arc=function(t,e,i,n,r,o){if(n!==r){n%=2*Math.PI,r%=2*Math.PI,n===r&&(r=(r+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var s=t+i*Math.cos(r),a=e+i*Math.sin(r),l=t+i*Math.cos(n),h=e+i*Math.sin(n),c=o?0:1,u=0,_=r-n;_<0&&(_+=2*Math.PI),u=o?_>Math.PI?0:1:_>Math.PI?1:0,this.lineTo(l,h),this.__addPathCommand(f(\"A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}\",{rx:i,ry:i,xAxisRotation:0,largeArcFlag:u,sweepFlag:c,endX:s,endY:a})),this.__currentPosition={x:s,y:a}}},x.prototype.clip=function(){var t=this.__closestGroupOrSvg(),e=this.__createElement(\"clipPath\"),i=l(this.__ids),n=this.__createElement(\"g\");this.__applyCurrentDefaultPath(),t.removeChild(this.__currentElement),e.setAttribute(\"id\",i),e.appendChild(this.__currentElement),this.__defs.appendChild(e),t.setAttribute(\"clip-path\",f(\"url(#{id})\",{id:i})),t.appendChild(n),this.__currentElement=n},x.prototype.drawImage=function(){var t,e,i,n,r,o,s,a,l,h,c,u,_,p,d=Array.prototype.slice.call(arguments),f=d[0],v=0,m=0;if(3===d.length)t=d[1],e=d[2],r=f.width,o=f.height,i=r,n=o;else if(5===d.length)t=d[1],e=d[2],i=d[3],n=d[4],r=f.width,o=f.height;else{if(9!==d.length)throw new Error(\"Inavlid number of arguments passed to drawImage: \"+arguments.length);v=d[1],m=d[2],r=d[3],o=d[4],t=d[5],e=d[6],i=d[7],n=d[8]}s=this.__closestGroupOrSvg(),this.__currentElement;var g=\"translate(\"+t+\", \"+e+\")\";if(f instanceof x){if((a=f.getSvg().cloneNode(!0)).childNodes&&1<a.childNodes.length){for(l=a.childNodes[0];l.childNodes.length;)p=l.childNodes[0].getAttribute(\"id\"),this.__ids[p]=p,this.__defs.appendChild(l.childNodes[0]);if(h=a.childNodes[1]){var y,b=h.getAttribute(\"transform\");y=b?b+\" \"+g:g,h.setAttribute(\"transform\",y),s.appendChild(h)}}}else\"IMG\"===f.nodeName?((c=this.__createElement(\"image\")).setAttribute(\"width\",i),c.setAttribute(\"height\",n),c.setAttribute(\"preserveAspectRatio\",\"none\"),(v||m||r!==f.width||o!==f.height)&&((u=this.__document.createElement(\"canvas\")).width=i,u.height=n,(_=u.getContext(\"2d\")).drawImage(f,v,m,r,o,0,0,i,n),f=u),c.setAttribute(\"transform\",g),c.setAttributeNS(\"http://www.w3.org/1999/xlink\",\"xlink:href\",\"CANVAS\"===f.nodeName?f.toDataURL():f.getAttribute(\"src\")),s.appendChild(c)):\"CANVAS\"===f.nodeName&&((c=this.__createElement(\"image\")).setAttribute(\"width\",i),c.setAttribute(\"height\",n),c.setAttribute(\"preserveAspectRatio\",\"none\"),(u=this.__document.createElement(\"canvas\")).width=i,u.height=n,(_=u.getContext(\"2d\")).imageSmoothingEnabled=!1,_.mozImageSmoothingEnabled=!1,_.oImageSmoothingEnabled=!1,_.webkitImageSmoothingEnabled=!1,_.drawImage(f,v,m,r,o,0,0,i,n),f=u,c.setAttribute(\"transform\",g),c.setAttributeNS(\"http://www.w3.org/1999/xlink\",\"xlink:href\",f.toDataURL()),s.appendChild(c))},x.prototype.createPattern=function(t,e){var i,n=this.__document.createElementNS(\"http://www.w3.org/2000/svg\",\"pattern\"),r=l(this.__ids);return n.setAttribute(\"id\",r),n.setAttribute(\"width\",t.width),n.setAttribute(\"height\",t.height),\"CANVAS\"===t.nodeName||\"IMG\"===t.nodeName?((i=this.__document.createElementNS(\"http://www.w3.org/2000/svg\",\"image\")).setAttribute(\"width\",t.width),i.setAttribute(\"height\",t.height),i.setAttributeNS(\"http://www.w3.org/1999/xlink\",\"xlink:href\",\"CANVAS\"===t.nodeName?t.toDataURL():t.getAttribute(\"src\")),n.appendChild(i),this.__defs.appendChild(n)):t instanceof x&&(n.appendChild(t.__root.childNodes[1]),this.__defs.appendChild(n)),new d(n,this)},x.prototype.setLineDash=function(t){t&&0<t.length?this.lineDash=t.join(\",\"):this.lineDash=null},x.prototype.drawFocusRing=function(){},x.prototype.createImageData=function(){},x.prototype.getImageData=function(){},x.prototype.putImageData=function(){},x.prototype.globalCompositeOperation=function(){},x.prototype.setTransform=function(){},\"object\"==typeof window&&(window.C2S=x),\"object\"==typeof e&&\"object\"==typeof e.exports&&(e.exports=x)}()},function(t,e,i){var n,o=t(297),r=t(307),s=t(311),a=t(306),l=t(311),h=t(313),c=Function.prototype.bind,u=Object.defineProperty,_=Object.prototype.hasOwnProperty;n=function(t,e,i){var n,r=h(e)&&l(e.value);return delete(n=o(e)).writable,delete n.value,n.get=function(){return!i.overwriteDefinition&&_.call(this,t)?r:(e.value=c.call(r,i.resolveContext?i.resolveContext(this):this),u(this,t,e),this[t])},n},e.exports=function(t){var i=r(arguments[1]);return null!=i.resolveContext&&s(i.resolveContext),a(t,function(t,e){return n(e,t,i)})}},function(t,e,i){var a=t(294),l=t(307),h=t(300),c=t(314);(e.exports=function(t,e){var i,n,r,o,s;return arguments.length<2||\"string\"!=typeof t?(o=e,e=t,t=null):o=arguments[2],null==t?(i=r=!0,n=!1):(i=c.call(t,\"c\"),n=c.call(t,\"e\"),r=c.call(t,\"w\")),s={value:e,configurable:i,enumerable:n,writable:r},o?a(l(o),s):s}).gs=function(t,e,i){var n,r,o,s;return\"string\"!=typeof t?(o=i,i=e,e=t,t=null):o=arguments[3],null==e?e=void 0:h(e)?null==i?i=void 0:h(i)||(o=i,i=void 0):(o=e,e=i=void 0),null==t?r=!(n=!0):(n=c.call(t,\"c\"),r=c.call(t,\"e\")),s={get:e,set:i,configurable:n,enumerable:r},o?a(l(o),s):s}},function(t,e,i){var n=t(313);e.exports=function(){return n(this).length=0,this}},function(t,e,i){var o=t(288),s=t(292),a=t(313),l=Array.prototype.indexOf,h=Object.prototype.hasOwnProperty,c=Math.abs,u=Math.floor;e.exports=function(t){var e,i,n,r;if(!o(t))return l.apply(this,arguments);for(i=s(a(this).length),n=arguments[1],n=isNaN(n)?0:0<=n?u(n):s(this.length)-u(c(n)),e=n;e<i;++e)if(h.call(this,e)&&(r=this[e],o(r)))return e;return-1}},function(t,e,i){e.exports=t(279)()?Array.from:t(280)},function(t,e,i){e.exports=function(){var t,e,i=Array.from;return\"function\"==typeof i&&(e=i(t=[\"raz\",\"dwa\"]),Boolean(e&&e!==t&&\"dwa\"===e[1]))}},function(t,e,i){var p=t(332).iterator,d=t(281),f=t(282),v=t(292),m=t(311),g=t(313),y=t(302),b=t(317),x=Array.isArray,w=Function.prototype.call,k={configurable:!0,enumerable:!0,writable:!0,value:null},S=Object.defineProperty;e.exports=function(t){var e,i,n,r,o,s,a,l,h,c,u=arguments[1],_=arguments[2];if(t=Object(g(t)),y(u)&&m(u),this&&this!==Array&&f(this))e=this;else{if(!u){if(d(t))return 1!==(o=t.length)?Array.apply(null,t):((r=new Array(1))[0]=t[0],r);if(x(t)){for(r=new Array(o=t.length),i=0;i<o;++i)r[i]=t[i];return r}}r=[]}if(!x(t))if(void 0!==(h=t[p])){for(a=m(h).call(t),e&&(r=new e),l=a.next(),i=0;!l.done;)c=u?w.call(u,_,l.value,i):l.value,e?(k.value=c,S(r,i,k)):r[i]=c,l=a.next(),++i;o=i}else if(b(t)){for(o=t.length,e&&(r=new e),n=i=0;i<o;++i)c=t[i],i+1<o&&55296<=(s=c.charCodeAt(0))&&s<=56319&&(c+=t[++i]),c=u?w.call(u,_,c,n):c,e?(k.value=c,S(r,n,k)):r[n]=c,++n;o=n}if(void 0===o)for(o=v(t.length),e&&(r=new e(o)),i=0;i<o;++i)c=u?w.call(u,_,t[i],i):t[i],e?(k.value=c,S(r,i,k)):r[i]=c;return e&&(k.value=null,r.length=o),r}},function(t,e,i){var n=Object.prototype.toString,r=n.call(function(){return arguments}());e.exports=function(t){return n.call(t)===r}},function(t,e,i){var n=Object.prototype.toString,r=n.call(t(283));e.exports=function(t){return\"function\"==typeof t&&n.call(t)===r}},function(t,e,i){e.exports=function(){}},function(t,e,i){e.exports=function(){return this}()},function(t,e,i){e.exports=t(286)()?Math.sign:t(287)},function(t,e,i){e.exports=function(){var t=Math.sign;return\"function\"==typeof t&&1===t(10)&&-1===t(-20)}},function(t,e,i){e.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:0<t?1:-1}},function(t,e,i){e.exports=t(289)()?Number.isNaN:t(290)},function(t,e,i){e.exports=function(){var t=Number.isNaN;return\"function\"==typeof t&&!t({})&&t(NaN)&&!t(34)}},function(t,e,i){e.exports=function(t){return t!=t}},function(t,e,i){var n=t(285),r=Math.abs,o=Math.floor;e.exports=function(t){return isNaN(t)?0:0!==(t=Number(t))&&isFinite(t)?n(t)*o(r(t)):t}},function(t,e,i){var n=t(291),r=Math.max;e.exports=function(t){return r(0,n(t))}},function(t,e,i){var a=t(311),l=t(313),h=Function.prototype.bind,c=Function.prototype.call,u=Object.keys,_=Object.prototype.propertyIsEnumerable;e.exports=function(o,s){return function(i,n){var t,r=arguments[2],e=arguments[3];return i=Object(l(i)),a(n),t=u(i),e&&t.sort(\"function\"==typeof e?h.call(e,i):void 0),\"function\"!=typeof o&&(o=t[o]),c.call(o,t,function(t,e){return _.call(i,t)?c.call(n,r,i[t],t,i,e):s})}}},function(t,e,i){e.exports=t(295)()?Object.assign:t(296)},function(t,e,i){e.exports=function(){var t,e=Object.assign;return\"function\"==typeof e&&(e(t={foo:\"raz\"},{bar:\"dwa\"},{trzy:\"trzy\"}),t.foo+t.bar+t.trzy===\"razdwatrzy\")}},function(t,e,i){var s=t(303),a=t(313),l=Math.max;e.exports=function(e,i){var n,t,r,o=l(arguments.length,2);for(e=Object(a(e)),r=function(t){try{e[t]=i[t]}catch(t){n||(n=t)}},t=1;t<o;++t)i=arguments[t],s(i).forEach(r);if(void 0!==n)throw n;return e}},function(t,e,i){var o=t(278),s=t(294),a=t(313);e.exports=function(e){var t=Object(a(e)),i=arguments[1],n=Object(arguments[2]);if(t!==e&&!i)return t;var r={};return i?o(i,function(t){(n.ensure||t in e)&&(r[t]=e[t])}):s(r,e),r}},function(t,e,i){var n,r,o,s,a=Object.create;t(309)()||(n=t(310)),e.exports=n?1!==n.level?a:(s={configurable:(o={},!1),enumerable:(r={},!1),writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(t){o[t]=\"__proto__\"!==t?s:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(r,o),Object.defineProperty(n,\"nullPolyfill\",{configurable:!1,enumerable:!1,writable:!1,value:r}),function(t,e){return a(null===t?r:t,e)}):a},function(t,e,i){e.exports=t(293)(\"forEach\")},function(t,e,i){e.exports=function(t){return\"function\"==typeof t}},function(t,e,i){var n=t(302),r={function:!0,object:!0};e.exports=function(t){return n(t)&&r[typeof t]||!1}},function(t,e,i){var n=t(283)();e.exports=function(t){return t!==n&&null!==t}},function(t,e,i){e.exports=t(304)()?Object.keys:t(305)},function(t,e,i){e.exports=function(){try{return Object.keys(\"primitive\"),!0}catch(t){return!1}}},function(t,e,i){var n=t(302),r=Object.keys;e.exports=function(t){return r(n(t)?Object(t):t)}},function(t,e,i){var n=t(311),a=t(299),l=Function.prototype.call;e.exports=function(t,r){var o={},s=arguments[2];return n(r),a(t,function(t,e,i,n){o[e]=l.call(r,s,t,e,i,n)}),o}},function(t,e,i){var n=t(302),r=Array.prototype.forEach,o=Object.create;e.exports=function(t){var e=o(null);return r.call(arguments,function(t){n(t)&&function(t,e){var i;for(i in t)e[i]=t[i]}(Object(t),e)}),e}},function(t,e,i){e.exports=t(309)()?Object.setPrototypeOf:t(310)},function(t,e,i){var n=Object.create,r=Object.getPrototypeOf,o={};e.exports=function(){var t=Object.setPrototypeOf,e=arguments[0]||n;return\"function\"==typeof t&&r(t(e(null),o))===o}},function(t,e,i){var r,n,o,s,a=t(301),l=t(313),h=Object.prototype.isPrototypeOf,c=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(t,e){if(l(t),null===e||a(e))return t;throw new TypeError(\"Prototype must be null or an object\")},e.exports=(n=function(){var t,e=Object.create(null),i={},n=Object.getOwnPropertyDescriptor(Object.prototype,\"__proto__\");if(n){try{(t=n.set).call(e,i)}catch(t){}if(Object.getPrototypeOf(e)===i)return{set:t,level:2}}return e.__proto__=i,Object.getPrototypeOf(e)===i?{level:2}:((e={}).__proto__=i,Object.getPrototypeOf(e)===i&&{level:1})}())?(2===n.level?n.set?(s=n.set,o=function(t,e){return s.call(r(t,e),e),t}):o=function(t,e){return r(t,e).__proto__=e,t}:o=function t(e,i){var n;return r(e,i),(n=h.call(t.nullPolyfill,e))&&delete t.nullPolyfill.__proto__,null===i&&(i=t.nullPolyfill),e.__proto__=i,n&&c(t.nullPolyfill,\"__proto__\",u),e},Object.defineProperty(o,\"level\",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null,t(298)},function(t,e,i){e.exports=function(t){if(\"function\"!=typeof t)throw new TypeError(t+\" is not a function\");return t}},function(t,e,i){var n=t(301);e.exports=function(t){if(!n(t))throw new TypeError(t+\" is not an Object\");return t}},function(t,e,i){var n=t(302);e.exports=function(t){if(!n(t))throw new TypeError(\"Cannot use null or undefined\");return t}},function(t,e,i){e.exports=t(315)()?String.prototype.contains:t(316)},function(t,e,i){var n=\"razdwatrzy\";e.exports=function(){return\"function\"==typeof n.contains&&!0===n.contains(\"dwa\")&&!1===n.contains(\"foo\")}},function(t,e,i){var n=String.prototype.indexOf;e.exports=function(t){return-1<n.call(this,t,arguments[1])}},function(t,e,i){var n=Object.prototype.toString,r=n.call(\"\");e.exports=function(t){return\"string\"==typeof t||t&&\"object\"==typeof t&&(t instanceof String||n.call(t)===r)||!1}},function(t,e,i){var n=Object.create(null),r=Math.random;e.exports=function(){for(var t;t=r().toString(36).slice(2),n[t];);return t}},function(t,e,i){var n,r=t(308),o=t(314),s=t(275),a=t(332),l=t(322),h=Object.defineProperty;n=e.exports=function(t,e){if(!(this instanceof n))throw new TypeError(\"Constructor requires 'new'\");l.call(this,t),e=e?o.call(e,\"key+value\")?\"key+value\":o.call(e,\"key\")?\"key\":\"value\":\"value\",h(this,\"__kind__\",s(\"\",e))},r&&r(n,l),delete n.prototype.constructor,n.prototype=Object.create(l.prototype,{_resolve:s(function(t){return\"value\"===this.__kind__?this.__list__[t]:\"key+value\"===this.__kind__?[t,this.__list__[t]]:t})}),h(n.prototype,a.toStringTag,s(\"c\",\"Array Iterator\"))},function(t,e,i){var u=t(281),_=t(311),p=t(317),d=t(321),f=Array.isArray,v=Function.prototype.call,m=Array.prototype.some;e.exports=function(t,e){var i,n,r,o,s,a,l,h,c=arguments[2];if(f(t)||u(t)?i=\"array\":p(t)?i=\"string\":t=d(t),_(e),r=function(){o=!0},\"array\"!==i)if(\"string\"!==i)for(n=t.next();!n.done;){if(v.call(e,c,n.value,r),o)return;n=t.next()}else for(a=t.length,s=0;s<a&&(l=t[s],s+1<a&&55296<=(h=l.charCodeAt(0))&&h<=56319&&(l+=t[++s]),v.call(e,c,l,r),!o);++s);else m.call(t,function(t){return v.call(e,c,t,r),o})}},function(t,e,i){var n=t(281),r=t(317),o=t(319),s=t(324),a=t(325),l=t(332).iterator;e.exports=function(t){return\"function\"==typeof a(t)[l]?t[l]():n(t)?new o(t):r(t)?new s(t):new o(t)}},function(t,e,i){var n,r=t(276),o=t(294),s=t(311),a=t(313),l=t(275),h=t(274),c=t(332),u=Object.defineProperty,_=Object.defineProperties;e.exports=n=function(t,e){if(!(this instanceof n))throw new TypeError(\"Constructor requires 'new'\");_(this,{__list__:l(\"w\",a(t)),__context__:l(\"w\",e),__nextIndex__:l(\"w\",0)}),e&&(s(e.on),e.on(\"_add\",this._onAdd),e.on(\"_delete\",this._onDelete),e.on(\"_clear\",this._onClear))},delete n.prototype.constructor,_(n.prototype,o({_next:l(function(){var t;if(this.__list__)return this.__redo__&&void 0!==(t=this.__redo__.shift())?t:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:l(function(){return this._createResult(this._next())}),_createResult:l(function(t){return void 0===t?{done:!0,value:void 0}:{done:!1,value:this._resolve(t)}}),_resolve:l(function(t){return this.__list__[t]}),_unBind:l(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off(\"_add\",this._onAdd),this.__context__.off(\"_delete\",this._onDelete),this.__context__.off(\"_clear\",this._onClear),this.__context__=null)}),toString:l(function(){return\"[object \"+(this[c.toStringTag]||\"Object\")+\"]\"})},h({_onAdd:l(function(i){i>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(t,e){i<=t&&(this.__redo__[e]=++t)},this),this.__redo__.push(i)):u(this,\"__redo__\",l(\"c\",[i])))}),_onDelete:l(function(i){var t;i>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(i))&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,e){i<t&&(this.__redo__[e]=--t)},this)))}),_onClear:l(function(){this.__redo__&&r.call(this.__redo__),this.__nextIndex__=0})}))),u(n.prototype,c.iterator,l(function(){return this}))},function(t,e,i){var n=t(281),r=t(302),o=t(317),s=t(332).iterator,a=Array.isArray;e.exports=function(t){return!(!r(t)||!a(t)&&!o(t)&&!n(t)&&\"function\"!=typeof t[s])}},function(t,e,i){var n,r=t(308),o=t(275),s=t(332),a=t(322),l=Object.defineProperty;n=e.exports=function(t){if(!(this instanceof n))throw new TypeError(\"Constructor requires 'new'\");t=String(t),a.call(this,t),l(this,\"__length__\",o(\"\",t.length))},r&&r(n,a),delete n.prototype.constructor,n.prototype=Object.create(a.prototype,{_next:o(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:o(function(t){var e,i=this.__list__[t];return this.__nextIndex__===this.__length__?i:55296<=(e=i.charCodeAt(0))&&e<=56319?i+this.__list__[this.__nextIndex__++]:i})}),l(n.prototype,s.toStringTag,o(\"c\",\"String Iterator\"))},function(t,e,i){var n=t(323);e.exports=function(t){if(!n(t))throw new TypeError(t+\" is not iterable\");return t}},function(L,t,e){ /*! * @overview es6-promise - a tiny implementation of Promises/A+. * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald) * @license Licensed under MIT license * See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE * @version v4.2.4+314e4831 */var i,n;i=this,n=function(){\"use strict\";function h(t){return\"function\"==typeof t}var i=Array.isArray?Array.isArray:function(t){return\"[object Array]\"===Object.prototype.toString.call(t)},n=0,e=void 0,r=void 0,a=function(t,e){_[n]=t,_[n+1]=e,2===(n+=2)&&(r?r(p):g())},t=\"undefined\"!=typeof window?window:void 0,o=t||{},s=o.MutationObserver||o.WebKitMutationObserver,l=\"undefined\"==typeof self&&\"undefined\"!=typeof process&&\"[object process]\"==={}.toString.call(process),c=\"undefined\"!=typeof Uint8ClampedArray&&\"undefined\"!=typeof importScripts&&\"undefined\"!=typeof MessageChannel;function u(){var t=setTimeout;return function(){return t(p,1)}}var _=new Array(1e3);function p(){for(var t=0;t<n;t+=2){var e=_[t],i=_[t+1];e(i),_[t]=void 0,_[t+1]=void 0}n=0}var d,f,v,m,g=void 0;function y(t,e){var i=this,n=new this.constructor(w);void 0===n[x]&&I(n);var r=i._state;if(r){var o=arguments[r-1];a(function(){return F(r,n,o,i._result)})}else j(i,n,t,e);return n}function b(t){if(t&&\"object\"==typeof t&&t.constructor===this)return t;var e=new this(w);return M(e,t),e}l?g=function(){return process.nextTick(p)}:s?(f=0,v=new s(p),m=document.createTextNode(\"\"),v.observe(m,{characterData:!0}),g=function(){m.data=f=++f%2}):c?((d=new MessageChannel).port1.onmessage=p,g=function(){return d.port2.postMessage(0)}):g=void 0===t&&\"function\"==typeof L?function(){try{var t=Function(\"return this\")().require(\"vertx\");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(p)}:u()}catch(t){return u()}}():u();var x=Math.random().toString(36).substring(2);function w(){}var k=void 0,S=1,T=2,C={error:null};function A(t){try{return t.then}catch(t){return C.error=t,C}}function E(t,e,i){var n,r,o,s;e.constructor===t.constructor&&i===y&&e.constructor.resolve===b?(o=t,(s=e)._state===S?z(o,s._result):s._state===T?P(o,s._result):j(s,void 0,function(t){return M(o,t)},function(t){return P(o,t)})):i===C?(P(t,C.error),C.error=null):void 0===i?z(t,e):h(i)?(n=e,r=i,a(function(e){var i=!1,t=function(t,e,i,n){try{t.call(e,i,n)}catch(t){return t}}(r,n,function(t){i||(i=!0,n!==t?M(e,t):z(e,t))},function(t){i||(i=!0,P(e,t))},e._label);!i&&t&&(i=!0,P(e,t))},t)):z(t,e)}function M(t,e){var i,n;t===e?P(t,new TypeError(\"You cannot resolve a promise with itself\")):(n=typeof(i=e),null===i||\"object\"!==n&&\"function\"!==n?z(t,e):E(t,e,A(e)))}function O(t){t._onerror&&t._onerror(t._result),N(t)}function z(t,e){t._state===k&&(t._result=e,t._state=S,0!==t._subscribers.length&&a(N,t))}function P(t,e){t._state===k&&(t._state=T,t._result=e,a(O,t))}function j(t,e,i,n){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+S]=i,r[o+T]=n,0===o&&t._state&&a(N,t)}function N(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var n=void 0,r=void 0,o=t._result,s=0;s<e.length;s+=3)n=e[s],r=e[s+i],n?F(i,n,r,o):r(o);t._subscribers.length=0}}function F(t,e,i,n){var r=h(i),o=void 0,s=void 0,a=void 0,l=void 0;if(r){if((o=function(t,e){try{return t(e)}catch(t){return C.error=t,C}}(i,n))===C?(l=!0,s=o.error,o.error=null):a=!0,e===o)return void P(e,new TypeError(\"A promises callback cannot return that same promise.\"))}else o=n,a=!0;e._state!==k||(r&&a?M(e,o):l?P(e,s):t===S?z(e,o):t===T&&P(e,o))}var D=0;function I(t){t[x]=D++,t._state=void 0,t._result=void 0,t._subscribers=[]}var R=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(w),this.promise[x]||I(this.promise),i(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?z(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&z(this.promise,this._result))):P(this.promise,new Error(\"Array Methods must be provided an Array\"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===k&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,n=i.resolve;if(n===b){var r=A(e);if(r===y&&e._state!==k)this._settledAt(e._state,t,e._result);else if(\"function\"!=typeof r)this._remaining--,this._result[t]=e;else if(i===B){var o=new i(w);E(o,e,r),this._willSettleAt(o,t)}else this._willSettleAt(new i(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},t.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===k&&(this._remaining--,t===T?P(n,i):this._result[e]=i),0===this._remaining&&z(n,this._result)},t.prototype._willSettleAt=function(t,e){var i=this;j(t,void 0,function(t){return i._settledAt(S,e,t)},function(t){return i._settledAt(T,e,t)})},t}(),B=function(){function e(t){this[x]=D++,this._result=this._state=void 0,this._subscribers=[],w!==t&&(\"function\"!=typeof t&&function(){throw new TypeError(\"You must pass a resolver function as the first argument to the promise constructor\")}(),this instanceof e?function(e,t){try{t(function(t){M(e,t)},function(t){P(e,t)})}catch(t){P(e,t)}}(this,t):function(){throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var i=this.constructor;return this.then(function(t){return i.resolve(e()).then(function(){return t})},function(t){return i.resolve(e()).then(function(){throw t})})},e}();return B.prototype.then=y,B.all=function(t){return new R(this,t).promise},B.race=function(r){var o=this;return i(r)?new o(function(t,e){for(var i=r.length,n=0;n<i;n++)o.resolve(r[n]).then(t,e)}):new o(function(t,e){return e(new TypeError(\"You must pass an array to race.\"))})},B.resolve=b,B.reject=function(t){var e=new this(w);return P(e,t),e},B._setScheduler=function(t){r=t},B._setAsap=function(t){a=t},B._asap=a,B.polyfill=function(){var t=void 0;if(\"undefined\"!=typeof global)t=global;else if(\"undefined\"!=typeof self)t=self;else try{t=Function(\"return this\")()}catch(t){throw new Error(\"polyfill failed because global object is unavailable in this environment\")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if(\"[object Promise]\"===i&&!e.cast)return}t.Promise=B},B.Promise=B},\"object\"==typeof e&&void 0!==t?t.exports=n():i.ES6Promise=n()},function(t,e,i){t(328)()||Object.defineProperty(t(284),\"Set\",{value:t(331),configurable:!0,enumerable:!1,writable:!0})},function(t,e,i){e.exports=function(){var t,e,i;return\"function\"==typeof Set&&(t=new Set([\"raz\",\"dwa\",\"trzy\"]),\"[object Set]\"===String(t)&&3===t.size&&\"function\"==typeof t.add&&\"function\"==typeof t.clear&&\"function\"==typeof t.delete&&\"function\"==typeof t.entries&&\"function\"==typeof t.forEach&&\"function\"==typeof t.has&&\"function\"==typeof t.keys&&\"function\"==typeof t.values&&(e=t.values(),!1===(i=e.next()).done&&\"raz\"===i.value))}},function(t,e,i){e.exports=\"undefined\"!=typeof Set&&\"[object Set]\"===Object.prototype.toString.call(Set.prototype)},function(t,e,i){var n,r=t(308),o=t(314),s=t(275),a=t(322),l=t(332).toStringTag,h=Object.defineProperty;n=e.exports=function(t,e){if(!(this instanceof n))return new n(t,e);a.call(this,t.__setData__,t),e=e&&o.call(e,\"key+value\")?\"key+value\":\"value\",h(this,\"__kind__\",s(\"\",e))},r&&r(n,a),n.prototype=Object.create(a.prototype,{constructor:s(n),_resolve:s(function(t){return\"value\"===this.__kind__?this.__list__[t]:[this.__list__[t],this.__list__[t]]}),toString:s(function(){return\"[object Set Iterator]\"})}),h(n.prototype,l,s(\"c\",\"Set Iterator\"))},function(t,e,i){var n,r,o,s=t(276),a=t(277),l=t(308),h=t(311),c=t(275),u=t(341),_=t(332),p=t(325),d=t(320),f=t(330),v=t(329),m=Function.prototype.call,g=Object.defineProperty,y=Object.getPrototypeOf;v&&(o=Set),e.exports=n=function(){var t,e=arguments[0];if(!(this instanceof n))throw new TypeError(\"Constructor requires 'new'\");return t=v&&l?l(new o,y(this)):this,null!=e&&p(e),g(t,\"__setData__\",c(\"c\",[])),e&&d(e,function(t){-1===a.call(this,t)&&this.push(t)},t.__setData__),t},v&&(l&&l(n,o),n.prototype=Object.create(o.prototype,{constructor:c(n)})),u(Object.defineProperties(n.prototype,{add:c(function(t){return this.has(t)||this.emit(\"_add\",this.__setData__.push(t)-1,t),this}),clear:c(function(){this.__setData__.length&&(s.call(this.__setData__),this.emit(\"_clear\"))}),delete:c(function(t){var e=a.call(this.__setData__,t);return-1!==e&&(this.__setData__.splice(e,1),this.emit(\"_delete\",e,t),!0)}),entries:c(function(){return new f(this,\"key+value\")}),forEach:c(function(t){var e,i,n,r=arguments[1];for(h(t),e=this.values(),i=e._next();void 0!==i;)n=e._resolve(i),m.call(t,r,n,n,this),i=e._next()}),has:c(function(t){return-1!==a.call(this.__setData__,t)}),keys:c(r=function(){return this.values()}),size:c.gs(function(){return this.__setData__.length}),values:c(function(){return new f(this)}),toString:c(function(){return\"[object Set]\"})})),g(n.prototype,_.iterator,c(r)),g(n.prototype,_.toStringTag,c(\"c\",\"Set\"))},function(t,e,i){e.exports=t(333)()?Symbol:t(335)},function(t,e,i){var n={object:!0,symbol:!0};e.exports=function(){var t;if(\"function\"!=typeof Symbol)return!1;t=Symbol(\"test symbol\");try{String(t)}catch(t){return!1}return!!n[typeof Symbol.iterator]&&!!n[typeof Symbol.toPrimitive]&&!!n[typeof Symbol.toStringTag]}},function(t,e,i){e.exports=function(t){return!!t&&(\"symbol\"==typeof t||!!t.constructor&&\"Symbol\"===t.constructor.name&&\"Symbol\"===t[t.constructor.toStringTag])}},function(t,e,i){var n,r,o,s,a=t(275),l=t(336),h=Object.create,c=Object.defineProperties,u=Object.defineProperty,_=Object.prototype,p=h(null);if(\"function\"==typeof Symbol){n=Symbol;try{String(n()),s=!0}catch(t){}}var d,f=(d=h(null),function(t){for(var e,i,n=0;d[t+(n||\"\")];)++n;return d[t+=n||\"\"]=!0,u(_,e=\"@@\"+t,a.gs(null,function(t){i||(i=!0,u(this,e,a(t)),i=!1)})),e});o=function(t){if(this instanceof o)throw new TypeError(\"Symbol is not a constructor\");return r(t)},e.exports=r=function t(e){var i;if(this instanceof t)throw new TypeError(\"Symbol is not a constructor\");return s?n(e):(i=h(o.prototype),e=void 0===e?\"\":String(e),c(i,{__description__:a(\"\",e),__name__:a(\"\",f(e))}))},c(r,{for:a(function(t){return p[t]?p[t]:p[t]=r(String(t))}),keyFor:a(function(t){var e;for(e in l(t),p)if(p[e]===t)return e}),hasInstance:a(\"\",n&&n.hasInstance||r(\"hasInstance\")),isConcatSpreadable:a(\"\",n&&n.isConcatSpreadable||r(\"isConcatSpreadable\")),iterator:a(\"\",n&&n.iterator||r(\"iterator\")),match:a(\"\",n&&n.match||r(\"match\")),replace:a(\"\",n&&n.replace||r(\"replace\")),search:a(\"\",n&&n.search||r(\"search\")),species:a(\"\",n&&n.species||r(\"species\")),split:a(\"\",n&&n.split||r(\"split\")),toPrimitive:a(\"\",n&&n.toPrimitive||r(\"toPrimitive\")),toStringTag:a(\"\",n&&n.toStringTag||r(\"toStringTag\")),unscopables:a(\"\",n&&n.unscopables||r(\"unscopables\"))}),c(o.prototype,{constructor:a(r),toString:a(\"\",function(){return this.__name__})}),c(r.prototype,{toString:a(function(){return\"Symbol (\"+l(this).__description__+\")\"}),valueOf:a(function(){return l(this)})}),u(r.prototype,r.toPrimitive,a(\"\",function(){var t=l(this);return\"symbol\"==typeof t?t:t.toString()})),u(r.prototype,r.toStringTag,a(\"c\",\"Symbol\")),u(o.prototype,r.toStringTag,a(\"c\",r.prototype[r.toStringTag])),u(o.prototype,r.toPrimitive,a(\"c\",r.prototype[r.toPrimitive]))},function(t,e,i){var n=t(334);e.exports=function(t){if(!n(t))throw new TypeError(t+\" is not a symbol\");return t}},function(t,e,i){t(338)()||Object.defineProperty(t(284),\"WeakMap\",{value:t(340),configurable:!0,enumerable:!1,writable:!0})},function(t,e,i){e.exports=function(){var t,e;if(\"function\"!=typeof WeakMap)return!1;try{t=new WeakMap([[e={},\"one\"],[{},\"two\"],[{},\"three\"]])}catch(t){return!1}return\"[object WeakMap]\"===String(t)&&\"function\"==typeof t.set&&t.set({},1)===t&&\"function\"==typeof t.delete&&\"function\"==typeof t.has&&\"one\"===t.get(e)}},function(t,e,i){e.exports=\"function\"==typeof WeakMap&&\"[object WeakMap]\"===Object.prototype.toString.call(new WeakMap)},function(t,e,i){var n,r=t(308),o=t(312),s=t(313),a=t(318),l=t(275),h=t(321),c=t(320),u=t(332).toStringTag,_=t(339),p=Array.isArray,d=Object.defineProperty,f=Object.prototype.hasOwnProperty,v=Object.getPrototypeOf;e.exports=n=function(){var e,t=arguments[0];if(!(this instanceof n))throw new TypeError(\"Constructor requires 'new'\");return e=_&&r&&WeakMap!==n?r(new WeakMap,v(this)):this,null!=t&&(p(t)||(t=h(t))),d(e,\"__weakMapData__\",l(\"c\",\"$weakMap$\"+a())),t&&c(t,function(t){s(t),e.set(t[0],t[1])}),e},_&&(r&&r(n,WeakMap),n.prototype=Object.create(WeakMap.prototype,{constructor:l(n)})),Object.defineProperties(n.prototype,{delete:l(function(t){return!!f.call(o(t),this.__weakMapData__)&&(delete t[this.__weakMapData__],!0)}),get:l(function(t){if(f.call(o(t),this.__weakMapData__))return t[this.__weakMapData__]}),has:l(function(t){return f.call(o(t),this.__weakMapData__)}),set:l(function(t,e){return d(o(t),this.__weakMapData__,l(\"c\",e)),this}),toString:l(function(){return\"[object WeakMap]\"})}),d(n.prototype,u,l(\"c\",\"WeakMap\"))},function(t,e,i){var r,n,o,s,a,l,h,c=t(275),u=t(311),_=Function.prototype.apply,p=Function.prototype.call,d=Object.create,f=Object.defineProperty,v=Object.defineProperties,m=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};n=function(t,e){var i,n;return u(e),r.call(n=this,t,i=function(){o.call(n,t,i),_.call(e,this,arguments)}),i.__eeOnceListener__=e,this},a={on:r=function(t,e){var i;return u(e),m.call(this,\"__ee__\")?i=this.__ee__:(i=g.value=d(null),f(this,\"__ee__\",g),g.value=null),i[t]?\"object\"==typeof i[t]?i[t].push(e):i[t]=[i[t],e]:i[t]=e,this},once:n,off:o=function(t,e){var i,n,r,o;if(u(e),!m.call(this,\"__ee__\"))return this;if(!(i=this.__ee__)[t])return this;if(\"object\"==typeof(n=i[t]))for(o=0;r=n[o];++o)r!==e&&r.__eeOnceListener__!==e||(2===n.length?i[t]=n[o?0:1]:n.splice(o,1));else n!==e&&n.__eeOnceListener__!==e||delete i[t];return this},emit:s=function(t){var e,i,n,r,o;if(m.call(this,\"__ee__\")&&(r=this.__ee__[t]))if(\"object\"==typeof r){for(i=arguments.length,o=new Array(i-1),e=1;e<i;++e)o[e-1]=arguments[e];for(r=r.slice(),e=0;n=r[e];++e)_.call(n,this,o)}else switch(arguments.length){case 1:p.call(r,this);break;case 2:p.call(r,this,arguments[1]);break;case 3:p.call(r,this,arguments[1],arguments[2]);break;default:for(i=arguments.length,o=new Array(i-1),e=1;e<i;++e)o[e-1]=arguments[e];_.call(r,this,o)}}},l={on:c(r),once:c(n),off:c(o),emit:c(s)},h=v({},l),e.exports=i=function(t){return null==t?d(h):v(Object(t),l)},i.methods=a},function(t,e,i){var n,r;n=this,r=function(){\"use strict\";var l=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],h=function(t,e,i,n){if(void 0===t)throw new Error(\"Missing required argument: numItems.\");if(isNaN(t)||t<=0)throw new Error(\"Unpexpected numItems value: \"+t+\".\");this.numItems=+t,this.nodeSize=Math.min(Math.max(+e||16,2),65535);var r=t,o=r;for(this._levelBounds=[4*r];r=Math.ceil(r/this.nodeSize),o+=r,this._levelBounds.push(4*o),1!==r;);this.ArrayType=i||Float64Array,this.IndexArrayType=o<16384?Uint16Array:Uint32Array;var s=l.indexOf(this.ArrayType),a=4*o*this.ArrayType.BYTES_PER_ELEMENT;if(s<0)throw new Error(\"Unexpected typed array class: \"+i+\".\");n&&n instanceof ArrayBuffer?(this.data=n,this._boxes=new this.ArrayType(this.data,8,4*o),this._indices=new this.IndexArrayType(this.data,8+a,o),this._pos=4*o,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new ArrayBuffer(8+a+o*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,4*o),this._indices=new this.IndexArrayType(this.data,8+a,o),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,48+s]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)};function T(t,e,i,n,r){var o=t[n];t[n]=t[r],t[r]=o;var s=4*n,a=4*r,l=e[s],h=e[s+1],c=e[s+2],u=e[s+3];e[s]=e[a],e[s+1]=e[a+1],e[s+2]=e[a+2],e[s+3]=e[a+3],e[a]=l,e[a+1]=h,e[a+2]=c,e[a+3]=u;var _=i[n];i[n]=i[r],i[r]=_}function C(t,e){var i=t&#94;e,n=65535&#94;i,r=65535&#94;(t|e),o=t&(65535&#94;e),s=i|n>>1,a=i>>1&#94;i,l=r>>1&#94;n&o>>1&#94;r,h=i&r>>1&#94;o>>1&#94;o;a=(i=s)&(n=a)>>2&#94;n&(i&#94;n)>>2,l&#94;=i&(r=l)>>2&#94;n&(o=h)>>2,h&#94;=n&r>>2&#94;(i&#94;n)&o>>2,a=(i=s=i&i>>2&#94;n&n>>2)&(n=a)>>4&#94;n&(i&#94;n)>>4,l&#94;=i&(r=l)>>4&#94;n&(o=h)>>4,h&#94;=n&r>>4&#94;(i&#94;n)&o>>4,l&#94;=(i=s=i&i>>4&#94;n&n>>4)&(r=l)>>8&#94;(n=a)&(o=h)>>8;var c=t&#94;e,u=(n=(h&#94;=n&r>>8&#94;(i&#94;n)&o>>8)&#94;h>>1)|65535&#94;(c|(i=l&#94;l>>1));return((u=1431655765&((u=858993459&((u=252645135&((u=16711935&(u|u<<8))|u<<4))|u<<2))|u<<1))<<1|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&(c|c<<8))|c<<4))|c<<2))|c<<1)))>>>0}return h.from=function(t){if(!(t instanceof ArrayBuffer))throw new Error(\"Data must be an instance of ArrayBuffer.\");var e=new Uint8Array(t,0,2),i=e[0],n=e[1];if(251!==i)throw new Error(\"Data does not appear to be in a Flatbush format.\");if(n>>4!=3)throw new Error(\"Got v\"+(n>>4)+\" data when expected v3.\");var r=new Uint16Array(t,2,1),o=r[0],s=new Uint32Array(t,4,1),a=s[0];return new h(a,o,l[15&n],t)},h.prototype.add=function(t,e,i,n){var r=this._pos>>2;this._indices[r]=r,this._boxes[this._pos++]=t,this._boxes[this._pos++]=e,this._boxes[this._pos++]=i,this._boxes[this._pos++]=n,t<this.minX&&(this.minX=t),e<this.minY&&(this.minY=e),i>this.maxX&&(this.maxX=i),n>this.maxY&&(this.maxY=n)},h.prototype.finish=function(){var t=this;if(this._pos>>2!==this.numItems)throw new Error(\"Added \"+(this._pos>>2)+\" items when expected \"+this.numItems+\".\");for(var e=this.maxX-this.minX,i=this.maxY-this.minY,n=new Uint32Array(this.numItems),r=0;r<this.numItems;r++){var o=4*r,s=t._boxes[o++],a=t._boxes[o++],l=t._boxes[o++],h=t._boxes[o++],c=Math.floor(65535*((s+l)/2-t.minX)/e),u=Math.floor(65535*((a+h)/2-t.minY)/i);n[r]=C(c,u)}!function t(e,i,n,r,o){if(!(o<=r)){for(var s=e[r+o>>1],a=r-1,l=o+1;;){for(;e[++a]<s;);for(;e[--l]>s;);if(l<=a)break;T(e,i,n,a,l)}t(e,i,n,r,l),t(e,i,n,l+1,o)}}(n,this._boxes,this._indices,0,this.numItems-1);for(var _=0,p=0;_<this._levelBounds.length-1;_++)for(var d=t._levelBounds[_];p<d;){for(var f=1/0,v=1/0,m=-1/0,g=-1/0,y=p,b=0;b<this.nodeSize&&p<d;b++){var x=t._boxes[p++],w=t._boxes[p++],k=t._boxes[p++],S=t._boxes[p++];x<f&&(f=x),w<v&&(v=w),m<k&&(m=k),g<S&&(g=S)}t._indices[t._pos>>2]=y,t._boxes[t._pos++]=f,t._boxes[t._pos++]=v,t._boxes[t._pos++]=m,t._boxes[t._pos++]=g}},h.prototype.search=function(t,e,i,n,r){if(this._pos!==this._boxes.length)throw new Error(\"Data not yet indexed - call index.finish().\");for(var o=this._boxes.length-4,s=this._levelBounds.length-1,a=[],l=[];void 0!==o;){for(var h=Math.min(o+4*this.nodeSize,this._levelBounds[s]),c=o;c<h;c+=4){var u=this._indices[c>>2];i<this._boxes[c]||n<this._boxes[c+1]||t>this._boxes[c+2]||e>this._boxes[c+3]||(o<4*this.numItems?(void 0===r||r(u))&&l.push(u):(a.push(u),a.push(s-1)))}s=a.pop(),o=a.pop()}return l},h},\"object\"==typeof i&&void 0!==e?e.exports=r():n.Flatbush=r()},function(t,Yt,e){ /*! Hammer.JS - v2.0.7 - 2016-04-22 * http://hammerjs.github.io/ * * Copyright (c) 2016 Jorik Tangelder; * Licensed under the MIT license */ !function(o,a,t,x){\"use strict\";var s,l=[\"\",\"webkit\",\"Moz\",\"MS\",\"ms\",\"o\"],e=a.createElement(\"div\"),i=\"function\",h=Math.round,w=Math.abs,k=Date.now;function c(t,e,i){return setTimeout(f(t,i),e)}function n(t,e,i){return!!Array.isArray(t)&&(u(t,i[e],i),!0)}function u(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==x)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function r(n,t,e){var r=\"DEPRECATED METHOD: \"+t+\"\\n\"+e+\" AT \\n\";return function(){var t=new Error(\"get-stack-trace\"),e=t&&t.stack?t.stack.replace(/&#94;[&#94;\\(]+?[\\n$]/gm,\"\").replace(/&#94;\\s+at\\s+/gm,\"\").replace(/&#94;Object.<anonymous>\\s*\\(/gm,\"{anonymous}()@\"):\"Unknown Stack Trace\",i=o.console&&(o.console.warn||o.console.log);return i&&i.call(o.console,r,e),n.apply(this,arguments)}}s=\"function\"!=typeof Object.assign?function(t){if(t===x||null===t)throw new TypeError(\"Cannot convert undefined or null to object\");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==x&&null!==n)for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e}:Object.assign;var _=r(function(t,e,i){for(var n=Object.keys(e),r=0;r<n.length;)(!i||i&&t[n[r]]===x)&&(t[n[r]]=e[n[r]]),r++;return t},\"extend\",\"Use `assign`.\"),p=r(function(t,e){return _(t,e,!0)},\"merge\",\"Use `assign`.\");function d(t,e,i){var n,r=e.prototype;(n=t.prototype=Object.create(r)).constructor=t,n._super=r,i&&s(n,i)}function f(t,e){return function(){return t.apply(e,arguments)}}function v(t,e){return typeof t==i?t.apply(e&&e[0]||x,e):t}function m(t,e){return t===x?e:t}function g(e,t,i){u(T(t),function(t){e.addEventListener(t,i,!1)})}function y(e,t,i){u(T(t),function(t){e.removeEventListener(t,i,!1)})}function S(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function b(t,e){return-1<t.indexOf(e)}function T(t){return t.trim().split(/\\s+/g)}function C(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function A(t){return Array.prototype.slice.call(t,0)}function E(t,i,e){for(var n=[],r=[],o=0;o<t.length;){var s=i?t[o][i]:t[o];C(r,s)<0&&n.push(t[o]),r[o]=s,o++}return e&&(n=i?n.sort(function(t,e){return t[i]>e[i]}):n.sort()),n}function M(t,e){for(var i,n,r=e[0].toUpperCase()+e.slice(1),o=0;o<l.length;){if(i=l[o],(n=i?i+r:e)in t)return n;o++}return x}var O=1;function z(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||o}var P=\"ontouchstart\"in o,j=M(o,\"PointerEvent\")!==x,N=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=\"touch\",D=25,I=1,R=4,B=8,L=1,V=2,G=4,U=8,q=16,Y=V|G,X=U|q,H=Y|X,W=[\"x\",\"y\"],J=[\"clientX\",\"clientY\"];function Q(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){v(e.options.enable,[e])&&i.handler(t)},this.init()}function $(t,e,i){var n=i.pointers.length,r=i.changedPointers.length,o=e&I&&n-r==0,s=e&(R|B)&&n-r==0;i.isFirst=!!o,i.isFinal=!!s,o&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,r=n.length;i.firstInput||(i.firstInput=K(e)),1<r&&!i.firstMultiple?i.firstMultiple=K(e):1===r&&(i.firstMultiple=!1);var o,s,a,l,h,c,u=i.firstInput,_=i.firstMultiple,p=_?_.center:u.center,d=e.center=Z(n);e.timeStamp=k(),e.deltaTime=e.timeStamp-u.timeStamp,e.angle=nt(p,d),e.distance=it(p,d),o=i,a=(s=e).center,l=o.offsetDelta||{},h=o.prevDelta||{},c=o.prevInput||{},s.eventType!==I&&c.eventType!==R||(h=o.prevDelta={x:c.deltaX||0,y:c.deltaY||0},l=o.offsetDelta={x:a.x,y:a.y}),s.deltaX=h.x+(a.x-l.x),s.deltaY=h.y+(a.y-l.y),e.offsetDirection=et(e.deltaX,e.deltaY);var f,v,m,g,y=tt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=y.x,e.overallVelocityY=y.y,e.overallVelocity=w(y.x)>w(y.y)?y.x:y.y,e.scale=_?(m=_.pointers,it((g=n)[0],g[1],J)/it(m[0],m[1],J)):1,e.rotation=_?(f=_.pointers,nt((v=n)[1],v[0],J)+nt(f[1],f[0],J)):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,r,o,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(e.eventType!=B&&(D<a||s.velocity===x)){var l=e.deltaX-s.deltaX,h=e.deltaY-s.deltaY,c=tt(a,l,h);n=c.x,r=c.y,i=w(c.x)>w(c.y)?c.x:c.y,o=et(l,h),t.lastInterval=e}else i=s.velocity,n=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=r,e.direction=o}(i,e);var b=t.element;S(e.srcEvent.target,b)&&(b=e.srcEvent.target),e.target=b}(t,i),t.emit(\"hammer.input\",i),t.recognize(i),t.session.prevInput=i}function K(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:h(t.pointers[i].clientX),clientY:h(t.pointers[i].clientY)},i++;return{timeStamp:k(),pointers:e,center:Z(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Z(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var i=0,n=0,r=0;r<e;)i+=t[r].clientX,n+=t[r].clientY,r++;return{x:h(i/e),y:h(n/e)}}function tt(t,e,i){return{x:e/t||0,y:i/t||0}}function et(t,e){return t===e?L:w(t)>=w(e)?t<0?V:G:e<0?U:q}function it(t,e,i){i||(i=W);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return Math.sqrt(n*n+r*r)}function nt(t,e,i){i||(i=W);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return 180*Math.atan2(r,n)/Math.PI}Q.prototype={handler:function(){},init:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(z(this.element),this.evWin,this.domHandler)}};var rt={mousedown:I,mousemove:2,mouseup:R},ot=\"mousedown\",st=\"mousemove mouseup\";function at(){this.evEl=ot,this.evWin=st,this.pressed=!1,Q.apply(this,arguments)}d(at,Q,{handler:function(t){var e=rt[t.type];e&I&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=R),this.pressed&&(e&R&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:\"mouse\",srcEvent:t}))}});var lt={pointerdown:I,pointermove:2,pointerup:R,pointercancel:B,pointerout:B},ht={2:F,3:\"pen\",4:\"mouse\",5:\"kinect\"},ct=\"pointerdown\",ut=\"pointermove pointerup pointercancel\";function _t(){this.evEl=ct,this.evWin=ut,Q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(ct=\"MSPointerDown\",ut=\"MSPointerMove MSPointerUp MSPointerCancel\"),d(_t,Q,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace(\"ms\",\"\"),r=lt[n],o=ht[t.pointerType]||t.pointerType,s=o==F,a=C(e,t.pointerId,\"pointerId\");r&I&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(R|B)&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(a,1))}});var pt={touchstart:I,touchmove:2,touchend:R,touchcancel:B};function dt(){this.evTarget=\"touchstart\",this.evWin=\"touchstart touchmove touchend touchcancel\",this.started=!1,Q.apply(this,arguments)}d(dt,Q,{handler:function(t){var e=pt[t.type];if(e===I&&(this.started=!0),this.started){var i=function(t,e){var i=A(t.touches),n=A(t.changedTouches);return e&(R|B)&&(i=E(i.concat(n),\"identifier\",!0)),[i,n]}.call(this,t,e);e&(R|B)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:F,srcEvent:t})}}});var ft={touchstart:I,touchmove:2,touchend:R,touchcancel:B},vt=\"touchstart touchmove touchend touchcancel\";function mt(){this.evTarget=vt,this.targetIds={},Q.apply(this,arguments)}d(mt,Q,{handler:function(t){var e=ft[t.type],i=function(t,e){var i=A(t.touches),n=this.targetIds;if(e&(2|I)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,o,s=A(t.changedTouches),a=[],l=this.target;if(o=i.filter(function(t){return S(t.target,l)}),e===I)for(r=0;r<o.length;)n[o[r].identifier]=!0,r++;for(r=0;r<s.length;)n[s[r].identifier]&&a.push(s[r]),e&(R|B)&&delete n[s[r].identifier],r++;return a.length?[E(o.concat(a),\"identifier\",!0),a]:void 0}.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:F,srcEvent:t})}});var gt=2500;function yt(){Q.apply(this,arguments);var t=f(this.handler,this);this.touch=new mt(this.manager,t),this.mouse=new at(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function bt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout(function(){var t=n.indexOf(i);-1<t&&n.splice(t,1)},gt)}}d(yt,Q,{handler:function(t,e,i){var n=i.pointerType==F,r=\"mouse\"==i.pointerType;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)(function(t,e){t&I?(this.primaryTouch=e.changedPointers[0].identifier,bt.call(this,e)):t&(R|B)&&bt.call(this,e)}).call(this,e,i);else if(r&&function(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],o=Math.abs(e-r.x),s=Math.abs(i-r.y);if(o<=25&&s<=25)return!0}return!1}.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var xt=M(e.style,\"touchAction\"),wt=xt!==x,kt=\"manipulation\",St=\"none\",Tt=\"pan-x\",Ct=\"pan-y\",At=function(){if(!wt)return!1;var e={},i=o.CSS&&o.CSS.supports;return[\"auto\",\"manipulation\",\"pan-y\",\"pan-x\",\"pan-x pan-y\",\"none\"].forEach(function(t){e[t]=!i||o.CSS.supports(\"touch-action\",t)}),e}();function Et(t,e){this.manager=t,this.set(e)}Et.prototype={set:function(t){\"compute\"==t&&(t=this.compute()),wt&&this.manager.element.style&&At[t]&&(this.manager.element.style[xt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return u(this.manager.recognizers,function(t){v(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(t){if(b(t,St))return St;var e=b(t,Tt),i=b(t,Ct);return e&&i?St:e||i?e?Tt:Ct:b(t,kt)?kt:\"auto\"}(e.join(\" \"))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,r=b(n,St)&&!At.none,o=b(n,Ct)&&!At[Ct],s=b(n,Tt)&&!At[Tt];if(r){var a=1===t.pointers.length,l=t.distance<2,h=t.deltaTime<250;if(a&&l&&h)return}if(!s||!o)return r||o&&i&Y||s&&i&X?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Mt=1;function Ot(t){this.options=s({},this.defaults,t||{}),this.id=O++,this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=Mt,this.simultaneous={},this.requireFail=[]}function zt(t){return 16&t?\"cancel\":8&t?\"end\":4&t?\"move\":2&t?\"start\":\"\"}function Pt(t){return t==q?\"down\":t==U?\"up\":t==V?\"left\":t==G?\"right\":\"\"}function jt(t,e){var i=e.manager;return i?i.get(t):t}function Nt(){Ot.apply(this,arguments)}function Ft(){Nt.apply(this,arguments),this.pX=null,this.pY=null}function Dt(){Nt.apply(this,arguments)}function It(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Rt(){Nt.apply(this,arguments)}function Bt(){Nt.apply(this,arguments)}function Lt(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Vt(t,e){return(e=e||{}).recognizers=m(e.recognizers,Vt.defaults.preset),new Gt(t,e)}function Gt(t,e){var i;this.options=s({},Vt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this).options.inputClass||(j?_t:N?mt:P?yt:at))(i,$),this.touchAction=new Et(this,this.options.touchAction),Ut(this,!0),u(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Ut(i,n){var r,o=i.element;o.style&&(u(i.options.cssProps,function(t,e){r=M(o.style,e),n?(i.oldCssProps[r]=o.style[r],o.style[r]=t):o.style[r]=i.oldCssProps[r]||\"\"}),n||(i.oldCssProps={}))}Ot.prototype={defaults:{},set:function(t){return s(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(n(t,\"recognizeWith\",this))return this;var e=this.simultaneous;return t=jt(t,this),e[t.id]||(e[t.id]=t).recognizeWith(this),this},dropRecognizeWith:function(t){return n(t,\"dropRecognizeWith\",this)||(t=jt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(n(t,\"requireFailure\",this))return this;var e=this.requireFail;return t=jt(t,this),-1===C(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(n(t,\"dropRequireFailure\",this))return this;t=jt(t,this);var e=C(this.requireFail,t);return-1<e&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(e){var i=this,t=this.state;function n(t){i.manager.emit(t,e)}t<8&&n(i.options.event+zt(t)),n(i.options.event),e.additionalEvent&&n(e.additionalEvent),8<=t&&n(i.options.event+zt(t))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Mt)))return!1;t++}return!0},recognize:function(t){var e=s({},t);if(!v(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Mt),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},d(Nt,Ot,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=6&e,r=this.attrTest(t);return n&&(i&B||!r)?16|e:n||r?i&R?8|e:2&e?4|e:2:32}}),d(Ft,Nt,{defaults:{event:\"pan\",threshold:10,pointers:1,direction:H},getTouchAction:function(){var t=this.options.direction,e=[];return t&Y&&e.push(Ct),t&X&&e.push(Tt),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&Y?(r=0===o?L:o<0?V:G,i=o!=this.pX,n=Math.abs(t.deltaX)):(r=0===s?L:s<0?U:q,i=s!=this.pY,n=Math.abs(t.deltaY))),t.direction=r,i&&n>e.threshold&&r&e.direction},attrTest:function(t){return Nt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Pt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),d(Dt,Nt,{defaults:{event:\"pinch\",threshold:0,pointers:2},getTouchAction:function(){return[St]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?\"in\":\"out\";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),d(It,Ot,{defaults:{event:\"press\",pointers:1,time:251,threshold:9},getTouchAction:function(){return[\"auto\"]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(R|B)&&!r)this.reset();else if(t.eventType&I)this.reset(),this._timer=c(function(){this.state=8,this.tryEmit()},e.time,this);else if(t.eventType&R)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&t.eventType&R?this.manager.emit(this.options.event+\"up\",t):(this._input.timeStamp=k(),this.manager.emit(this.options.event,this._input)))}}),d(Rt,Nt,{defaults:{event:\"rotate\",threshold:0,pointers:2},getTouchAction:function(){return[St]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),d(Bt,Nt,{defaults:{event:\"swipe\",threshold:10,velocity:.3,direction:Y|X,pointers:1},getTouchAction:function(){return Ft.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(Y|X)?e=t.overallVelocity:i&Y?e=t.overallVelocityX:i&X&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&w(e)>this.options.velocity&&t.eventType&R},emit:function(t){var e=Pt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),d(Lt,Ot,{defaults:{event:\"tap\",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[kt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&I&&0===this.count)return this.failTimeout();if(n&&r&&i){if(t.eventType!=R)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||it(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t;var a=this.count%e.taps;if(0===a)return this.hasRequireFailures()?(this._timer=c(function(){this.state=8,this.tryEmit()},e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=c(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Vt.VERSION=\"2.0.7\",Vt.defaults={domEvents:!1,touchAction:\"compute\",enable:!0,inputTarget:null,inputClass:null,preset:[[Rt,{enable:!1}],[Dt,{enable:!1},[\"rotate\"]],[Bt,{direction:Y}],[Ft,{direction:Y},[\"swipe\"]],[Lt],[Lt,{event:\"doubletap\",taps:2},[\"tap\"]],[It]],cssProps:{userSelect:\"none\",touchSelect:\"none\",touchCallout:\"none\",contentZooming:\"none\",userDrag:\"none\",tapHighlightColor:\"rgba(0,0,0,0)\"}},Gt.prototype={set:function(t){return s(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,r=e.curRecognizer;(!r||r&&8&r.state)&&(r=e.curRecognizer=null);for(var o=0;o<n.length;)i=n[o],2===e.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(t),!r&&14&i.state&&(r=e.curRecognizer=i),o++}},get:function(t){if(t instanceof Ot)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(n(t,\"add\",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),(t.manager=this).touchAction.update(),t},remove:function(t){if(n(t,\"remove\",this))return this;if(t=this.get(t)){var e=this.recognizers,i=C(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==x&&e!==x){var i=this.handlers;return u(T(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==x){var i=this.handlers;return u(T(t),function(t){e?i[t]&&i[t].splice(C(i[t],e),1):delete i[t]}),this}},emit:function(t,e){var i,n,r;this.options.domEvents&&(i=t,n=e,(r=a.createEvent(\"Event\")).initEvent(i,!0,!0),(r.gesture=n).target.dispatchEvent(r));var o=this.handlers[t]&&this.handlers[t].slice();if(o&&o.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var s=0;s<o.length;)o[s](e),s++}},destroy:function(){this.element&&Ut(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(Vt,{INPUT_START:I,INPUT_MOVE:2,INPUT_END:R,INPUT_CANCEL:B,STATE_POSSIBLE:Mt,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:L,DIRECTION_LEFT:V,DIRECTION_RIGHT:G,DIRECTION_UP:U,DIRECTION_DOWN:q,DIRECTION_HORIZONTAL:Y,DIRECTION_VERTICAL:X,DIRECTION_ALL:H,Manager:Gt,Input:Q,TouchAction:Et,TouchInput:mt,MouseInput:at,PointerEventInput:_t,TouchMouseInput:yt,SingleTouchInput:dt,Recognizer:Ot,AttrRecognizer:Nt,Tap:Lt,Pan:Ft,Swipe:Bt,Pinch:Dt,Rotate:Rt,Press:It,on:g,off:y,each:u,merge:p,extend:_,assign:s,inherit:d,bindFn:f,prefixed:M});var qt=void 0!==o?o:\"undefined\"!=typeof self?self:{};qt.Hammer=Vt,void 0!==Yt&&Yt.exports?Yt.exports=Vt:o.Hammer=Vt}(window,document)},function(t,e,i){var n,r,o=t(349);(r=n=i.Operator||(i.Operator={}))[r.Le=0]=\"Le\",r[r.Ge=1]=\"Ge\",r[r.Eq=2]=\"Eq\";var s=function(){function t(t,e,i){void 0===i&&(i=o.Strength.required),this._id=a++,this._operator=e,this._expression=t,this._strength=o.Strength.clip(i)}return t.Compare=function(t,e){return t.id-e.id},t.prototype.toString=function(){var t=this;return this._expression+\" \"+function(){switch(t._operator){case n.Le:return\"<=\";case n.Ge:return\">=\";case n.Eq:return\"==\"}}()+\" 0\"},Object.defineProperty(t.prototype,\"id\",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"expression\",{get:function(){return this._expression},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"op\",{get:function(){return this._operator},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"strength\",{get:function(){return this._strength},enumerable:!0,configurable:!0}),t}();i.Constraint=s;var a=0},function(t,e,i){var h=t(353),c=t(356),u=t(347),n=function(){function t(){var t=function(t){for(var e=0,i=function(){return 0},n=u.createMap(c.Variable.Compare),r=0,o=t.length;r<o;++r){var s=t[r];if(\"number\"==typeof s)e+=s;else if(s instanceof c.Variable)n.setDefault(s,i).second+=1;else{if(!(s instanceof Array))throw new Error(\"invalid Expression argument: \"+JSON.stringify(s));if(2!==s.length)throw new Error(\"array must have length 2\");var a=s[0],l=s[1];if(\"number\"!=typeof a)throw new Error(\"array item 0 must be a number\");if(!(l instanceof c.Variable))throw new Error(\"array item 1 must be a variable\");n.setDefault(l,i).second+=a}}return{terms:n,constant:e}}(arguments);this._terms=t.terms,this._constant=t.constant}return t.prototype.toString=function(){var e=[];h.forEach(this._terms,function(t){e.push([t.first,t.second])});for(var t=!0,i=\"\",n=0,r=e;n<r.length;n++){var o=r[n],s=o[0],a=o[1];t?(t=!1,i+=1==a?\"\"+s:-1==a?\"-\"+s:a+\"*\"+s):i+=1==a?\" + \"+s:-1==a?\" - \"+s:0<=a?\" + \"+a+s:\" - \"+-a+s}var l=this.constant;return l<0?i+=\" - \"+-l:0<l&&(i+=\" + \"+l),i},Object.defineProperty(t.prototype,\"terms\",{get:function(){return this._terms},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"constant\",{get:function(){return this._constant},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"value\",{get:function(){var e=this._constant;return h.forEach(this._terms,function(t){e+=t.first.value*t.second}),e},enumerable:!0,configurable:!0}),t}();i.Expression=n},function(t,e,i){ /*----------------------------------------------------------------------------- | Copyright (c) 2014, Nucleic Development Team. | | Distributed under the terms of the Modified BSD License. | | The full license is in the file COPYING.txt, distributed with this software. |----------------------------------------------------------------------------*/ function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t(356)),n(t(345)),n(t(344)),n(t(349)),n(t(348))},function(t,e,i){var n=t(353);i.createMap=function(t){return new n.AssociativeArray(t)}},function(t,e,i){var g,n,r=t(356),a=t(345),y=t(344),b=t(349),o=t(347),s=t(353),l=function(){function t(){this._cnMap=o.createMap(y.Constraint.Compare),this._rowMap=o.createMap(h.Compare),this._varMap=o.createMap(r.Variable.Compare),this._editMap=o.createMap(r.Variable.Compare),this._infeasibleRows=[],this._objective=new k,this._artificial=null,this._idTick=0}return t.prototype.addConstraint=function(t){var e=this._cnMap.find(t);if(void 0!==e)throw new Error(\"duplicate constraint\");var i=this._createRow(t),n=i.row,r=i.tag,o=this._chooseSubject(n,r);if(o.type()===g.Invalid&&n.allDummies()){if(!x(n.constant())){for(var s=[],a=0,l=t.expression.terms._array;a<l.length;a++){var h=l[a];s.push(h.first.name)}var c=[\"LE\",\"GE\",\"EQ\"][t.op];throw new Error(\"unsatisfiable constraint [\"+s.join(\",\")+\"] operator: \"+c)}o=r.marker}if(o.type()===g.Invalid){if(!this._addWithArtificialVariable(n))throw new Error(\"unsatisfiable constraint\")}else n.solveFor(o),this._substitute(o,n),this._rowMap.insert(o,n);this._cnMap.insert(t,r),this._optimize(this._objective)},t.prototype.removeConstraint=function(t,e){void 0===e&&(e=!1);var i=this._cnMap.erase(t);if(void 0===i){if(e)return;throw new Error(\"unknown constraint\")}this._removeConstraintEffects(t,i.second);var n=i.second.marker,r=this._rowMap.erase(n);if(void 0===r){var o=this._getMarkerLeavingSymbol(n);if(o.type()===g.Invalid)throw new Error(\"failed to find leaving row\");(r=this._rowMap.erase(o)).second.solveForEx(o,n),this._substitute(n,r.second)}this._optimize(this._objective)},t.prototype.hasConstraint=function(t){return this._cnMap.contains(t)},t.prototype.addEditVariable=function(t,e){var i=this._editMap.find(t);if(void 0!==i)throw new Error(\"duplicate edit variable: \"+t.name);if((e=b.Strength.clip(e))===b.Strength.required)throw new Error(\"bad required strength\");var n=new a.Expression(t),r=new y.Constraint(n,y.Operator.Eq,e);this.addConstraint(r);var o=this._cnMap.find(r).second,s={tag:o,constraint:r,constant:0};this._editMap.insert(t,s)},t.prototype.removeEditVariable=function(t,e){void 0===e&&(e=!1);var i=this._editMap.erase(t);if(void 0===i){if(e)return;throw new Error(\"unknown edit variable: \"+t.name)}this.removeConstraint(i.second.constraint,e)},t.prototype.hasEditVariable=function(t){return this._editMap.contains(t)},t.prototype.suggestValue=function(t,e){var i=this._editMap.find(t);if(void 0===i)throw new Error(\"unknown edit variable: \"+t.name);var n=this._rowMap,r=i.second,o=e-r.constant;r.constant=e;var s=r.tag.marker,a=n.find(s);if(void 0!==a)return a.second.add(-o)<0&&this._infeasibleRows.push(s),void this._dualOptimize();var l=r.tag.other;if(void 0!==(a=n.find(l)))return a.second.add(o)<0&&this._infeasibleRows.push(l),void this._dualOptimize();for(var h=0,c=n.size();h<c;++h){var u=n.itemAt(h),_=u.second,p=_.coefficientFor(s);0!==p&&_.add(o*p)<0&&u.first.type()!==g.External&&this._infeasibleRows.push(u.first)}this._dualOptimize()},t.prototype.updateVariables=function(){for(var t=this._varMap,e=this._rowMap,i=0,n=t.size();i<n;++i){var r=t.itemAt(i),o=e.find(r.second),s=0;void 0!==o&&-0===(s=o.second.constant())&&(s=0),r.first.setValue(s)}},t.prototype.getConstraints=function(){var e=[];return s.forEach(this._cnMap,function(t){e.push(t.first)}),e},Object.defineProperty(t.prototype,\"numConstraints\",{get:function(){return this._cnMap.size()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"numEditVariables\",{get:function(){return this._editMap.size()},enumerable:!0,configurable:!0}),t.prototype._getVarSymbol=function(t){var e=this;return this._varMap.setDefault(t,function(){return e._makeSymbol(g.External)}).second},t.prototype._createRow=function(t){for(var e=t.expression,i=new k(e.constant),n=e.terms,r=0,o=n.size();r<o;++r){var s=n.itemAt(r);if(!x(s.second)){var a=this._getVarSymbol(s.first),l=this._rowMap.find(a);void 0!==l?i.insertRow(l.second,s.second):i.insertSymbol(a,s.second)}}var h=this._objective,c=t.strength,u={marker:w,other:w};switch(t.op){case y.Operator.Le:case y.Operator.Ge:var _=t.op===y.Operator.Le?1:-1,p=this._makeSymbol(g.Slack);if(u.marker=p,i.insertSymbol(p,_),c<b.Strength.required){var d=this._makeSymbol(g.Error);u.other=d,i.insertSymbol(d,-_),h.insertSymbol(d,c)}break;case y.Operator.Eq:if(c<b.Strength.required){var f=this._makeSymbol(g.Error),v=this._makeSymbol(g.Error);u.marker=f,u.other=v,i.insertSymbol(f,-1),i.insertSymbol(v,1),h.insertSymbol(f,c),h.insertSymbol(v,c)}else{var m=this._makeSymbol(g.Dummy);u.marker=m,i.insertSymbol(m)}}return i.constant()<0&&i.reverseSign(),{row:i,tag:u}},t.prototype._chooseSubject=function(t,e){for(var i=t.cells(),n=0,r=i.size();n<r;++n){var o=i.itemAt(n);if(o.first.type()===g.External)return o.first}var s=e.marker.type();return(s===g.Slack||s===g.Error)&&t.coefficientFor(e.marker)<0?e.marker:((s=e.other.type())===g.Slack||s===g.Error)&&t.coefficientFor(e.other)<0?e.other:w},t.prototype._addWithArtificialVariable=function(t){var e=this._makeSymbol(g.Slack);this._rowMap.insert(e,t.copy()),this._artificial=t.copy(),this._optimize(this._artificial);var i=x(this._artificial.constant());this._artificial=null;var n=this._rowMap.erase(e);if(void 0!==n){var r=n.second;if(r.isConstant())return i;var o=this._anyPivotableSymbol(r);if(o.type()===g.Invalid)return!1;r.solveForEx(e,o),this._substitute(o,r),this._rowMap.insert(o,r)}for(var s=this._rowMap,a=0,l=s.size();a<l;++a)s.itemAt(a).second.removeSymbol(e);return this._objective.removeSymbol(e),i},t.prototype._substitute=function(t,e){for(var i=this._rowMap,n=0,r=i.size();n<r;++n){var o=i.itemAt(n);o.second.substitute(t,e),o.second.constant()<0&&o.first.type()!==g.External&&this._infeasibleRows.push(o.first)}this._objective.substitute(t,e),this._artificial&&this._artificial.substitute(t,e)},t.prototype._optimize=function(t){for(;;){var e=this._getEnteringSymbol(t);if(e.type()===g.Invalid)return;var i=this._getLeavingSymbol(e);if(i.type()===g.Invalid)throw new Error(\"the objective is unbounded\");var n=this._rowMap.erase(i).second;n.solveForEx(i,e),this._substitute(e,n),this._rowMap.insert(e,n)}},t.prototype._dualOptimize=function(){for(var t=this._rowMap,e=this._infeasibleRows;0!==e.length;){var i=e.pop(),n=t.find(i);if(void 0!==n&&n.second.constant()<0){var r=this._getDualEnteringSymbol(n.second);if(r.type()===g.Invalid)throw new Error(\"dual optimize failed\");var o=n.second;t.erase(i),o.solveForEx(i,r),this._substitute(r,o),t.insert(r,o)}}},t.prototype._getEnteringSymbol=function(t){for(var e=t.cells(),i=0,n=e.size();i<n;++i){var r=e.itemAt(i),o=r.first;if(r.second<0&&o.type()!==g.Dummy)return o}return w},t.prototype._getDualEnteringSymbol=function(t){for(var e=Number.MAX_VALUE,i=w,n=t.cells(),r=0,o=n.size();r<o;++r){var s=n.itemAt(r),a=s.first,l=s.second;if(0<l&&a.type()!==g.Dummy){var h=this._objective.coefficientFor(a),c=h/l;c<e&&(e=c,i=a)}}return i},t.prototype._getLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,i=w,n=this._rowMap,r=0,o=n.size();r<o;++r){var s=n.itemAt(r),a=s.first;if(a.type()!==g.External){var l=s.second,h=l.coefficientFor(t);if(h<0){var c=-l.constant()/h;c<e&&(e=c,i=a)}}}return i},t.prototype._getMarkerLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,i=e,n=e,r=w,o=r,s=r,a=r,l=this._rowMap,h=0,c=l.size();h<c;++h){var u=l.itemAt(h),_=u.second,p=_.coefficientFor(t);if(0!==p){var d=u.first;if(d.type()===g.External)a=d;else if(p<0){var f=-_.constant()/p;f<i&&(i=f,o=d)}else{var f=_.constant()/p;f<n&&(n=f,s=d)}}}return o!==r?o:s!==r?s:a},t.prototype._removeConstraintEffects=function(t,e){e.marker.type()===g.Error&&this._removeMarkerEffects(e.marker,t.strength),e.other.type()===g.Error&&this._removeMarkerEffects(e.other,t.strength)},t.prototype._removeMarkerEffects=function(t,e){var i=this._rowMap.find(t);void 0!==i?this._objective.insertRow(i.second,-e):this._objective.insertSymbol(t,-e)},t.prototype._anyPivotableSymbol=function(t){for(var e=t.cells(),i=0,n=e.size();i<n;++i){var r=e.itemAt(i),o=r.first.type();if(o===g.Slack||o===g.Error)return r.first}return w},t.prototype._makeSymbol=function(t){return new h(t,this._idTick++)},t}();function x(t){return t<0?-t<1e-8:t<1e-8}i.Solver=l,(n=g||(g={}))[n.Invalid=0]=\"Invalid\",n[n.External=1]=\"External\",n[n.Slack=2]=\"Slack\",n[n.Error=3]=\"Error\",n[n.Dummy=4]=\"Dummy\";var h=function(){function t(t,e){this._id=e,this._type=t}return t.Compare=function(t,e){return t.id()-e.id()},t.prototype.id=function(){return this._id},t.prototype.type=function(){return this._type},t}(),w=new h(g.Invalid,-1),k=function(){function e(t){void 0===t&&(t=0),this._cellMap=o.createMap(h.Compare),this._constant=t}return e.prototype.cells=function(){return this._cellMap},e.prototype.constant=function(){return this._constant},e.prototype.isConstant=function(){return this._cellMap.empty()},e.prototype.allDummies=function(){for(var t=this._cellMap,e=0,i=t.size();e<i;++e){var n=t.itemAt(e);if(n.first.type()!==g.Dummy)return!1}return!0},e.prototype.copy=function(){var t=new e(this._constant);return t._cellMap=this._cellMap.copy(),t},e.prototype.add=function(t){return this._constant+=t},e.prototype.insertSymbol=function(t,e){void 0===e&&(e=1);var i=this._cellMap.setDefault(t,function(){return 0});x(i.second+=e)&&this._cellMap.erase(t)},e.prototype.insertRow=function(t,e){void 0===e&&(e=1),this._constant+=t._constant*e;for(var i=t._cellMap,n=0,r=i.size();n<r;++n){var o=i.itemAt(n);this.insertSymbol(o.first,o.second*e)}},e.prototype.removeSymbol=function(t){this._cellMap.erase(t)},e.prototype.reverseSign=function(){this._constant=-this._constant;for(var t=this._cellMap,e=0,i=t.size();e<i;++e){var n=t.itemAt(e);n.second=-n.second}},e.prototype.solveFor=function(t){var e=this._cellMap,i=e.erase(t),n=-1/i.second;this._constant*=n;for(var r=0,o=e.size();r<o;++r)e.itemAt(r).second*=n},e.prototype.solveForEx=function(t,e){this.insertSymbol(t,-1),this.solveFor(e)},e.prototype.coefficientFor=function(t){var e=this._cellMap.find(t);return void 0!==e?e.second:0},e.prototype.substitute=function(t,e){var i=this._cellMap.erase(t);void 0!==i&&this.insertRow(e,i.second)},e}()},function(t,e,i){!function(e){function t(t,e,i,n){void 0===n&&(n=1);var r=0;return r+=1e6*Math.max(0,Math.min(1e3,t*n)),r+=1e3*Math.max(0,Math.min(1e3,e*n)),r+=Math.max(0,Math.min(1e3,i*n))}e.create=t,e.required=t(1e3,1e3,1e3),e.strong=t(1,0,0),e.medium=t(0,1,0),e.weak=t(0,0,1),e.clip=function(t){return Math.max(0,Math.min(e.required,t))}}(i.Strength||(i.Strength={}))},function(t,e,i){var l=t(354);function o(t,e,i){for(var n,r,o=0,s=t.length;0<s;)i(t[r=o+(n=s>>1)],e)<0?(o=r+1,s-=n+1):s=n;return o}i.lowerBound=o,i.binarySearch=function(t,e,i){var n=o(t,e,i);if(n===t.length)return-1;var r=t[n];return 0!==i(r,e)?-1:n},i.binaryFind=function(t,e,i){var n=o(t,e,i);if(n!==t.length){var r=t[n];if(0===i(r,e))return r}},i.asSet=function(t,e){var i=l.asArray(t),n=i.length;if(n<=1)return i;i.sort(e);for(var r=[i[0]],o=1,s=0;o<n;++o){var a=i[o];0!==e(r[s],a)&&(r.push(a),++s)}return r},i.setIsDisjoint=function(t,e,i){for(var n=0,r=0,o=t.length,s=e.length;n<o&&r<s;){var a=i(t[n],e[r]);if(a<0)++n;else{if(!(0<a))return!1;++r}}return!0},i.setIsSubset=function(t,e,i){var n=t.length,r=e.length;if(r<n)return!1;for(var o=0,s=0;o<n&&s<r;){var a=i(t[o],e[s]);if(a<0)return!1;0<a||++o,++s}return!(o<n)},i.setUnion=function(t,e,i){for(var n=0,r=0,o=t.length,s=e.length,a=[];n<o&&r<s;){var l=t[n],h=e[r],c=i(l,h);c<0?(a.push(l),++n):(0<c?a.push(h):(a.push(l),++n),++r)}for(;n<o;)a.push(t[n]),++n;for(;r<s;)a.push(e[r]),++r;return a},i.setIntersection=function(t,e,i){for(var n=0,r=0,o=t.length,s=e.length,a=[];n<o&&r<s;){var l=t[n],h=e[r],c=i(l,h);c<0?++n:(0<c||(a.push(l),++n),++r)}return a},i.setDifference=function(t,e,i){for(var n=0,r=0,o=t.length,s=e.length,a=[];n<o&&r<s;){var l=t[n],h=e[r],c=i(l,h);c<0?(a.push(l),++n):(0<c||++n,++r)}for(;n<o;)a.push(t[n]),++n;return a},i.setSymmetricDifference=function(t,e,i){for(var n=0,r=0,o=t.length,s=e.length,a=[];n<o&&r<s;){var l=t[n],h=e[r],c=i(l,h);c<0?(a.push(l),++n):(0<c?a.push(h):++n,++r)}for(;n<o;)a.push(t[n]),++n;for(;r<s;)a.push(e[r]),++r;return a}},function(t,e,i){var n=t(354),r=function(){function t(){this._array=[]}return t.prototype.size=function(){return this._array.length},t.prototype.empty=function(){return 0===this._array.length},t.prototype.itemAt=function(t){return this._array[t]},t.prototype.takeAt=function(t){return this._array.splice(t,1)[0]},t.prototype.clear=function(){this._array=[]},t.prototype.swap=function(t){var e=this._array;this._array=t._array,t._array=e},t.prototype.__iter__=function(){return n.iter(this._array)},t.prototype.__reversed__=function(){return n.reversed(this._array)},t}();i.ArrayBase=r},function(t,e,i){ /*----------------------------------------------------------------------------- | Copyright (c) 2014, Nucleic Development Team. | | Distributed under the terms of the Modified BSD License. | | The full license is in the file COPYING.txt, distributed with this software. |----------------------------------------------------------------------------*/ var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=t(355),o=t(351),a=t(350),l=t(354),h=function(n){function o(t){var i,e=n.call(this)||this;return e._compare=t,e._wrapped=(i=t,function(t,e){return i(t.first,e)}),e}return r(o,n),o.prototype.comparitor=function(){return this._compare},o.prototype.indexOf=function(t){return a.binarySearch(this._array,t,this._wrapped)},o.prototype.contains=function(t){return 0<=a.binarySearch(this._array,t,this._wrapped)},o.prototype.find=function(t){return a.binaryFind(this._array,t,this._wrapped)},o.prototype.setDefault=function(t,e){var i=this._array,n=a.lowerBound(i,t,this._wrapped);if(n===i.length){var r=new s.Pair(t,e());return i.push(r),r}var o=i[n];if(0!==this._compare(o.first,t)){var r=new s.Pair(t,e());return i.splice(n,0,r),r}return o},o.prototype.insert=function(t,e){var i=this._array,n=a.lowerBound(i,t,this._wrapped);if(n===i.length){var r=new s.Pair(t,e);return i.push(r),r}var o=i[n];if(0!==this._compare(o.first,t)){var r=new s.Pair(t,e);return i.splice(n,0,r),r}return o.second=e,o},o.prototype.update=function(t){var e=this;t instanceof o?this._array=function(t,e,i){for(var n=0,r=0,o=t.length,s=e.length,a=[];n<o&&r<s;){var l=t[n],h=e[r],c=i(l.first,h.first);c<0?(a.push(l.copy()),++n):(0<c?a.push(h.copy()):(a.push(h.copy()),++n),++r)}for(;n<o;)a.push(t[n].copy()),++n;for(;r<s;)a.push(e[r].copy()),++r;return a}(this._array,t._array,this._compare):l.forEach(t,function(t){e.insert(t.first,t.second)})},o.prototype.erase=function(t){var e=this._array,i=a.binarySearch(e,t,this._wrapped);if(!(i<0))return e.splice(i,1)[0]},o.prototype.copy=function(){for(var t=new o(this._compare),e=t._array,i=this._array,n=0,r=i.length;n<r;++n)e.push(i[n].copy());return t},o}(o.ArrayBase);i.AssociativeArray=h},function(t,e,i){function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}n(t(350)),n(t(351)),n(t(352)),n(t(354)),n(t(355))},function(t,e,i){var n=function(){function t(t,e){void 0===e&&(e=0),this._array=t,this._index=Math.max(0,Math.min(e,t.length))}return t.prototype.__next__=function(){return this._array[this._index++]},t.prototype.__iter__=function(){return this},t}();i.ArrayIterator=n;var r=function(){function t(t,e){void 0===e&&(e=t.length),this._array=t,this._index=Math.max(0,Math.min(e,t.length))}return t.prototype.__next__=function(){return this._array[--this._index]},t.prototype.__iter__=function(){return this},t}();i.ReverseArrayIterator=r,i.iter=function(t){return t instanceof Array?new n(t):t.__iter__()},i.reversed=function(t){return t instanceof Array?new r(t):t.__reversed__()},i.next=function(t){return t.__next__()},i.asArray=function(t){if(t instanceof Array)return t.slice();for(var e,i=[],n=t.__iter__();void 0!==(e=n.__next__());)i.push(e);return i},i.forEach=function(t,e){if(t instanceof Array){for(var i=0,n=t.length;i<n;++i)if(!1===e(t[i]))return}else for(var r,o=t.__iter__();void 0!==(r=o.__next__());)if(!1===e(r))return},i.map=function(t,e){var i=[];if(t instanceof Array)for(var n=0,r=t.length;n<r;++n)i.push(e(t[n]));else for(var o,s=t.__iter__();void 0!==(o=s.__next__());)i.push(e(o));return i},i.filter=function(t,e){var i,n=[];if(t instanceof Array)for(var r=0,o=t.length;r<o;++r)i=t[r],e(i)&&n.push(i);else for(var s=t.__iter__();void 0!==(i=s.__next__());)e(i)&&n.push(i);return n}},function(t,e,i){var n=function(){function t(t,e){this.first=t,this.second=e}return t.prototype.copy=function(){return new t(this.first,this.second)},t}();i.Pair=n},function(t,e,i){var n=function(){function t(t){void 0===t&&(t=\"\"),this._value=0,this._context=null,this._id=r++,this._name=t}return t.Compare=function(t,e){return t.id-e.id},t.prototype.toString=function(){return this._name},Object.defineProperty(t.prototype,\"id\",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"name\",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.setName=function(t){this._name=t},Object.defineProperty(t.prototype,\"context\",{get:function(){return this._context},enumerable:!0,configurable:!0}),t.prototype.setContext=function(t){this._context=t},Object.defineProperty(t.prototype,\"value\",{get:function(){return this._value},enumerable:!0,configurable:!0}),t.prototype.setValue=function(t){this._value=t},t}();i.Variable=n;var r=0},function(t,e,i){ /*! * numbro.js * version : 1.6.2 * author : Företagsplatsen AB * license : MIT * http://www.foretagsplatsen.se */ var c,U={},o=U,q=\"en-US\",Y=null,r=\"0,0\";function n(t){this._value=t}function p(t){var e,i=\"\";for(e=0;e<t;e++)i+=\"0\";return i}function X(t,e,i,n){var r,o,s,a,l,h,c,u,_=Math.pow(10,e);return o=-1<t.toFixed(0).search(\"e\")?(s=e,u=t.toString(),a=u.split(\"e\")[0],c=u.split(\"e\")[1],l=a.split(\".\")[0],h=a.split(\".\")[1]||\"\",u=l+h+p(c-h.length),0<s&&(u+=\".\"+p(s)),u):(i(t*_)/_).toFixed(e),n&&(r=new RegExp(\"0{1,\"+n+\"}$\"),o=o.replace(r,\"\")),o}function s(t,e,i){var n,r,o,s,a,l,h,c,u,_;return-1<e.indexOf(\"$\")?n=function(t,e,i){var n,r,o=e,s=o.indexOf(\"$\"),a=o.indexOf(\"(\"),l=o.indexOf(\"+\"),h=o.indexOf(\"-\"),c=\"\",u=\"\";if(-1===o.indexOf(\"$\")?\"infix\"===U[q].currency.position?(u=U[q].currency.symbol,U[q].currency.spaceSeparated&&(u=\" \"+u+\" \")):U[q].currency.spaceSeparated&&(c=\" \"):-1<o.indexOf(\" $\")?(c=\" \",o=o.replace(\" $\",\"\")):-1<o.indexOf(\"$ \")?(c=\" \",o=o.replace(\"$ \",\"\")):o=o.replace(\"$\",\"\"),r=d(t,o,i,u),-1===e.indexOf(\"$\"))switch(U[q].currency.position){case\"postfix\":-1<r.indexOf(\")\")?((r=r.split(\"\")).splice(-1,0,c+U[q].currency.symbol),r=r.join(\"\")):r=r+c+U[q].currency.symbol;break;case\"infix\":break;case\"prefix\":-1<r.indexOf(\"(\")||-1<r.indexOf(\"-\")?(r=r.split(\"\"),n=Math.max(a,h)+1,r.splice(n,0,U[q].currency.symbol+c),r=r.join(\"\")):r=U[q].currency.symbol+c+r;break;default:throw Error('Currency position should be among [\"prefix\", \"infix\", \"postfix\"]')}else s<=1?-1<r.indexOf(\"(\")||-1<r.indexOf(\"+\")||-1<r.indexOf(\"-\")?(r=r.split(\"\"),n=1,(s<a||s<l||s<h)&&(n=0),r.splice(n,0,U[q].currency.symbol+c),r=r.join(\"\")):r=U[q].currency.symbol+c+r:-1<r.indexOf(\")\")?((r=r.split(\"\")).splice(-1,0,c+U[q].currency.symbol),r=r.join(\"\")):r=r+c+U[q].currency.symbol;return r}(t,e,i):-1<e.indexOf(\"%\")?(l=t,c=i,_=\"\",l*=100,-1<(h=e).indexOf(\" %\")?(_=\" \",h=h.replace(\" %\",\"\")):h=h.replace(\"%\",\"\"),-1<(u=d(l,h,c)).indexOf(\")\")?((u=u.split(\"\")).splice(-1,0,_+\"%\"),u=u.join(\"\")):u=u+_+\"%\",n=u):-1<e.indexOf(\":\")?(r=t,o=Math.floor(r/60/60),s=Math.floor((r-60*o*60)/60),a=Math.round(r-60*o*60-60*s),n=o+\":\"+(s<10?\"0\"+s:s)+\":\"+(a<10?\"0\"+a:a)):n=d(t,e,i),n}function d(t,e,i,n){var r,o,s,a,l,h,c,u,_,p,d,f,v,m,g,y,b,x,w,k=!1,S=!1,T=!1,C=\"\",A=!1,E=!1,M=!1,O=!1,z=!1,P=\"\",j=\"\",N=Math.abs(t),F=[\"B\",\"KiB\",\"MiB\",\"GiB\",\"TiB\",\"PiB\",\"EiB\",\"ZiB\",\"YiB\"],D=[\"B\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"],I=\"\",R=!1,B=!1;if(0===t&&null!==Y)return Y;if(!isFinite(t))return\"\"+t;if(0===e.indexOf(\"{\")){var L=e.indexOf(\"}\");if(-1===L)throw Error('Format should also contain a \"}\"');f=e.slice(1,L),e=e.slice(L+1)}else f=\"\";if(e.indexOf(\"}\")===e.length-1){var V=e.indexOf(\"{\");if(-1===V)throw Error('Format should also contain a \"{\"');v=e.slice(V+1,-1),e=e.slice(0,V+1)}else v=\"\";if(w=-1===e.indexOf(\".\")?e.match(/([0-9]+).*/):e.match(/([0-9]+)\\..*/),x=null===w?-1:w[1].length,-1!==e.indexOf(\"-\")&&(R=!0),-1<e.indexOf(\"(\")?(k=!0,e=e.slice(1,-1)):-1<e.indexOf(\"+\")&&(S=!0,e=e.replace(/\\+/g,\"\")),-1<e.indexOf(\"a\")){if(p=e.split(\".\")[0].match(/[0-9]+/g)||[\"0\"],p=parseInt(p[0],10),A=0<=e.indexOf(\"aK\"),E=0<=e.indexOf(\"aM\"),M=0<=e.indexOf(\"aB\"),O=0<=e.indexOf(\"aT\"),z=A||E||M||O,-1<e.indexOf(\" a\")?(C=\" \",e=e.replace(\" a\",\"\")):e=e.replace(\"a\",\"\"),l=Math.floor(Math.log(N)/Math.LN10)+1,c=0==(c=l%3)?3:c,p&&0!==N&&(h=Math.floor(Math.log(N)/Math.LN10)+1-p,u=3*~~((Math.min(p,l)-c)/3),N/=Math.pow(10,u),-1===e.indexOf(\".\")&&3<p))for(e+=\"[.]\",y=(y=0===h?0:3*~~(h/3)-h)<0?y+3:y,r=0;r<y;r++)e+=\"0\";Math.floor(Math.log(Math.abs(t))/Math.LN10)+1!==p&&(N>=Math.pow(10,12)&&!z||O?(C+=U[q].abbreviations.trillion,t/=Math.pow(10,12)):N<Math.pow(10,12)&&N>=Math.pow(10,9)&&!z||M?(C+=U[q].abbreviations.billion,t/=Math.pow(10,9)):N<Math.pow(10,9)&&N>=Math.pow(10,6)&&!z||E?(C+=U[q].abbreviations.million,t/=Math.pow(10,6)):(N<Math.pow(10,6)&&N>=Math.pow(10,3)&&!z||A)&&(C+=U[q].abbreviations.thousand,t/=Math.pow(10,3)))}if(-1<e.indexOf(\"b\"))for(-1<e.indexOf(\" b\")?(P=\" \",e=e.replace(\" b\",\"\")):e=e.replace(\"b\",\"\"),a=0;a<=F.length;a++)if(o=Math.pow(1024,a),s=Math.pow(1024,a+1),o<=t&&t<s){P+=F[a],0<o&&(t/=o);break}if(-1<e.indexOf(\"d\"))for(-1<e.indexOf(\" d\")?(P=\" \",e=e.replace(\" d\",\"\")):e=e.replace(\"d\",\"\"),a=0;a<=D.length;a++)if(o=Math.pow(1e3,a),s=Math.pow(1e3,a+1),o<=t&&t<s){P+=D[a],0<o&&(t/=o);break}if(-1<e.indexOf(\"o\")&&(-1<e.indexOf(\" o\")?(j=\" \",e=e.replace(\" o\",\"\")):e=e.replace(\"o\",\"\"),U[q].ordinal&&(j+=U[q].ordinal(t))),-1<e.indexOf(\"[.]\")&&(T=!0,e=e.replace(\"[.]\",\".\")),_=t.toString().split(\".\")[0],d=e.split(\".\")[1],m=e.indexOf(\",\"),d){if(-1!==d.indexOf(\"*\")?I=X(t,t.toString().split(\".\")[1].length,i):-1<d.indexOf(\"[\")?(d=(d=d.replace(\"]\",\"\")).split(\"[\"),I=X(t,d[0].length+d[1].length,i,d[1].length)):I=X(t,d.length,i),_=I.split(\".\")[0],I.split(\".\")[1].length){var G=n?C+n:U[q].delimiters.decimal;I=G+I.split(\".\")[1]}else I=\"\";T&&0===Number(I.slice(1))&&(I=\"\")}else _=X(t,null,i);return-1<_.indexOf(\"-\")&&(_=_.slice(1),B=!0),_.length<x&&(_=new Array(x-_.length+1).join(\"0\")+_),-1<m&&(_=_.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g,\"$1\"+U[q].delimiters.thousands)),0===e.indexOf(\".\")&&(_=\"\"),g=e.indexOf(\"(\"),b=e.indexOf(\"-\"),f+(g<b?(k&&B?\"(\":\"\")+(R&&B||!k&&B?\"-\":\"\"):(R&&B||!k&&B?\"-\":\"\")+(k&&B?\"(\":\"\"))+(!B&&S&&0!==t?\"+\":\"\")+_+I+(j||\"\")+(C&&!n?C:\"\")+(P||\"\")+(k&&B?\")\":\"\")+v}function a(t,e){U[t]=e}function l(t){var e=U[q=t].defaults;e&&e.format&&c.defaultFormat(e.format),e&&e.currencyFormat&&c.defaultCurrencyFormat(e.currencyFormat)}void 0!==e&&e.exports,(c=function(t){return c.isNumbro(t)?t=t.value():0===t||void 0===t?t=0:Number(t)||(t=c.fn.unformat(t)),new n(Number(t))}).version=\"1.6.2\",c.isNumbro=function(t){return t instanceof n},c.setLanguage=function(t,e){console.warn(\"`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead\");var i=t,n=t.split(\"-\")[0],r=null;o[i]||(Object.keys(o).forEach(function(t){r||t.split(\"-\")[0]!==n||(r=t)}),i=r||e||\"en-US\"),l(i)},c.setCulture=function(t,e){var i=t,n=t.split(\"-\")[1],r=null;U[i]||(n&&Object.keys(U).forEach(function(t){r||t.split(\"-\")[1]!==n||(r=t)}),i=r||e||\"en-US\"),l(i)},c.language=function(t,e){if(console.warn(\"`language` is deprecated since version 1.6.0. Use `culture` instead\"),!t)return q;if(t&&!e){if(!o[t])throw new Error(\"Unknown language : \"+t);l(t)}return!e&&o[t]||a(t,e),c},c.culture=function(t,e){if(!t)return q;if(t&&!e){if(!U[t])throw new Error(\"Unknown culture : \"+t);l(t)}return!e&&U[t]||a(t,e),c},c.languageData=function(t){if(console.warn(\"`languageData` is deprecated since version 1.6.0. Use `cultureData` instead\"),!t)return o[q];if(!o[t])throw new Error(\"Unknown language : \"+t);return o[t]},c.cultureData=function(t){if(!t)return U[q];if(!U[t])throw new Error(\"Unknown culture : \"+t);return U[t]},c.culture(\"en-US\",{delimiters:{thousands:\",\",decimal:\".\"},abbreviations:{thousand:\"k\",million:\"m\",billion:\"b\",trillion:\"t\"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?\"th\":1===e?\"st\":2===e?\"nd\":3===e?\"rd\":\"th\"},currency:{symbol:\"$\",position:\"prefix\"},defaults:{currencyFormat:\",0000 a\"},formats:{fourDigits:\"0000 a\",fullWithTwoDecimals:\"$ ,0.00\",fullWithTwoDecimalsNoCurrency:\",0.00\"}}),c.languages=function(){return console.warn(\"`languages` is deprecated since version 1.6.0. Use `cultures` instead\"),o},c.cultures=function(){return U},c.zeroFormat=function(t){Y=\"string\"==typeof t?t:null},c.defaultFormat=function(t){r=\"string\"==typeof t?t:\"0.0\"},c.defaultCurrencyFormat=function(t){},c.validate=function(t,e){var i,n,r,o,s,a,l,h;if(\"string\"!=typeof t&&(t+=\"\",console.warn&&console.warn(\"Numbro.js: Value is not string. It has been co-erced to: \",t)),(t=t.trim()).match(/&#94;\\d+$/))return!0;if(\"\"===t)return!1;try{l=c.cultureData(e)}catch(t){l=c.cultureData(c.culture())}return r=l.currency.symbol,s=l.abbreviations,i=l.delimiters.decimal,n=\".\"===l.delimiters.thousands?\"\\\\.\":l.delimiters.thousands,!(null!==(h=t.match(/&#94;[&#94;\\d]+/))&&(t=t.substr(1),h[0]!==r)||null!==(h=t.match(/[&#94;\\d]+$/))&&(t=t.slice(0,-1),h[0]!==s.thousand&&h[0]!==s.million&&h[0]!==s.billion&&h[0]!==s.trillion)||(a=new RegExp(n+\"{2}\"),t.match(/[&#94;\\d.,]/g)||2<(o=t.split(i)).length||(o.length<2?!o[0].match(/&#94;\\d+.*\\d$/)||o[0].match(a):1===o[0].length?!o[0].match(/&#94;\\d+$/)||o[0].match(a)||!o[1].match(/&#94;\\d+$/):!o[0].match(/&#94;\\d+.*\\d$/)||o[0].match(a)||!o[1].match(/&#94;\\d+$/))))},e.exports={format:function(t,e,i,n){return null!=i&&i!==c.culture()&&c.setCulture(i),s(Number(t),null!=e?e:r,null==n?Math.round:n)}}},function(t,e,i){var l=t(378),h=t(376),n=t(380),c=t(375),u=t(366),_=t(371);function p(t,e){if(!(this instanceof p))return new p(t);e=e||function(t){if(t)throw t};var i=l(t);if(\"object\"==typeof i){var n=p.projections.get(i.projName);if(n){if(i.datumCode&&\"none\"!==i.datumCode){var r=u[i.datumCode];r&&(i.datum_params=r.towgs84?r.towgs84.split(\",\"):null,i.ellps=r.ellipse,i.datumName=r.datumName?r.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||\"enu\";var o=c.sphere(i.a,i.b,i.rf,i.ellps,i.sphere),s=c.eccentricity(o.a,o.b,o.rf,i.R_A),a=i.datum||_(i.datumCode,i.datum_params,o.a,o.b,s.es,s.ep2);h(this,i),h(this,n),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=a,this.init(),e(null,this)}else e(t)}else e(t)}(p.projections=n).start(),e.exports=p},function(t,e,i){e.exports=function(t,e,i){var n,r,o,s=i.x,a=i.y,l=i.z||0,h={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==i.z)switch(0===o?(n=s,r=\"x\"):1===o?(n=a,r=\"y\"):(n=l,r=\"z\"),t.axis[o]){case\"e\":h[r]=n;break;case\"w\":h[r]=-n;break;case\"n\":h[r]=n;break;case\"s\":h[r]=-n;break;case\"u\":void 0!==i[r]&&(h.z=n);break;case\"d\":void 0!==i[r]&&(h.z=-n);break;default:return null}return h}},function(t,e,i){var n=2*Math.PI,r=t(363);e.exports=function(t){return Math.abs(t)<=3.14159265359?t:t-r(t)*n}},function(t,e,i){e.exports=function(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}},function(t,e,i){var a=Math.PI/2;e.exports=function(t,e){for(var i,n,r=.5*t,o=a-2*Math.atan(e),s=0;s<=15;s++)if(i=t*Math.sin(o),n=a-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-o,o+=n,Math.abs(n)<=1e-10)return o;return-9999}},function(t,e,i){e.exports=function(t){return t<0?-1:1}},function(t,e,i){e.exports=function(t){var e={x:t[0],y:t[1]};return 2<t.length&&(e.z=t[2]),3<t.length&&(e.m=t[3]),e}},function(t,e,i){var o=Math.PI/2;e.exports=function(t,e,i){var n=t*i,r=.5*t;return n=Math.pow((1-n)/(1+n),r),Math.tan(.5*(o-e))/n}},function(t,e,i){i.wgs84={towgs84:\"0,0,0\",ellipse:\"WGS84\",datumName:\"WGS84\"},i.ch1903={towgs84:\"674.374,15.056,405.346\",ellipse:\"bessel\",datumName:\"swiss\"},i.ggrs87={towgs84:\"-199.87,74.79,246.62\",ellipse:\"GRS80\",datumName:\"Greek_Geodetic_Reference_System_1987\"},i.nad83={towgs84:\"0,0,0\",ellipse:\"GRS80\",datumName:\"North_American_Datum_1983\"},i.nad27={nadgrids:\"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat\",ellipse:\"clrk66\",datumName:\"North_American_Datum_1927\"},i.potsdam={towgs84:\"606.0,23.0,413.0\",ellipse:\"bessel\",datumName:\"Potsdam Rauenberg 1950 DHDN\"},i.carthage={towgs84:\"-263.0,6.0,431.0\",ellipse:\"clark80\",datumName:\"Carthage 1934 Tunisia\"},i.hermannskogel={towgs84:\"653.0,-212.0,449.0\",ellipse:\"bessel\",datumName:\"Hermannskogel\"},i.ire65={towgs84:\"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\",ellipse:\"mod_airy\",datumName:\"Ireland 1965\"},i.rassadiran={towgs84:\"-133.63,-157.5,-158.62\",ellipse:\"intl\",datumName:\"Rassadiran\"},i.nzgd49={towgs84:\"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993\",ellipse:\"intl\",datumName:\"New Zealand Geodetic Datum 1949\"},i.osgb36={towgs84:\"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894\",ellipse:\"airy\",datumName:\"Airy 1830\"},i.s_jtsk={towgs84:\"589,76,480\",ellipse:\"bessel\",datumName:\"S-JTSK (Ferro)\"},i.beduaram={towgs84:\"-106,-87,188\",ellipse:\"clrk80\",datumName:\"Beduaram\"},i.gunung_segara={towgs84:\"-403,684,41\",ellipse:\"bessel\",datumName:\"Gunung Segara Jakarta\"},i.rnb72={towgs84:\"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1\",ellipse:\"intl\",datumName:\"Reseau National Belge 1972\"}},function(t,e,i){i.MERIT={a:6378137,rf:298.257,ellipseName:\"MERIT 1983\"},i.SGS85={a:6378136,rf:298.257,ellipseName:\"Soviet Geodetic System 85\"},i.GRS80={a:6378137,rf:298.257222101,ellipseName:\"GRS 1980(IUGG, 1980)\"},i.IAU76={a:6378140,rf:298.257,ellipseName:\"IAU 1976\"},i.airy={a:6377563.396,b:6356256.91,ellipseName:\"Airy 1830\"},i.APL4={a:6378137,rf:298.25,ellipseName:\"Appl. Physics. 1965\"},i.NWL9D={a:6378145,rf:298.25,ellipseName:\"Naval Weapons Lab., 1965\"},i.mod_airy={a:6377340.189,b:6356034.446,ellipseName:\"Modified Airy\"},i.andrae={a:6377104.43,rf:300,ellipseName:\"Andrae 1876 (Den., Iclnd.)\"},i.aust_SA={a:6378160,rf:298.25,ellipseName:\"Australian Natl & S. Amer. 1969\"},i.GRS67={a:6378160,rf:298.247167427,ellipseName:\"GRS 67(IUGG 1967)\"},i.bessel={a:6377397.155,rf:299.1528128,ellipseName:\"Bessel 1841\"},i.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:\"Bessel 1841 (Namibia)\"},i.clrk66={a:6378206.4,b:6356583.8,ellipseName:\"Clarke 1866\"},i.clrk80={a:6378249.145,rf:293.4663,ellipseName:\"Clarke 1880 mod.\"},i.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:\"Clarke 1858\"},i.CPM={a:6375738.7,rf:334.29,ellipseName:\"Comm. des Poids et Mesures 1799\"},i.delmbr={a:6376428,rf:311.5,ellipseName:\"Delambre 1810 (Belgium)\"},i.engelis={a:6378136.05,rf:298.2566,ellipseName:\"Engelis 1985\"},i.evrst30={a:6377276.345,rf:300.8017,ellipseName:\"Everest 1830\"},i.evrst48={a:6377304.063,rf:300.8017,ellipseName:\"Everest 1948\"},i.evrst56={a:6377301.243,rf:300.8017,ellipseName:\"Everest 1956\"},i.evrst69={a:6377295.664,rf:300.8017,ellipseName:\"Everest 1969\"},i.evrstSS={a:6377298.556,rf:300.8017,ellipseName:\"Everest (Sabah & Sarawak)\"},i.fschr60={a:6378166,rf:298.3,ellipseName:\"Fischer (Mercury Datum) 1960\"},i.fschr60m={a:6378155,rf:298.3,ellipseName:\"Fischer 1960\"},i.fschr68={a:6378150,rf:298.3,ellipseName:\"Fischer 1968\"},i.helmert={a:6378200,rf:298.3,ellipseName:\"Helmert 1906\"},i.hough={a:6378270,rf:297,ellipseName:\"Hough\"},i.intl={a:6378388,rf:297,ellipseName:\"International 1909 (Hayford)\"},i.kaula={a:6378163,rf:298.24,ellipseName:\"Kaula 1961\"},i.lerch={a:6378139,rf:298.257,ellipseName:\"Lerch 1979\"},i.mprts={a:6397300,rf:191,ellipseName:\"Maupertius 1738\"},i.new_intl={a:6378157.5,b:6356772.2,ellipseName:\"New International 1967\"},i.plessis={a:6376523,rf:6355863,ellipseName:\"Plessis 1817 (France)\"},i.krass={a:6378245,rf:298.3,ellipseName:\"Krassovsky, 1942\"},i.SEasia={a:6378155,b:6356773.3205,ellipseName:\"Southeast Asia\"},i.walbeck={a:6376896,b:6355834.8467,ellipseName:\"Walbeck\"},i.WGS60={a:6378165,rf:298.3,ellipseName:\"WGS 60\"},i.WGS66={a:6378145,rf:298.25,ellipseName:\"WGS 66\"},i.WGS7={a:6378135,rf:298.26,ellipseName:\"WGS 72\"},i.WGS84={a:6378137,rf:298.257223563,ellipseName:\"WGS 84\"},i.sphere={a:6370997,b:6370997,ellipseName:\"Normal Sphere (r=6370997)\"}},function(t,e,i){i.greenwich=0,i.lisbon=-9.131906111111,i.paris=2.337229166667,i.bogota=-74.080916666667,i.madrid=-3.687938888889,i.rome=12.452333333333,i.bern=7.439583333333,i.jakarta=106.807719444444,i.ferro=-17.666666666667,i.brussels=4.367975,i.stockholm=18.058277777778,i.athens=23.7163375,i.oslo=10.722916666667},function(t,e,i){i.ft={to_meter:.3048},i[\"us-ft\"]={to_meter:1200/3937}},function(t,e,i){var n=t(358),r=t(383),o=n(\"WGS84\");function s(t,e,i){var n;return Array.isArray(i)?(n=r(t,e,i),3===i.length?[n.x,n.y,n.z]:[n.x,n.y]):r(t,e,i)}function a(t){return t instanceof n?t:t.oProj?t.oProj:n(t)}e.exports=function(e,i,t){e=a(e);var n,r=!1;return void 0===i?(i=e,e=o,r=!0):(void 0!==i.x||Array.isArray(i))&&(t=i,i=e,e=o,r=!0),i=a(i),t?s(e,i,t):(n={forward:function(t){return s(e,i,t)},inverse:function(t){return s(i,e,t)}},r&&(n.oProj=i),n)}},function(t,e,i){var a=484813681109536e-20;e.exports=function(t,e,i,n,r,o){var s={datum_type:4};return t&&\"none\"===t&&(s.datum_type=5),e&&(s.datum_params=e.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=1),3<s.datum_params.length&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=2,s.datum_params[3]*=a,s.datum_params[4]*=a,s.datum_params[5]*=a,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=i,s.b=n,s.es=r,s.ep2=o,s}},function(t,e,i){var k=Math.PI/2;i.compareDatums=function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||5e-11<Math.abs(this.es-e.es))&&(1===t.datum_type?this.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])},i.geodeticToGeocentric=function(t,e,i){var n,r,o,s,a=t.x,l=t.y,h=t.z?t.z:0;if(l<-k&&-1.001*k<l)l=-k;else if(k<l&&l<1.001*k)l=k;else if(l<-k||k<l)return null;return a>Math.PI&&(a-=2*Math.PI),r=Math.sin(l),s=Math.cos(l),o=r*r,{x:((n=i/Math.sqrt(1-e*o))+h)*s*Math.cos(a),y:(n+h)*s*Math.sin(a),z:(n*(1-e)+h)*r}},i.geocentricToGeodetic=function(t,e,i,n){var r,o,s,a,l,h,c,u,_,p,d,f,v,m,g,y,b=t.x,x=t.y,w=t.z?t.z:0;if(r=Math.sqrt(b*b+x*x),o=Math.sqrt(b*b+x*x+w*w),r/i<1e-12){if(m=0,o/i<1e-12)return g=k,y=-n,{x:t.x,y:t.y,z:t.z}}else m=Math.atan2(x,b);for(s=w/o,a=r/o,l=1/Math.sqrt(1-e*(2-e)*a*a),u=a*(1-e)*l,_=s*l,v=0;v++,c=i/Math.sqrt(1-e*_*_),h=e*c/(c+(y=r*u+w*_-c*(1-e*_*_))),l=1/Math.sqrt(1-h*(2-h)*a*a),f=(d=s*l)*u-(p=a*(1-h)*l)*_,u=p,_=d,1e-24<f*f&&v<30;);return g=Math.atan(d/Math.abs(p)),{x:m,y:g,z:y}},i.geocentricToWgs84=function(t,e,i){if(1===e)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(2===e){var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],h=i[6];return{x:h*(t.x-l*t.y+a*t.z)+n,y:h*(l*t.x+t.y-s*t.z)+r,z:h*(-a*t.x+s*t.y+t.z)+o}}},i.geocentricFromWgs84=function(t,e,i){if(1===e)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(2===e){var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],h=i[6],c=(t.x-n)/h,u=(t.y-r)/h,_=(t.z-o)/h;return{x:c+l*u-a*_,y:-l*c+u+s*_,z:a*c-s*u+_}}}},function(t,e,i){var n=t(372);function r(t){return 1===t||2===t}e.exports=function(t,e,i){return n.compareDatums(t,e)?i:5===t.datum_type||5===e.datum_type?i:t.es!==e.es||t.a!==e.a||r(t.datum_type)||r(e.datum_type)?(i=n.geodeticToGeocentric(i,t.es,t.a),r(t.datum_type)&&(i=n.geocentricToWgs84(i,t.datum_type,t.datum_params)),r(e.datum_type)&&(i=n.geocentricFromWgs84(i,e.datum_type,e.datum_params)),n.geocentricToGeodetic(i,e.es,e.a,e.b)):i}},function(t,e,i){var n=t(377),r=t(379),o=t(384);function s(t){var e=this;if(2===arguments.length){var i=arguments[1];s[t]=\"string\"==typeof i?\"+\"===i.charAt(0)?r(arguments[1]):o(arguments[1]):i}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?s.apply(e,t):s(t)});if(\"string\"==typeof t){if(t in s)return s[t]}else\"EPSG\"in t?s[\"EPSG:\"+t.EPSG]=t:\"ESRI\"in t?s[\"ESRI:\"+t.ESRI]=t:\"IAU2000\"in t?s[\"IAU2000:\"+t.IAU2000]=t:console.log(t);return}}n(s),e.exports=s},function(t,e,i){var s=t(367);i.eccentricity=function(t,e,i,n){var r=t*t,o=e*e,s=(r-o)/r,a=0;n?(r=(t*=1-s*(.16666666666666666+s*(.04722222222222222+.022156084656084655*s)))*t,s=0):a=Math.sqrt(s);var l=(r-o)/o;return{es:s,e:a,ep2:l}},i.sphere=function(t,e,i,n,r){if(!t){var o=s[n];o||(o=s.WGS84),t=o.a,e=o.b,i=o.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<1e-10)&&(r=!0,e=t),{a:t,b:e,rf:i,sphere:r}}},function(t,e,i){e.exports=function(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}},function(t,e,i){e.exports=function(t){t(\"EPSG:4326\",\"+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees\"),t(\"EPSG:4269\",\"+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees\"),t(\"EPSG:3857\",\"+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs\"),t.WGS84=t[\"EPSG:4326\"],t[\"EPSG:3785\"]=t[\"EPSG:3857\"],t.GOOGLE=t[\"EPSG:3857\"],t[\"EPSG:900913\"]=t[\"EPSG:3857\"],t[\"EPSG:102113\"]=t[\"EPSG:3857\"]}},function(t,e,i){var n=t(374),r=t(384),o=t(379),s=[\"GEOGCS\",\"GEOCCS\",\"PROJCS\",\"LOCAL_CS\"];e.exports=function(t){return\"string\"!=typeof t?t:t in n?n[t]:(e=t,s.some(function(t){return-1<e.indexOf(t)})?r(t):\"+\"===t[0]?o(t):void 0);var e}},function(t,e,i){var a=.017453292519943295,l=t(368),h=t(369);e.exports=function(t){var e,i,n,r={},o=t.split(\"+\").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var i=e.split(\"=\");return i.push(!0),t[i[0].toLowerCase()]=i[1],t},{}),s={proj:\"projName\",datum:\"datumCode\",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*a},lat_1:function(t){r.lat1=t*a},lat_2:function(t){r.lat2=t*a},lat_ts:function(t){r.lat_ts=t*a},lon_0:function(t){r.long0=t*a},lon_1:function(t){r.long1=t*a},lon_2:function(t){r.long2=t*a},alpha:function(t){r.alpha=parseFloat(t)*a},lonc:function(t){r.longc=t*a},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(\",\").map(function(t){return parseFloat(t)})},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t,h[t]&&(r.to_meter=h[t].to_meter)},from_greenwich:function(t){r.from_greenwich=t*a},pm:function(t){r.from_greenwich=(l[t]?l[t]:parseFloat(t))*a},nadgrids:function(t){\"@null\"===t?r.datumCode=\"none\":r.nadgrids=t},axis:function(t){var e=\"ewnsud\";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)}};for(e in o)i=o[e],e in s?\"function\"==typeof(n=s[e])?n(i):r[n]=i:r[e]=i;return\"string\"==typeof r.datumCode&&\"WGS84\"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}},function(t,e,i){var n=[t(382),t(381)],r={},o=[];function s(t,e){var i=o.length;return t.names?((o[i]=t).names.forEach(function(t){r[t.toLowerCase()]=i}),this):(console.log(e),!0)}i.add=s,i.get=function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==r[e]&&o[r[e]]?o[r[e]]:void 0},i.start=function(){n.forEach(s)}},function(t,e,i){function n(t){return t}i.init=function(){},i.forward=n,i.inverse=n,i.names=[\"longlat\",\"identity\"]},function(t,e,i){var n=t(361),a=Math.PI/2,l=57.29577951308232,h=t(360),c=Math.PI/4,u=t(365),s=t(362);i.init=function(){var t=this.b/this.a;this.es=1-t*t,\"x0\"in this||(this.x0=0),\"y0\"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=n(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},i.forward=function(t){var e,i,n=t.x,r=t.y;if(90<r*l&&r*l<-90&&180<n*l&&n*l<-180)return null;if(Math.abs(Math.abs(r)-a)<=1e-10)return null;if(this.sphere)e=this.x0+this.a*this.k0*h(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(c+.5*r));else{var o=Math.sin(r),s=u(this.e,r,o);e=this.x0+this.a*this.k0*h(n-this.long0),i=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=i,t},i.inverse=function(t){var e,i,n=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=a-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(-9999===(i=s(this.e,o)))return null}return e=h(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},i.names=[\"Mercator\",\"Popular Visualisation Pseudo Mercator\",\"Mercator_1SP\",\"Mercator_Auxiliary_Sphere\",\"merc\"]},function(t,e,i){var a=.017453292519943295,l=57.29577951308232,h=t(373),c=t(359),u=t(358),_=t(364);e.exports=function t(e,i,n){var r,o,s;return Array.isArray(n)&&(n=_(n)),e.datum&&i.datum&&(s=i,(1===(o=e).datum.datum_type||2===o.datum.datum_type)&&\"WGS84\"!==s.datumCode||(1===s.datum.datum_type||2===s.datum.datum_type)&&\"WGS84\"!==o.datumCode)&&(r=new u(\"WGS84\"),n=t(e,r,n),e=r),\"enu\"!==e.axis&&(n=c(e,!1,n)),\"longlat\"===e.projName?n={x:n.x*a,y:n.y*a}:(e.to_meter&&(n={x:n.x*e.to_meter,y:n.y*e.to_meter}),n=e.inverse(n)),e.from_greenwich&&(n.x+=e.from_greenwich),n=h(e.datum,i.datum,n),i.from_greenwich&&(n={x:n.x-i.grom_greenwich,y:n.y}),\"longlat\"===i.projName?n={x:n.x*l,y:n.y*l}:(n=i.forward(n),i.to_meter&&(n={x:n.x/i.to_meter,y:n.y/i.to_meter})),\"enu\"!==i.axis?c(i,!0,n):n}},function(t,e,i){var n=.017453292519943295,s=t(376);function r(t,e,i){t[e]=i.map(function(t){var e={};return a(t,e),e}).reduce(function(t,e){return s(t,e)},{})}function a(t,e){var i;Array.isArray(t)?(\"PARAMETER\"===(i=t.shift())&&(i=t.shift()),1===t.length?Array.isArray(t[0])?(e[i]={},a(t[0],e[i])):e[i]=t[0]:t.length?\"TOWGS84\"===i?e[i]=t:(e[i]={},-1<[\"UNIT\",\"PRIMEM\",\"VERT_DATUM\"].indexOf(i)?(e[i]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(e[i].auth=t[2])):\"SPHEROID\"===i?(e[i]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(e[i].auth=t[3])):-1<[\"GEOGCS\",\"GEOCCS\",\"DATUM\",\"VERT_CS\",\"COMPD_CS\",\"LOCAL_CS\",\"FITTED_CS\",\"LOCAL_DATUM\"].indexOf(i)?(t[0]=[\"name\",t[0]],r(e,i,t)):t.every(function(t){return Array.isArray(t)})?r(e,i,t):a(t,e[i])):e[i]=!0):e[t]=!0}function l(t){return t*n}e.exports=function(t,e){var i=JSON.parse((\",\"+t).replace(/\\s*\\,\\s*([A-Z_0-9]+?)(\\[)/g,',[\"$1\",').slice(1).replace(/\\s*\\,\\s*([A-Z_0-9]+?)\\]/g,',\"$1\"]').replace(/,\\[\"VERTCS\".+/,\"\")),n=i.shift(),r=i.shift();i.unshift([\"name\",r]),i.unshift([\"type\",n]),i.unshift(\"output\");var o={};return a(i,o),function(o){function t(t){var e=o.to_meter||1;return parseFloat(t,10)*e}\"GEOGCS\"===o.type?o.projName=\"longlat\":\"LOCAL_CS\"===o.type?(o.projName=\"identity\",o.local=!0):\"object\"==typeof o.PROJECTION?o.projName=Object.keys(o.PROJECTION)[0]:o.projName=o.PROJECTION,o.UNIT&&(o.units=o.UNIT.name.toLowerCase(),\"metre\"===o.units&&(o.units=\"meter\"),o.UNIT.convert&&(\"GEOGCS\"===o.type?o.DATUM&&o.DATUM.SPHEROID&&(o.to_meter=parseFloat(o.UNIT.convert,10)*o.DATUM.SPHEROID.a):o.to_meter=parseFloat(o.UNIT.convert,10))),o.GEOGCS&&(o.GEOGCS.DATUM?o.datumCode=o.GEOGCS.DATUM.name.toLowerCase():o.datumCode=o.GEOGCS.name.toLowerCase(),\"d_\"===o.datumCode.slice(0,2)&&(o.datumCode=o.datumCode.slice(2)),\"new_zealand_geodetic_datum_1949\"!==o.datumCode&&\"new_zealand_1949\"!==o.datumCode||(o.datumCode=\"nzgd49\"),\"wgs_1984\"===o.datumCode&&(\"Mercator_Auxiliary_Sphere\"===o.PROJECTION&&(o.sphere=!0),o.datumCode=\"wgs84\"),\"_ferro\"===o.datumCode.slice(-6)&&(o.datumCode=o.datumCode.slice(0,-6)),\"_jakarta\"===o.datumCode.slice(-8)&&(o.datumCode=o.datumCode.slice(0,-8)),~o.datumCode.indexOf(\"belge\")&&(o.datumCode=\"rnb72\"),o.GEOGCS.DATUM&&o.GEOGCS.DATUM.SPHEROID&&(o.ellps=o.GEOGCS.DATUM.SPHEROID.name.replace(\"_19\",\"\").replace(/[Cc]larke\\_18/,\"clrk\"),\"international\"===o.ellps.toLowerCase().slice(0,13)&&(o.ellps=\"intl\"),o.a=o.GEOGCS.DATUM.SPHEROID.a,o.rf=parseFloat(o.GEOGCS.DATUM.SPHEROID.rf,10)),~o.datumCode.indexOf(\"osgb_1936\")&&(o.datumCode=\"osgb36\")),o.b&&!isFinite(o.b)&&(o.b=o.a),[[\"standard_parallel_1\",\"Standard_Parallel_1\"],[\"standard_parallel_2\",\"Standard_Parallel_2\"],[\"false_easting\",\"False_Easting\"],[\"false_northing\",\"False_Northing\"],[\"central_meridian\",\"Central_Meridian\"],[\"latitude_of_origin\",\"Latitude_Of_Origin\"],[\"latitude_of_origin\",\"Central_Parallel\"],[\"scale_factor\",\"Scale_Factor\"],[\"k0\",\"scale_factor\"],[\"latitude_of_center\",\"Latitude_of_center\"],[\"lat0\",\"latitude_of_center\",l],[\"longitude_of_center\",\"Longitude_Of_Center\"],[\"longc\",\"longitude_of_center\",l],[\"x0\",\"false_easting\",t],[\"y0\",\"false_northing\",t],[\"long0\",\"central_meridian\",l],[\"lat0\",\"latitude_of_origin\",l],[\"lat0\",\"standard_parallel_1\",l],[\"lat1\",\"standard_parallel_1\",l],[\"lat2\",\"standard_parallel_2\",l],[\"alpha\",\"azimuth\",l],[\"srsCode\",\"name\"]].forEach(function(t){return e=o,n=(i=t)[0],r=i[1],void(!(n in e)&&r in e&&(e[n]=e[r],3===i.length&&(e[n]=i[2](e[n]))));var e,i,n,r}),o.long0||!o.longc||\"Albers_Conic_Equal_Area\"!==o.projName&&\"Lambert_Azimuthal_Equal_Area\"!==o.projName||(o.long0=o.longc),o.lat_ts||!o.lat1||\"Stereographic_South_Pole\"!==o.projName&&\"Polar Stereographic (variant B)\"!==o.projName||(o.lat0=l(0<o.lat1?90:-90),o.lat_ts=o.lat1)}(o.output),s(e,o.output)}},function(t,e,i){!function(){\"use strict\";var d={not_string:/[&#94;s]/,not_bool:/[&#94;t]/,not_type:/[&#94;T]/,not_primitive:/[&#94;v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[&#94;j]/,text:/&#94;[&#94;\\x25]+/,modulo:/&#94;\\x25{2}/,placeholder:/&#94;\\x25(?:([1-9]\\d*)\\$|\\(([&#94;\\)]+)\\))?(\\+)?(0|'[&#94;$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,key:/&#94;([a-z_][a-z_\\d]*)/i,key_access:/&#94;\\.([a-z_][a-z_\\d]*)/i,index_access:/&#94;\\[(\\d+)\\]/,sign:/&#94;[\\+\\-]/};function f(t){return function(t,e){var i,n,r,o,s,a,l,h,c,u=1,_=t.length,p=\"\";for(n=0;n<_;n++)if(\"string\"==typeof t[n])p+=t[n];else if(Array.isArray(t[n])){if((o=t[n])[2])for(i=e[u],r=0;r<o[2].length;r++){if(!i.hasOwnProperty(o[2][r]))throw new Error(f('[sprintf] property \"%s\" does not exist',o[2][r]));i=i[o[2][r]]}else i=o[1]?e[o[1]]:e[u++];if(d.not_type.test(o[8])&&d.not_primitive.test(o[8])&&i instanceof Function&&(i=i()),d.numeric_arg.test(o[8])&&\"number\"!=typeof i&&isNaN(i))throw new TypeError(f(\"[sprintf] expecting number but found %T\",i));switch(d.number.test(o[8])&&(h=0<=i),o[8]){case\"b\":i=parseInt(i,10).toString(2);break;case\"c\":i=String.fromCharCode(parseInt(i,10));break;case\"d\":case\"i\":i=parseInt(i,10);break;case\"j\":i=JSON.stringify(i,null,o[6]?parseInt(o[6]):0);break;case\"e\":i=o[7]?parseFloat(i).toExponential(o[7]):parseFloat(i).toExponential();break;case\"f\":i=o[7]?parseFloat(i).toFixed(o[7]):parseFloat(i);break;case\"g\":i=o[7]?String(Number(i.toPrecision(o[7]))):parseFloat(i);break;case\"o\":i=(parseInt(i,10)>>>0).toString(8);break;case\"s\":i=String(i),i=o[7]?i.substring(0,o[7]):i;break;case\"t\":i=String(!!i),i=o[7]?i.substring(0,o[7]):i;break;case\"T\":i=Object.prototype.toString.call(i).slice(8,-1).toLowerCase(),i=o[7]?i.substring(0,o[7]):i;break;case\"u\":i=parseInt(i,10)>>>0;break;case\"v\":i=i.valueOf(),i=o[7]?i.substring(0,o[7]):i;break;case\"x\":i=(parseInt(i,10)>>>0).toString(16);break;case\"X\":i=(parseInt(i,10)>>>0).toString(16).toUpperCase()}d.json.test(o[8])?p+=i:(!d.number.test(o[8])||h&&!o[3]?c=\"\":(c=h?\"+\":\"-\",i=i.toString().replace(d.sign,\"\")),a=o[4]?\"0\"===o[4]?\"0\":o[4].charAt(1):\" \",l=o[6]-(c+i).length,s=o[6]&&0<l?a.repeat(l):\"\",p+=o[5]?c+i+s:\"0\"===a?c+s+i:s+c+i)}return p}(function(t){if(l[t])return l[t];for(var e,i=t,n=[],r=0;i;){if(null!==(e=d.text.exec(i)))n.push(e[0]);else if(null!==(e=d.modulo.exec(i)))n.push(\"%\");else{if(null===(e=d.placeholder.exec(i)))throw new SyntaxError(\"[sprintf] unexpected placeholder\");if(e[2]){r|=1;var o=[],s=e[2],a=[];if(null===(a=d.key.exec(s)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");for(o.push(a[1]);\"\"!==(s=s.substring(a[0].length));)if(null!==(a=d.key_access.exec(s)))o.push(a[1]);else{if(null===(a=d.index_access.exec(s)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");o.push(a[1])}e[2]=o}else r|=2;if(3===r)throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");n.push(e)}i=i.substring(e[0].length)}return l[t]=n}(t),arguments)}function t(t,e){return f.apply(null,[t].concat(e||[]))}var l=Object.create(null);void 0!==i&&(i.sprintf=f,i.vsprintf=t),\"undefined\"!=typeof window&&(window.sprintf=f,window.vsprintf=t)}()},function(t,e,i){!function(t){\"object\"==typeof e&&e.exports?e.exports=t():this.tz=t()}(function(){function d(t,e,i){for(var n,r=e.day[1];n=new Date(Date.UTC(i,e.month,Math.abs(r++))),e.day[0]<7&&n.getUTCDay()!=e.day[0];);return(n={clock:e.clock,sort:n.getTime(),rule:e,save:6e4*e.save,offset:t.offset})[n.clock]=n.sort+6e4*e.time,n.posix?n.wallclock=n[n.clock]+(t.offset+e.saved):n.posix=n[n.clock]-(t.offset+e.saved),n}function r(t,e,i){var n,r,o,s,a,l,h,c=t[t.zone],u=[],_=new Date(i).getUTCFullYear(),p=1;for(n=1,r=c.length;n<r&&!(c[n][e]<=i);n++);if((o=c[n]).rules){for(l=t[o.rules],h=_+1;_-p<=h;--h)for(n=0,r=l.length;n<r;n++)l[n].from<=h&&h<=l[n].to?u.push(d(o,l[n],h)):l[n].to<h&&1==p&&(p=h-l[n].to);for(u.sort(function(t,e){return t.sort-e.sort}),n=0,r=u.length;n<r;n++)i>=u[n][e]&&u[n][u[n].clock]>o[u[n].clock]&&(s=u[n])}return s&&((a=/&#94;(.*)\\/(.*)$/.exec(o.format))?s.abbrev=a[s.save?2:1]:s.abbrev=o.format.replace(/%s/,s.rule.letter)),s||o}function a(t,e){return\"UTC\"==t.zone?e:(t.entry=r(t,\"posix\",e),e+t.entry.offset+t.entry.save)}function u(t,e){return\"UTC\"==t.zone?e:(t.entry=i=r(t,\"wallclock\",e),0<(n=e-i.wallclock)&&n<i.save?null:e-i.offset-i.save);var i,n}function o(t,e,i){var n,r=+(i[1]+1),o=i[2]*r,s=l.indexOf(i[3].toLowerCase());if(9<s)e+=o*h[s-10];else{if(n=new Date(a(t,e)),s<7)for(;o;)n.setUTCDate(n.getUTCDate()+r),n.getUTCDay()==s&&(o-=r);else 7==s?n.setUTCFullYear(n.getUTCFullYear()+o):8==s?n.setUTCMonth(n.getUTCMonth()+o):n.setUTCDate(n.getUTCDate()+o);null==(e=u(t,n.getTime()))&&(e=u(t,n.getTime()+864e5*r)-864e5*r)}return e}var e={clock:function(){return+new Date},zone:\"UTC\",entry:{abbrev:\"UTC\",offset:0,save:0},UTC:1,z:function(t,e,i,n){var r,o,s=this.entry.offset+this.entry.save,a=Math.abs(s/1e3),l=[],h=3600;for(r=0;r<3;r++)l.push((\"0\"+Math.floor(a/h)).slice(-2)),a%=h,h/=60;return\"&#94;\"!=i||s?(\"&#94;\"==i&&(n=3),3==n?(o=(o=l.join(\":\")).replace(/:00$/,\"\"),\"&#94;\"!=i&&(o=o.replace(/:00$/,\"\"))):n?(o=l.slice(0,n+1).join(\":\"),\"&#94;\"==i&&(o=o.replace(/:00$/,\"\"))):o=l.slice(0,2).join(\"\"),o=(o=(s<0?\"-\":\"+\")+o).replace(/([-+])(0)/,{_:\" $1\",\"-\":\"$1\"}[i]||\"$1$2\")):\"Z\"},\"%\":function(t){return\"%\"},n:function(t){return\"\\n\"},t:function(t){return\"\\t\"},U:function(t){return c(t,0)},W:function(t){return c(t,1)},V:function(t){return i(t)[0]},G:function(t){return i(t)[1]},g:function(t){return i(t)[1]%100},j:function(t){return Math.floor((t.getTime()-Date.UTC(t.getUTCFullYear(),0))/864e5)+1},s:function(t){return Math.floor(t.getTime()/1e3)},C:function(t){return Math.floor(t.getUTCFullYear()/100)},N:function(t){return t.getTime()%1e3*1e6},m:function(t){return t.getUTCMonth()+1},Y:function(t){return t.getUTCFullYear()},y:function(t){return t.getUTCFullYear()%100},H:function(t){return t.getUTCHours()},M:function(t){return t.getUTCMinutes()},S:function(t){return t.getUTCSeconds()},e:function(t){return t.getUTCDate()},d:function(t){return t.getUTCDate()},u:function(t){return t.getUTCDay()||7},w:function(t){return t.getUTCDay()},l:function(t){return t.getUTCHours()%12||12},I:function(t){return t.getUTCHours()%12||12},k:function(t){return t.getUTCHours()},Z:function(t){return this.entry.abbrev},a:function(t){return this[this.locale].day.abbrev[t.getUTCDay()]},A:function(t){return this[this.locale].day.full[t.getUTCDay()]},h:function(t){return this[this.locale].month.abbrev[t.getUTCMonth()]},b:function(t){return this[this.locale].month.abbrev[t.getUTCMonth()]},B:function(t){return this[this.locale].month.full[t.getUTCMonth()]},P:function(t){return this[this.locale].meridiem[Math.floor(t.getUTCHours()/12)].toLowerCase()},p:function(t){return this[this.locale].meridiem[Math.floor(t.getUTCHours()/12)]},R:function(t,e){return this.convert([e,\"%H:%M\"])},T:function(t,e){return this.convert([e,\"%H:%M:%S\"])},D:function(t,e){return this.convert([e,\"%m/%d/%y\"])},F:function(t,e){return this.convert([e,\"%Y-%m-%d\"])},x:function(t,e){return this.convert([e,this[this.locale].date])},r:function(t,e){return this.convert([e,this[this.locale].time12||\"%I:%M:%S\"])},X:function(t,e){return this.convert([e,this[this.locale].time24])},c:function(t,e){return this.convert([e,this[this.locale].dateTime])},convert:function(t){if(!t.length)return\"1.0.13\";var e,i,l,n,h,c=Object.create(this),r=[];for(e=0;e<t.length;e++)if(n=t[e],Array.isArray(n))e||isNaN(n[1])?n.splice.apply(t,[e--,1].concat(n)):h=n;else if(isNaN(n)){if(\"string\"==(l=typeof n))~n.indexOf(\"%\")?c.format=n:e||\"*\"!=n?!e&&(l=/&#94;(\\d{4})-(\\d{2})-(\\d{2})(?:[T\\s](\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d+))?)?(Z|(([+-])(\\d{2}(:\\d{2}){0,2})))?)?$/.exec(n))?((h=[]).push.apply(h,l.slice(1,8)),l[9]?(h.push(l[10]+1),h.push.apply(h,l[11].split(/:/))):l[8]&&h.push(1)):/&#94;\\w{2,3}_\\w{2}$/.test(n)?c.locale=n:(l=s.exec(n))?r.push(l):c.zone=n:h=n;else if(\"function\"==l){if(l=n.call(c))return l}else if(/&#94;\\w{2,3}_\\w{2}$/.test(n.name))c[n.name]=n;else if(n.zones){for(l in n.zones)c[l]=n.zones[l];for(l in n.rules)c[l]=n.rules[l]}}else e||(h=n);if(c[c.locale]||delete c.locale,c[c.zone]||delete c.zone,null!=h){if(\"*\"==h)h=c.clock();else if(Array.isArray(h)){for(l=[],i=!h[7],e=0;e<11;e++)l[e]=+(h[e]||0);--l[1],h=Date.UTC.apply(Date.UTC,l)+-l[7]*(36e5*l[8]+6e4*l[9]+1e3*l[10])}else h=Math.floor(h);if(!isNaN(h)){if(i&&(h=u(c,h)),null==h)return h;for(e=0,i=r.length;e<i;e++)h=o(c,h,r[e]);return c.format?(l=new Date(a(c,h)),c.format.replace(/%([-0_&#94;]?)(:{0,3})(\\d*)(.)/g,function(t,e,i,n,r){var o,s,a=\"0\";if(o=c[r]){for(t=String(o.call(c,l,h,e,i.length)),\"_\"==(e||o.style)&&(a=\" \"),s=\"-\"==e?0:o.pad||0;t.length<s;)t=a+t;for(s=\"-\"==e?0:n||o.pad;t.length<s;)t=a+t;\"N\"==r&&s<t.length&&(t=t.slice(0,s)),\"&#94;\"==e&&(t=t.toUpperCase())}return t})):h}}return function(){return c.convert(arguments)}},locale:\"en_US\",en_US:{date:\"%m/%d/%Y\",time24:\"%I:%M:%S %p\",time12:\"%I:%M:%S %p\",dateTime:\"%a %d %b %Y %I:%M:%S %p %Z\",meridiem:[\"AM\",\"PM\"],month:{abbrev:\"Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec\".split(\"|\"),full:\"January|February|March|April|May|June|July|August|September|October|November|December\".split(\"|\")},day:{abbrev:\"Sun|Mon|Tue|Wed|Thu|Fri|Sat\".split(\"|\"),full:\"Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday\".split(\"|\")}}},l=\"Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|year|month|day|hour|minute|second|millisecond\",s=new RegExp(\"&#94;\\\\s*([+-])(\\\\d+)\\\\s+(\"+l+\")s?\\\\s*$\",\"i\"),h=[36e5,6e4,1e3,1];function c(t,e){var i,n,r;return n=new Date(Date.UTC(t.getUTCFullYear(),0)),i=Math.floor((t.getTime()-n.getTime())/864e5),n.getUTCDay()==e?r=0:8==(r=7-n.getUTCDay()+e)&&(r=1),r<=i?Math.floor((i-r)/7)+1:0}function i(t){var e,i,n;return i=t.getUTCFullYear(),e=new Date(Date.UTC(i,0)).getUTCDay(),(n=c(t,1)+(1<e&&e<=4?1:0))?53!=n||4==e||3==e&&29==new Date(i,1,29).getDate()?[n,t.getUTCFullYear()]:[1,t.getUTCFullYear()+1]:(i=t.getUTCFullYear()-1,e=new Date(Date.UTC(i,0)).getUTCDay(),[n=4==e||3==e&&29==new Date(i,1,29).getDate()?53:52,t.getUTCFullYear()-1])}return l=l.toLowerCase().split(\"|\"),\"delmHMSUWVgCIky\".replace(/./g,function(t){e[t].pad=2}),e.N.pad=9,e.j.pad=3,e.k.style=\"_\",e.l.style=\"_\",e.e.style=\"_\",function(){return e.convert(arguments)}})},function(t,n,e){ /*! ***************************************************************************** Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABLITY OR NON-INFRINGEMENT. See the Apache Version 2.0 License for specific language governing permissions and limitations under the License. ***************************************************************************** */ var i,r,o,s,a,l,h,c,u,_,p,d,f,v,m,g,y,b,x;!function(t){var e=\"object\"==typeof global?global:\"object\"==typeof self?self:\"object\"==typeof this?this:{};function i(i,n){return i!==e&&(\"function\"==typeof Object.create?Object.defineProperty(i,\"__esModule\",{value:!0}):i.__esModule=!0),function(t,e){return i[t]=n?n(t,e):e}}\"object\"==typeof n&&\"object\"==typeof n.exports?t(i(e,i(n.exports))):t(i(e))}(function(t){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};i=function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&\"function\"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&(i[n[r]]=t[n[r]]);return i},s=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;0<=a;a--)(r=t[a])&&(s=(o<3?r(s):3<o?r(e,i,s):r(e,i))||s);return 3<o&&s&&Object.defineProperty(e,i,s),s},a=function(i,n){return function(t,e){n(t,e,i)}},l=function(t,e){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},c=function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},\"function\"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},u=function(t,e){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])},_=function(t){var e=\"function\"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}},p=function(t,e){var i=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s},d=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t},f=function(t){return this instanceof f?(this.v=t,this):new f(t)},v=function(t,e,i){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var r,o=i.apply(t,e||[]),s=[];return r={},n(\"next\"),n(\"throw\"),n(\"return\"),r[Symbol.asyncIterator]=function(){return this},r;function n(n){o[n]&&(r[n]=function(i){return new Promise(function(t,e){1<s.push([n,i,t,e])||a(n,i)})})}function a(t,e){try{(i=o[t](e)).value instanceof f?Promise.resolve(i.value.v).then(l,h):c(s[0][2],i)}catch(t){c(s[0][3],t)}var i}function l(t){a(\"next\",t)}function h(t){a(\"throw\",t)}function c(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}},m=function(n){var t,r;return t={},e(\"next\"),e(\"throw\",function(t){throw t}),e(\"return\"),t[Symbol.iterator]=function(){return this},t;function e(e,i){t[e]=n[e]?function(t){return(r=!r)?{value:f(n[e](t)),done:\"return\"===e}:i?i(t):t}:i}},g=function(l){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var t,e=l[Symbol.asyncIterator];return e?e.call(l):(l=_(l),t={},i(\"next\"),i(\"throw\"),i(\"return\"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=l[a]&&function(s){return new Promise(function(t,e){var i,n,r,o;s=l[a](s),i=t,n=e,r=s.done,o=s.value,Promise.resolve(o).then(function(t){i({value:t,done:r})},n)})}}},y=function(t,e){return Object.defineProperty?Object.defineProperty(t,\"raw\",{value:e}):t.raw=e,t},b=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e},x=function(t){return t&&t.__esModule?t:{default:t}},t(\"__extends\",i),t(\"__assign\",r),t(\"__rest\",o),t(\"__decorate\",s),t(\"__param\",a),t(\"__metadata\",l),t(\"__awaiter\",h),t(\"__generator\",c),t(\"__exportStar\",u),t(\"__values\",_),t(\"__read\",p),t(\"__spread\",d),t(\"__await\",f),t(\"__asyncGenerator\",v),t(\"__asyncDelegator\",m),t(\"__asyncValues\",g),t(\"__makeTemplateObject\",y),t(\"__importStar\",b),t(\"__importDefault\",x)})}],s={base:0,\"client/connection\":1,\"client/session\":2,\"core/bokeh_events\":3,\"core/build_views\":4,\"core/dom\":5,\"core/dom_view\":6,\"core/enums\":7,\"core/has_props\":8,\"core/hittest\":9,\"core/layout/alignments\":10,\"core/layout/layout_canvas\":11,\"core/layout/side_panel\":12,\"core/layout/solver\":13,\"core/logging\":14,\"core/properties\":15,\"core/property_mixins\":16,\"core/selection_manager\":17,\"core/settings\":18,\"core/signaling\":19,\"core/ui_events\":20,\"core/util/array\":21,\"core/util/arrayable\":22,\"core/util/assert\":23,\"core/util/bbox\":24,\"core/util/callback\":25,\"core/util/canvas\":26,\"core/util/color\":27,\"core/util/compat\":28,\"core/util/data_structures\":29,\"core/util/eq\":30,\"core/util/math\":31,\"core/util/object\":32,\"core/util/projections\":33,\"core/util/refs\":34,\"core/util/selection\":35,\"core/util/serialization\":36,\"core/util/spatial\":37,\"core/util/string\":38,\"core/util/svg_colors\":39,\"core/util/templating\":40,\"core/util/text\":41,\"core/util/throttle\":42,\"core/util/typed_array\":43,\"core/util/types\":44,\"core/util/wheel\":45,\"core/util/zoom\":46,\"core/vectorization\":47,\"core/view\":48,\"core/visuals\":49,document:50,\"embed/dom\":51,\"embed/index\":52,\"embed/notebook\":53,\"embed/server\":54,\"embed/standalone\":55,main:56,model:57,\"models/annotations/annotation\":58,\"models/annotations/arrow\":59,\"models/annotations/arrow_head\":60,\"models/annotations/band\":61,\"models/annotations/box_annotation\":62,\"models/annotations/color_bar\":63,\"models/annotations/index\":64,\"models/annotations/label\":65,\"models/annotations/label_set\":66,\"models/annotations/legend\":67,\"models/annotations/legend_item\":68,\"models/annotations/poly_annotation\":69,\"models/annotations/slope\":70,\"models/annotations/span\":71,\"models/annotations/text_annotation\":72,\"models/annotations/title\":73,\"models/annotations/toolbar_panel\":74,\"models/annotations/tooltip\":75,\"models/annotations/whisker\":76,\"models/axes/axis\":77,\"models/axes/categorical_axis\":78,\"models/axes/continuous_axis\":79,\"models/axes/datetime_axis\":80,\"models/axes/index\":81,\"models/axes/linear_axis\":82,\"models/axes/log_axis\":83,\"models/axes/mercator_axis\":84,\"models/callbacks/callback\":85,\"models/callbacks/customjs\":86,\"models/callbacks/index\":87,\"models/callbacks/open_url\":88,\"models/canvas/canvas\":89,\"models/canvas/cartesian_frame\":90,\"models/canvas/index\":91,\"models/expressions/cumsum\":92,\"models/expressions/expression\":93,\"models/expressions/index\":94,\"models/expressions/stack\":95,\"models/filters/boolean_filter\":96,\"models/filters/customjs_filter\":97,\"models/filters/filter\":98,\"models/filters/group_filter\":99,\"models/filters/index\":100,\"models/filters/index_filter\":101,\"models/formatters/basic_tick_formatter\":102,\"models/formatters/categorical_tick_formatter\":103,\"models/formatters/datetime_tick_formatter\":104,\"models/formatters/func_tick_formatter\":105,\"models/formatters/index\":106,\"models/formatters/log_tick_formatter\":107,\"models/formatters/mercator_tick_formatter\":108,\"models/formatters/numeral_tick_formatter\":109,\"models/formatters/printf_tick_formatter\":110,\"models/formatters/tick_formatter\":111,\"models/glyphs/annular_wedge\":112,\"models/glyphs/annulus\":113,\"models/glyphs/arc\":114,\"models/glyphs/bezier\":115,\"models/glyphs/box\":116,\"models/glyphs/circle\":117,\"models/glyphs/ellipse\":118,\"models/glyphs/glyph\":119,\"models/glyphs/hbar\":120,\"models/glyphs/hex_tile\":121,\"models/glyphs/image\":122,\"models/glyphs/image_rgba\":123,\"models/glyphs/image_url\":124,\"models/glyphs/index\":125,\"models/glyphs/line\":126,\"models/glyphs/multi_line\":127,\"models/glyphs/oval\":128,\"models/glyphs/patch\":129,\"models/glyphs/patches\":130,\"models/glyphs/quad\":131,\"models/glyphs/quadratic\":132,\"models/glyphs/ray\":133,\"models/glyphs/rect\":134,\"models/glyphs/segment\":135,\"models/glyphs/step\":136,\"models/glyphs/text\":137,\"models/glyphs/utils\":138,\"models/glyphs/vbar\":139,\"models/glyphs/wedge\":140,\"models/glyphs/xy_glyph\":141,\"models/graphs/graph_hit_test_policy\":142,\"models/graphs/index\":143,\"models/graphs/layout_provider\":144,\"models/graphs/static_layout_provider\":145,\"models/grids/grid\":146,\"models/grids/index\":147,\"models/index\":148,\"models/layouts/box\":149,\"models/layouts/column\":150,\"models/layouts/index\":151,\"models/layouts/layout_dom\":152,\"models/layouts/row\":153,\"models/layouts/spacer\":154,\"models/layouts/widget_box\":155,\"models/mappers/categorical_color_mapper\":156,\"models/mappers/color_mapper\":157,\"models/mappers/continuous_color_mapper\":158,\"models/mappers/index\":159,\"models/mappers/linear_color_mapper\":160,\"models/mappers/log_color_mapper\":161,\"models/markers/index\":162,\"models/markers/marker\":163,\"models/plots/gmap_plot\":164,\"models/plots/gmap_plot_canvas\":165,\"models/plots/index\":166,\"models/plots/plot\":167,\"models/plots/plot_canvas\":168,\"models/ranges/data_range\":169,\"models/ranges/data_range1d\":170,\"models/ranges/factor_range\":171,\"models/ranges/index\":172,\"models/ranges/range\":173,\"models/ranges/range1d\":174,\"models/renderers/glyph_renderer\":175,\"models/renderers/graph_renderer\":176,\"models/renderers/guide_renderer\":177,\"models/renderers/index\":178,\"models/renderers/renderer\":179,\"models/scales/categorical_scale\":180,\"models/scales/index\":181,\"models/scales/linear_scale\":182,\"models/scales/log_scale\":183,\"models/scales/scale\":184,\"models/selections/index\":185,\"models/selections/interaction_policy\":186,\"models/selections/selection\":187,\"models/sources/ajax_data_source\":188,\"models/sources/cds_view\":189,\"models/sources/column_data_source\":190,\"models/sources/columnar_data_source\":191,\"models/sources/data_source\":192,\"models/sources/geojson_data_source\":193,\"models/sources/index\":194,\"models/sources/remote_data_source\":195,\"models/tickers/adaptive_ticker\":196,\"models/tickers/basic_ticker\":197,\"models/tickers/categorical_ticker\":198,\"models/tickers/composite_ticker\":199,\"models/tickers/continuous_ticker\":200,\"models/tickers/datetime_ticker\":201,\"models/tickers/days_ticker\":202,\"models/tickers/fixed_ticker\":203,\"models/tickers/index\":204,\"models/tickers/log_ticker\":205,\"models/tickers/mercator_ticker\":206,\"models/tickers/months_ticker\":207,\"models/tickers/single_interval_ticker\":208,\"models/tickers/ticker\":209,\"models/tickers/util\":210,\"models/tickers/years_ticker\":211,\"models/tiles/bbox_tile_source\":212,\"models/tiles/image_pool\":213,\"models/tiles/index\":214,\"models/tiles/mercator_tile_source\":215,\"models/tiles/quadkey_tile_source\":216,\"models/tiles/tile_renderer\":217,\"models/tiles/tile_source\":218,\"models/tiles/tile_utils\":219,\"models/tiles/tms_tile_source\":220,\"models/tiles/wmts_tile_source\":221,\"models/tools/actions/action_tool\":222,\"models/tools/actions/help_tool\":223,\"models/tools/actions/redo_tool\":224,\"models/tools/actions/reset_tool\":225,\"models/tools/actions/save_tool\":226,\"models/tools/actions/undo_tool\":227,\"models/tools/actions/zoom_in_tool\":228,\"models/tools/actions/zoom_out_tool\":229,\"models/tools/button_tool\":230,\"models/tools/edit/box_edit_tool\":231,\"models/tools/edit/edit_tool\":232,\"models/tools/edit/point_draw_tool\":233,\"models/tools/edit/poly_draw_tool\":234,\"models/tools/edit/poly_edit_tool\":235,\"models/tools/gestures/box_select_tool\":236,\"models/tools/gestures/box_zoom_tool\":237,\"models/tools/gestures/gesture_tool\":238,\"models/tools/gestures/lasso_select_tool\":239,\"models/tools/gestures/pan_tool\":240,\"models/tools/gestures/poly_select_tool\":241,\"models/tools/gestures/range_tool\":242,\"models/tools/gestures/select_tool\":243,\"models/tools/gestures/tap_tool\":244,\"models/tools/gestures/wheel_pan_tool\":245,\"models/tools/gestures/wheel_zoom_tool\":246,\"models/tools/index\":247,\"models/tools/inspectors/crosshair_tool\":248,\"models/tools/inspectors/customjs_hover\":249,\"models/tools/inspectors/hover_tool\":250,\"models/tools/inspectors/inspect_tool\":251,\"models/tools/on_off_button\":252,\"models/tools/tool\":253,\"models/tools/tool_proxy\":254,\"models/tools/toolbar\":255,\"models/tools/toolbar_base\":256,\"models/tools/toolbar_box\":257,\"models/tools/util\":258,\"models/transforms/customjs_transform\":259,\"models/transforms/dodge\":260,\"models/transforms/index\":261,\"models/transforms/interpolator\":262,\"models/transforms/jitter\":263,\"models/transforms/linear_interpolator\":264,\"models/transforms/step_interpolator\":265,\"models/transforms/transform\":266,polyfill:267,\"protocol/index\":268,\"protocol/message\":269,\"protocol/receiver\":270,safely:271,version:272},r={},(l=(a=function(t){var e=null!=s[t]?s[t]:t;if(!r[e]){if(!o[e]){var i=new Error(\"Cannot find module '\"+t+\"'\");throw i.code=\"MODULE_NOT_FOUND\",i}var n=r[e]={exports:{}};o[e].call(n.exports,a,n,n.exports)}return r[e].exports})(56)).require=a,l.register_plugin=function(t,e,i){for(var n in t)o[n]=t[n];for(var n in e)s[n]=e[n];var r=a(i);for(var n in r)l[n]=r[n];return r},l)}(this); //# sourceMappingURL=bokeh.min.js.map /* END bokeh.min.js */ }, function(Bokeh) { /* BEGIN bokeh-widgets.min.js */ /*! * Copyright (c) 2012, Anaconda, Inc. * All rights reserved. * * Redistribution and use in source and binary forms, with or without modification, * are permitted provided that the following conditions are met: * * Redistributions of source code must retain the above copyright notice, * this list of conditions and the following disclaimer. * * Redistributions in binary form must reproduce the above copyright notice, * this list of conditions and the following disclaimer in the documentation * and/or other materials provided with the distribution. * * Neither the name of Anaconda nor the names of any contributors * may be used to endorse or promote products derived from this software * without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF * THE POSSIBILITY OF SUCH DAMAGE. */ !function(t,e){var i;i=t.Bokeh,function(t,e,n){if(null!=i)return i.register_plugin(t,{\"core/menus\":396,\"models/widgets/abstract_button\":397,\"models/widgets/abstract_icon\":398,\"models/widgets/abstract_slider\":399,\"models/widgets/autocomplete_input\":400,\"models/widgets/button\":401,\"models/widgets/checkbox_button_group\":402,\"models/widgets/checkbox_group\":403,\"models/widgets/date_picker\":404,\"models/widgets/date_range_slider\":405,\"models/widgets/date_slider\":406,\"models/widgets/div\":407,\"models/widgets/dropdown\":408,\"models/widgets/index\":409,\"models/widgets/input_widget\":410,\"models/widgets/main\":411,\"models/widgets/markup\":412,\"models/widgets/multiselect\":413,\"models/widgets/panel\":414,\"models/widgets/paragraph\":415,\"models/widgets/password_input\":416,\"models/widgets/pretext\":417,\"models/widgets/radio_button_group\":418,\"models/widgets/radio_group\":419,\"models/widgets/range_slider\":420,\"models/widgets/selectbox\":421,\"models/widgets/slider\":422,\"models/widgets/tabs\":423,\"models/widgets/text_input\":424,\"models/widgets/toggle\":425,\"models/widgets/widget\":436},411);throw new Error(\"Cannot find Bokeh. You have to load it prior to loading plugins.\")}({396:function(t,e,n){var i=t(19);n.clear_menus=new i.Signal0({},\"clear_menus\"),document.addEventListener(\"click\",function(){return n.clear_menus.emit()})},397:function(t,e,n){var i=t(387),r=t(15),o=t(5),s=t(4),a=t(436),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return i.__extends(t,n),t.prototype.initialize=function(t){n.prototype.initialize.call(this,t),this.icon_views={},this.render()},t.prototype.connect_signals=function(){var t=this;n.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.remove=function(){s.remove_views(this.icon_views),n.prototype.remove.call(this)},t.prototype._render_button=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.button.apply(void 0,[{type:\"button\",disabled:this.model.disabled,class:[\"bk-bs-btn\",\"bk-bs-btn-\"+this.model.button_type]}].concat(t))},t.prototype.render=function(){var e=this;n.prototype.render.call(this),o.empty(this.el),this.buttonEl=this._render_button(this.model.label),this.buttonEl.addEventListener(\"click\",function(t){return e._button_click(t)}),this.el.appendChild(this.buttonEl);var t=this.model.icon;null!=t&&(s.build_views(this.icon_views,[t],{parent:this}),o.prepend(this.buttonEl,this.icon_views[t.id].el,o.nbsp))},t.prototype._button_click=function(t){t.preventDefault(),this.change_input()},t.prototype.change_input=function(){null!=this.model.callback&&this.model.callback.execute(this.model)},t}(a.WidgetView);n.AbstractButtonView=l;var u=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"AbstractButton\",this.define({label:[r.String,\"Button\"],icon:[r.Instance],button_type:[r.String,\"default\"],callback:[r.Instance]})},t}(a.Widget);(n.AbstractButton=u).initClass()},398:function(t,e,n){var i=t(387),r=t(436),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e}(r.WidgetView);n.AbstractIconView=o;var s=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"AbstractIcon\"},t}(r.Widget);(n.AbstractIcon=s).initClass()},399:function(t,e,n){var i=t(387),f=t(427),r=t(15),m=t(5),v=t(14),g=t(21),y=t(25),o=t(436),s=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return i.__extends(t,p),t.prototype.initialize=function(t){p.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;p.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.render=function(){var r=this;if(null==this.sliderEl&&p.prototype.render.call(this),null!=this.model.callback){var t=function(){return r.model.callback.execute(r.model)};switch(this.model.callback_policy){case\"continuous\":this.callback_wrapper=t;break;case\"throttle\":this.callback_wrapper=y.throttle(t,this.model.callback_throttle)}}var e,o=\"bk-noUi-\",n=this._calc_to(),i=n.start,s=n.end,a=n.value,l=n.step;if(this.model.tooltips){var u={to:function(t){return r.model.pretty(t)}};e=g.repeat(u,a.length)}else e=!1;if(this.el.classList.add(\"bk-slider\"),null==this.sliderEl){this.sliderEl=m.div(),this.el.appendChild(this.sliderEl),f.create(this.sliderEl,{cssPrefix:o,range:{min:i,max:s},start:a,step:l,behaviour:this.model.behaviour,connect:this.model.connected,tooltips:e,orientation:this.model.orientation,direction:this.model.direction}),this.sliderEl.noUiSlider.on(\"slide\",function(t,e,n){return r._slide(n)}),this.sliderEl.noUiSlider.on(\"change\",function(t,e,n){return r._change(n)});var c=this.sliderEl.querySelector(\".\"+o+\"handle\");c.setAttribute(\"tabindex\",\"0\"),c.addEventListener(\"keydown\",function(t){var e=r._calc_to().value[0];switch(t.which){case 37:e=Math.max(e-l,i);break;case 39:e=Math.min(e+l,s);break;default:return}var n=r.model.pretty(e);v.logger.debug(\"[slider keypress] value = \"+n),r.model.value=e,r.sliderEl.noUiSlider.set(e),null!=r.valueEl&&(r.valueEl.textContent=n),null!=r.callback_wrapper&&r.callback_wrapper()});var d=function(t,e){var n=r.sliderEl.querySelectorAll(\".\"+o+\"handle\")[t],i=n.querySelector(\".\"+o+\"tooltip\");i.style.display=e?\"block\":\"\"};this.sliderEl.noUiSlider.on(\"start\",function(t,e){return d(e,!0)}),this.sliderEl.noUiSlider.on(\"end\",function(t,e){return d(e,!1)})}else this.sliderEl.noUiSlider.updateOptions({range:{min:i,max:s},start:a,step:l});if(null!=this.titleEl&&this.el.removeChild(this.titleEl),null!=this.valueEl&&this.el.removeChild(this.valueEl),null!=this.model.title&&(0!=this.model.title.length&&(this.titleEl=m.label({},this.model.title+\":\"),this.el.insertBefore(this.titleEl,this.sliderEl)),this.model.show_value)){var h=a.map(function(t){return r.model.pretty(t)}).join(\" .. \");this.valueEl=m.div({class:\"bk-slider-value\"},h),this.el.insertBefore(this.valueEl,this.sliderEl)}this.model.disabled||(this.sliderEl.querySelector(\".\"+o+\"connect\").style.backgroundColor=this.model.bar_color),this.model.disabled?this.sliderEl.setAttribute(\"disabled\",\"true\"):this.sliderEl.removeAttribute(\"disabled\")},t.prototype._slide=function(t){var e=this,n=this._calc_from(t),i=t.map(function(t){return e.model.pretty(t)}).join(\" .. \");v.logger.debug(\"[slider slide] value = \"+i),null!=this.valueEl&&(this.valueEl.textContent=i),this.model.value=n,null!=this.callback_wrapper&&this.callback_wrapper()},t.prototype._change=function(t){var e=this,n=this._calc_from(t),i=t.map(function(t){return e.model.pretty(t)}).join(\" .. \");switch(v.logger.debug(\"[slider change] value = \"+i),null!=this.valueEl&&(this.valueEl.dataset.value=i),this.model.value=n,this.model.callback_policy){case\"mouseup\":case\"throttle\":null!=this.model.callback&&this.model.callback.execute(this.model)}},t}(o.WidgetView);n.AbstractSliderView=s;var a=function(n){function t(t){var e=n.call(this,t)||this;return e.connected=!1,e}return i.__extends(t,n),t.initClass=function(){this.prototype.type=\"AbstractSlider\",this.define({title:[r.String,\"\"],show_value:[r.Bool,!0],start:[r.Any],end:[r.Any],value:[r.Any],step:[r.Number,1],format:[r.String],orientation:[r.Orientation,\"horizontal\"],direction:[r.Any,\"ltr\"],tooltips:[r.Boolean,!0],callback:[r.Instance],callback_throttle:[r.Number,200],callback_policy:[r.String,\"throttle\"],bar_color:[r.Color,\"#e6e6e6\"]})},t.prototype._formatter=function(t,e){return\"\"+t},t.prototype.pretty=function(t){return this._formatter(t,this.format)},t}(o.Widget);(n.AbstractSlider=a).initClass()},400:function(t,e,n){var i=t(387),r=t(424),s=t(5),o=t(396),a=t(15),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return i.__extends(t,n),t.prototype.connect_signals=function(){var t=this;n.prototype.connect_signals.call(this),o.clear_menus.connect(function(){return t._clear_menu()})},t.prototype.render=function(){var e=this;n.prototype.render.call(this),this.inputEl.classList.add(\"bk-autocomplete-input\"),this.inputEl.addEventListener(\"keydown\",function(t){return e._keydown(t)}),this.inputEl.addEventListener(\"keyup\",function(t){return e._keyup(t)}),this.menuEl=s.ul({class:\"bk-bs-dropdown-menu\"}),this.menuEl.addEventListener(\"click\",function(t){return e._item_click(t)}),this.el.appendChild(this.menuEl)},t.prototype._render_items=function(t){s.empty(this.menuEl);for(var e=0,n=t;e<n.length;e++){var i=n[e],r=s.li({},s.a({data:{text:i}},i));this.menuEl.appendChild(r)}},t.prototype._open_menu=function(){this.el.classList.add(\"bk-bs-open\")},t.prototype._clear_menu=function(){this.el.classList.remove(\"bk-bs-open\")},t.prototype._item_click=function(t){if(t.preventDefault(),t.target!=t.currentTarget){var e=t.target,n=e.dataset.text;this.model.value=n}},t.prototype._keydown=function(t){},t.prototype._keyup=function(t){switch(t.keyCode){case s.Keys.Enter:console.log(\"enter\");break;case s.Keys.Esc:this._clear_menu();break;case s.Keys.Up:case s.Keys.Down:console.log(\"up/down\");break;default:var e=this.inputEl.value;if(e.length<=1)return void this._clear_menu();for(var n=[],i=0,r=this.model.completions;i<r.length;i++){var o=r[i];-1!=o.indexOf(e)&&n.push(o)}0==n.length?this._clear_menu():(this._render_items(n),this._open_menu())}},t}(r.TextInputView);n.AutocompleteInputView=l;var u=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"AutocompleteInput\",this.prototype.default_view=l,this.define({completions:[a.Array,[]]}),this.internal({active:[a.Boolean,!0]})},t}(r.TextInput);(n.AutocompleteInput=u).initClass()},401:function(t,e,n){var i=t(387),r=t(15),o=t(3),s=t(397),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.change_input=function(){this.model.trigger_event(new o.ButtonClick({})),this.model.clicks=this.model.clicks+1,t.prototype.change_input.call(this)},e}(s.AbstractButtonView);n.ButtonView=a;var l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Button\",this.prototype.default_view=a,this.define({clicks:[r.Number,0]}),o.register_with_event(o.ButtonClick,this)},t}(s.AbstractButton);(n.Button=l).initClass()},402:function(t,e,n){var i=t(387),l=t(5),r=t(15),u=t(21),o=t(436),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return i.__extends(t,n),t.prototype.initialize=function(t){n.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;n.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.render=function(){var i=this;n.prototype.render.call(this),l.empty(this.el);var r=l.div({class:\"bk-bs-btn-group\"});this.el.appendChild(r);for(var o=this.model.active,s=this.model.labels,t=function(t){var e=l.input({type:\"checkbox\",value:\"\"+t,checked:t in o});e.addEventListener(\"change\",function(){return i.model.change_input(t)});var n=l.label({class:[\"bk-bs-btn\",\"bk-bs-btn-\"+a.model.button_type]},e,s[t]);u.includes(o,t)&&n.classList.add(\"bk-bs-active\"),r.appendChild(n)},a=this,e=0;e<s.length;e++)t(e)},t}(o.WidgetView);n.CheckboxButtonGroupView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.prototype.change_input=function(e){var t=u.copy(this.active);u.includes(t,e)?u.removeBy(t,function(t){return e==t}):t.push(e),t.sort(),this.active=t,null!=this.callback&&this.callback.execute(this)},t.initClass=function(){this.prototype.type=\"CheckboxButtonGroup\",this.prototype.default_view=s,this.define({active:[r.Array,[]],labels:[r.Array,[]],button_type:[r.String,\"default\"],callback:[r.Instance]})},t}(o.Widget);(n.CheckboxButtonGroup=a).initClass()},403:function(t,e,n){var i=t(387),u=t(5),r=t(15),c=t(21),o=t(436),s=function(l){function t(){return null!==l&&l.apply(this,arguments)||this}return i.__extends(t,l),t.prototype.initialize=function(t){l.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;l.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.render=function(){var t=this;l.prototype.render.call(this),u.empty(this.el);for(var e=this.model.active,n=this.model.labels,i=0;i<n.length;i++){var r=n[i],o=u.input({type:\"checkbox\",value:\"\"+i});o.addEventListener(\"change\",function(){return t.change_input()}),this.model.disabled&&(o.disabled=!0),c.includes(e,i)&&(o.checked=!0);var s=u.label({},o,r);if(this.model.inline)s.classList.add(\"bk-bs-checkbox-inline\"),this.el.appendChild(s);else{var a=u.div({class:\"bk-bs-checkbox\"},s);this.el.appendChild(a)}}},t.prototype.change_input=function(){for(var t=this.el.querySelectorAll(\"input\"),e=[],n=0;n<t.length;n++){var i=t[n];i.checked&&e.push(n)}this.model.active=e,null!=this.model.callback&&this.model.callback.execute(this.model)},t}(o.WidgetView);n.CheckboxGroupView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"CheckboxGroup\",this.prototype.default_view=s,this.define({active:[r.Array,[]],labels:[r.Array,[]],inline:[r.Bool,!1],callback:[r.Instance]})},t}(o.Widget);(n.CheckboxGroup=a).initClass()},404:function(t,e,n){var i=t(387),r=t(410),o=t(5),s=t(15),a=t(428);a.prototype.adjustPosition=function(){if(!this._o.container){this.el.style.position=\"absolute\";var t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,o=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,s=t.getBoundingClientRect(),a=s.left+window.pageXOffset,l=s.bottom+window.pageYOffset;a-=this.el.parentElement.offsetLeft,l-=this.el.parentElement.offsetTop,(this._o.reposition&&i<a+e||-1<this._o.position.indexOf(\"right\")&&0<a-e+t.offsetWidth)&&(a=a-e+t.offsetWidth),(this._o.reposition&&r+o<l+n||-1<this._o.position.indexOf(\"top\")&&0<l-n-t.offsetHeight)&&(l=l-n-t.offsetHeight),this.el.style.left=a+\"px\",this.el.style.top=l+\"px\"}};var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-widget-form-group\")},e.prototype.render=function(){var e=this;t.prototype.render.call(this),null!=this._picker&&this._picker.destroy(),o.empty(this.el),this.labelEl=o.label({},this.model.title),this.el.appendChild(this.labelEl),this.inputEl=o.input({type:\"text\",class:\"bk-widget-form-input\",disabled:this.model.disabled}),this.el.appendChild(this.inputEl),this._picker=new a({field:this.inputEl,defaultDate:new Date(this.model.value),setDefaultDate:!0,minDate:null!=this.model.min_date?new Date(this.model.min_date):void 0,maxDate:null!=this.model.max_date?new Date(this.model.max_date):void 0,onSelect:function(t){return e._on_select(t)}}),this._root_element.appendChild(this._picker.el)},e.prototype._on_select=function(t){this.model.value=t.toDateString(),this.change_input()},e}(r.InputWidgetView);n.DatePickerView=l;var u=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"DatePicker\",this.prototype.default_view=l,this.define({value:[s.Any,(new Date).toDateString()],min_date:[s.Any],max_date:[s.Any]})},t}(r.InputWidget);(n.DatePicker=u).initClass()},405:function(t,e,n){var i=t(387),r=t(386),o=t(399),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype._calc_to=function(){return{start:this.model.start,end:this.model.end,value:this.model.value,step:this.model.step}},e.prototype._calc_from=function(t){return t},e}(o.AbstractSliderView);n.DateRangeSliderView=s;var a=function(n){function t(t){var e=n.call(this,t)||this;return e.behaviour=\"drag\",e.connected=[!1,!0,!1],e}return i.__extends(t,n),t.initClass=function(){this.prototype.type=\"DateRangeSlider\",this.prototype.default_view=s,this.override({format:\"%d %b %Y\"})},t.prototype._formatter=function(t,e){return r(t,e)},t}(o.AbstractSlider);(n.DateRangeSlider=a).initClass()},406:function(t,e,n){var i=t(387),r=t(386),o=t(399),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype._calc_to=function(){return{start:this.model.start,end:this.model.end,value:[this.model.value],step:this.model.step}},e.prototype._calc_from=function(t){var e=t[0];return e},e}(o.AbstractSliderView);n.DateSliderView=s;var a=function(n){function t(t){var e=n.call(this,t)||this;return e.behaviour=\"tap\",e.connected=[!0,!1],e}return i.__extends(t,n),t.initClass=function(){this.prototype.type=\"DateSlider\",this.prototype.default_view=s,this.override({format:\"%d %b %Y\"})},t.prototype._formatter=function(t,e){return r(t,e)},t}(o.AbstractSlider);(n.DateSlider=a).initClass()},407:function(t,e,n){var i=t(387),r=t(412),o=t(5),s=t(15),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){e.prototype.render.call(this);var t=o.div();this.model.render_as_text?t.textContent=this.model.text:t.innerHTML=this.model.text,this.markupEl.appendChild(t)},t}(r.MarkupView);n.DivView=a;var l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Div\",this.prototype.default_view=a,this.define({render_as_text:[s.Bool,!1]})},t}(r.Markup);(n.Div=l).initClass()},408:function(t,e,n){var i=t(387),h=t(5),r=t(396),o=t(15),s=t(397),a=function(d){function t(){return null!==d&&d.apply(this,arguments)||this}return i.__extends(t,d),t.prototype.connect_signals=function(){var t=this;d.prototype.connect_signals.call(this),r.clear_menus.connect(function(){return t._clear_menu()})},t.prototype.render=function(){var e=this;if(d.prototype.render.call(this),this.model.is_split_button){this.el.classList.add(\"bk-bs-btn-group\");var t=this._render_button(h.span({class:\"bk-bs-caret\"}));t.classList.add(\"bk-bs-dropdown-toggle\"),t.addEventListener(\"click\",function(t){return e._caret_click(t)}),this.el.appendChild(t)}else this.el.classList.add(\"bk-bs-dropdown\"),this.buttonEl.classList.add(\"bk-bs-dropdown-toggle\"),this.buttonEl.appendChild(h.span({class:\"bk-bs-caret\"}));this.model.active&&this.el.classList.add(\"bk-bs-open\");for(var n=[],i=0,r=this.model.menu;i<r.length;i++){var o=r[i],s=void 0;if(null!=o){var a=o[0],l=o[1],u=h.a({},a);u.dataset.value=l,u.addEventListener(\"click\",function(t){return e._item_click(t)}),s=h.li({},u)}else s=h.li({class:\"bk-bs-divider\"});n.push(s)}var c=h.ul({class:\"bk-bs-dropdown-menu\"},n);this.el.appendChild(c)},t.prototype._clear_menu=function(){this.model.active=!1},t.prototype._toggle_menu=function(){var t=this.model.active;r.clear_menus.emit(),t||(this.model.active=!0)},t.prototype._button_click=function(t){t.preventDefault(),t.stopPropagation(),this.model.is_split_button?(this._clear_menu(),this.set_value(this.model.default_value)):this._toggle_menu()},t.prototype._caret_click=function(t){t.preventDefault(),t.stopPropagation(),this._toggle_menu()},t.prototype._item_click=function(t){t.preventDefault(),this._clear_menu(),this.set_value(t.currentTarget.dataset.value)},t.prototype.set_value=function(t){this.buttonEl.value=this.model.value=t,this.change_input()},t}(s.AbstractButtonView);n.DropdownView=a;var l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Dropdown\",this.prototype.default_view=a,this.define({value:[o.String],default_value:[o.String],menu:[o.Array,[]]}),this.override({label:\"Dropdown\"}),this.internal({active:[o.Boolean,!1]})},Object.defineProperty(t.prototype,\"is_split_button\",{get:function(){return null!=this.default_value},enumerable:!0,configurable:!0}),t}(s.AbstractButton);(n.Dropdown=l).initClass()},409:function(t,e,n){var i=t(397);n.AbstractButton=i.AbstractButton;var r=t(398);n.AbstractIcon=r.AbstractIcon;var o=t(400);n.AutocompleteInput=o.AutocompleteInput;var s=t(401);n.Button=s.Button;var a=t(402);n.CheckboxButtonGroup=a.CheckboxButtonGroup;var l=t(403);n.CheckboxGroup=l.CheckboxGroup;var u=t(404);n.DatePicker=u.DatePicker;var c=t(405);n.DateRangeSlider=c.DateRangeSlider;var d=t(406);n.DateSlider=d.DateSlider;var h=t(407);n.Div=h.Div;var p=t(408);n.Dropdown=p.Dropdown;var f=t(410);n.InputWidget=f.InputWidget;var m=t(412);n.Markup=m.Markup;var v=t(413);n.MultiSelect=v.MultiSelect;var g=t(414);n.Panel=g.Panel;var y=t(415);n.Paragraph=y.Paragraph;var b=t(416);n.PasswordInput=b.PasswordInput;var _=t(417);n.PreText=_.PreText;var w=t(418);n.RadioButtonGroup=w.RadioButtonGroup;var x=t(419);n.RadioGroup=x.RadioGroup;var k=t(420);n.RangeSlider=k.RangeSlider;var S=t(421);n.Select=S.Select;var C=t(422);n.Slider=C.Slider;var E=t(423);n.Tabs=E.Tabs;var D=t(424);n.TextInput=D.TextInput;var M=t(425);n.Toggle=M.Toggle;var A=t(436);n.Widget=A.Widget},410:function(t,e,n){var i=t(387),r=t(436),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.change_input=function(){null!=this.model.callback&&this.model.callback.execute(this.model)},e}(r.WidgetView);n.InputWidgetView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"InputWidget\",this.prototype.default_view=s,this.define({title:[o.String,\"\"],callback:[o.Instance]})},t}(r.Widget);(n.InputWidget=a).initClass()},411:function(t,e,n){var i=t(409);n.Widgets=i;var r=t(0);r.register_models(i)},412:function(t,e,n){var i=t(387),r=t(15),o=t(5),s=t(436),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;e.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.render=function(){e.prototype.render.call(this),o.empty(this.el);var t=i.__assign({width:this.model.width+\"px\",height:this.model.height+\"px\"},this.model.style);this.markupEl=o.div({style:t}),this.el.appendChild(this.markupEl)},t}(s.WidgetView);n.MarkupView=a;var l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Markup\",this.define({text:[r.String,\"\"],style:[r.Any,{}]})},t}(s.Widget);(n.Markup=l).initClass()},413:function(t,e,n){var i=t(387),r=t(5),s=t(44),o=t(15),a=t(410),l=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return i.__extends(t,o),t.prototype.initialize=function(t){o.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;o.prototype.connect_signals.call(this),this.connect(this.model.properties.value.change,function(){return t.render_selection()}),this.connect(this.model.properties.options.change,function(){return t.render()}),this.connect(this.model.properties.name.change,function(){return t.render()}),this.connect(this.model.properties.title.change,function(){return t.render()}),this.connect(this.model.properties.size.change,function(){return t.render()}),this.connect(this.model.properties.disabled.change,function(){return t.render()})},t.prototype.render=function(){var t=this;o.prototype.render.call(this),r.empty(this.el);var e=r.label({for:this.model.id},this.model.title);this.el.appendChild(e);var n=this.model.options.map(function(t){var e,n;return s.isString(t)?e=n=t:(e=t[0],n=t[1]),r.option({value:e},n)});this.selectEl=r.select({multiple:!0,class:\"bk-widget-form-input\",id:this.model.id,name:this.model.name,disabled:this.model.disabled},n),this.selectEl.addEventListener(\"change\",function(){return t.change_input()}),this.el.appendChild(this.selectEl),this.render_selection()},t.prototype.render_selection=function(){for(var t=new Set(this.model.value),e=0,n=Array.from(this.el.querySelectorAll(\"option\"));e<n.length;e++){var i=n[e];i.selected=t.has(i.value)}this.selectEl.size=this.model.size},t.prototype.change_input=function(){for(var t=null!=this.el.querySelector(\"select:focus\"),e=[],n=0,i=Array.from(this.el.querySelectorAll(\"option\"));n<i.length;n++){var r=i[n];r.selected&&e.push(r.value)}this.model.value=e,o.prototype.change_input.call(this),t&&this.selectEl.focus()},t}(a.InputWidgetView);n.MultiSelectView=l;var u=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"MultiSelect\",this.prototype.default_view=l,this.define({value:[o.Array,[]],options:[o.Array,[]],size:[o.Number,4]})},t}(a.InputWidget);(n.MultiSelect=u).initClass()},414:function(t,e,n){var i=t(387),r=t(436),o=t(15),s=t(5),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),s.empty(this.el)},e}(r.WidgetView);n.PanelView=a;var l=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Panel\",this.prototype.default_view=a,this.define({title:[o.String,\"\"],child:[o.Instance],closable:[o.Bool,!1]})},t}(r.Widget);(n.Panel=l).initClass()},415:function(t,e,n){var i=t(387),r=t(412),o=t(5),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){e.prototype.render.call(this);var t=o.p({style:{margin:0}},this.model.text);this.markupEl.appendChild(t)},t}(r.MarkupView);n.ParagraphView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Paragraph\",this.prototype.default_view=s},t}(r.Markup);(n.Paragraph=a).initClass()},416:function(t,e,n){var i=t(387),r=t(424),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),this.inputEl.type=\"password\"},e}(r.TextInputView);n.PasswordInputView=o;var s=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"PasswordInput\",this.prototype.default_view=o},t}(r.TextInput);(n.PasswordInput=s).initClass()},417:function(t,e,n){var i=t(387),r=t(412),o=t(5),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){e.prototype.render.call(this);var t=o.pre({style:{overflow:\"auto\"}},this.model.text);this.markupEl.appendChild(t)},t}(r.MarkupView);n.PreTextView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"PreText\",this.prototype.default_view=s},t}(r.Markup);(n.PreText=a).initClass()},418:function(t,e,n){var i=t(387),c=t(5),d=t(38),r=t(15),o=t(436),s=function(u){function t(){return null!==u&&u.apply(this,arguments)||this}return i.__extends(t,u),t.prototype.initialize=function(t){u.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;u.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.render=function(){var t=this;u.prototype.render.call(this),c.empty(this.el);var e=c.div({class:\"bk-bs-btn-group\"});this.el.appendChild(e);for(var n=d.uniqueId(),i=this.model.active,r=this.model.labels,o=0;o<r.length;o++){var s=r[o],a=c.input({type:\"radio\",name:n,value:\"\"+o,checked:o==i});a.addEventListener(\"change\",function(){return t.change_input()});var l=c.label({class:[\"bk-bs-btn\",\"bk-bs-btn-\"+this.model.button_type]},a,s);o==i&&l.classList.add(\"bk-bs-active\"),e.appendChild(l)}},t.prototype.change_input=function(){for(var t=this.el.querySelectorAll(\"input\"),e=[],n=0;n<t.length;n++){var i=t[n];i.checked&&e.push(n)}this.model.active=e[0],null!=this.model.callback&&this.model.callback.execute(this.model)},t}(o.WidgetView);n.RadioButtonGroupView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"RadioButtonGroup\",this.prototype.default_view=s,this.define({active:[r.Any,null],labels:[r.Array,[]],button_type:[r.String,\"default\"],callback:[r.Instance]})},t}(o.Widget);(n.RadioButtonGroup=a).initClass()},419:function(t,e,n){var i=t(387),c=t(5),d=t(38),r=t(15),o=t(436),s=function(u){function t(){return null!==u&&u.apply(this,arguments)||this}return i.__extends(t,u),t.prototype.initialize=function(t){u.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;u.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.render=function(){var t=this;u.prototype.render.call(this),c.empty(this.el);for(var e=d.uniqueId(),n=this.model.active,i=this.model.labels,r=0;r<i.length;r++){var o=i[r],s=c.input({type:\"radio\",name:e,value:\"\"+r});s.addEventListener(\"change\",function(){return t.change_input()}),this.model.disabled&&(s.disabled=!0),r==n&&(s.checked=!0);var a=c.label({},s,o);if(this.model.inline)a.classList.add(\"bk-bs-radio-inline\"),this.el.appendChild(a);else{var l=c.div({class:\"bk-bs-radio\"},a);this.el.appendChild(l)}}},t.prototype.change_input=function(){for(var t=this.el.querySelectorAll(\"input\"),e=[],n=0;n<t.length;n++){var i=t[n];i.checked&&e.push(n)}this.model.active=e[0],null!=this.model.callback&&this.model.callback.execute(this.model)},t}(o.WidgetView);n.RadioGroupView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"RadioGroup\",this.prototype.default_view=s,this.define({active:[r.Any,null],labels:[r.Array,[]],inline:[r.Bool,!1],callback:[r.Instance]})},t}(o.Widget);(n.RadioGroup=a).initClass()},420:function(t,e,n){var i=t(387),r=t(357),o=t(399),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype._calc_to=function(){return{start:this.model.start,end:this.model.end,value:this.model.value,step:this.model.step}},e.prototype._calc_from=function(t){return t},e}(o.AbstractSliderView);n.RangeSliderView=s;var a=function(n){function t(t){var e=n.call(this,t)||this;return e.behaviour=\"drag\",e.connected=[!1,!0,!1],e}return i.__extends(t,n),t.initClass=function(){this.prototype.type=\"RangeSlider\",this.prototype.default_view=s,this.override({format:\"0[.]00\"})},t.prototype._formatter=function(t,e){return r.format(t,e)},t}(o.AbstractSlider);(n.RangeSlider=a).initClass()},421:function(t,e,n){var i=t(387),a=t(5),l=t(44),r=t(14),o=t(15),s=t(410),u=function(s){function t(){return null!==s&&s.apply(this,arguments)||this}return i.__extends(t,s),t.prototype.initialize=function(t){s.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;s.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.build_options=function(t){var r=this;return t.map(function(t){var e,n;l.isString(t)?e=n=t:(e=t[0],n=t[1]);var i=r.model.value==e;return a.option({selected:i,value:e},n)})},t.prototype.render=function(){var t=this;s.prototype.render.call(this),a.empty(this.el);var e,n=a.label({for:this.model.id},this.model.title);if(this.el.appendChild(n),l.isArray(this.model.options))e=this.build_options(this.model.options);else{e=[];var i=this.model.options;for(var r in i){var o=i[r];e.push(a.optgroup({label:r},this.build_options(o)))}}this.selectEl=a.select({class:\"bk-widget-form-input\",id:this.model.id,name:this.model.name,disabled:this.model.disabled},e),this.selectEl.addEventListener(\"change\",function(){return t.change_input()}),this.el.appendChild(this.selectEl)},t.prototype.change_input=function(){var t=this.selectEl.value;r.logger.debug(\"selectbox: value = \"+t),this.model.value=t,s.prototype.change_input.call(this)},t}(s.InputWidgetView);n.SelectView=u;var c=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Select\",this.prototype.default_view=u,this.define({value:[o.String,\"\"],options:[o.Any,[]]})},t}(s.InputWidget);(n.Select=c).initClass()},422:function(t,e,n){var i=t(387),r=t(357),o=t(399),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype._calc_to=function(){return{start:this.model.start,end:this.model.end,value:[this.model.value],step:this.model.step}},e.prototype._calc_from=function(t){var e=t[0];return Number.isInteger(this.model.start)&&Number.isInteger(this.model.end)&&Number.isInteger(this.model.step)?Math.round(e):e},e}(o.AbstractSliderView);n.SliderView=s;var a=function(n){function t(t){var e=n.call(this,t)||this;return e.behaviour=\"tap\",e.connected=[!0,!1],e}return i.__extends(t,n),t.initClass=function(){this.prototype.type=\"Slider\",this.prototype.default_view=s,this.override({format:\"0[.]00\"})},t.prototype._formatter=function(t,e){return r.format(t,e)},t}(o.AbstractSlider);(n.Slider=a).initClass()},423:function(t,e,n){var i=t(387),h=t(5),p=t(21),r=t(15),o=t(436),s=function(d){function t(){return null!==d&&d.apply(this,arguments)||this}return i.__extends(t,d),t.prototype.connect_signals=function(){var t=this;d.prototype.connect_signals.call(this),this.connect(this.model.properties.tabs.change,function(){return t.rebuild_child_views()}),this.connect(this.model.properties.active.change,function(){return t.render()})},t.prototype.render=function(){var r=this;d.prototype.render.call(this),h.empty(this.el);var t=this.model.tabs.length;if(0!=t){this.model.active>=t&&(this.model.active=t-1);var o=this.model.tabs.map(function(t,e){return h.li({},h.span({data:{index:e}},t.title))});o[this.model.active].classList.add(\"bk-bs-active\");var e=h.ul({class:[\"bk-bs-nav\",\"bk-bs-nav-tabs\"]},o);this.el.appendChild(e);var s=this.model.tabs.map(function(t){return h.div({class:\"bk-bs-tab-pane\"})});s[this.model.active].classList.add(\"bk-bs-active\");var n=h.div({class:\"bk-bs-tab-content\"},s);this.el.appendChild(n),e.addEventListener(\"click\",function(t){if(t.preventDefault(),t.target!=t.currentTarget){var e=t.target,n=r.model.active,i=parseInt(e.dataset.index);n!=i&&(o[n].classList.remove(\"bk-bs-active\"),s[n].classList.remove(\"bk-bs-active\"),o[i].classList.add(\"bk-bs-active\"),s[i].classList.add(\"bk-bs-active\"),r.model.active=i,null!=r.model.callback&&r.model.callback.execute(r.model))}});for(var i=0,a=p.zip(this.model.children,s);i<a.length;i++){var l=a[i],u=l[0],c=l[1];c.appendChild(this.child_views[u.id].el)}}},t}(o.WidgetView);n.TabsView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Tabs\",this.prototype.default_view=s,this.define({tabs:[r.Array,[]],active:[r.Number,0],callback:[r.Instance]})},t.prototype.get_layoutable_children=function(){return this.children},Object.defineProperty(t.prototype,\"children\",{get:function(){return this.tabs.map(function(t){return t.child})},enumerable:!0,configurable:!0}),t}(o.Widget);(n.Tabs=a).initClass()},424:function(t,e,n){var i=t(387),r=t(14),o=t(15),s=t(5),a=t(410),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return i.__extends(t,n),t.prototype.initialize=function(t){n.prototype.initialize.call(this,t),this.render()},t.prototype.connect_signals=function(){var t=this;n.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return t.render()})},t.prototype.css_classes=function(){return n.prototype.css_classes.call(this).concat(\"bk-widget-form-group\")},t.prototype.render=function(){var t=this;n.prototype.render.call(this),s.empty(this.el);var e=s.label({for:this.model.id},this.model.title);this.el.appendChild(e),this.inputEl=s.input({type:\"text\",class:\"bk-widget-form-input\",id:this.model.id,name:this.model.name,value:this.model.value,disabled:this.model.disabled,placeholder:this.model.placeholder}),this.inputEl.addEventListener(\"change\",function(){return t.change_input()}),this.el.appendChild(this.inputEl),this.model.height&&(this.inputEl.style.height=this.model.height-35+\"px\")},t.prototype.change_input=function(){var t=this.inputEl.value;r.logger.debug(\"widget/text_input: value = \"+t),this.model.value=t,n.prototype.change_input.call(this)},t}(a.InputWidgetView);n.TextInputView=l;var u=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"TextInput\",this.prototype.default_view=l,this.define({value:[o.String,\"\"],placeholder:[o.String,\"\"]})},t}(a.InputWidget);(n.TextInput=u).initClass()},425:function(t,e,n){var i=t(387),r=t(397),o=t(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),this.model.active&&this.buttonEl.classList.add(\"bk-bs-active\")},e.prototype.change_input=function(){this.model.active=!this.model.active,t.prototype.change_input.call(this)},e}(r.AbstractButtonView);n.ToggleView=s;var a=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Toggle\",this.prototype.default_view=s,this.define({active:[o.Bool,!1]}),this.override({label:\"Toggle\"})},t}(r.AbstractButton);(n.Toggle=a).initClass()},436:function(t,e,n){var i=t(387),r=t(152),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-widget\")},e.prototype.render=function(){this._render_classes(),null!=this.model.height&&(this.el.style.height=this.model.height+\"px\"),null!=this.model.width&&(this.el.style.width=this.model.width+\"px\")},e.prototype.get_width=function(){throw new Error(\"unused\")},e.prototype.get_height=function(){throw new Error(\"unused\")},e}(r.LayoutDOMView);n.WidgetView=o;var s=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.initClass=function(){this.prototype.type=\"Widget\"},t}(r.LayoutDOM);(n.Widget=s).initClass()},427:function(t,e,n){ /*! nouislider - 10.1.0 - 2017-07-28 17:11:18 */var i;i=function(){\"use strict\";var $=\"10.1.0\";function Q(t){t.preventDefault()}function r(t){return\"number\"==typeof t&&!isNaN(t)&&isFinite(t)}function Z(t,e,n){0<n&&(et(t,e),setTimeout(function(){nt(t,e)},n))}function tt(t){return Array.isArray(t)?t:[t]}function e(t){var e=(t=String(t)).split(\".\");return 1<e.length?e[1].length:0}function et(t,e){t.classList?t.classList.add(e):t.className+=\" \"+e}function nt(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp(\"(&#94;|\\\\b)\"+e.split(\" \").join(\"|\")+\"(\\\\b|$)\",\"gi\"),\" \")}function it(t){var e=void 0!==window.pageXOffset,n=\"CSS1Compat\"===(t.compatMode||\"\"),i=e?window.pageXOffset:n?t.documentElement.scrollLeft:t.body.scrollLeft,r=e?window.pageYOffset:n?t.documentElement.scrollTop:t.body.scrollTop;return{x:i,y:r}}function c(t,e){return 100/(e-t)}function d(t,e){return 100*e/(t[1]-t[0])}function h(t,e){for(var n=1;t>=e[n];)n+=1;return n}function n(t,e,n){if(n>=t.slice(-1)[0])return 100;var i,r,o,s,a,l,u=h(n,t);return i=t[u-1],r=t[u],o=e[u-1],s=e[u],o+(l=n,d(a=[i,r],a[0]<0?l+Math.abs(a[0]):l-a[0])/c(o,s))}function i(t,e,n,i){if(100===i)return i;var r,o,s,a,l=h(i,t);return n?(r=t[l-1],((o=t[l])-r)/2<i-r?o:r):e[l-1]?t[l-1]+(s=i-t[l-1],a=e[l-1],Math.round(s/a)*a):i}function o(t,e,n){var i;if(\"number\"==typeof e&&(e=[e]),\"[object Array]\"!==Object.prototype.toString.call(e))throw new Error(\"noUiSlider (\"+$+\"): 'range' contains invalid value.\");if(!r(i=\"min\"===t?0:\"max\"===t?100:parseFloat(t))||!r(e[0]))throw new Error(\"noUiSlider (\"+$+\"): 'range' value isn't numeric.\");n.xPct.push(i),n.xVal.push(e[0]),i?n.xSteps.push(!isNaN(e[1])&&e[1]):isNaN(e[1])||(n.xSteps[0]=e[1]),n.xHighestCompleteStep.push(0)}function s(t,e,n){if(!e)return!0;n.xSteps[t]=d([n.xVal[t],n.xVal[t+1]],e)/c(n.xPct[t],n.xPct[t+1]);var i=(n.xVal[t+1]-n.xVal[t])/n.xNumSteps[t],r=Math.ceil(Number(i.toFixed(3))-1),o=n.xVal[t]+n.xNumSteps[t]*r;n.xHighestCompleteStep[t]=o}function a(t,e,n){this.xPct=[],this.xVal=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=e;var i,r=[];for(i in t)t.hasOwnProperty(i)&&r.push([t[i],i]);for(r.length&&\"object\"==typeof r[0][0]?r.sort(function(t,e){return t[0][0]-e[0][0]}):r.sort(function(t,e){return t[0]-e[0]}),i=0;i<r.length;i++)o(r[i][1],r[i][0],this);for(this.xNumSteps=this.xSteps.slice(0),i=0;i<this.xNumSteps.length;i++)s(i,this.xNumSteps[i],this)}a.prototype.getMargin=function(t){var e=this.xNumSteps[0];if(e&&t/e%1!=0)throw new Error(\"noUiSlider (\"+$+\"): 'limit', 'margin' and 'padding' must be divisible by step.\");return 2===this.xPct.length&&d(this.xVal,t)},a.prototype.toStepping=function(t){return t=n(this.xVal,this.xPct,t)},a.prototype.fromStepping=function(t){return function(t,e,n){if(100<=n)return t.slice(-1)[0];var i,r,o,s,a,l=h(n,e);return i=t[l-1],r=t[l],o=e[l-1],s=e[l],a=[i,r],(n-o)*c(o,s)*(a[1]-a[0])/100+a[0]}(this.xVal,this.xPct,t)},a.prototype.getStep=function(t){return t=i(this.xPct,this.xSteps,this.snap,t)},a.prototype.getNearbySteps=function(t){var e=h(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e-0],step:this.xNumSteps[e-0],highestStep:this.xHighestCompleteStep[e-0]}}},a.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(e);return Math.max.apply(null,t)},a.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var l={to:function(t){return void 0!==t&&t.toFixed(2)},from:Number};function u(t){if(\"object\"==typeof(e=t)&&\"function\"==typeof e.to&&\"function\"==typeof e.from)return!0;var e;throw new Error(\"noUiSlider (\"+$+\"): 'format' requires 'to' and 'from' methods.\")}function p(t,e){if(!r(e))throw new Error(\"noUiSlider (\"+$+\"): 'step' is not numeric.\");t.singleStep=e}function f(t,e){if(\"object\"!=typeof e||Array.isArray(e))throw new Error(\"noUiSlider (\"+$+\"): 'range' is not an object.\");if(void 0===e.min||void 0===e.max)throw new Error(\"noUiSlider (\"+$+\"): Missing 'min' or 'max' in 'range'.\");if(e.min===e.max)throw new Error(\"noUiSlider (\"+$+\"): 'range' 'min' and 'max' cannot be equal.\");t.spectrum=new a(e,t.snap,t.singleStep)}function m(t,e){if(e=tt(e),!Array.isArray(e)||!e.length)throw new Error(\"noUiSlider (\"+$+\"): 'start' option is incorrect.\");t.handles=e.length,t.start=e}function v(t,e){if(\"boolean\"!=typeof(t.snap=e))throw new Error(\"noUiSlider (\"+$+\"): 'snap' option must be a boolean.\")}function g(t,e){if(\"boolean\"!=typeof(t.animate=e))throw new Error(\"noUiSlider (\"+$+\"): 'animate' option must be a boolean.\")}function y(t,e){if(\"number\"!=typeof(t.animationDuration=e))throw new Error(\"noUiSlider (\"+$+\"): 'animationDuration' option must be a number.\")}function b(t,e){var n,i=[!1];if(\"lower\"===e?e=[!0,!1]:\"upper\"===e&&(e=[!1,!0]),!0===e||!1===e){for(n=1;n<t.handles;n++)i.push(e);i.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error(\"noUiSlider (\"+$+\"): 'connect' option doesn't match handle count.\");i=e}t.connect=i}function _(t,e){switch(e){case\"horizontal\":t.ort=0;break;case\"vertical\":t.ort=1;break;default:throw new Error(\"noUiSlider (\"+$+\"): 'orientation' option is invalid.\")}}function w(t,e){if(!r(e))throw new Error(\"noUiSlider (\"+$+\"): 'margin' option must be numeric.\");if(0!==e&&(t.margin=t.spectrum.getMargin(e),!t.margin))throw new Error(\"noUiSlider (\"+$+\"): 'margin' option is only supported on linear sliders.\")}function x(t,e){if(!r(e))throw new Error(\"noUiSlider (\"+$+\"): 'limit' option must be numeric.\");if(t.limit=t.spectrum.getMargin(e),!t.limit||t.handles<2)throw new Error(\"noUiSlider (\"+$+\"): 'limit' option is only supported on linear sliders with 2 or more handles.\")}function k(t,e){if(!r(e))throw new Error(\"noUiSlider (\"+$+\"): 'padding' option must be numeric.\");if(0!==e){if(t.padding=t.spectrum.getMargin(e),!t.padding)throw new Error(\"noUiSlider (\"+$+\"): 'padding' option is only supported on linear sliders.\");if(t.padding<0)throw new Error(\"noUiSlider (\"+$+\"): 'padding' option must be a positive number.\");if(50<=t.padding)throw new Error(\"noUiSlider (\"+$+\"): 'padding' option must be less than half the range.\")}}function S(t,e){switch(e){case\"ltr\":t.dir=0;break;case\"rtl\":t.dir=1;break;default:throw new Error(\"noUiSlider (\"+$+\"): 'direction' option was not recognized.\")}}function C(t,e){if(\"string\"!=typeof e)throw new Error(\"noUiSlider (\"+$+\"): 'behaviour' must be a string containing options.\");var n=0<=e.indexOf(\"tap\"),i=0<=e.indexOf(\"drag\"),r=0<=e.indexOf(\"fixed\"),o=0<=e.indexOf(\"snap\"),s=0<=e.indexOf(\"hover\");if(r){if(2!==t.handles)throw new Error(\"noUiSlider (\"+$+\"): 'fixed' behaviour must be used with 2 handles\");w(t,t.start[1]-t.start[0])}t.events={tap:n||o,drag:i,fixed:r,snap:o,hover:s}}function E(t,e){if(\"boolean\"!=typeof(t.multitouch=e))throw new Error(\"noUiSlider (\"+$+\"): 'multitouch' option must be a boolean.\")}function D(t,e){if(!1!==e)if(!0===e){t.tooltips=[];for(var n=0;n<t.handles;n++)t.tooltips.push(!0)}else{if(t.tooltips=tt(e),t.tooltips.length!==t.handles)throw new Error(\"noUiSlider (\"+$+\"): must pass a formatter for all handles.\");t.tooltips.forEach(function(t){if(\"boolean\"!=typeof t&&(\"object\"!=typeof t||\"function\"!=typeof t.to))throw new Error(\"noUiSlider (\"+$+\"): 'tooltips' must be passed a formatter or 'false'.\")})}}function M(t,e){u(t.ariaFormat=e)}function A(t,e){u(t.format=e)}function N(t,e){if(void 0!==e&&\"string\"!=typeof e&&!1!==e)throw new Error(\"noUiSlider (\"+$+\"): 'cssPrefix' must be a string or `false`.\");t.cssPrefix=e}function V(t,e){if(void 0!==e&&\"object\"!=typeof e)throw new Error(\"noUiSlider (\"+$+\"): 'cssClasses' must be an object.\");if(\"string\"==typeof t.cssPrefix)for(var n in t.cssClasses={},e)e.hasOwnProperty(n)&&(t.cssClasses[n]=t.cssPrefix+e[n]);else t.cssClasses=e}function I(t,e){if(!0!==e&&!1!==e)throw new Error(\"noUiSlider (\"+$+\"): 'useRequestAnimationFrame' option should be true (default) or false.\");t.useRequestAnimationFrame=e}function rt(e){var n={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:l,format:l},i={step:{r:!1,t:p},start:{r:!0,t:m},connect:{r:!0,t:b},direction:{r:!0,t:S},snap:{r:!1,t:v},animate:{r:!1,t:g},animationDuration:{r:!1,t:y},range:{r:!0,t:f},orientation:{r:!1,t:_},margin:{r:!1,t:w},limit:{r:!1,t:x},padding:{r:!1,t:k},behaviour:{r:!0,t:C},multitouch:{r:!0,t:E},ariaFormat:{r:!1,t:M},format:{r:!1,t:A},tooltips:{r:!1,t:D},cssPrefix:{r:!1,t:N},cssClasses:{r:!1,t:V},useRequestAnimationFrame:{r:!1,t:I}},r={connect:!1,direction:\"ltr\",behaviour:\"tap\",multitouch:!1,orientation:\"horizontal\",cssPrefix:\"noUi-\",cssClasses:{target:\"target\",base:\"base\",origin:\"origin\",handle:\"handle\",handleLower:\"handle-lower\",handleUpper:\"handle-upper\",horizontal:\"horizontal\",vertical:\"vertical\",background:\"background\",connect:\"connect\",ltr:\"ltr\",rtl:\"rtl\",draggable:\"draggable\",drag:\"state-drag\",tap:\"state-tap\",active:\"active\",tooltip:\"tooltip\",pips:\"pips\",pipsHorizontal:\"pips-horizontal\",pipsVertical:\"pips-vertical\",marker:\"marker\",markerHorizontal:\"marker-horizontal\",markerVertical:\"marker-vertical\",markerNormal:\"marker-normal\",markerLarge:\"marker-large\",markerSub:\"marker-sub\",value:\"value\",valueHorizontal:\"value-horizontal\",valueVertical:\"value-vertical\",valueNormal:\"value-normal\",valueLarge:\"value-large\",valueSub:\"value-sub\"},useRequestAnimationFrame:!0};e.format&&!e.ariaFormat&&(e.ariaFormat=e.format),Object.keys(i).forEach(function(t){if(void 0===e[t]&&void 0===r[t]){if(i[t].r)throw new Error(\"noUiSlider (\"+$+\"): '\"+t+\"' is required.\");return!0}i[t].t(n,void 0===e[t]?r[t]:e[t])}),n.pips=e.pips;var t=[[\"left\",\"top\"],[\"right\",\"bottom\"]];return n.style=t[n.dir][n.ort],n.styleOposite=t[n.dir?0:1][n.ort],n}function P(t,d,o){var u,l,s,a,h,r,c,e,p=window.navigator.pointerEnabled?{start:\"pointerdown\",move:\"pointermove\",end:\"pointerup\"}:window.navigator.msPointerEnabled?{start:\"MSPointerDown\",move:\"MSPointerMove\",end:\"MSPointerUp\"}:{start:\"mousedown touchstart\",move:\"mousemove touchmove\",end:\"mouseup touchend\"},n=window.CSS&&CSS.supports&&CSS.supports(\"touch-action\",\"none\"),f=n&&function(){var t=!1;try{var e=Object.defineProperty({},\"passive\",{get:function(){t=!0}});window.addEventListener(\"test\",null,e)}catch(t){}return t}(),_=t,m=[],v=[],g=0,w=d.spectrum,y=[],b={},x=t.ownerDocument,k=x.documentElement,S=x.body;function C(t,e){var n=x.createElement(\"div\");return e&&et(n,e),t.appendChild(n),n}function i(t,e){var n=C(t,d.cssClasses.origin),i=C(n,d.cssClasses.handle);return i.setAttribute(\"data-handle\",e),i.setAttribute(\"tabindex\",\"0\"),i.setAttribute(\"role\",\"slider\"),i.setAttribute(\"aria-orientation\",d.ort?\"vertical\":\"horizontal\"),0===e?et(i,d.cssClasses.handleLower):e===d.handles-1&&et(i,d.cssClasses.handleUpper),n}function E(t,e){return!!e&&C(t,d.cssClasses.connect)}function D(t,e){return!!d.tooltips[e]&&C(t.firstChild,d.cssClasses.tooltip)}function M(e,i,r){var o=x.createElement(\"div\"),s=[d.cssClasses.valueNormal,d.cssClasses.valueLarge,d.cssClasses.valueSub],a=[d.cssClasses.markerNormal,d.cssClasses.markerLarge,d.cssClasses.markerSub],l=[d.cssClasses.valueHorizontal,d.cssClasses.valueVertical],u=[d.cssClasses.markerHorizontal,d.cssClasses.markerVertical];function c(t,e){var n=e===d.cssClasses.value,i=n?l:u,r=n?s:a;return e+\" \"+i[d.ort]+\" \"+r[t]}return et(o,d.cssClasses.pips),et(o,0===d.ort?d.cssClasses.pipsHorizontal:d.cssClasses.pipsVertical),Object.keys(e).forEach(function(t){!function(t,e){e[1]=e[1]&&i?i(e[0],e[1]):e[1];var n=C(o,!1);n.className=c(e[1],d.cssClasses.marker),n.style[d.style]=t+\"%\",e[1]&&((n=C(o,!1)).className=c(e[1],d.cssClasses.value),n.style[d.style]=t+\"%\",n.innerText=r.to(e[0]))}(t,e[t])}),o}function A(){var t;h&&((t=h).parentElement.removeChild(t),h=null)}function N(t){A();var p,f,m,e,v,n,i,g,y,b,r=t.mode,o=t.density||1,s=t.filter||!1,a=t.values||!1,l=t.stepped||!1,u=function(t,e,n){if(\"range\"===t||\"steps\"===t)return w.xVal;if(\"count\"===t){if(!e)throw new Error(\"noUiSlider (\"+$+\"): 'values' required for mode 'count'.\");var i,r=100/(e-1),o=0;for(e=[];(i=o++*r)<=100;)e.push(i);t=\"positions\"}return\"positions\"===t?e.map(function(t){return w.fromStepping(n?w.getStep(t):t)}):\"values\"===t?n?e.map(function(t){return w.fromStepping(w.getStep(w.toStepping(t)))}):e:void 0}(r,a,l),c=(p=o,f=r,m=u,v={},n=w.xVal[0],i=w.xVal[w.xVal.length-1],y=g=!1,b=0,(e=m.slice().sort(function(t,e){return t-e}),m=e.filter(function(t){return!this[t]&&(this[t]=!0)},{}))[0]!==n&&(m.unshift(n),g=!0),m[m.length-1]!==i&&(m.push(i),y=!0),m.forEach(function(t,e){var n,i,r,o,s,a,l,u,c,d=t,h=m[e+1];if(\"steps\"===f&&(n=w.xNumSteps[e]),n||(n=h-d),!1!==d&&void 0!==h)for(n=Math.max(n,1e-7),i=d;i<=h;i=(i+n).toFixed(7)/1){for(l=(s=(o=w.toStepping(i))-b)/p,c=s/(u=Math.round(l)),r=1;r<=u;r+=1)v[(b+r*c).toFixed(5)]=[\"x\",0];a=-1<m.indexOf(i)?1:\"steps\"===f?2:0,!e&&g&&(a=0),i===h&&y||(v[o.toFixed(5)]=[i,a]),b=o}}),v),d=t.format||{to:Math.round};return h=_.appendChild(M(c,s,d))}function V(){var t=u.getBoundingClientRect(),e=\"offset\"+[\"Width\",\"Height\"][d.ort];return 0===d.ort?t.width||u[e]:t.height||u[e]}function I(i,r,o,s){var e=function(t){return!_.hasAttribute(\"disabled\")&&(e=_,n=d.cssClasses.tap,(e.classList?!e.classList.contains(n):!new RegExp(\"\\\\b\"+n+\"\\\\b\").test(e.className))&&!!(t=function(t,e,n){var i,r,o=0===t.type.indexOf(\"touch\"),s=0===t.type.indexOf(\"mouse\"),a=0===t.type.indexOf(\"pointer\");if(0===t.type.indexOf(\"MSPointer\")&&(a=!0),o&&d.multitouch){var l=function(t){return t.target===n||n.contains(t.target)};if(\"touchstart\"===t.type){var u=Array.prototype.filter.call(t.touches,l);if(1<u.length)return!1;i=u[0].pageX,r=u[0].pageY}else{var c=Array.prototype.find.call(t.changedTouches,l);if(!c)return!1;i=c.pageX,r=c.pageY}}else if(o){if(1<t.touches.length)return!1;i=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY}return e=e||it(x),(s||a)&&(i=t.clientX+e.x,r=t.clientY+e.y),t.pageOffset=e,t.points=[i,r],t.cursor=s||a,t}(t,s.pageOffset,s.target||r))&&!(i===p.start&&void 0!==t.buttons&&1<t.buttons)&&(!s.hover||!t.buttons)&&(f||t.preventDefault(),t.calcPoint=t.points[d.ort],void o(t,s)));var e,n},n=[];return i.split(\" \").forEach(function(t){r.addEventListener(t,e,!!f&&{passive:!0}),n.push([t,e])}),n}function P(t){var e,n,i,r,o,s,a=t-(e=u,n=d.ort,i=e.getBoundingClientRect(),r=e.ownerDocument,o=r.documentElement,s=it(r),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(s.x=0),n?i.top+s.y-o.clientTop:i.left+s.x-o.clientLeft),l=100*a/V();return d.dir?100-l:l}function R(t,i,n,e){var r=n.slice(),o=[!t,t],s=[t,!t];e=e.slice(),t&&e.reverse(),1<e.length?e.forEach(function(t,e){var n=z(r,t,r[t]+i,o[e],s[e],!1);!1===n?i=0:(i=n-r[t],r[t]=n)}):o=s=[!0];var a=!1;e.forEach(function(t,e){a=H(t,n[t]+i,o[e],s[e])||a}),a&&e.forEach(function(t){L(\"update\",t),L(\"slide\",t)})}function L(n,i,r){Object.keys(b).forEach(function(t){var e=t.split(\".\")[0];n===e&&b[t].forEach(function(t){t.call(a,y.map(d.format.to),i,y.slice(),r||!1,m.slice())})})}function T(t,e){\"mouseout\"===t.type&&\"HTML\"===t.target.nodeName&&null===t.relatedTarget&&W(t,e)}function O(t,e){if(-1===navigator.appVersion.indexOf(\"MSIE 9\")&&0===t.buttons&&0!==e.buttonsProperty)return W(t,e);var n=(d.dir?-1:1)*(t.calcPoint-e.startCalcPoint),i=100*n/e.baseSize;R(0<n,i,e.locations,e.handleNumbers)}function W(t,e){e.handle&&(nt(e.handle,d.cssClasses.active),g-=1),e.listeners.forEach(function(t){k.removeEventListener(t[0],t[1])}),0===g&&(nt(_,d.cssClasses.drag),Y(),t.cursor&&(S.style.cursor=\"\",S.removeEventListener(\"selectstart\",Q))),e.handleNumbers.forEach(function(t){L(\"change\",t),L(\"set\",t),L(\"end\",t)})}function B(t,e){var n;if(1===e.handleNumbers.length){var i=l[e.handleNumbers[0]];if(i.hasAttribute(\"disabled\"))return!1;n=i.children[0],g+=1,et(n,d.cssClasses.active)}t.stopPropagation();var r=[],o=I(p.move,k,O,{target:t.target,handle:n,listeners:r,startCalcPoint:t.calcPoint,baseSize:V(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:m.slice()}),s=I(p.end,k,W,{target:t.target,handle:n,listeners:r,handleNumbers:e.handleNumbers}),a=I(\"mouseout\",k,T,{target:t.target,handle:n,listeners:r,handleNumbers:e.handleNumbers});r.push.apply(r,o.concat(s,a)),t.cursor&&(S.style.cursor=getComputedStyle(t.target).cursor,1<l.length&&et(_,d.cssClasses.drag),S.addEventListener(\"selectstart\",Q,!1)),e.handleNumbers.forEach(function(t){L(\"start\",t)})}function U(t){t.stopPropagation();var i,r,o,e=P(t.calcPoint),n=(i=e,o=!(r=100),l.forEach(function(t,e){if(!t.hasAttribute(\"disabled\")){var n=Math.abs(m[e]-i);n<r&&(o=e,r=n)}}),o);if(!1===n)return!1;d.events.snap||Z(_,d.cssClasses.tap,d.animationDuration),H(n,e,!0,!0),Y(),L(\"slide\",n,!0),L(\"update\",n,!0),L(\"change\",n,!0),L(\"set\",n,!0),d.events.snap&&B(t,{handleNumbers:[n]})}function j(t){var e=P(t.calcPoint),n=w.getStep(e),i=w.fromStepping(n);Object.keys(b).forEach(function(t){\"hover\"===t.split(\".\")[0]&&b[t].forEach(function(t){t.call(a,i)})})}function z(t,e,n,i,r,o){var s;return 1<l.length&&(i&&0<e&&(n=Math.max(n,t[e-1]+d.margin)),r&&e<l.length-1&&(n=Math.min(n,t[e+1]-d.margin))),1<l.length&&d.limit&&(i&&0<e&&(n=Math.min(n,t[e-1]+d.limit)),r&&e<l.length-1&&(n=Math.max(n,t[e+1]-d.limit))),d.padding&&(0===e&&(n=Math.max(n,d.padding)),e===l.length-1&&(n=Math.min(n,100-d.padding))),n=w.getStep(n),s=n,!((n=Math.max(Math.min(s,100),0))===t[e]&&!o)&&n}function F(t){return t+\"%\"}function Y(){v.forEach(function(t){var e=50<m[t]?-1:1,n=3+(l.length+e*t);l[t].childNodes[0].style.zIndex=n})}function H(t,e,n,i){return!1!==(e=z(m,t,e,n,i,!1))&&(function(t,e){m[t]=e,y[t]=w.fromStepping(e);var n=function(){l[t].style[d.style]=F(e),q(t),q(t+1)};window.requestAnimationFrame&&d.useRequestAnimationFrame?window.requestAnimationFrame(n):n()}(t,e),!0)}function q(t){if(s[t]){var e=0,n=100;0!==t&&(e=m[t-1]),t!==s.length-1&&(n=m[t]),s[t].style[d.style]=F(e),s[t].style[d.styleOposite]=F(100-n)}}function G(t,e){null!==t&&!1!==t&&(\"number\"==typeof t&&(t=String(t)),!1===(t=d.format.from(t))||isNaN(t)||H(e,w.toStepping(t),!1,!1))}function X(t,e){var n=tt(t),i=void 0===m[0];e=void 0===e||!!e,n.forEach(G),d.animate&&!i&&Z(_,d.cssClasses.tap,d.animationDuration),v.forEach(function(t){H(t,m[t],!0,!1)}),Y(),v.forEach(function(t){L(\"update\",t),null!==n[t]&&e&&L(\"set\",t)})}function K(){var t=y.map(d.format.to);return 1===t.length?t[0]:t}function J(t,e){b[t]=b[t]||[],b[t].push(e),\"update\"===t.split(\".\")[0]&&l.forEach(function(t,e){L(\"update\",e)})}if(_.noUiSlider)throw new Error(\"noUiSlider (\"+$+\"): Slider was already initialized.\");return et(e=_,d.cssClasses.target),0===d.dir?et(e,d.cssClasses.ltr):et(e,d.cssClasses.rtl),0===d.ort?et(e,d.cssClasses.horizontal):et(e,d.cssClasses.vertical),u=C(e,d.cssClasses.base),function(t,e){l=[],(s=[]).push(E(e,t[0]));for(var n=0;n<d.handles;n++)l.push(i(e,n)),v[n]=n,s.push(E(e,t[n+1]))}(d.connect,u),a={destroy:function(){for(var t in d.cssClasses)d.cssClasses.hasOwnProperty(t)&&nt(_,d.cssClasses[t]);for(;_.firstChild;)_.removeChild(_.firstChild);delete _.noUiSlider},steps:function(){return m.map(function(t,e){var n=w.getNearbySteps(t),i=y[e],r=n.thisStep.step,o=null;!1!==r&&i+r>n.stepAfter.startValue&&(r=n.stepAfter.startValue-i),o=i>n.thisStep.startValue?n.thisStep.step:!1!==n.stepBefore.step&&i-n.stepBefore.highestStep,100===t?r=null:0===t&&(o=null);var s=w.countStepDecimals();return null!==r&&!1!==r&&(r=Number(r.toFixed(s))),null!==o&&!1!==o&&(o=Number(o.toFixed(s))),[o,r]})},on:J,off:function(t){var i=t&&t.split(\".\")[0],r=i&&t.substring(i.length);Object.keys(b).forEach(function(t){var e=t.split(\".\")[0],n=t.substring(e.length);i&&i!==e||r&&r!==n||delete b[t]})},get:K,set:X,reset:function(t){X(d.start,t)},__moveHandles:function(t,e,n){R(t,e,m,n)},options:o,updateOptions:function(e,t){var n=K(),i=[\"margin\",\"limit\",\"padding\",\"range\",\"animate\",\"snap\",\"step\",\"format\"];i.forEach(function(t){void 0!==e[t]&&(o[t]=e[t])});var r=rt(o);i.forEach(function(t){void 0!==e[t]&&(d[t]=r[t])}),w=r.spectrum,d.margin=r.margin,d.limit=r.limit,d.padding=r.padding,d.pips&&N(d.pips),m=[],X(e.start||n,t)},target:_,removePips:A,pips:N},(c=d.events).fixed||l.forEach(function(t,e){I(p.start,t.children[0],B,{handleNumbers:[e]})}),c.tap&&I(p.start,u,U,{}),c.hover&&I(p.move,u,j,{hover:!0}),c.drag&&s.forEach(function(t,e){if(!1!==t&&0!==e&&e!==s.length-1){var n=l[e-1],i=l[e],r=[t];et(t,d.cssClasses.draggable),c.fixed&&(r.push(n.children[0]),r.push(i.children[0])),r.forEach(function(t){I(p.start,t,B,{handles:[n,i],handleNumbers:[e-1,e]})})}}),X(d.start),d.pips&&N(d.pips),d.tooltips&&(r=l.map(D),J(\"update\",function(t,e,n){if(r[e]){var i=t[e];!0!==d.tooltips[e]&&(i=d.tooltips[e].to(n[e])),r[e].innerHTML=i}})),J(\"update\",function(t,e,s,n,a){v.forEach(function(t){var e=l[t],n=z(m,t,0,!0,!0,!0),i=z(m,t,100,!0,!0,!0),r=a[t],o=d.ariaFormat.to(s[t]);e.children[0].setAttribute(\"aria-valuemin\",n.toFixed(1)),e.children[0].setAttribute(\"aria-valuemax\",i.toFixed(1)),e.children[0].setAttribute(\"aria-valuenow\",r.toFixed(1)),e.children[0].setAttribute(\"aria-valuetext\",o)})}),a}return{version:$,create:function(t,e){if(!t||!t.nodeName)throw new Error(\"noUiSlider (\"+$+\"): create requires a single element, got: \"+t);var n=rt(e),i=P(t,n,e);return t.noUiSlider=i}}},\"object\"==typeof n?e.exports=i():window.noUiSlider=i()},428:function(i,r,o){ /*! * Pikaday * * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday */ !function(t,e){\"use strict\";var n;if(\"object\"==typeof o){try{n=i(\"moment\")}catch(t){}r.exports=e(n)}else t.Pikaday=e(t.moment)}(this,function(n){\"use strict\";var o=\"function\"==typeof n,s=!!window.addEventListener,c=window.document,u=window.setTimeout,a=function(t,e,n,i){s?t.addEventListener(e,n,!!i):t.attachEvent(\"on\"+e,n)},i=function(t,e,n,i){s?t.removeEventListener(e,n,!!i):t.detachEvent(\"on\"+e,n)},l=function(t,e){return-1!==(\" \"+t.className+\" \").indexOf(\" \"+e+\" \")},g=function(t){return/Array/.test(Object.prototype.toString.call(t))},B=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},U=function(t,e){return[31,(n=t,n%4==0&&n%100!=0||n%400==0?29:28),31,30,31,30,31,31,30,31,30,31][e];var n},j=function(t){B(t)&&t.setHours(0,0,0,0)},z=function(t,e){return t.getTime()===e.getTime()},d=function(t,e,n){var i,r;for(i in e)(r=void 0!==t[i])&&\"object\"==typeof e[i]&&null!==e[i]&&void 0===e[i].nodeName?B(e[i])?n&&(t[i]=new Date(e[i].getTime())):g(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=d({},e[i],n):!n&&r||(t[i]=e[i]);return t},r=function(t,e,n){var i;c.createEvent?((i=c.createEvent(\"HTMLEvents\")).initEvent(e,!0,!1),i=d(i,n),t.dispatchEvent(i)):c.createEventObject&&(i=c.createEventObject(),i=d(i,n),t.fireEvent(\"on\"+e,i))},e=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),11<t.month&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},h={field:null,bound:void 0,position:\"bottom left\",reposition:!0,format:\"YYYY-MM-DD\",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:\"\",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:\"left\",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:\"Previous Month\",nextMonth:\"Next Month\",months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],weekdays:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],weekdaysShort:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},p=function(t,e,n){for(e+=t.firstDay;7<=e;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},F=function(t){var e=[],n=\"false\";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class=\"is-empty\"></td>';e.push(\"is-outside-current-month\"),t.enableSelectionDaysInNextAndPreviousMonths||e.push(\"is-selection-disabled\")}return t.isDisabled&&e.push(\"is-disabled\"),t.isToday&&e.push(\"is-today\"),t.isSelected&&(e.push(\"is-selected\"),n=\"true\"),t.hasEvent&&e.push(\"has-event\"),t.isInRange&&e.push(\"is-inrange\"),t.isStartRange&&e.push(\"is-startrange\"),t.isEndRange&&e.push(\"is-endrange\"),'<td data-day=\"'+t.day+'\" class=\"'+e.join(\" \")+'\" aria-selected=\"'+n+'\"><button class=\"pika-button pika-day\" type=\"button\" data-pika-year=\"'+t.year+'\" data-pika-month=\"'+t.month+'\" data-pika-day=\"'+t.day+'\">'+t.day+\"</button></td>\"},f=function(t,e,n,i,r,o){var s,a,l,u,c,d=t._o,h=n===d.minYear,p=n===d.maxYear,f='<div id=\"'+o+'\" class=\"pika-title\" role=\"heading\" aria-live=\"assertive\">',m=!0,v=!0;for(l=[],s=0;s<12;s++)l.push('<option value=\"'+(n===r?s-e:12+s-e)+'\"'+(s===i?' selected=\"selected\"':\"\")+(h&&s<d.minMonth||p&&s>d.maxMonth?'disabled=\"disabled\"':\"\")+\">\"+d.i18n.months[s]+\"</option>\");for(u='<div class=\"pika-label\">'+d.i18n.months[i]+'<select class=\"pika-select pika-select-month\" tabindex=\"-1\">'+l.join(\"\")+\"</select></div>\",g(d.yearRange)?(s=d.yearRange[0],a=d.yearRange[1]+1):(s=n-d.yearRange,a=1+n+d.yearRange),l=[];s<a&&s<=d.maxYear;s++)s>=d.minYear&&l.push('<option value=\"'+s+'\"'+(s===n?' selected=\"selected\"':\"\")+\">\"+s+\"</option>\");return c='<div class=\"pika-label\">'+n+d.yearSuffix+'<select class=\"pika-select pika-select-year\" tabindex=\"-1\">'+l.join(\"\")+\"</select></div>\",d.showMonthAfterYear?f+=c+u:f+=u+c,h&&(0===i||d.minMonth>=i)&&(m=!1),p&&(11===i||d.maxMonth<=i)&&(v=!1),0===e&&(f+='<button class=\"pika-prev'+(m?\"\":\" is-disabled\")+'\" type=\"button\">'+d.i18n.previousMonth+\"</button>\"),e===t._o.numberOfMonths-1&&(f+='<button class=\"pika-next'+(v?\"\":\" is-disabled\")+'\" type=\"button\">'+d.i18n.nextMonth+\"</button>\"),f+=\"</div>\"},Y=function(t,e,n){return'<table cellpadding=\"0\" cellspacing=\"0\" class=\"pika-table\" role=\"grid\" aria-labelledby=\"'+n+'\">'+function(t){var e,n=[];for(t.showWeekNumber&&n.push(\"<th></th>\"),e=0;e<7;e++)n.push('<th scope=\"col\"><abbr title=\"'+p(t,e)+'\">'+p(t,e,!0)+\"</abbr></th>\");return\"<thead><tr>\"+(t.isRTL?n.reverse():n).join(\"\")+\"</tr></thead>\"}(t)+\"<tbody>\"+e.join(\"\")+\"</tbody></table>\"},t=function(t){var i=this,r=i.config(t);i._onMouseDown=function(t){if(i._v){var e=(t=t||window.event).target||t.srcElement;if(e)if(l(e,\"is-disabled\")||(!l(e,\"pika-button\")||l(e,\"is-empty\")||l(e.parentNode,\"is-disabled\")?l(e,\"pika-prev\")?i.prevMonth():l(e,\"pika-next\")&&i.nextMonth():(i.setDate(new Date(e.getAttribute(\"data-pika-year\"),e.getAttribute(\"data-pika-month\"),e.getAttribute(\"data-pika-day\"))),r.bound&&u(function(){i.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100))),l(e,\"pika-select\"))i._c=!0;else{if(!t.preventDefault)return t.returnValue=!1;t.preventDefault()}}},i._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(l(e,\"pika-select-month\")?i.gotoMonth(e.value):l(e,\"pika-select-year\")&&i.gotoYear(e.value))},i._onKeyChange=function(t){if(t=t||window.event,i.isVisible())switch(t.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:t.preventDefault(),i.adjustDate(\"subtract\",1);break;case 38:i.adjustDate(\"subtract\",7);break;case 39:i.adjustDate(\"add\",1);break;case 40:i.adjustDate(\"add\",7)}},i._onInputChange=function(t){var e;t.firedBy!==i&&(e=r.parse?r.parse(r.field.value,r.format):o?(e=n(r.field.value,r.format,r.formatStrict))&&e.isValid()?e.toDate():null:new Date(Date.parse(r.field.value)),B(e)&&i.setDate(e),i._v||i.show())},i._onInputFocus=function(){i.show()},i._onInputClick=function(){i.show()},i._onInputBlur=function(){var t=c.activeElement;do{if(l(t,\"pika-single\"))return}while(t=t.parentNode);i._c||(i._b=u(function(){i.hide()},50)),i._c=!1},i._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,n=e;if(e){!s&&l(e,\"pika-select\")&&(e.onchange||(e.setAttribute(\"onchange\",\"return;\"),a(e,\"change\",i._onChange)));do{if(l(n,\"pika-single\")||n===r.trigger)return}while(n=n.parentNode);i._v&&e!==r.trigger&&n!==r.trigger&&i.hide()}},i.el=c.createElement(\"div\"),i.el.className=\"pika-single\"+(r.isRTL?\" is-rtl\":\"\")+(r.theme?\" \"+r.theme:\"\"),a(i.el,\"mousedown\",i._onMouseDown,!0),a(i.el,\"touchend\",i._onMouseDown,!0),a(i.el,\"change\",i._onChange),r.keyboardInput&&a(c,\"keydown\",i._onKeyChange),r.field&&(r.container?r.container.appendChild(i.el):r.bound?c.body.appendChild(i.el):r.field.parentNode.insertBefore(i.el,r.field.nextSibling),a(r.field,\"change\",i._onInputChange),r.defaultDate||(o&&r.field.value?r.defaultDate=n(r.field.value,r.format).toDate():r.defaultDate=new Date(Date.parse(r.field.value)),r.setDefaultDate=!0));var e=r.defaultDate;B(e)?r.setDefaultDate?i.setDate(e,!0):i.gotoDate(e):i.gotoDate(new Date),r.bound?(this.hide(),i.el.className+=\" is-bound\",a(r.trigger,\"click\",i._onInputClick),a(r.trigger,\"focus\",i._onInputFocus),a(r.trigger,\"blur\",i._onInputBlur)):this.show()};return t.prototype={config:function(t){this._o||(this._o=d({},h,!0));var e=d(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=\"string\"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=\"function\"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=4<n?4:n,B(e.minDate)||(e.minDate=!1),B(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),g(e.yearRange)){var i=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||h.yearRange,100<e.yearRange&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,B(this._d)?this._o.toString?this._o.toString(this._d,t):o?n(this._d).format(t):this._d.toDateString():\"\"},getMoment:function(){return o?n(this._d):null},setMoment:function(t,e){o&&n.isMoment(t)&&this.setDate(t.toDate(),e)},getDate:function(){return B(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value=\"\",r(this._o.field,\"change\",{firedBy:this})),this.draw();if(\"string\"==typeof t&&(t=new Date(Date.parse(t))),B(t)){var n=this._o.minDate,i=this._o.maxDate;B(n)&&t<n?t=n:B(i)&&i<t&&(t=i),this._d=new Date(t.getTime()),j(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),r(this._o.field,\"change\",{firedBy:this})),e||\"function\"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(B(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],\"right\"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){var n,i=this.getDate()||new Date,r=24*parseInt(e)*60*60*1e3;\"add\"===t?n=new Date(i.valueOf()+r):\"subtract\"===t&&(n=new Date(i.valueOf()-r)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=e(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=e({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(j(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=h.minDate,this._o.minYear=h.minYear,this._o.minMonth=h.minMonth,this._o.startRange=h.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(j(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=h.maxDate,this._o.maxYear=h.maxYear,this._o.maxMonth=h.maxMonth,this._o.endRange=h.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(this._v||t){var e,n=this._o,i=n.minYear,r=n.maxYear,o=n.minMonth,s=n.maxMonth,a=\"\";this._y<=i&&(this._y=i,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s)),e=\"pika-title-\"+Math.random().toString(36).replace(/[&#94;a-z]+/g,\"\").substr(0,2);for(var l=0;l<n.numberOfMonths;l++)a+='<div class=\"pika-lendar\">'+f(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,e)+this.render(this.calendars[l].year,this.calendars[l].month,e)+\"</div>\";this.el.innerHTML=a,n.bound&&\"hidden\"!==n.field.type&&u(function(){n.trigger.focus()},1),\"function\"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute(\"aria-label\",\"Use the arrow keys to pick a date\")}},adjustPosition:function(){var t,e,n,i,r,o,s,a,l,u;if(!this._o.container){if(this.el.style.position=\"absolute\",t=this._o.trigger,e=t,n=this.el.offsetWidth,i=this.el.offsetHeight,r=window.innerWidth||c.documentElement.clientWidth,o=window.innerHeight||c.documentElement.clientHeight,s=window.pageYOffset||c.body.scrollTop||c.documentElement.scrollTop,\"function\"==typeof t.getBoundingClientRect)u=t.getBoundingClientRect(),a=u.left+window.pageXOffset,l=u.bottom+window.pageYOffset;else for(a=e.offsetLeft,l=e.offsetTop+e.offsetHeight;e=e.offsetParent;)a+=e.offsetLeft,l+=e.offsetTop;(this._o.reposition&&r<a+n||-1<this._o.position.indexOf(\"right\")&&0<a-n+t.offsetWidth)&&(a=a-n+t.offsetWidth),(this._o.reposition&&o+s<l+i||-1<this._o.position.indexOf(\"top\")&&0<l-i-t.offsetHeight)&&(l=l-i-t.offsetHeight),this.el.style.left=a+\"px\",this.el.style.top=l+\"px\"}},render:function(t,e,n){var i=this._o,r=new Date,o=U(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];j(r),0<i.firstDay&&(s-=i.firstDay)<0&&(s+=7);for(var u=0===e?11:e-1,c=11===e?0:e+1,d=0===e?t-1:t,h=11===e?t+1:t,p=U(d,u),f=o+s,m=f;7<m;)m-=7;f+=7-m;for(var v,g,y,b,_,w,x,k=!1,S=0,C=0;S<f;S++){var E=new Date(t,e,S-s+1),D=!!B(this._d)&&z(E,this._d),M=z(E,r),A=-1!==i.events.indexOf(E.toDateString()),N=S<s||o+s<=S,V=S-s+1,I=e,P=t,R=i.startRange&&z(i.startRange,E),L=i.endRange&&z(i.endRange,E),T=i.startRange&&i.endRange&&i.startRange<E&&E<i.endRange,O=i.minDate&&E<i.minDate||i.maxDate&&E>i.maxDate||i.disableWeekends&&(0===(x=E.getDay())||6===x)||i.disableDayFn&&i.disableDayFn(E);N&&(S<s?(V=p+V,I=u,P=d):(V-=o,I=c,P=h));var W={day:V,month:I,year:P,hasEvent:A,isSelected:D,isToday:M,isDisabled:O,isEmpty:N,isStartRange:R,isEndRange:L,isInRange:T,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&D&&(k=!0),l.push(F(W)),7==++C&&(i.showWeekNumber&&l.unshift((y=S-s,b=e,_=t,w=void 0,w=new Date(_,0,1),'<td class=\"pika-week\">'+Math.ceil(((new Date(_,b,y)-w)/864e5+w.getDay()+1)/7)+\"</td>\")),a.push((v=l,g=i.isRTL,'<tr class=\"pika-row'+(i.pickWholeWeek?\" pick-whole-week\":\"\")+(k?\" is-selected\":\"\")+'\">'+(g?v.reverse():v).join(\"\")+\"</tr>\")),C=0,k=!(l=[]))}return Y(i,a,n)},isVisible:function(){return this._v},show:function(){var t,e,n;this.isVisible()||(this._v=!0,this.draw(),t=this.el,e=\"is-hidden\",t.className=(n=(\" \"+t.className+\" \").replace(\" \"+e+\" \",\" \")).trim?n.trim():n.replace(/&#94;\\s+|\\s+$/g,\"\"),this._o.bound&&(a(c,\"click\",this._onClick),this.adjustPosition()),\"function\"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t,e,n=this._v;!1!==n&&(this._o.bound&&i(c,\"click\",this._onClick),this.el.style.position=\"static\",this.el.style.left=\"auto\",this.el.style.top=\"auto\",t=this.el,l(t,e=\"is-hidden\")||(t.className=\"\"===t.className?e:t.className+\" \"+e),this._v=!1,void 0!==n&&\"function\"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var t=this._o;this.hide(),i(this.el,\"mousedown\",this._onMouseDown,!0),i(this.el,\"touchend\",this._onMouseDown,!0),i(this.el,\"change\",this._onChange),t.keyboardInput&&i(c,\"keydown\",this._onKeyChange),t.field&&(i(t.field,\"change\",this._onInputChange),t.bound&&(i(t.trigger,\"click\",this._onInputClick),i(t.trigger,\"focus\",this._onInputFocus),i(t.trigger,\"blur\",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},t})}})}(this); //# sourceMappingURL=bokeh-widgets.min.js.map /* END bokeh-widgets.min.js */ }, function(Bokeh) { /* BEGIN bokeh-tables.min.js */ /*! * Copyright (c) 2012, Anaconda, Inc. * All rights reserved. * * Redistribution and use in source and binary forms, with or without modification, * are permitted provided that the following conditions are met: * * Redistributions of source code must retain the above copyright notice, * this list of conditions and the following disclaimer. * * Redistributions in binary form must reproduce the above copyright notice, * this list of conditions and the following disclaimer in the documentation * and/or other materials provided with the distribution. * * Neither the name of Anaconda nor the names of any contributors * may be used to endorse or promote products derived from this software * without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF * THE POSSIBILITY OF SUCH DAMAGE. */ !function(a,b){!function(Bokeh){var define;(function(e,t,n){if(null!=Bokeh)return Bokeh.register_plugin(e,{\"models/widgets/tables/cell_editors\":429,\"models/widgets/tables/cell_formatters\":430,\"models/widgets/tables/data_table\":431,\"models/widgets/tables/index\":432,\"models/widgets/tables/main\":433,\"models/widgets/tables/table_column\":434,\"models/widgets/tables/table_widget\":435,\"models/widgets/widget\":436},433);throw new Error(\"Cannot find Bokeh. You have to load it prior to loading plugins.\")})({429:function(e,t,n){var o=e(387),r=e(15),i=e(5),l=e(6),s=e(57),a=e(431),c=function(t){function e(e){return t.call(this,o.__assign({model:e.column.model},e))||this}return o.__extends(e,t),Object.defineProperty(e.prototype,\"emptyValue\",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.inputEl=this._createInput(),this.defaultValue=null,this.args=e,this.render()},e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-cell-editor\")},e.prototype.render=function(){t.prototype.render.call(this),this.args.container.appendChild(this.el),this.el.appendChild(this.inputEl),this.renderEditor(),this.disableNavigation()},e.prototype.renderEditor=function(){},e.prototype.disableNavigation=function(){this.inputEl.addEventListener(\"keydown\",function(e){switch(e.keyCode){case i.Keys.Left:case i.Keys.Right:case i.Keys.Up:case i.Keys.Down:case i.Keys.PageUp:case i.Keys.PageDown:e.stopImmediatePropagation()}})},e.prototype.destroy=function(){this.remove()},e.prototype.focus=function(){this.inputEl.focus()},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.position=function(){},e.prototype.getValue=function(){return this.inputEl.value},e.prototype.setValue=function(e){this.inputEl.value=e},e.prototype.serializeValue=function(){return this.getValue()},e.prototype.isValueChanged=function(){return!(\"\"==this.getValue()&&null==this.defaultValue)&&this.getValue()!==this.defaultValue},e.prototype.applyValue=function(e,t){this.args.grid.getData().setField(e[a.DTINDEX_NAME],this.args.column.field,t)},e.prototype.loadValue=function(e){var t=e[this.args.column.field];this.defaultValue=null!=t?t:this.emptyValue,this.setValue(this.defaultValue)},e.prototype.validateValue=function(e){if(this.args.column.validator){var t=this.args.column.validator(e);if(!t.valid)return t}return{valid:!0,msg:null}},e.prototype.validate=function(){return this.validateValue(this.getValue())},e}(l.DOMView);n.CellEditorView=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"CellEditor\"},t}(s.Model);(n.CellEditor=u).initClass();var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),Object.defineProperty(e.prototype,\"emptyValue\",{get:function(){return\"\"},enumerable:!0,configurable:!0}),e.prototype._createInput=function(){return i.input({type:\"text\"})},e.prototype.renderEditor=function(){this.inputEl.focus(),this.inputEl.select()},e.prototype.loadValue=function(e){t.prototype.loadValue.call(this,e),this.inputEl.defaultValue=this.defaultValue,this.inputEl.select()},e}(c);n.StringEditorView=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"StringEditor\",this.prototype.default_view=d,this.define({completions:[r.Array,[]]})},t}(u);(n.StringEditor=p).initClass();var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._createInput=function(){return i.textarea()},t}(c);n.TextEditorView=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"TextEditor\",this.prototype.default_view=f},t}(u);(n.TextEditor=h).initClass();var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._createInput=function(){return i.select()},t.prototype.renderEditor=function(){for(var e=0,t=this.model.options;e<t.length;e++){var n=t[e];this.inputEl.appendChild(i.option({value:n},n))}this.focus()},t}(c);n.SelectEditorView=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"SelectEditor\",this.prototype.default_view=g,this.define({options:[r.Array,[]]})},t}(u);(n.SelectEditor=m).initClass();var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._createInput=function(){return i.input({type:\"text\"})},t}(c);n.PercentEditorView=v;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"PercentEditor\",this.prototype.default_view=v},t}(u);(n.PercentEditor=w).initClass();var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._createInput=function(){return i.input({type:\"checkbox\",value:\"true\"})},t.prototype.renderEditor=function(){this.focus()},t.prototype.loadValue=function(e){this.defaultValue=!!e[this.args.column.field],this.inputEl.checked=this.defaultValue},t.prototype.serializeValue=function(){return this.inputEl.checked},t}(c);n.CheckboxEditorView=y;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"CheckboxEditor\",this.prototype.default_view=y},t}(u);(n.CheckboxEditor=C).initClass();var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype._createInput=function(){return i.input({type:\"text\"})},e.prototype.renderEditor=function(){this.inputEl.focus(),this.inputEl.select()},e.prototype.remove=function(){t.prototype.remove.call(this)},e.prototype.serializeValue=function(){return parseInt(this.getValue(),10)||0},e.prototype.loadValue=function(e){t.prototype.loadValue.call(this,e),this.inputEl.defaultValue=this.defaultValue,this.inputEl.select()},e.prototype.validateValue=function(e){return isNaN(e)?{valid:!1,msg:\"Please enter a valid integer\"}:t.prototype.validateValue.call(this,e)},e}(c);n.IntEditorView=b;var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"IntEditor\",this.prototype.default_view=b,this.define({step:[r.Number,1]})},t}(u);(n.IntEditor=x).initClass();var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype._createInput=function(){return i.input({type:\"text\"})},e.prototype.renderEditor=function(){this.inputEl.focus(),this.inputEl.select()},e.prototype.remove=function(){t.prototype.remove.call(this)},e.prototype.serializeValue=function(){return parseFloat(this.getValue())||0},e.prototype.loadValue=function(e){t.prototype.loadValue.call(this,e),this.inputEl.defaultValue=this.defaultValue,this.inputEl.select()},e.prototype.validateValue=function(e){return isNaN(e)?{valid:!1,msg:\"Please enter a valid number\"}:t.prototype.validateValue.call(this,e)},e}(c);n.NumberEditorView=R;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"NumberEditor\",this.prototype.default_view=R,this.define({step:[r.Number,.01]})},t}(u);(n.NumberEditor=S).initClass();var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._createInput=function(){return i.input({type:\"text\"})},t}(c);n.TimeEditorView=E;var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"TimeEditor\",this.prototype.default_view=E},t}(u);(n.TimeEditor=k).initClass();var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._createInput=function(){return i.input({type:\"text\"})},Object.defineProperty(t.prototype,\"emptyValue\",{get:function(){return new Date},enumerable:!0,configurable:!0}),t.prototype.renderEditor=function(){this.inputEl.focus(),this.inputEl.select()},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.position=function(){return e.prototype.position.call(this)},t.prototype.getValue=function(){},t.prototype.setValue=function(e){},t}(c);n.DateEditorView=T;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.initClass=function(){this.prototype.type=\"DateEditor\",this.prototype.default_view=T},t}(u);(n.DateEditor=P).initClass()},430:function(e,t,n){var a=e(387),u=e(357),c=e(445),s=e(386),o=e(15),d=e(5),p=e(44),r=e(57),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.doFormat=function(e,t,n,o,r){return null==n?\"\":(n+\"\").replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")},t}(r.Model),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.initClass=function(){this.prototype.type=\"StringFormatter\",this.define({font_style:[o.FontStyle,\"normal\"],text_align:[o.TextAlign,\"left\"],text_color:[o.Color]})},t.prototype.doFormat=function(e,t,n,o,r){var i=this.font_style,l=this.text_align,s=this.text_color,a=d.span({},null==n?\"\":\"\"+n);switch(i){case\"bold\":a.style.fontWeight=\"bold\";break;case\"italic\":a.style.fontStyle=\"italic\"}return null!=l&&(a.style.textAlign=l),null!=s&&(a.style.color=s),a.outerHTML},t}(n.CellFormatter=i);(n.StringFormatter=l).initClass();var f=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return a.__extends(e,c),e.initClass=function(){this.prototype.type=\"NumberFormatter\",this.define({format:[o.String,\"0,0\"],language:[o.String,\"en\"],rounding:[o.String,\"round\"]})},e.prototype.doFormat=function(e,t,n,o,r){var i=this,l=this.format,s=this.language,a=function(){switch(i.rounding){case\"round\":case\"nearest\":return Math.round;case\"floor\":case\"rounddown\":return Math.floor;case\"ceil\":case\"roundup\":return Math.ceil}}();return n=u.format(n,l,s,a),c.prototype.doFormat.call(this,e,t,n,o,r)},e}(l);(n.NumberFormatter=f).initClass();var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.initClass=function(){this.prototype.type=\"BooleanFormatter\",this.define({icon:[o.String,\"check\"]})},t.prototype.doFormat=function(e,t,n,o,r){return n?d.i({class:this.icon}).outerHTML:\"\"},t}(i);(n.BooleanFormatter=h).initClass();var g=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return a.__extends(e,l),e.initClass=function(){this.prototype.type=\"DateFormatter\",this.define({format:[o.String,\"ISO-8601\"]})},e.prototype.getFormat=function(){switch(this.format){case\"ATOM\":case\"W3C\":case\"RFC-3339\":case\"ISO-8601\":return\"%Y-%m-%d\";case\"COOKIE\":return\"%a, %d %b %Y\";case\"RFC-850\":return\"%A, %d-%b-%y\";case\"RFC-1123\":case\"RFC-2822\":return\"%a, %e %b %Y\";case\"RSS\":case\"RFC-822\":case\"RFC-1036\":return\"%a, %e %b %y\";case\"TIMESTAMP\":return;default:return this.format}},e.prototype.doFormat=function(e,t,n,o,r){n=p.isString(n)?parseInt(n,10):n;var i=s(n,this.getFormat());return l.prototype.doFormat.call(this,e,t,i,o,r)},e}(i);(n.DateFormatter=g).initClass();var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.initClass=function(){this.prototype.type=\"HTMLTemplateFormatter\",this.define({template:[o.String,\"<%= value %>\"]})},t.prototype.doFormat=function(e,t,n,o,r){var i=this.template;if(null==n)return\"\";var l=c(i),s=a.__assign({},r,{value:n});return l(s)},t}(i);(n.HTMLTemplateFormatter=m).initClass()},431:function(e,t,i){var o=e(387),s=e(443).Grid,a=e(441).RowSelectionModel,c=e(440).CheckboxSelectColumn,r=e(15),n=e(38),l=e(21),u=e(32),d=e(14),p=e(435),f=e(436);i.DTINDEX_NAME=\"__bkdt_internal_index__\";var h=function(){function e(e,t){if(this.source=e,this.view=t,i.DTINDEX_NAME in this.source.data)throw new Error(\"special name \"+i.DTINDEX_NAME+\" cannot be used as a data table column\");this.index=this.view.indices}return e.prototype.getLength=function(){return this.index.length},e.prototype.getItem=function(e){for(var t={},n=0,o=u.keys(this.source.data);n<o.length;n++){var r=o[n];t[r]=this.source.data[r][this.index[e]]}return t[i.DTINDEX_NAME]=this.index[e],t},e.prototype.setItem=function(e,t){for(var n in t){var o=t[n];n!=i.DTINDEX_NAME&&(this.source.data[n][this.index[e]]=o)}this._update_source_inplace()},e.prototype.getField=function(e,t){return t==i.DTINDEX_NAME?this.index[e]:this.source.data[t][this.index[e]]},e.prototype.setField=function(e,t,n){this.source.data[t][this.index[e]]=n,this._update_source_inplace()},e.prototype.getItemMetadata=function(e){return null},e.prototype.getRecords=function(){var t=this;return l.range(0,this.getLength()).map(function(e){return t.getItem(e)})},e.prototype.sort=function(e){var u=e.map(function(e){return[e.sortCol.field,e.sortAsc?1:-1]});0==u.length&&(u=[[i.DTINDEX_NAME,1]]);var d=this.getRecords(),p=this.index.slice();this.index.sort(function(e,t){for(var n=0,o=u;n<o.length;n++){var r=o[n],i=r[0],l=r[1],s=d[p.indexOf(e)][i],a=d[p.indexOf(t)][i],c=s==a?0:a<s?l:-l;if(0!=c)return c}return 0})},e.prototype._update_source_inplace=function(){this.source.properties.data.change.emit()},e}();i.DataProvider=h;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._in_selection_update=!1,e._warned_not_reorderable=!1,e}return o.__extends(e,t),e.prototype.connect_signals=function(){var e=this;t.prototype.connect_signals.call(this),this.connect(this.model.change,function(){return e.render()}),this.connect(this.model.source.streaming,function(){return e.updateGrid()}),this.connect(this.model.source.patching,function(){return e.updateGrid()}),this.connect(this.model.source.change,function(){return e.updateGrid(!0)}),this.connect(this.model.source.properties.data.change,function(){return e.updateGrid()}),this.connect(this.model.source.selected.change,function(){return e.updateSelection()})},e.prototype.updateGrid=function(e){void 0===e&&(e=!1),this.model.view.compute_indices(),this.data.constructor(this.model.source,this.model.view),this.grid.invalidate(),this.grid.render(),e||(this.model.source.data=this.model.source.data,this.model.source.change.emit())},e.prototype.updateSelection=function(){var t=this;if(!this._in_selection_update){var e=this.model.source.selected,n=e.indices.map(function(e){return t.data.index.indexOf(e)});this._in_selection_update=!0,this.grid.setSelectedRows(n),this._in_selection_update=!1;var o=this.grid.getViewport(),r=this.model.get_scroll_index(o,n);null!=r&&this.grid.scrollRowToTop(r)}},e.prototype.newIndexColumn=function(){return{id:n.uniqueId(),name:this.model.index_header,field:i.DTINDEX_NAME,width:this.model.index_width,behavior:\"select\",cannotTriggerInsert:!0,resizable:!1,selectable:!1,sortable:!0,cssClass:\"bk-cell-index\",headerCssClass:\"bk-header-index\"}},e.prototype.css_classes=function(){return t.prototype.css_classes.call(this).concat(\"bk-data-table\")},e.prototype.render=function(){var e,n=this,o=this.model.columns.map(function(e){return e.toColumn()});if(\"checkbox\"==this.model.selectable&&(e=new c({cssClass:\"bk-cell-select\"}),o.unshift(e.getColumnDefinition())),null!=this.model.index_position){var t=this.model.index_position,r=this.newIndexColumn();-1==t?o.push(r):t<-1?o.splice(t+1,0,r):o.splice(t,0,r)}var i=this.model.reorderable;!i||\"undefined\"!=typeof $&&null!=$.fn&&null!=$.fn.sortable||(this._warned_not_reorderable||(d.logger.warn(\"jquery-ui is required to enable DataTable.reorderable\"),this._warned_not_reorderable=!0),i=!1);var l={enableCellNavigation:!1!==this.model.selectable,enableColumnReorder:i,forceFitColumns:this.model.fit_columns,autoHeight:\"auto\"==this.model.height,multiColumnSort:this.model.sortable,editable:this.model.editable,autoEdit:!1};null!=this.model.width?this.el.style.width=this.model.width+\"px\":this.el.style.width=this.model.default_width+\"px\",null!=this.model.height&&\"auto\"!=this.model.height&&(this.el.style.height=this.model.height+\"px\"),this.data=new h(this.model.source,this.model.view),this.grid=new s(this.el,this.data,o,l),this.grid.onSort.subscribe(function(e,t){o=t.sortCols,n.data.sort(o),n.grid.invalidate(),n.updateSelection(),n.grid.render()}),!1!==this.model.selectable&&(this.grid.setSelectionModel(new a({selectActiveRow:null==e})),null!=e&&this.grid.registerPlugin(e),this.grid.onSelectedRowsChanged.subscribe(function(e,t){n._in_selection_update||(n.model.source.selected.indices=t.rows.map(function(e){return n.data.index[e]}))}),this.updateSelection())},e}(f.WidgetView);i.DataTableView=g;var m=function(n){function e(e){var t=n.call(this,e)||this;return t.default_width=600,t}return o.__extends(e,n),e.initClass=function(){this.prototype.type=\"DataTable\",this.prototype.default_view=g,this.define({columns:[r.Array,[]],fit_columns:[r.Bool,!0],sortable:[r.Bool,!0],reorderable:[r.Bool,!0],editable:[r.Bool,!1],selectable:[r.Bool,!0],index_position:[r.Int,0],index_header:[r.String,\"#\"],index_width:[r.Int,40],scroll_to_selection:[r.Bool,!0]}),this.override({height:400})},e.prototype.get_scroll_index=function(t,e){return this.scroll_to_selection&&0!=e.length?l.any(e,function(e){return t.top<=e&&e<=t.bottom})?null:Math.max(0,Math.min.apply(Math,e)-1):null},e}(p.TableWidget);(i.DataTable=m).initClass()},432:function(e,t,n){var o=e(387);o.__exportStar(e(429),n),o.__exportStar(e(430),n);var r=e(431);n.DataTable=r.DataTable;var i=e(434);n.TableColumn=i.TableColumn;var l=e(435);n.TableWidget=l.TableWidget},433:function(e,t,n){var o=e(432);n.Tables=o;var r=e(0);r.register_models(o)},434:function(e,t,n){var o=e(387),r=e(430),i=e(429),l=e(15),s=e(38),a=e(57),c=function(t){function e(e){return t.call(this,e)||this}return o.__extends(e,t),e.initClass=function(){this.prototype.type=\"TableColumn\",this.define({field:[l.String],title:[l.String],width:[l.Number,300],formatter:[l.Instance,function(){return new r.StringFormatter}],editor:[l.Instance,function(){return new i.StringEditor}],sortable:[l.Bool,!0],default_sort:[l.String,\"ascending\"]})},e.prototype.toColumn=function(){return{id:s.uniqueId(),field:this.field,name:this.title,width:this.width,formatter:null!=this.formatter?this.formatter.doFormat.bind(this.formatter):void 0,model:this.editor,editor:this.editor.default_view,sortable:this.sortable,defaultSortAsc:\"ascending\"==this.default_sort}},e}(a.Model);(n.TableColumn=c).initClass()},435:function(e,t,n){var o=e(387),r=e(436),i=e(189),l=e(15),s=function(t){function e(e){return t.call(this,e)||this}return o.__extends(e,t),e.initClass=function(){this.prototype.type=\"TableWidget\",this.define({source:[l.Instance],view:[l.Instance,function(){return new i.CDSView}]})},e.prototype.initialize=function(){t.prototype.initialize.call(this),null==this.view.source&&(this.view.source=this.source,this.view.compute_indices())},e}(r.Widget);(n.TableWidget=s).initClass()},436:function(e,t,n){var o=e(387),r=e(152),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.css_classes=function(){return e.prototype.css_classes.call(this).concat(\"bk-widget\")},t.prototype.render=function(){this._render_classes(),null!=this.model.height&&(this.el.style.height=this.model.height+\"px\"),null!=this.model.width&&(this.el.style.width=this.model.width+\"px\")},t.prototype.get_width=function(){throw new Error(\"unused\")},t.prototype.get_height=function(){throw new Error(\"unused\")},t}(r.LayoutDOMView);n.WidgetView=i;var l=function(t){function e(e){return t.call(this,e)||this}return o.__extends(e,t),e.initClass=function(){this.prototype.type=\"Widget\"},e}(r.LayoutDOM);(n.Widget=l).initClass()},437:function(e,n,t){ /*! * jQuery JavaScript Library v3.2.1 * https://jquery.com/ * * Includes Sizzle.js * https://sizzlejs.com/ * * Copyright JS Foundation and other contributors * Released under the MIT license * https://jquery.org/license * * Date: 2017-03-20T18:59Z */ !function(e,t){\"use strict\";\"object\"==typeof n&&\"object\"==typeof n.exports?n.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error(\"jQuery requires a window with a document\");return t(e)}:t(e)}(\"undefined\"!=typeof window?window:this,function(R,e){\"use strict\";var t=[],S=R.document,o=Object.getPrototypeOf,s=t.slice,g=t.concat,a=t.push,r=t.indexOf,n={},i=n.toString,h=n.hasOwnProperty,l=h.toString,c=l.call(Object),m={};function v(e,t){var n=(t=t||S).createElement(\"script\");n.text=e,t.head.appendChild(n).parentNode.removeChild(n)}var E=function(e,t){return new E.fn.init(e,t)},u=/&#94;[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,d=/&#94;-ms-/,p=/-([a-z])/g,f=function(e,t){return t.toUpperCase()};function w(e){var t=!!e&&\"length\"in e&&e.length,n=E.type(e);return\"function\"!==n&&!E.isWindow(e)&&(\"array\"===n||0===t||\"number\"==typeof t&&0<t&&t-1 in e)}E.fn=E.prototype={jquery:\"3.2.1\",constructor:E,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=E.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return E.each(this,e)},map:function(n){return this.pushStack(E.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:t.sort,splice:t.splice},E.extend=E.fn.extend=function(){var e,t,n,o,r,i,l=arguments[0]||{},s=1,a=arguments.length,c=!1;for(\"boolean\"==typeof l&&(c=l,l=arguments[s]||{},s++),\"object\"==typeof l||E.isFunction(l)||(l={}),s===a&&(l=this,s--);s<a;s++)if(null!=(e=arguments[s]))for(t in e)n=l[t],o=e[t],l!==o&&(c&&o&&(E.isPlainObject(o)||(r=Array.isArray(o)))?(r?(r=!1,i=n&&Array.isArray(n)?n:[]):i=n&&E.isPlainObject(n)?n:{},l[t]=E.extend(c,i,o)):void 0!==o&&(l[t]=o));return l},E.extend({expando:\"jQuery\"+(\"3.2.1\"+Math.random()).replace(/\\D/g,\"\"),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return\"function\"===E.type(e)},isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=E.type(e);return(\"number\"===t||\"string\"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,n;return!(!e||\"[object Object]\"!==i.call(e))&&(!(t=o(e))||\"function\"==typeof(n=h.call(t,\"constructor\")&&t.constructor)&&l.call(n)===c)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+\"\":\"object\"==typeof e||\"function\"==typeof e?n[i.call(e)]||\"object\":typeof e},globalEval:function(e){v(e)},camelCase:function(e){return e.replace(d,\"ms-\").replace(p,f)},each:function(e,t){var n,o=0;if(w(e))for(n=e.length;o<n&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},trim:function(e){return null==e?\"\":(e+\"\").replace(u,\"\")},makeArray:function(e,t){var n=t||[];return null!=e&&(w(Object(e))?E.merge(n,\"string\"==typeof e?[e]:e):a.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:r.call(t,e,n)},merge:function(e,t){for(var n=+t.length,o=0,r=e.length;o<n;o++)e[r++]=t[o];return e.length=r,e},grep:function(e,t,n){for(var o=[],r=0,i=e.length,l=!n;r<i;r++)!t(e[r],r)!==l&&o.push(e[r]);return o},map:function(e,t,n){var o,r,i=0,l=[];if(w(e))for(o=e.length;i<o;i++)null!=(r=t(e[i],i,n))&&l.push(r);else for(i in e)null!=(r=t(e[i],i,n))&&l.push(r);return g.apply([],l)},guid:1,proxy:function(e,t){var n,o,r;if(\"string\"==typeof t&&(n=e[t],t=e,e=n),E.isFunction(e))return o=s.call(arguments,2),(r=function(){return e.apply(t||this,o.concat(s.call(arguments)))}).guid=e.guid=e.guid||E.guid++,r},now:Date.now,support:m}),\"function\"==typeof Symbol&&(E.fn[Symbol.iterator]=t[Symbol.iterator]),E.each(\"Boolean Number String Function Array Date RegExp Object Error Symbol\".split(\" \"),function(e,t){n[\"[object \"+t+\"]\"]=t.toLowerCase()});var y= /*! * Sizzle CSS Selector Engine v2.3.3 * https://sizzlejs.com/ * * Copyright jQuery Foundation and other contributors * Released under the MIT license * http://jquery.org/license * * Date: 2016-08-08 */ function(n){var e,f,C,i,r,h,d,g,b,a,c,x,R,l,S,m,s,u,v,E=\"sizzle\"+1*new Date,w=n.document,k=0,o=0,p=le(),y=le(),T=le(),P=function(e,t){return e===t&&(c=!0),0},D={}.hasOwnProperty,t=[],N=t.pop,A=t.push,$=t.push,H=t.slice,L=function(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1},_=\"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",F=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",I=\"(?:\\\\\\\\.|[\\\\w-]|[&#94;\\0-\\\\xa0])+\",M=\"\\\\[\"+F+\"*(\"+I+\")(?:\"+F+\"*([*&#94;$|!~]?=)\"+F+\"*(?:'((?:\\\\\\\\.|[&#94;\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[&#94;\\\\\\\\\\\"])*)\\\"|(\"+I+\"))|)\"+F+\"*\\\\]\",W=\":(\"+I+\")(?:\\\\((('((?:\\\\\\\\.|[&#94;\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[&#94;\\\\\\\\\\\"])*)\\\")|((?:\\\\\\\\.|[&#94;\\\\\\\\()[\\\\]]|\"+M+\")*)|.*)\\\\)|)\",j=new RegExp(F+\"+\",\"g\"),V=new RegExp(\"&#94;\"+F+\"+|((?:&#94;|[&#94;\\\\\\\\])(?:\\\\\\\\.)*)\"+F+\"+$\",\"g\"),B=new RegExp(\"&#94;\"+F+\"*,\"+F+\"*\"),q=new RegExp(\"&#94;\"+F+\"*([>+~]|\"+F+\")\"+F+\"*\"),O=new RegExp(\"=\"+F+\"*([&#94;\\\\]'\\\"]*?)\"+F+\"*\\\\]\",\"g\"),z=new RegExp(W),X=new RegExp(\"&#94;\"+I+\"$\"),U={ID:new RegExp(\"&#94;#(\"+I+\")\"),CLASS:new RegExp(\"&#94;\\\\.(\"+I+\")\"),TAG:new RegExp(\"&#94;(\"+I+\"|[*])\"),ATTR:new RegExp(\"&#94;\"+M),PSEUDO:new RegExp(\"&#94;\"+W),CHILD:new RegExp(\"&#94;:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+F+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+F+\"*(?:([+-]|)\"+F+\"*(\\\\d+)|))\"+F+\"*\\\\)|)\",\"i\"),bool:new RegExp(\"&#94;(?:\"+_+\")$\",\"i\"),needsContext:new RegExp(\"&#94;\"+F+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+F+\"*((?:-\\\\d)?\\\\d*)\"+F+\"*\\\\)|)(?=[&#94;-]|$)\",\"i\")},K=/&#94;(?:input|select|textarea|button)$/i,G=/&#94;h\\d$/i,Y=/&#94;[&#94;{]+\\{\\s*\\[native \\w/,Q=/&#94;(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,J=/[+~]/,Z=new RegExp(\"\\\\\\\\([\\\\da-f]{1,6}\"+F+\"?|(\"+F+\")|.)\",\"ig\"),ee=function(e,t,n){var o=\"0x\"+t-65536;return o!=o||n?t:o<0?String.fromCharCode(o+65536):String.fromCharCode(o>>10|55296,1023&o|56320)},te=/([\\0-\\x1f\\x7f]|&#94;-?\\d)|&#94;-$|[&#94;\\0-\\x1f\\x7f-\\uFFFF\\w-]/g,ne=function(e,t){return t?\"\\0\"===e?\"�\":e.slice(0,-1)+\"\\\\\"+e.charCodeAt(e.length-1).toString(16)+\" \":\"\\\\\"+e},oe=function(){x()},re=we(function(e){return!0===e.disabled&&(\"form\"in e||\"label\"in e)},{dir:\"parentNode\",next:\"legend\"});try{$.apply(t=H.call(w.childNodes),w.childNodes),t[w.childNodes.length].nodeType}catch(e){$={apply:t.length?function(e,t){A.apply(e,H.call(t))}:function(e,t){for(var n=e.length,o=0;e[n++]=t[o++];);e.length=n-1}}}function ie(e,t,n,o){var r,i,l,s,a,c,u,d=t&&t.ownerDocument,p=t?t.nodeType:9;if(n=n||[],\"string\"!=typeof e||!e||1!==p&&9!==p&&11!==p)return n;if(!o&&((t?t.ownerDocument||t:w)!==R&&x(t),t=t||R,S)){if(11!==p&&(a=Q.exec(e)))if(r=a[1]){if(9===p){if(!(l=t.getElementById(r)))return n;if(l.id===r)return n.push(l),n}else if(d&&(l=d.getElementById(r))&&v(t,l)&&l.id===r)return n.push(l),n}else{if(a[2])return $.apply(n,t.getElementsByTagName(e)),n;if((r=a[3])&&f.getElementsByClassName&&t.getElementsByClassName)return $.apply(n,t.getElementsByClassName(r)),n}if(f.qsa&&!T[e+\" \"]&&(!m||!m.test(e))){if(1!==p)d=t,u=e;else if(\"object\"!==t.nodeName.toLowerCase()){for((s=t.getAttribute(\"id\"))?s=s.replace(te,ne):t.setAttribute(\"id\",s=E),c=h(e),i=c.length;i--;)c[i]=\"#\"+s+\" \"+ve(c[i]);u=c.join(\",\"),d=J.test(e)&&ge(t.parentNode)||t}if(u)try{return $.apply(n,d.querySelectorAll(u)),n}catch(e){}finally{s===E&&t.removeAttribute(\"id\")}}}return g(e.replace(V,\"$1\"),t,n,o)}function le(){var o=[];return function e(t,n){o.push(t+\" \")>C.cacheLength&&delete e[o.shift()];return e[t+\" \"]=n}}function se(e){return e[E]=!0,e}function ae(e){var t=R.createElement(\"fieldset\");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ce(e,t){for(var n=e.split(\"|\"),o=n.length;o--;)C.attrHandle[n[o]]=t}function ue(e,t){var n=t&&e,o=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(o)return o;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(n){return function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&e.type===n}}function pe(n){return function(e){var t=e.nodeName.toLowerCase();return(\"input\"===t||\"button\"===t)&&e.type===n}}function fe(t){return function(e){return\"form\"in e?e.parentNode&&!1===e.disabled?\"label\"in e?\"label\"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&re(e)===t:e.disabled===t:\"label\"in e&&e.disabled===t}}function he(l){return se(function(i){return i=+i,se(function(e,t){for(var n,o=l([],e.length,i),r=o.length;r--;)e[n=o[r]]&&(e[n]=!(t[n]=e[n]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in f=ie.support={},r=ie.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&\"HTML\"!==t.nodeName},x=ie.setDocument=function(e){var t,n,o=e?e.ownerDocument||e:w;return o!==R&&9===o.nodeType&&o.documentElement&&(l=(R=o).documentElement,S=!r(R),w!==R&&(n=R.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener(\"unload\",oe,!1):n.attachEvent&&n.attachEvent(\"onunload\",oe)),f.attributes=ae(function(e){return e.className=\"i\",!e.getAttribute(\"className\")}),f.getElementsByTagName=ae(function(e){return e.appendChild(R.createComment(\"\")),!e.getElementsByTagName(\"*\").length}),f.getElementsByClassName=Y.test(R.getElementsByClassName),f.getById=ae(function(e){return l.appendChild(e).id=E,!R.getElementsByName||!R.getElementsByName(E).length}),f.getById?(C.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){return e.getAttribute(\"id\")===t}},C.find.ID=function(e,t){if(void 0!==t.getElementById&&S){var n=t.getElementById(e);return n?[n]:[]}}):(C.filter.ID=function(e){var n=e.replace(Z,ee);return function(e){var t=void 0!==e.getAttributeNode&&e.getAttributeNode(\"id\");return t&&t.value===n}},C.find.ID=function(e,t){if(void 0!==t.getElementById&&S){var n,o,r,i=t.getElementById(e);if(i){if((n=i.getAttributeNode(\"id\"))&&n.value===e)return[i];for(r=t.getElementsByName(e),o=0;i=r[o++];)if((n=i.getAttributeNode(\"id\"))&&n.value===e)return[i]}return[]}}),C.find.TAG=f.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):f.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,o=[],r=0,i=t.getElementsByTagName(e);if(\"*\"===e){for(;n=i[r++];)1===n.nodeType&&o.push(n);return o}return i},C.find.CLASS=f.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&S)return t.getElementsByClassName(e)},s=[],m=[],(f.qsa=Y.test(R.querySelectorAll))&&(ae(function(e){l.appendChild(e).innerHTML=\"<a id='\"+E+\"'></a><select id='\"+E+\"-\\r\\\\' msallowcapture=''><option selected=''></option></select>\",e.querySelectorAll(\"[msallowcapture&#94;='']\").length&&m.push(\"[*&#94;$]=\"+F+\"*(?:''|\\\"\\\")\"),e.querySelectorAll(\"[selected]\").length||m.push(\"\\\\[\"+F+\"*(?:value|\"+_+\")\"),e.querySelectorAll(\"[id~=\"+E+\"-]\").length||m.push(\"~=\"),e.querySelectorAll(\":checked\").length||m.push(\":checked\"),e.querySelectorAll(\"a#\"+E+\"+*\").length||m.push(\".#.+[+~]\")}),ae(function(e){e.innerHTML=\"<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>\";var t=R.createElement(\"input\");t.setAttribute(\"type\",\"hidden\"),e.appendChild(t).setAttribute(\"name\",\"D\"),e.querySelectorAll(\"[name=d]\").length&&m.push(\"name\"+F+\"*[*&#94;$|!~]?=\"),2!==e.querySelectorAll(\":enabled\").length&&m.push(\":enabled\",\":disabled\"),l.appendChild(e).disabled=!0,2!==e.querySelectorAll(\":disabled\").length&&m.push(\":enabled\",\":disabled\"),e.querySelectorAll(\"*,:x\"),m.push(\",.*:\")})),(f.matchesSelector=Y.test(u=l.matches||l.webkitMatchesSelector||l.mozMatchesSelector||l.oMatchesSelector||l.msMatchesSelector))&&ae(function(e){f.disconnectedMatch=u.call(e,\"*\"),u.call(e,\"[s!='']:x\"),s.push(\"!=\",W)}),m=m.length&&new RegExp(m.join(\"|\")),s=s.length&&new RegExp(s.join(\"|\")),t=Y.test(l.compareDocumentPosition),v=t||Y.test(l.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,o=t&&t.parentNode;return e===o||!(!o||1!==o.nodeType||!(n.contains?n.contains(o):e.compareDocumentPosition&&16&e.compareDocumentPosition(o)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},P=t?function(e,t){if(e===t)return c=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!f.sortDetached&&t.compareDocumentPosition(e)===n?e===R||e.ownerDocument===w&&v(w,e)?-1:t===R||t.ownerDocument===w&&v(w,t)?1:a?L(a,e)-L(a,t):0:4&n?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,o=0,r=e.parentNode,i=t.parentNode,l=[e],s=[t];if(!r||!i)return e===R?-1:t===R?1:r?-1:i?1:a?L(a,e)-L(a,t):0;if(r===i)return ue(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;l[o]===s[o];)o++;return o?ue(l[o],s[o]):l[o]===w?-1:s[o]===w?1:0}),R},ie.matches=function(e,t){return ie(e,null,null,t)},ie.matchesSelector=function(e,t){if((e.ownerDocument||e)!==R&&x(e),t=t.replace(O,\"='$1']\"),f.matchesSelector&&S&&!T[t+\" \"]&&(!s||!s.test(t))&&(!m||!m.test(t)))try{var n=u.call(e,t);if(n||f.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ie(t,R,null,[e]).length},ie.contains=function(e,t){return(e.ownerDocument||e)!==R&&x(e),v(e,t)},ie.attr=function(e,t){(e.ownerDocument||e)!==R&&x(e);var n=C.attrHandle[t.toLowerCase()],o=n&&D.call(C.attrHandle,t.toLowerCase())?n(e,t,!S):void 0;return void 0!==o?o:f.attributes||!S?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},ie.escape=function(e){return(e+\"\").replace(te,ne)},ie.error=function(e){throw new Error(\"Syntax error, unrecognized expression: \"+e)},ie.uniqueSort=function(e){var t,n=[],o=0,r=0;if(c=!f.detectDuplicates,a=!f.sortStable&&e.slice(0),e.sort(P),c){for(;t=e[r++];)t===e[r]&&(o=n.push(r));for(;o--;)e.splice(n[o],1)}return a=null,e},i=ie.getText=function(e){var t,n=\"\",o=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if(\"string\"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[o++];)n+=i(t);return n},(C=ie.selectors={cacheLength:50,createPseudo:se,match:U,attrHandle:{},find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Z,ee),e[3]=(e[3]||e[4]||e[5]||\"\").replace(Z,ee),\"~=\"===e[2]&&(e[3]=\" \"+e[3]+\" \"),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),\"nth\"===e[1].slice(0,3)?(e[3]||ie.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(\"even\"===e[3]||\"odd\"===e[3])),e[5]=+(e[7]+e[8]||\"odd\"===e[3])):e[3]&&ie.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return U.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||\"\":n&&z.test(n)&&(t=h(n,!0))&&(t=n.indexOf(\")\",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Z,ee).toLowerCase();return\"*\"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=p[e+\" \"];return t||(t=new RegExp(\"(&#94;|\"+F+\")\"+e+\"(\"+F+\"|$)\"))&&p(e,function(e){return t.test(\"string\"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute(\"class\")||\"\")})},ATTR:function(n,o,r){return function(e){var t=ie.attr(e,n);return null==t?\"!=\"===o:!o||(t+=\"\",\"=\"===o?t===r:\"!=\"===o?t!==r:\"&#94;=\"===o?r&&0===t.indexOf(r):\"*=\"===o?r&&-1<t.indexOf(r):\"$=\"===o?r&&t.slice(-r.length)===r:\"~=\"===o?-1<(\" \"+t.replace(j,\" \")+\" \").indexOf(r):\"|=\"===o&&(t===r||t.slice(0,r.length+1)===r+\"-\"))}},CHILD:function(h,e,t,g,m){var v=\"nth\"!==h.slice(0,3),w=\"last\"!==h.slice(-4),y=\"of-type\"===e;return 1===g&&0===m?function(e){return!!e.parentNode}:function(e,t,n){var o,r,i,l,s,a,c=v!==w?\"nextSibling\":\"previousSibling\",u=e.parentNode,d=y&&e.nodeName.toLowerCase(),p=!n&&!y,f=!1;if(u){if(v){for(;c;){for(l=e;l=l[c];)if(y?l.nodeName.toLowerCase()===d:1===l.nodeType)return!1;a=c=\"only\"===h&&!a&&\"nextSibling\"}return!0}if(a=[w?u.firstChild:u.lastChild],w&&p){for(i=(l=u)[E]||(l[E]={}),r=i[l.uniqueID]||(i[l.uniqueID]={}),o=r[h]||[],s=o[0]===k&&o[1],f=s&&o[2],l=s&&u.childNodes[s];l=++s&&l&&l[c]||(f=s=0)||a.pop();)if(1===l.nodeType&&++f&&l===e){r[h]=[k,s,f];break}}else if(p&&(i=(l=e)[E]||(l[E]={}),r=i[l.uniqueID]||(i[l.uniqueID]={}),o=r[h]||[],s=o[0]===k&&o[1],f=s),!1===f)for(;(l=++s&&l&&l[c]||(f=s=0)||a.pop())&&((y?l.nodeName.toLowerCase()!==d:1!==l.nodeType)||!++f||(p&&(i=l[E]||(l[E]={}),(r=i[l.uniqueID]||(i[l.uniqueID]={}))[h]=[k,f]),l!==e)););return(f-=m)===g||f%g==0&&0<=f/g}}},PSEUDO:function(e,i){var t,l=C.pseudos[e]||C.setFilters[e.toLowerCase()]||ie.error(\"unsupported pseudo: \"+e);return l[E]?l(i):1<l.length?(t=[e,e,\"\",i],C.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,t){for(var n,o=l(e,i),r=o.length;r--;)n=L(e,o[r]),e[n]=!(t[n]=o[r])}):function(e){return l(e,0,t)}):l}},pseudos:{not:se(function(e){var o=[],r=[],s=d(e.replace(V,\"$1\"));return s[E]?se(function(e,t,n,o){for(var r,i=s(e,null,o,[]),l=e.length;l--;)(r=i[l])&&(e[l]=!(t[l]=r))}):function(e,t,n){return o[0]=e,s(o,null,n,r),o[0]=null,!r.pop()}}),has:se(function(t){return function(e){return 0<ie(t,e).length}}),contains:se(function(t){return t=t.replace(Z,ee),function(e){return-1<(e.textContent||e.innerText||i(e)).indexOf(t)}}),lang:se(function(n){return X.test(n||\"\")||ie.error(\"unsupported lang: \"+n),n=n.replace(Z,ee).toLowerCase(),function(e){var t;do{if(t=S?e.lang:e.getAttribute(\"xml:lang\")||e.getAttribute(\"lang\"))return(t=t.toLowerCase())===n||0===t.indexOf(n+\"-\")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===l},focus:function(e){return e===R.activeElement&&(!R.hasFocus||R.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:fe(!1),disabled:fe(!0),checked:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&!!e.checked||\"option\"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&\"button\"===e.type||\"button\"===t},text:function(e){var t;return\"input\"===e.nodeName.toLowerCase()&&\"text\"===e.type&&(null==(t=e.getAttribute(\"type\"))||\"text\"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var o=n<0?n+t:n;0<=--o;)e.push(o);return e}),gt:he(function(e,t,n){for(var o=n<0?n+t:n;++o<t;)e.push(o);return e})}}).pseudos.nth=C.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})C.pseudos[e]=pe(e);function me(){}function ve(e){for(var t=0,n=e.length,o=\"\";t<n;t++)o+=e[t].value;return o}function we(s,e,t){var a=e.dir,c=e.next,u=c||a,d=t&&\"parentNode\"===u,p=o++;return e.first?function(e,t,n){for(;e=e[a];)if(1===e.nodeType||d)return s(e,t,n);return!1}:function(e,t,n){var o,r,i,l=[k,p];if(n){for(;e=e[a];)if((1===e.nodeType||d)&&s(e,t,n))return!0}else for(;e=e[a];)if(1===e.nodeType||d)if(i=e[E]||(e[E]={}),r=i[e.uniqueID]||(i[e.uniqueID]={}),c&&c===e.nodeName.toLowerCase())e=e[a]||e;else{if((o=r[u])&&o[0]===k&&o[1]===p)return l[2]=o[2];if((r[u]=l)[2]=s(e,t,n))return!0}return!1}}function ye(r){return 1<r.length?function(e,t,n){for(var o=r.length;o--;)if(!r[o](e,t,n))return!1;return!0}:r[0]}function Ce(e,t,n,o,r){for(var i,l=[],s=0,a=e.length,c=null!=t;s<a;s++)(i=e[s])&&(n&&!n(i,o,r)||(l.push(i),c&&t.push(s)));return l}function be(f,h,g,m,v,e){return m&&!m[E]&&(m=be(m)),v&&!v[E]&&(v=be(v,e)),se(function(e,t,n,o){var r,i,l,s=[],a=[],c=t.length,u=e||function(e,t,n){for(var o=0,r=t.length;o<r;o++)ie(e,t[o],n);return n}(h||\"*\",n.nodeType?[n]:n,[]),d=!f||!e&&h?u:Ce(u,s,f,n,o),p=g?v||(e?f:c||m)?[]:t:d;if(g&&g(d,p,n,o),m)for(r=Ce(p,a),m(r,[],n,o),i=r.length;i--;)(l=r[i])&&(p[a[i]]=!(d[a[i]]=l));if(e){if(v||f){if(v){for(r=[],i=p.length;i--;)(l=p[i])&&r.push(d[i]=l);v(null,p=[],r,o)}for(i=p.length;i--;)(l=p[i])&&-1<(r=v?L(e,l):s[i])&&(e[r]=!(t[r]=l))}}else p=Ce(p===t?p.splice(c,p.length):p),v?v(null,t,p,o):$.apply(t,p)})}function xe(e){for(var r,t,n,o=e.length,i=C.relative[e[0].type],l=i||C.relative[\" \"],s=i?1:0,a=we(function(e){return e===r},l,!0),c=we(function(e){return-1<L(r,e)},l,!0),u=[function(e,t,n){var o=!i&&(n||t!==b)||((r=t).nodeType?a(e,t,n):c(e,t,n));return r=null,o}];s<o;s++)if(t=C.relative[e[s].type])u=[we(ye(u),t)];else{if((t=C.filter[e[s].type].apply(null,e[s].matches))[E]){for(n=++s;n<o&&!C.relative[e[n].type];n++);return be(1<s&&ye(u),1<s&&ve(e.slice(0,s-1).concat({value:\" \"===e[s-2].type?\"*\":\"\"})).replace(V,\"$1\"),t,s<n&&xe(e.slice(s,n)),n<o&&xe(e=e.slice(n)),n<o&&ve(e))}u.push(t)}return ye(u)}return me.prototype=C.filters=C.pseudos,C.setFilters=new me,h=ie.tokenize=function(e,t){var n,o,r,i,l,s,a,c=y[e+\" \"];if(c)return t?0:c.slice(0);for(l=e,s=[],a=C.preFilter;l;){for(i in n&&!(o=B.exec(l))||(o&&(l=l.slice(o[0].length)||l),s.push(r=[])),n=!1,(o=q.exec(l))&&(n=o.shift(),r.push({value:n,type:o[0].replace(V,\" \")}),l=l.slice(n.length)),C.filter)!(o=U[i].exec(l))||a[i]&&!(o=a[i](o))||(n=o.shift(),r.push({value:n,type:i,matches:o}),l=l.slice(n.length));if(!n)break}return t?l.length:l?ie.error(e):y(e,s).slice(0)},d=ie.compile=function(e,t){var n,m,v,w,y,o,r=[],i=[],l=T[e+\" \"];if(!l){for(t||(t=h(e)),n=t.length;n--;)(l=xe(t[n]))[E]?r.push(l):i.push(l);(l=T(e,(m=i,w=0<(v=r).length,y=0<m.length,o=function(e,t,n,o,r){var i,l,s,a=0,c=\"0\",u=e&&[],d=[],p=b,f=e||y&&C.find.TAG(\"*\",r),h=k+=null==p?1:Math.random()||.1,g=f.length;for(r&&(b=t===R||t||r);c!==g&&null!=(i=f[c]);c++){if(y&&i){for(l=0,t||i.ownerDocument===R||(x(i),n=!S);s=m[l++];)if(s(i,t||R,n)){o.push(i);break}r&&(k=h)}w&&((i=!s&&i)&&a--,e&&u.push(i))}if(a+=c,w&&c!==a){for(l=0;s=v[l++];)s(u,d,t,n);if(e){if(0<a)for(;c--;)u[c]||d[c]||(d[c]=N.call(o));d=Ce(d)}$.apply(o,d),r&&!e&&0<d.length&&1<a+v.length&&ie.uniqueSort(o)}return r&&(k=h,b=p),u},w?se(o):o))).selector=e}return l},g=ie.select=function(e,t,n,o){var r,i,l,s,a,c=\"function\"==typeof e&&e,u=!o&&h(e=c.selector||e);if(n=n||[],1===u.length){if(2<(i=u[0]=u[0].slice(0)).length&&\"ID\"===(l=i[0]).type&&9===t.nodeType&&S&&C.relative[i[1].type]){if(!(t=(C.find.ID(l.matches[0].replace(Z,ee),t)||[])[0]))return n;c&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(r=U.needsContext.test(e)?0:i.length;r--&&(l=i[r],!C.relative[s=l.type]);)if((a=C.find[s])&&(o=a(l.matches[0].replace(Z,ee),J.test(i[0].type)&&ge(t.parentNode)||t))){if(i.splice(r,1),!(e=o.length&&ve(i)))return $.apply(n,o),n;break}}return(c||d(e,u))(o,t,!S,n,!t||J.test(e)&&ge(t.parentNode)||t),n},f.sortStable=E.split(\"\").sort(P).join(\"\")===E,f.detectDuplicates=!!c,x(),f.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(R.createElement(\"fieldset\"))}),ae(function(e){return e.innerHTML=\"<a href='#'></a>\",\"#\"===e.firstChild.getAttribute(\"href\")})||ce(\"type|href|height|width\",function(e,t,n){if(!n)return e.getAttribute(t,\"type\"===t.toLowerCase()?1:2)}),f.attributes&&ae(function(e){return e.innerHTML=\"<input/>\",e.firstChild.setAttribute(\"value\",\"\"),\"\"===e.firstChild.getAttribute(\"value\")})||ce(\"value\",function(e,t,n){if(!n&&\"input\"===e.nodeName.toLowerCase())return e.defaultValue}),ae(function(e){return null==e.getAttribute(\"disabled\")})||ce(_,function(e,t,n){var o;if(!n)return!0===e[t]?t.toLowerCase():(o=e.getAttributeNode(t))&&o.specified?o.value:null}),ie}(R);E.find=y,E.expr=y.selectors,E.expr[\":\"]=E.expr.pseudos,E.uniqueSort=E.unique=y.uniqueSort,E.text=y.getText,E.isXMLDoc=y.isXML,E.contains=y.contains,E.escapeSelector=y.escape;var C=function(e,t,n){for(var o=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&E(e).is(n))break;o.push(e)}return o},b=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},x=E.expr.match.needsContext;function k(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var T=/&#94;<([a-z][&#94;\\/\\0>:\\x20\\t\\r\\n\\f]*)[\\x20\\t\\r\\n\\f]*\\/?>(?:<\\/\\1>|)$/i,P=/&#94;.[&#94;:#\\[\\.,]*$/;function D(e,n,o){return E.isFunction(n)?E.grep(e,function(e,t){return!!n.call(e,t,e)!==o}):n.nodeType?E.grep(e,function(e){return e===n!==o}):\"string\"!=typeof n?E.grep(e,function(e){return-1<r.call(n,e)!==o}):P.test(n)?E.filter(n,e,o):(n=E.filter(n,e),E.grep(e,function(e){return-1<r.call(n,e)!==o&&1===e.nodeType}))}E.filter=function(e,t,n){var o=t[0];return n&&(e=\":not(\"+e+\")\"),1===t.length&&1===o.nodeType?E.find.matchesSelector(o,e)?[o]:[]:E.find.matches(e,E.grep(t,function(e){return 1===e.nodeType}))},E.fn.extend({find:function(e){var t,n,o=this.length,r=this;if(\"string\"!=typeof e)return this.pushStack(E(e).filter(function(){for(t=0;t<o;t++)if(E.contains(r[t],this))return!0}));for(n=this.pushStack([]),t=0;t<o;t++)E.find(e,r[t],n);return 1<o?E.uniqueSort(n):n},filter:function(e){return this.pushStack(D(this,e||[],!1))},not:function(e){return this.pushStack(D(this,e||[],!0))},is:function(e){return!!D(this,\"string\"==typeof e&&x.test(e)?E(e):e||[],!1).length}});var N,A=/&#94;(?:\\s*(<[\\w\\W]+>)[&#94;>]*|#([\\w-]+))$/,$=E.fn.init=function(e,t,n){var o,r;if(!e)return this;if(n=n||N,\"string\"==typeof e){if(!(o=\"<\"===e[0]&&\">\"===e[e.length-1]&&3<=e.length?[null,e,null]:A.exec(e))||!o[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(o[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:S,!0)),T.test(o[1])&&E.isPlainObject(t))for(o in t)E.isFunction(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}return(r=S.getElementById(o[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):E.isFunction(e)?void 0!==n.ready?n.ready(e):e(E):E.makeArray(e,this)};$.prototype=E.fn,N=E(S);var H=/&#94;(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};function _(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}E.fn.extend({has:function(e){var t=E(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(E.contains(this,t[e]))return!0})},closest:function(e,t){var n,o=0,r=this.length,i=[],l=\"string\"!=typeof e&&E(e);if(!x.test(e))for(;o<r;o++)for(n=this[o];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(l?-1<l.index(n):1===n.nodeType&&E.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(1<i.length?E.uniqueSort(i):i)},index:function(e){return e?\"string\"==typeof e?r.call(E(e),this[0]):r.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),E.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return C(e,\"parentNode\")},parentsUntil:function(e,t,n){return C(e,\"parentNode\",n)},next:function(e){return _(e,\"nextSibling\")},prev:function(e){return _(e,\"previousSibling\")},nextAll:function(e){return C(e,\"nextSibling\")},prevAll:function(e){return C(e,\"previousSibling\")},nextUntil:function(e,t,n){return C(e,\"nextSibling\",n)},prevUntil:function(e,t,n){return C(e,\"previousSibling\",n)},siblings:function(e){return b((e.parentNode||{}).firstChild,e)},children:function(e){return b(e.firstChild)},contents:function(e){return k(e,\"iframe\")?e.contentDocument:(k(e,\"template\")&&(e=e.content||e),E.merge([],e.childNodes))}},function(o,r){E.fn[o]=function(e,t){var n=E.map(this,r,e);return\"Until\"!==o.slice(-5)&&(t=e),t&&\"string\"==typeof t&&(n=E.filter(t,n)),1<this.length&&(L[o]||E.uniqueSort(n),H.test(o)&&n.reverse()),this.pushStack(n)}});var F=/[&#94;\\x20\\t\\r\\n\\f]+/g;function I(e){return e}function M(e){throw e}function W(e,t,n,o){var r;try{e&&E.isFunction(r=e.promise)?r.call(e).done(t).fail(n):e&&E.isFunction(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(o))}catch(e){n.apply(void 0,[e])}}E.Callbacks=function(o){var e,n;o=\"string\"==typeof o?(e=o,n={},E.each(e.match(F)||[],function(e,t){n[t]=!0}),n):E.extend({},o);var r,t,i,l,s=[],a=[],c=-1,u=function(){for(l=l||o.once,i=r=!0;a.length;c=-1)for(t=a.shift();++c<s.length;)!1===s[c].apply(t[0],t[1])&&o.stopOnFalse&&(c=s.length,t=!1);o.memory||(t=!1),r=!1,l&&(s=t?[]:\"\")},d={add:function(){return s&&(t&&!r&&(c=s.length-1,a.push(t)),function n(e){E.each(e,function(e,t){E.isFunction(t)?o.unique&&d.has(t)||s.push(t):t&&t.length&&\"string\"!==E.type(t)&&n(t)})}(arguments),t&&!r&&u()),this},remove:function(){return E.each(arguments,function(e,t){for(var n;-1<(n=E.inArray(t,s,n));)s.splice(n,1),n<=c&&c--}),this},has:function(e){return e?-1<E.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return l=a=[],s=t=\"\",this},disabled:function(){return!s},lock:function(){return l=a=[],t||r||(s=t=\"\"),this},locked:function(){return!!l},fireWith:function(e,t){return l||(t=[e,(t=t||[]).slice?t.slice():t],a.push(t),r||u()),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},E.extend({Deferred:function(e){var i=[[\"notify\",\"progress\",E.Callbacks(\"memory\"),E.Callbacks(\"memory\"),2],[\"resolve\",\"done\",E.Callbacks(\"once memory\"),E.Callbacks(\"once memory\"),0,\"resolved\"],[\"reject\",\"fail\",E.Callbacks(\"once memory\"),E.Callbacks(\"once memory\"),1,\"rejected\"]],r=\"pending\",l={state:function(){return r},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return l.then(null,e)},pipe:function(){var r=arguments;return E.Deferred(function(o){E.each(i,function(e,t){var n=E.isFunction(r[t[4]])&&r[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&E.isFunction(e.promise)?e.promise().progress(o.notify).done(o.resolve).fail(o.reject):o[t[0]+\"With\"](this,n?[e]:arguments)})}),r=null}).promise()},then:function(t,n,o){var a=0;function c(r,i,l,s){return function(){var n=this,o=arguments,e=function(){var e,t;if(!(r<a)){if((e=l.apply(n,o))===i.promise())throw new TypeError(\"Thenable self-resolution\");t=e&&(\"object\"==typeof e||\"function\"==typeof e)&&e.then,E.isFunction(t)?s?t.call(e,c(a,i,I,s),c(a,i,M,s)):(a++,t.call(e,c(a,i,I,s),c(a,i,M,s),c(a,i,I,i.notifyWith))):(l!==I&&(n=void 0,o=[e]),(s||i.resolveWith)(n,o))}},t=s?e:function(){try{e()}catch(e){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(e,t.stackTrace),a<=r+1&&(l!==M&&(n=void 0,o=[e]),i.rejectWith(n,o))}};r?t():(E.Deferred.getStackHook&&(t.stackTrace=E.Deferred.getStackHook()),R.setTimeout(t))}}return E.Deferred(function(e){i[0][3].add(c(0,e,E.isFunction(o)?o:I,e.notifyWith)),i[1][3].add(c(0,e,E.isFunction(t)?t:I)),i[2][3].add(c(0,e,E.isFunction(n)?n:M))}).promise()},promise:function(e){return null!=e?E.extend(e,l):l}},s={};return E.each(i,function(e,t){var n=t[2],o=t[5];l[t[1]]=n.add,o&&n.add(function(){r=o},i[3-e][2].disable,i[0][2].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+\"With\"](this===s?void 0:this,arguments),this},s[t[0]+\"With\"]=n.fireWith}),l.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,o=Array(t),r=s.call(arguments),i=E.Deferred(),l=function(t){return function(e){o[t]=this,r[t]=1<arguments.length?s.call(arguments):e,--n||i.resolveWith(o,r)}};if(n<=1&&(W(e,i.done(l(t)).resolve,i.reject,!n),\"pending\"===i.state()||E.isFunction(r[t]&&r[t].then)))return i.then();for(;t--;)W(r[t],l(t),i.reject);return i.promise()}});var j=/&#94;(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,t){R.console&&R.console.warn&&e&&j.test(e.name)&&R.console.warn(\"jQuery.Deferred exception: \"+e.message,e.stack,t)},E.readyException=function(e){R.setTimeout(function(){throw e})};var V=E.Deferred();function B(){S.removeEventListener(\"DOMContentLoaded\",B),R.removeEventListener(\"load\",B),E.ready()}E.fn.ready=function(e){return V.then(e).catch(function(e){E.readyException(e)}),this},E.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--E.readyWait:E.isReady)||(E.isReady=!0)!==e&&0<--E.readyWait||V.resolveWith(S,[E])}}),E.ready.then=V.then,\"complete\"===S.readyState||\"loading\"!==S.readyState&&!S.documentElement.doScroll?R.setTimeout(E.ready):(S.addEventListener(\"DOMContentLoaded\",B),R.addEventListener(\"load\",B));var q=function(e,t,n,o,r,i,l){var s=0,a=e.length,c=null==n;if(\"object\"===E.type(n))for(s in r=!0,n)q(e,t,s,n[s],!0,i,l);else if(void 0!==o&&(r=!0,E.isFunction(o)||(l=!0),c&&(l?(t.call(e,o),t=null):(c=t,t=function(e,t,n){return c.call(E(e),n)})),t))for(;s<a;s++)t(e[s],n,l?o:o.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):a?t(e[0],n):i},O=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function z(){this.expando=E.expando+z.uid++}z.uid=1,z.prototype={cache:function(e){var t=e[this.expando];return t||(t={},O(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var o,r=this.cache(e);if(\"string\"==typeof t)r[E.camelCase(t)]=n;else for(o in t)r[E.camelCase(o)]=t[o];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][E.camelCase(t)]},access:function(e,t,n){return void 0===t||t&&\"string\"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,o=e[this.expando];if(void 0!==o){if(void 0!==t){t=Array.isArray(t)?t.map(E.camelCase):(t=E.camelCase(t))in o?[t]:t.match(F)||[],n=t.length;for(;n--;)delete o[t[n]]}(void 0===t||E.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!E.isEmptyObject(t)}};var X=new z,U=new z,K=/&#94;(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,G=/[A-Z]/g;function Y(e,t,n){var o;if(void 0===n&&1===e.nodeType)if(o=\"data-\"+t.replace(G,\"-$&\").toLowerCase(),\"string\"==typeof(n=e.getAttribute(o))){try{n=function(e){if(\"true\"===e)return!0;if(\"false\"===e)return!1;if(\"null\"===e)return null;if(e===+e+\"\")return+e;if(K.test(e))return JSON.parse(e);return e}(n)}catch(e){}U.set(e,t,n)}else n=void 0;return n}E.extend({hasData:function(e){return U.hasData(e)||X.hasData(e)},data:function(e,t,n){return U.access(e,t,n)},removeData:function(e,t){U.remove(e,t)},_data:function(e,t,n){return X.access(e,t,n)},_removeData:function(e,t){X.remove(e,t)}}),E.fn.extend({data:function(n,e){var t,o,r,i=this[0],l=i&&i.attributes;if(void 0===n){if(this.length&&(r=U.get(i),1===i.nodeType&&!X.get(i,\"hasDataAttrs\"))){for(t=l.length;t--;)l[t]&&0===(o=l[t].name).indexOf(\"data-\")&&(o=E.camelCase(o.slice(5)),Y(i,o,r[o]));X.set(i,\"hasDataAttrs\",!0)}return r}return\"object\"==typeof n?this.each(function(){U.set(this,n)}):q(this,function(e){var t;if(i&&void 0===e)return void 0!==(t=U.get(i,n))?t:void 0!==(t=Y(i,n))?t:void 0;this.each(function(){U.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){U.remove(this,e)})}}),E.extend({queue:function(e,t,n){var o;if(e)return t=(t||\"fx\")+\"queue\",o=X.get(e,t),n&&(!o||Array.isArray(n)?o=X.access(e,t,E.makeArray(n)):o.push(n)),o||[]},dequeue:function(e,t){t=t||\"fx\";var n=E.queue(e,t),o=n.length,r=n.shift(),i=E._queueHooks(e,t);\"inprogress\"===r&&(r=n.shift(),o--),r&&(\"fx\"===t&&n.unshift(\"inprogress\"),delete i.stop,r.call(e,function(){E.dequeue(e,t)},i)),!o&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+\"queueHooks\";return X.get(e,n)||X.access(e,n,{empty:E.Callbacks(\"once memory\").add(function(){X.remove(e,[t+\"queue\",n])})})}}),E.fn.extend({queue:function(t,n){var e=2;return\"string\"!=typeof t&&(n=t,t=\"fx\",e--),arguments.length<e?E.queue(this[0],t):void 0===n?this:this.each(function(){var e=E.queue(this,t,n);E._queueHooks(this,t),\"fx\"===t&&\"inprogress\"!==e[0]&&E.dequeue(this,t)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||\"fx\",[])},promise:function(e,t){var n,o=1,r=E.Deferred(),i=this,l=this.length,s=function(){--o||r.resolveWith(i,[i])};for(\"string\"!=typeof e&&(t=e,e=void 0),e=e||\"fx\";l--;)(n=X.get(i[l],e+\"queueHooks\"))&&n.empty&&(o++,n.empty.add(s));return s(),r.promise(t)}});var Q=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,J=new RegExp(\"&#94;(?:([+-])=|)(\"+Q+\")([a-z%]*)$\",\"i\"),Z=[\"Top\",\"Right\",\"Bottom\",\"Left\"],ee=function(e,t){return\"none\"===(e=t||e).style.display||\"\"===e.style.display&&E.contains(e.ownerDocument,e)&&\"none\"===E.css(e,\"display\")},te=function(e,t,n,o){var r,i,l={};for(i in t)l[i]=e.style[i],e.style[i]=t[i];for(i in r=n.apply(e,o||[]),t)e.style[i]=l[i];return r};function ne(e,t,n,o){var r,i=1,l=20,s=o?function(){return o.cur()}:function(){return E.css(e,t,\"\")},a=s(),c=n&&n[3]||(E.cssNumber[t]?\"\":\"px\"),u=(E.cssNumber[t]||\"px\"!==c&&+a)&&J.exec(E.css(e,t));if(u&&u[3]!==c)for(c=c||u[3],n=n||[],u=+a||1;u/=i=i||\".5\",E.style(e,t,u+c),i!==(i=s()/a)&&1!==i&&--l;);return n&&(u=+u||+a||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],o&&(o.unit=c,o.start=u,o.end=r)),r}var oe={};function re(e){var t,n=e.ownerDocument,o=e.nodeName,r=oe[o];return r||(t=n.body.appendChild(n.createElement(o)),r=E.css(t,\"display\"),t.parentNode.removeChild(t),\"none\"===r&&(r=\"block\"),oe[o]=r)}function ie(e,t){for(var n,o,r=[],i=0,l=e.length;i<l;i++)(o=e[i]).style&&(n=o.style.display,t?(\"none\"===n&&(r[i]=X.get(o,\"display\")||null,r[i]||(o.style.display=\"\")),\"\"===o.style.display&&ee(o)&&(r[i]=re(o))):\"none\"!==n&&(r[i]=\"none\",X.set(o,\"display\",n)));for(i=0;i<l;i++)null!=r[i]&&(e[i].style.display=r[i]);return e}E.fn.extend({show:function(){return ie(this,!0)},hide:function(){return ie(this)},toggle:function(e){return\"boolean\"==typeof e?e?this.show():this.hide():this.each(function(){ee(this)?E(this).show():E(this).hide()})}});var le=/&#94;(?:checkbox|radio)$/i,se=/<([a-z][&#94;\\/\\0>\\x20\\t\\r\\n\\f]+)/i,ae=/&#94;$|\\/(?:java|ecma)script/i,ce={option:[1,\"<select multiple='multiple'>\",\"</select>\"],thead:[1,\"<table class=\"table table-striped table-bordered table-hover\">\",\"</table>\"],col:[2,\"<table class=\"table table-striped table-bordered table-hover\"><colgroup>\",\"</colgroup></table>\"],tr:[2,\"<table class=\"table table-striped table-bordered table-hover\"><tbody>\",\"</tbody></table>\"],td:[3,\"<table class=\"table table-striped table-bordered table-hover\"><tbody><tr>\",\"</tr></tbody></table>\"],_default:[0,\"\",\"\"]};function ue(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||\"*\"):void 0!==e.querySelectorAll?e.querySelectorAll(t||\"*\"):[],void 0===t||t&&k(e,t)?E.merge([e],n):n}function de(e,t){for(var n=0,o=e.length;n<o;n++)X.set(e[n],\"globalEval\",!t||X.get(t[n],\"globalEval\"))}ce.optgroup=ce.option,ce.tbody=ce.tfoot=ce.colgroup=ce.caption=ce.thead,ce.th=ce.td;var pe,fe,he,ge=/<|&#?\\w+;/;function me(e,t,n,o,r){for(var i,l,s,a,c,u,d=t.createDocumentFragment(),p=[],f=0,h=e.length;f<h;f++)if((i=e[f])||0===i)if(\"object\"===E.type(i))E.merge(p,i.nodeType?[i]:i);else if(ge.test(i)){for(l=l||d.appendChild(t.createElement(\"div\")),s=(se.exec(i)||[\"\",\"\"])[1].toLowerCase(),a=ce[s]||ce._default,l.innerHTML=a[1]+E.htmlPrefilter(i)+a[2],u=a[0];u--;)l=l.lastChild;E.merge(p,l.childNodes),(l=d.firstChild).textContent=\"\"}else p.push(t.createTextNode(i));for(d.textContent=\"\",f=0;i=p[f++];)if(o&&-1<E.inArray(i,o))r&&r.push(i);else if(c=E.contains(i.ownerDocument,i),l=ue(d.appendChild(i),\"script\"),c&&de(l),n)for(u=0;i=l[u++];)ae.test(i.type||\"\")&&n.push(i);return d}pe=S.createDocumentFragment(),fe=pe.appendChild(S.createElement(\"div\")),(he=S.createElement(\"input\")).setAttribute(\"type\",\"radio\"),he.setAttribute(\"checked\",\"checked\"),he.setAttribute(\"name\",\"t\"),fe.appendChild(he),m.checkClone=fe.cloneNode(!0).cloneNode(!0).lastChild.checked,fe.innerHTML=\"<textarea>x</textarea>\",m.noCloneChecked=!!fe.cloneNode(!0).lastChild.defaultValue;var ve=S.documentElement,we=/&#94;key/,ye=/&#94;(?:mouse|pointer|contextmenu|drag|drop)|click/,Ce=/&#94;([&#94;.]*)(?:\\.(.+)|)/;function be(){return!0}function xe(){return!1}function Re(){try{return S.activeElement}catch(e){}}function Se(e,t,n,o,r,i){var l,s;if(\"object\"==typeof t){for(s in\"string\"!=typeof n&&(o=o||n,n=void 0),t)Se(e,s,n,o,t[s],i);return e}if(null==o&&null==r?(r=n,o=n=void 0):null==r&&(\"string\"==typeof n?(r=o,o=void 0):(r=o,o=n,n=void 0)),!1===r)r=xe;else if(!r)return e;return 1===i&&(l=r,(r=function(e){return E().off(e),l.apply(this,arguments)}).guid=l.guid||(l.guid=E.guid++)),e.each(function(){E.event.add(this,t,r,o,n)})}E.event={global:{},add:function(t,e,n,o,r){var i,l,s,a,c,u,d,p,f,h,g,m=X.get(t);if(m)for(n.handler&&(n=(i=n).handler,r=i.selector),r&&E.find.matchesSelector(ve,r),n.guid||(n.guid=E.guid++),(a=m.events)||(a=m.events={}),(l=m.handle)||(l=m.handle=function(e){return void 0!==E&&E.event.triggered!==e.type?E.event.dispatch.apply(t,arguments):void 0}),e=(e||\"\").match(F)||[\"\"],c=e.length;c--;)s=Ce.exec(e[c])||[],f=g=s[1],h=(s[2]||\"\").split(\".\").sort(),f&&(d=E.event.special[f]||{},f=(r?d.delegateType:d.bindType)||f,d=E.event.special[f]||{},u=E.extend({type:f,origType:g,data:o,handler:n,guid:n.guid,selector:r,needsContext:r&&E.expr.match.needsContext.test(r),namespace:h.join(\".\")},i),(p=a[f])||((p=a[f]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,o,h,l)||t.addEventListener&&t.addEventListener(f,l)),d.add&&(d.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?p.splice(p.delegateCount++,0,u):p.push(u),E.event.global[f]=!0)},remove:function(e,t,n,o,r){var i,l,s,a,c,u,d,p,f,h,g,m=X.hasData(e)&&X.get(e);if(m&&(a=m.events)){for(t=(t||\"\").match(F)||[\"\"],c=t.length;c--;)if(s=Ce.exec(t[c])||[],f=g=s[1],h=(s[2]||\"\").split(\".\").sort(),f){for(d=E.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,p=a[f]||[],s=s[2]&&new RegExp(\"(&#94;|\\\\.)\"+h.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),l=i=p.length;i--;)u=p[i],!r&&g!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||o&&o!==u.selector&&(\"**\"!==o||!u.selector)||(p.splice(i,1),u.selector&&p.delegateCount--,d.remove&&d.remove.call(e,u));l&&!p.length&&(d.teardown&&!1!==d.teardown.call(e,h,m.handle)||E.removeEvent(e,f,m.handle),delete a[f])}else for(f in a)E.event.remove(e,f+t[c],n,o,!0);E.isEmptyObject(a)&&X.remove(e,\"handle events\")}},dispatch:function(e){var t,n,o,r,i,l,s=E.event.fix(e),a=new Array(arguments.length),c=(X.get(this,\"events\")||{})[s.type]||[],u=E.event.special[s.type]||{};for(a[0]=s,t=1;t<arguments.length;t++)a[t]=arguments[t];if(s.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,s)){for(l=E.event.handlers.call(this,s,c),t=0;(r=l[t++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(i.namespace)||(s.handleObj=i,s.data=i.data,void 0!==(o=((E.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,a))&&!1===(s.result=o)&&(s.preventDefault(),s.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,o,r,i,l,s=[],a=t.delegateCount,c=e.target;if(a&&c.nodeType&&!(\"click\"===e.type&&1<=e.button))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&(\"click\"!==e.type||!0!==c.disabled)){for(i=[],l={},n=0;n<a;n++)o=t[n],r=o.selector+\" \",void 0===l[r]&&(l[r]=o.needsContext?-1<E(r,this).index(c):E.find(r,this,null,[c]).length),l[r]&&i.push(o);i.length&&s.push({elem:c,handlers:i})}return c=this,a<t.length&&s.push({elem:c,handlers:t.slice(a)}),s},addProp:function(t,e){Object.defineProperty(E.Event.prototype,t,{enumerable:!0,configurable:!0,get:E.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[E.expando]?e:new E.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Re()&&this.focus)return this.focus(),!1},delegateType:\"focusin\"},blur:{trigger:function(){if(this===Re()&&this.blur)return this.blur(),!1},delegateType:\"focusout\"},click:{trigger:function(){if(\"checkbox\"===this.type&&this.click&&k(this,\"input\"))return this.click(),!1},_default:function(e){return k(e.target,\"a\")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},E.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},E.Event=function(e,t){if(!(this instanceof E.Event))return new E.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?be:xe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||E.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:xe,isPropagationStopped:xe,isImmediatePropagationStopped:xe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=be,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=be,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=be,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&ye.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},E.event.addProp),E.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\",pointerenter:\"pointerover\",pointerleave:\"pointerout\"},function(e,r){E.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,n=e.relatedTarget,o=e.handleObj;return n&&(n===this||E.contains(this,n))||(e.type=o.origType,t=o.handler.apply(this,arguments),e.type=r),t}}}),E.fn.extend({on:function(e,t,n,o){return Se(this,e,t,n,o)},one:function(e,t,n,o){return Se(this,e,t,n,o,1)},off:function(e,t,n){var o,r;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,E(e.delegateTarget).off(o.namespace?o.origType+\".\"+o.namespace:o.origType,o.selector,o.handler),this;if(\"object\"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&\"function\"!=typeof t||(n=t,t=void 0),!1===n&&(n=xe),this.each(function(){E.event.remove(this,e,n,t)})}});var Ee=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][&#94;\\/\\0>\\x20\\t\\r\\n\\f]*)[&#94;>]*)\\/>/gi,ke=/<script|<style|<link/i,Te=/checked\\s*(?:[&#94;=]|=\\s*.checked.)/i,Pe=/&#94;true\\/(.*)/,De=/&#94;\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g;function Ne(e,t){return k(e,\"table\")&&k(11!==t.nodeType?t:t.firstChild,\"tr\")&&E(\">tbody\",e)[0]||e}function Ae(e){return e.type=(null!==e.getAttribute(\"type\"))+\"/\"+e.type,e}function $e(e){var t=Pe.exec(e.type);return t?e.type=t[1]:e.removeAttribute(\"type\"),e}function He(e,t){var n,o,r,i,l,s,a,c;if(1===t.nodeType){if(X.hasData(e)&&(i=X.access(e),l=X.set(t,i),c=i.events))for(r in delete l.handle,l.events={},c)for(n=0,o=c[r].length;n<o;n++)E.event.add(t,r,c[r][n]);U.hasData(e)&&(s=U.access(e),a=E.extend({},s),U.set(t,a))}}function Le(e,t){var n=t.nodeName.toLowerCase();\"input\"===n&&le.test(e.type)?t.checked=e.checked:\"input\"!==n&&\"textarea\"!==n||(t.defaultValue=e.defaultValue)}function _e(n,o,r,i){o=g.apply([],o);var e,t,l,s,a,c,u=0,d=n.length,p=d-1,f=o[0],h=E.isFunction(f);if(h||1<d&&\"string\"==typeof f&&!m.checkClone&&Te.test(f))return n.each(function(e){var t=n.eq(e);h&&(o[0]=f.call(this,e,t.html())),_e(t,o,r,i)});if(d&&(e=me(o,n[0].ownerDocument,!1,n,i),t=e.firstChild,1===e.childNodes.length&&(e=t),t||i)){for(l=E.map(ue(e,\"script\"),Ae),s=l.length;u<d;u++)a=e,u!==p&&(a=E.clone(a,!0,!0),s&&E.merge(l,ue(a,\"script\"))),r.call(n[u],a,u);if(s)for(c=l[l.length-1].ownerDocument,E.map(l,$e),u=0;u<s;u++)a=l[u],ae.test(a.type||\"\")&&!X.access(a,\"globalEval\")&&E.contains(c,a)&&(a.src?E._evalUrl&&E._evalUrl(a.src):v(a.textContent.replace(De,\"\"),c))}return n}function Fe(e,t,n){for(var o,r=t?E.filter(t,e):e,i=0;null!=(o=r[i]);i++)n||1!==o.nodeType||E.cleanData(ue(o)),o.parentNode&&(n&&E.contains(o.ownerDocument,o)&&de(ue(o,\"script\")),o.parentNode.removeChild(o));return e}E.extend({htmlPrefilter:function(e){return e.replace(Ee,\"<$1></$2>\")},clone:function(e,t,n){var o,r,i,l,s=e.cloneNode(!0),a=E.contains(e.ownerDocument,e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(l=ue(s),i=ue(e),o=0,r=i.length;o<r;o++)Le(i[o],l[o]);if(t)if(n)for(i=i||ue(e),l=l||ue(s),o=0,r=i.length;o<r;o++)He(i[o],l[o]);else He(e,s);return 0<(l=ue(s,\"script\")).length&&de(l,!a&&ue(e,\"script\")),s},cleanData:function(e){for(var t,n,o,r=E.event.special,i=0;void 0!==(n=e[i]);i++)if(O(n)){if(t=n[X.expando]){if(t.events)for(o in t.events)r[o]?E.event.remove(n,o):E.removeEvent(n,o,t.handle);n[X.expando]=void 0}n[U.expando]&&(n[U.expando]=void 0)}}}),E.fn.extend({detach:function(e){return Fe(this,e,!0)},remove:function(e){return Fe(this,e)},text:function(e){return q(this,function(e){return void 0===e?E.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return _e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ne(this,e);t.appendChild(e)}})},prepend:function(){return _e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ne(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return _e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return _e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(E.cleanData(ue(e,!1)),e.textContent=\"\");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return E.clone(this,e,t)})},html:function(e){return q(this,function(e){var t=this[0]||{},n=0,o=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if(\"string\"==typeof e&&!ke.test(e)&&!ce[(se.exec(e)||[\"\",\"\"])[1].toLowerCase()]){e=E.htmlPrefilter(e);try{for(;n<o;n++)1===(t=this[n]||{}).nodeType&&(E.cleanData(ue(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return _e(this,arguments,function(e){var t=this.parentNode;E.inArray(this,n)<0&&(E.cleanData(ue(this)),t&&t.replaceChild(e,this))},n)}}),E.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(e,l){E.fn[e]=function(e){for(var t,n=[],o=E(e),r=o.length-1,i=0;i<=r;i++)t=i===r?this:this.clone(!0),E(o[i])[l](t),a.apply(n,t.get());return this.pushStack(n)}});var Ie=/&#94;margin/,Me=new RegExp(\"&#94;(\"+Q+\")(?!px)[a-z%]+$\",\"i\"),We=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=R),t.getComputedStyle(e)};function je(e,t,n){var o,r,i,l,s=e.style;return(n=n||We(e))&&(\"\"!==(l=n.getPropertyValue(t)||n[t])||E.contains(e.ownerDocument,e)||(l=E.style(e,t)),!m.pixelMarginRight()&&Me.test(l)&&Ie.test(t)&&(o=s.width,r=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=l,l=n.width,s.width=o,s.minWidth=r,s.maxWidth=i)),void 0!==l?l+\"\":l}function Ve(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){l.style.cssText=\"box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%\",l.innerHTML=\"\",ve.appendChild(i);var e=R.getComputedStyle(l);t=\"1%\"!==e.top,r=\"2px\"===e.marginLeft,n=\"4px\"===e.width,l.style.marginRight=\"50%\",o=\"4px\"===e.marginRight,ve.removeChild(i),l=null}}var t,n,o,r,i=S.createElement(\"div\"),l=S.createElement(\"div\");l.style&&(l.style.backgroundClip=\"content-box\",l.cloneNode(!0).style.backgroundClip=\"\",m.clearCloneStyle=\"content-box\"===l.style.backgroundClip,i.style.cssText=\"border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute\",i.appendChild(l),E.extend(m,{pixelPosition:function(){return e(),t},boxSizingReliable:function(){return e(),n},pixelMarginRight:function(){return e(),o},reliableMarginLeft:function(){return e(),r}}))}();var Be=/&#94;(none|table(?!-c[ea]).+)/,qe=/&#94;--/,Oe={position:\"absolute\",visibility:\"hidden\",display:\"block\"},ze={letterSpacing:\"0\",fontWeight:\"400\"},Xe=[\"Webkit\",\"Moz\",\"ms\"],Ue=S.createElement(\"div\").style;function Ke(e){var t=E.cssProps[e];return t||(t=E.cssProps[e]=function(e){if(e in Ue)return e;var t=e[0].toUpperCase()+e.slice(1),n=Xe.length;for(;n--;)if((e=Xe[n]+t)in Ue)return e}(e)||e),t}function Ge(e,t,n){var o=J.exec(t);return o?Math.max(0,o[2]-(n||0))+(o[3]||\"px\"):t}function Ye(e,t,n,o,r){var i,l=0;for(i=n===(o?\"border\":\"content\")?4:\"width\"===t?1:0;i<4;i+=2)\"margin\"===n&&(l+=E.css(e,n+Z[i],!0,r)),o?(\"content\"===n&&(l-=E.css(e,\"padding\"+Z[i],!0,r)),\"margin\"!==n&&(l-=E.css(e,\"border\"+Z[i]+\"Width\",!0,r))):(l+=E.css(e,\"padding\"+Z[i],!0,r),\"padding\"!==n&&(l+=E.css(e,\"border\"+Z[i]+\"Width\",!0,r)));return l}function Qe(e,t,n){var o,r=We(e),i=je(e,t,r),l=\"border-box\"===E.css(e,\"boxSizing\",!1,r);return Me.test(i)?i:(o=l&&(m.boxSizingReliable()||i===e.style[t]),\"auto\"===i&&(i=e[\"offset\"+t[0].toUpperCase()+t.slice(1)]),(i=parseFloat(i)||0)+Ye(e,t,n||(l?\"border\":\"content\"),o,r)+\"px\")}function Je(e,t,n,o,r){return new Je.prototype.init(e,t,n,o,r)}E.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=je(e,\"opacity\");return\"\"===n?\"1\":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:\"cssFloat\"},style:function(e,t,n,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,i,l,s=E.camelCase(t),a=qe.test(t),c=e.style;if(a||(t=Ke(s)),l=E.cssHooks[t]||E.cssHooks[s],void 0===n)return l&&\"get\"in l&&void 0!==(r=l.get(e,!1,o))?r:c[t];\"string\"===(i=typeof n)&&(r=J.exec(n))&&r[1]&&(n=ne(e,t,r),i=\"number\"),null!=n&&n==n&&(\"number\"===i&&(n+=r&&r[3]||(E.cssNumber[s]?\"\":\"px\")),m.clearCloneStyle||\"\"!==n||0!==t.indexOf(\"background\")||(c[t]=\"inherit\"),l&&\"set\"in l&&void 0===(n=l.set(e,n,o))||(a?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,o){var r,i,l,s=E.camelCase(t),a=qe.test(t);return a||(t=Ke(s)),(l=E.cssHooks[t]||E.cssHooks[s])&&\"get\"in l&&(r=l.get(e,!0,n)),void 0===r&&(r=je(e,t,o)),\"normal\"===r&&t in ze&&(r=ze[t]),\"\"===n||n?(i=parseFloat(r),!0===n||isFinite(i)?i||0:r):r}}),E.each([\"height\",\"width\"],function(e,l){E.cssHooks[l]={get:function(e,t,n){if(t)return!Be.test(E.css(e,\"display\"))||e.getClientRects().length&&e.getBoundingClientRect().width?Qe(e,l,n):te(e,Oe,function(){return Qe(e,l,n)})},set:function(e,t,n){var o,r=n&&We(e),i=n&&Ye(e,l,n,\"border-box\"===E.css(e,\"boxSizing\",!1,r),r);return i&&(o=J.exec(t))&&\"px\"!==(o[3]||\"px\")&&(e.style[l]=t,t=E.css(e,l)),Ge(e,t,i)}}}),E.cssHooks.marginLeft=Ve(m.reliableMarginLeft,function(e,t){if(t)return(parseFloat(je(e,\"marginLeft\"))||e.getBoundingClientRect().left-te(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+\"px\"}),E.each({margin:\"\",padding:\"\",border:\"Width\"},function(r,i){E.cssHooks[r+i]={expand:function(e){for(var t=0,n={},o=\"string\"==typeof e?e.split(\" \"):[e];t<4;t++)n[r+Z[t]+i]=o[t]||o[t-2]||o[0];return n}},Ie.test(r)||(E.cssHooks[r+i].set=Ge)}),E.fn.extend({css:function(e,t){return q(this,function(e,t,n){var o,r,i={},l=0;if(Array.isArray(t)){for(o=We(e),r=t.length;l<r;l++)i[t[l]]=E.css(e,t[l],!1,o);return i}return void 0!==n?E.style(e,t,n):E.css(e,t)},e,t,1<arguments.length)}}),((E.Tween=Je).prototype={constructor:Je,init:function(e,t,n,o,r,i){this.elem=e,this.prop=n,this.easing=r||E.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=o,this.unit=i||(E.cssNumber[n]?\"\":\"px\")},cur:function(){var e=Je.propHooks[this.prop];return e&&e.get?e.get(this):Je.propHooks._default.get(this)},run:function(e){var t,n=Je.propHooks[this.prop];return this.options.duration?this.pos=t=E.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Je.propHooks._default.set(this),this}}).init.prototype=Je.prototype,(Je.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=E.css(e.elem,e.prop,\"\"))&&\"auto\"!==t?t:0},set:function(e){E.fx.step[e.prop]?E.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[E.cssProps[e.prop]]&&!E.cssHooks[e.prop]?e.elem[e.prop]=e.now:E.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Je.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},E.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:\"swing\"},E.fx=Je.prototype.init,E.fx.step={};var Ze,et,tt,nt,ot,rt=/&#94;(?:toggle|show|hide)$/,it=/queueHooks$/;function lt(){et&&(!1===S.hidden&&R.requestAnimationFrame?R.requestAnimationFrame(lt):R.setTimeout(lt,E.fx.interval),E.fx.tick())}function st(){return R.setTimeout(function(){Ze=void 0}),Ze=E.now()}function at(e,t){var n,o=0,r={height:e};for(t=t?1:0;o<4;o+=2-t)n=Z[o],r[\"margin\"+n]=r[\"padding\"+n]=e;return t&&(r.opacity=r.width=e),r}function ct(e,t,n){for(var o,r=(ut.tweeners[t]||[]).concat(ut.tweeners[\"*\"]),i=0,l=r.length;i<l;i++)if(o=r[i].call(n,t,e))return o}function ut(l,e,t){var n,s,o=0,r=ut.prefilters.length,a=E.Deferred().always(function(){delete i.elem}),i=function(){if(s)return!1;for(var e=Ze||st(),t=Math.max(0,c.startTime+c.duration-e),n=t/c.duration||0,o=1-n,r=0,i=c.tweens.length;r<i;r++)c.tweens[r].run(o);return a.notifyWith(l,[c,o,t]),o<1&&i?t:(i||a.notifyWith(l,[c,1,0]),a.resolveWith(l,[c]),!1)},c=a.promise({elem:l,props:E.extend({},e),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||st(),duration:t.duration,tweens:[],createTween:function(e,t){var n=E.Tween(l,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var t=0,n=e?c.tweens.length:0;if(s)return this;for(s=!0;t<n;t++)c.tweens[t].run(1);return e?(a.notifyWith(l,[c,1,0]),a.resolveWith(l,[c,e])):a.rejectWith(l,[c,e]),this}}),u=c.props;for(!function(e,t){var n,o,r,i,l;for(n in e)if(o=E.camelCase(n),r=t[o],i=e[n],Array.isArray(i)&&(r=i[1],i=e[n]=i[0]),n!==o&&(e[o]=i,delete e[n]),(l=E.cssHooks[o])&&\"expand\"in l)for(n in i=l.expand(i),delete e[o],i)n in e||(e[n]=i[n],t[n]=r);else t[o]=r}(u,c.opts.specialEasing);o<r;o++)if(n=ut.prefilters[o].call(c,l,u,c.opts))return E.isFunction(n.stop)&&(E._queueHooks(c.elem,c.opts.queue).stop=E.proxy(n.stop,n)),n;return E.map(u,ct,c),E.isFunction(c.opts.start)&&c.opts.start.call(l,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),E.fx.timer(E.extend(i,{elem:l,anim:c,queue:c.opts.queue})),c}E.Animation=E.extend(ut,{tweeners:{\"*\":[function(e,t){var n=this.createTween(e,t);return ne(n.elem,e,J.exec(t),n),n}]},tweener:function(e,t){E.isFunction(e)?(t=e,e=[\"*\"]):e=e.match(F);for(var n,o=0,r=e.length;o<r;o++)n=e[o],ut.tweeners[n]=ut.tweeners[n]||[],ut.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var o,r,i,l,s,a,c,u,d=\"width\"in t||\"height\"in t,p=this,f={},h=e.style,g=e.nodeType&&ee(e),m=X.get(e,\"fxshow\");n.queue||(null==(l=E._queueHooks(e,\"fx\")).unqueued&&(l.unqueued=0,s=l.empty.fire,l.empty.fire=function(){l.unqueued||s()}),l.unqueued++,p.always(function(){p.always(function(){l.unqueued--,E.queue(e,\"fx\").length||l.empty.fire()})}));for(o in t)if(r=t[o],rt.test(r)){if(delete t[o],i=i||\"toggle\"===r,r===(g?\"hide\":\"show\")){if(\"show\"!==r||!m||void 0===m[o])continue;g=!0}f[o]=m&&m[o]||E.style(e,o)}if(!(a=!E.isEmptyObject(t))&&E.isEmptyObject(f))return;d&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(c=m&&m.display)&&(c=X.get(e,\"display\")),\"none\"===(u=E.css(e,\"display\"))&&(c?u=c:(ie([e],!0),c=e.style.display||c,u=E.css(e,\"display\"),ie([e]))),(\"inline\"===u||\"inline-block\"===u&&null!=c)&&\"none\"===E.css(e,\"float\")&&(a||(p.done(function(){h.display=c}),null==c&&(u=h.display,c=\"none\"===u?\"\":u)),h.display=\"inline-block\"));n.overflow&&(h.overflow=\"hidden\",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(o in a=!1,f)a||(m?\"hidden\"in m&&(g=m.hidden):m=X.access(e,\"fxshow\",{display:c}),i&&(m.hidden=!g),g&&ie([e],!0),p.done(function(){for(o in g||ie([e]),X.remove(e,\"fxshow\"),f)E.style(e,o,f[o])})),a=ct(g?m[o]:0,o,p),o in m||(m[o]=a.start,g&&(a.end=a.start,a.start=0))}],prefilter:function(e,t){t?ut.prefilters.unshift(e):ut.prefilters.push(e)}}),E.speed=function(e,t,n){var o=e&&\"object\"==typeof e?E.extend({},e):{complete:n||!n&&t||E.isFunction(e)&&e,duration:e,easing:n&&t||t&&!E.isFunction(t)&&t};return E.fx.off?o.duration=0:\"number\"!=typeof o.duration&&(o.duration in E.fx.speeds?o.duration=E.fx.speeds[o.duration]:o.duration=E.fx.speeds._default),null!=o.queue&&!0!==o.queue||(o.queue=\"fx\"),o.old=o.complete,o.complete=function(){E.isFunction(o.old)&&o.old.call(this),o.queue&&E.dequeue(this,o.queue)},o},E.fn.extend({fadeTo:function(e,t,n,o){return this.filter(ee).css(\"opacity\",0).show().end().animate({opacity:t},e,n,o)},animate:function(t,e,n,o){var r=E.isEmptyObject(t),i=E.speed(e,n,o),l=function(){var e=ut(this,E.extend({},t),i);(r||X.get(this,\"finish\"))&&e.stop(!0)};return l.finish=l,r||!1===i.queue?this.each(l):this.queue(i.queue,l)},stop:function(r,e,i){var l=function(e){var t=e.stop;delete e.stop,t(i)};return\"string\"!=typeof r&&(i=e,e=r,r=void 0),e&&!1!==r&&this.queue(r||\"fx\",[]),this.each(function(){var e=!0,t=null!=r&&r+\"queueHooks\",n=E.timers,o=X.get(this);if(t)o[t]&&o[t].stop&&l(o[t]);else for(t in o)o[t]&&o[t].stop&&it.test(t)&&l(o[t]);for(t=n.length;t--;)n[t].elem!==this||null!=r&&n[t].queue!==r||(n[t].anim.stop(i),e=!1,n.splice(t,1));!e&&i||E.dequeue(this,r)})},finish:function(l){return!1!==l&&(l=l||\"fx\"),this.each(function(){var e,t=X.get(this),n=t[l+\"queue\"],o=t[l+\"queueHooks\"],r=E.timers,i=n?n.length:0;for(t.finish=!0,E.queue(this,l,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===l&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<i;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),E.each([\"toggle\",\"show\",\"hide\"],function(e,o){var r=E.fn[o];E.fn[o]=function(e,t,n){return null==e||\"boolean\"==typeof e?r.apply(this,arguments):this.animate(at(o,!0),e,t,n)}}),E.each({slideDown:at(\"show\"),slideUp:at(\"hide\"),slideToggle:at(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(e,o){E.fn[e]=function(e,t,n){return this.animate(o,e,t,n)}}),E.timers=[],E.fx.tick=function(){var e,t=0,n=E.timers;for(Ze=E.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||E.fx.stop(),Ze=void 0},E.fx.timer=function(e){E.timers.push(e),E.fx.start()},E.fx.interval=13,E.fx.start=function(){et||(et=!0,lt())},E.fx.stop=function(){et=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(o,e){return o=E.fx&&E.fx.speeds[o]||o,e=e||\"fx\",this.queue(e,function(e,t){var n=R.setTimeout(e,o);t.stop=function(){R.clearTimeout(n)}})},tt=S.createElement(\"input\"),nt=S.createElement(\"select\"),ot=nt.appendChild(S.createElement(\"option\")),tt.type=\"checkbox\",m.checkOn=\"\"!==tt.value,m.optSelected=ot.selected,(tt=S.createElement(\"input\")).value=\"t\",tt.type=\"radio\",m.radioValue=\"t\"===tt.value;var dt,pt=E.expr.attrHandle;E.fn.extend({attr:function(e,t){return q(this,E.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){E.removeAttr(this,e)})}}),E.extend({attr:function(e,t,n){var o,r,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?E.prop(e,t,n):(1===i&&E.isXMLDoc(e)||(r=E.attrHooks[t.toLowerCase()]||(E.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void E.removeAttr(e,t):r&&\"set\"in r&&void 0!==(o=r.set(e,n,t))?o:(e.setAttribute(t,n+\"\"),n):r&&\"get\"in r&&null!==(o=r.get(e,t))?o:null==(o=E.find.attr(e,t))?void 0:o)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&\"radio\"===t&&k(e,\"input\")){var n=e.value;return e.setAttribute(\"type\",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,o=0,r=t&&t.match(F);if(r&&1===e.nodeType)for(;n=r[o++];)e.removeAttribute(n)}}),dt={set:function(e,t,n){return!1===t?E.removeAttr(e,n):e.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\\w+/g),function(e,t){var l=pt[t]||E.find.attr;pt[t]=function(e,t,n){var o,r,i=t.toLowerCase();return n||(r=pt[i],pt[i]=o,o=null!=l(e,t,n)?i:null,pt[i]=r),o}});var ft=/&#94;(?:input|select|textarea|button)$/i,ht=/&#94;(?:a|area)$/i;function gt(e){var t=e.match(F)||[];return t.join(\" \")}function mt(e){return e.getAttribute&&e.getAttribute(\"class\")||\"\"}E.fn.extend({prop:function(e,t){return q(this,E.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[E.propFix[e]||e]})}}),E.extend({prop:function(e,t,n){var o,r,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&E.isXMLDoc(e)||(t=E.propFix[t]||t,r=E.propHooks[t]),void 0!==n?r&&\"set\"in r&&void 0!==(o=r.set(e,n,t))?o:e[t]=n:r&&\"get\"in r&&null!==(o=r.get(e,t))?o:e[t]},propHooks:{tabIndex:{get:function(e){var t=E.find.attr(e,\"tabindex\");return t?parseInt(t,10):ft.test(e.nodeName)||ht.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:\"htmlFor\",class:\"className\"}}),m.optSelected||(E.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),E.each([\"tabIndex\",\"readOnly\",\"maxLength\",\"cellSpacing\",\"cellPadding\",\"rowSpan\",\"colSpan\",\"useMap\",\"frameBorder\",\"contentEditable\"],function(){E.propFix[this.toLowerCase()]=this}),E.fn.extend({addClass:function(t){var e,n,o,r,i,l,s,a=0;if(E.isFunction(t))return this.each(function(e){E(this).addClass(t.call(this,e,mt(this)))});if(\"string\"==typeof t&&t)for(e=t.match(F)||[];n=this[a++];)if(r=mt(n),o=1===n.nodeType&&\" \"+gt(r)+\" \"){for(l=0;i=e[l++];)o.indexOf(\" \"+i+\" \")<0&&(o+=i+\" \");s=gt(o),r!==s&&n.setAttribute(\"class\",s)}return this},removeClass:function(t){var e,n,o,r,i,l,s,a=0;if(E.isFunction(t))return this.each(function(e){E(this).removeClass(t.call(this,e,mt(this)))});if(!arguments.length)return this.attr(\"class\",\"\");if(\"string\"==typeof t&&t)for(e=t.match(F)||[];n=this[a++];)if(r=mt(n),o=1===n.nodeType&&\" \"+gt(r)+\" \"){for(l=0;i=e[l++];)for(;-1<o.indexOf(\" \"+i+\" \");)o=o.replace(\" \"+i+\" \",\" \");s=gt(o),r!==s&&n.setAttribute(\"class\",s)}return this},toggleClass:function(r,t){var i=typeof r;return\"boolean\"==typeof t&&\"string\"===i?t?this.addClass(r):this.removeClass(r):E.isFunction(r)?this.each(function(e){E(this).toggleClass(r.call(this,e,mt(this),t),t)}):this.each(function(){var e,t,n,o;if(\"string\"===i)for(t=0,n=E(this),o=r.match(F)||[];e=o[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==r&&\"boolean\"!==i||((e=mt(this))&&X.set(this,\"__className__\",e),this.setAttribute&&this.setAttribute(\"class\",e||!1===r?\"\":X.get(this,\"__className__\")||\"\"))})},hasClass:function(e){var t,n,o=0;for(t=\" \"+e+\" \";n=this[o++];)if(1===n.nodeType&&-1<(\" \"+gt(mt(n))+\" \").indexOf(t))return!0;return!1}});var vt=/\\r/g;E.fn.extend({val:function(n){var o,e,r,t=this[0];return arguments.length?(r=E.isFunction(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=r?n.call(this,e,E(this).val()):n)?t=\"\":\"number\"==typeof t?t+=\"\":Array.isArray(t)&&(t=E.map(t,function(e){return null==e?\"\":e+\"\"})),(o=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&\"set\"in o&&void 0!==o.set(this,t,\"value\")||(this.value=t))})):t?(o=E.valHooks[t.type]||E.valHooks[t.nodeName.toLowerCase()])&&\"get\"in o&&void 0!==(e=o.get(t,\"value\"))?e:\"string\"==typeof(e=t.value)?e.replace(vt,\"\"):null==e?\"\":e:void 0}}),E.extend({valHooks:{option:{get:function(e){var t=E.find.attr(e,\"value\");return null!=t?t:gt(E.text(e))}},select:{get:function(e){var t,n,o,r=e.options,i=e.selectedIndex,l=\"select-one\"===e.type,s=l?null:[],a=l?i+1:r.length;for(o=i<0?a:l?i:0;o<a;o++)if(((n=r[o]).selected||o===i)&&!n.disabled&&(!n.parentNode.disabled||!k(n.parentNode,\"optgroup\"))){if(t=E(n).val(),l)return t;s.push(t)}return s},set:function(e,t){for(var n,o,r=e.options,i=E.makeArray(t),l=r.length;l--;)((o=r[l]).selected=-1<E.inArray(E.valHooks.option.get(o),i))&&(n=!0);return n||(e.selectedIndex=-1),i}}}}),E.each([\"radio\",\"checkbox\"],function(){E.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<E.inArray(E(e).val(),t)}},m.checkOn||(E.valHooks[this].get=function(e){return null===e.getAttribute(\"value\")?\"on\":e.value})});var wt=/&#94;(?:focusinfocus|focusoutblur)$/;E.extend(E.event,{trigger:function(e,t,n,o){var r,i,l,s,a,c,u,d=[n||S],p=h.call(e,\"type\")?e.type:e,f=h.call(e,\"namespace\")?e.namespace.split(\".\"):[];if(i=l=n=n||S,3!==n.nodeType&&8!==n.nodeType&&!wt.test(p+E.event.triggered)&&(-1<p.indexOf(\".\")&&(p=(f=p.split(\".\")).shift(),f.sort()),a=p.indexOf(\":\")<0&&\"on\"+p,(e=e[E.expando]?e:new E.Event(p,\"object\"==typeof e&&e)).isTrigger=o?2:3,e.namespace=f.join(\".\"),e.rnamespace=e.namespace?new RegExp(\"(&#94;|\\\\.)\"+f.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:E.makeArray(t,[e]),u=E.event.special[p]||{},o||!u.trigger||!1!==u.trigger.apply(n,t))){if(!o&&!u.noBubble&&!E.isWindow(n)){for(s=u.delegateType||p,wt.test(s+p)||(i=i.parentNode);i;i=i.parentNode)d.push(i),l=i;l===(n.ownerDocument||S)&&d.push(l.defaultView||l.parentWindow||R)}for(r=0;(i=d[r++])&&!e.isPropagationStopped();)e.type=1<r?s:u.bindType||p,(c=(X.get(i,\"events\")||{})[e.type]&&X.get(i,\"handle\"))&&c.apply(i,t),(c=a&&i[a])&&c.apply&&O(i)&&(e.result=c.apply(i,t),!1===e.result&&e.preventDefault());return e.type=p,o||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(d.pop(),t)||!O(n)||a&&E.isFunction(n[p])&&!E.isWindow(n)&&((l=n[a])&&(n[a]=null),E.event.triggered=p,n[p](),E.event.triggered=void 0,l&&(n[a]=l)),e.result}},simulate:function(e,t,n){var o=E.extend(new E.Event,n,{type:e,isSimulated:!0});E.event.trigger(o,null,t)}}),E.fn.extend({trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return E.event.trigger(e,t,n,!0)}}),E.each(\"blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu\".split(\" \"),function(e,n){E.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),E.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),m.focusin=\"onfocusin\"in R,m.focusin||E.each({focus:\"focusin\",blur:\"focusout\"},function(n,o){var r=function(e){E.event.simulate(o,e.target,E.event.fix(e))};E.event.special[o]={setup:function(){var e=this.ownerDocument||this,t=X.access(e,o);t||e.addEventListener(n,r,!0),X.access(e,o,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=X.access(e,o)-1;t?X.access(e,o,t):(e.removeEventListener(n,r,!0),X.remove(e,o))}}});var yt=R.location,Ct=E.now(),bt=/\\?/;E.parseXML=function(e){var t;if(!e||\"string\"!=typeof e)return null;try{t=(new R.DOMParser).parseFromString(e,\"text/xml\")}catch(e){t=void 0}return t&&!t.getElementsByTagName(\"parsererror\").length||E.error(\"Invalid XML: \"+e),t};var xt=/\\[\\]$/,Rt=/\\r?\\n/g,St=/&#94;(?:submit|button|image|reset|file)$/i,Et=/&#94;(?:input|select|textarea|keygen)/i;function kt(n,e,o,r){var t;if(Array.isArray(e))E.each(e,function(e,t){o||xt.test(n)?r(n,t):kt(n+\"[\"+(\"object\"==typeof t&&null!=t?e:\"\")+\"]\",t,o,r)});else if(o||\"object\"!==E.type(e))r(n,e);else for(t in e)kt(n+\"[\"+t+\"]\",e[t],o,r)}E.param=function(e,t){var n,o=[],r=function(e,t){var n=E.isFunction(t)?t():t;o[o.length]=encodeURIComponent(e)+\"=\"+encodeURIComponent(null==n?\"\":n)};if(Array.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){r(this.name,this.value)});else for(n in e)kt(n,e[n],t,r);return o.join(\"&\")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=E.prop(this,\"elements\");return e?E.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!E(this).is(\":disabled\")&&Et.test(this.nodeName)&&!St.test(e)&&(this.checked||!le.test(e))}).map(function(e,t){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,function(e){return{name:t.name,value:e.replace(Rt,\"\\r\\n\")}}):{name:t.name,value:n.replace(Rt,\"\\r\\n\")}}).get()}});var Tt=/%20/g,Pt=/#.*$/,Dt=/([?&])_=[&#94;&]*/,Nt=/&#94;(.*?):[ \\t]*([&#94;\\r\\n]*)$/gm,At=/&#94;(?:GET|HEAD)$/,$t=/&#94;\\/\\//,Ht={},Lt={},_t=\"*/\".concat(\"*\"),Ft=S.createElement(\"a\");function It(i){return function(e,t){\"string\"!=typeof e&&(t=e,e=\"*\");var n,o=0,r=e.toLowerCase().match(F)||[];if(E.isFunction(t))for(;n=r[o++];)\"+\"===n[0]?(n=n.slice(1)||\"*\",(i[n]=i[n]||[]).unshift(t)):(i[n]=i[n]||[]).push(t)}}function Mt(t,r,i,l){var s={},a=t===Lt;function c(e){var o;return s[e]=!0,E.each(t[e]||[],function(e,t){var n=t(r,i,l);return\"string\"!=typeof n||a||s[n]?a?!(o=n):void 0:(r.dataTypes.unshift(n),c(n),!1)}),o}return c(r.dataTypes[0])||!s[\"*\"]&&c(\"*\")}function Wt(e,t){var n,o,r=E.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:o||(o={}))[n]=t[n]);return o&&E.extend(!0,e,o),e}Ft.href=yt.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yt.href,type:\"GET\",isLocal:/&#94;(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(yt.protocol),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":_t,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/\\bxml\\b/,html:/\\bhtml/,json:/\\bjson\\b/},responseFields:{xml:\"responseXML\",text:\"responseText\",json:\"responseJSON\"},converters:{\"* text\":String,\"text html\":!0,\"text json\":JSON.parse,\"text xml\":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Wt(Wt(e,E.ajaxSettings),t):Wt(E.ajaxSettings,e)},ajaxPrefilter:It(Ht),ajaxTransport:It(Lt),ajax:function(e,t){\"object\"==typeof e&&(t=e,e=void 0),t=t||{};var u,d,p,n,f,o,h,g,r,i,m=E.ajaxSetup({},t),v=m.context||m,w=m.context&&(v.nodeType||v.jquery)?E(v):E.event,y=E.Deferred(),C=E.Callbacks(\"once memory\"),b=m.statusCode||{},l={},s={},a=\"canceled\",x={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n)for(n={};t=Nt.exec(p);)n[t[1].toLowerCase()]=t[2];t=n[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,l[e]=t),this},overrideMimeType:function(e){return null==h&&(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)x.always(e[x.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||a;return u&&u.abort(t),c(0,t),this}};if(y.promise(x),m.url=((e||m.url||yt.href)+\"\").replace($t,yt.protocol+\"//\"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=(m.dataType||\"*\").toLowerCase().match(F)||[\"\"],null==m.crossDomain){o=S.createElement(\"a\");try{o.href=m.url,o.href=o.href,m.crossDomain=Ft.protocol+\"//\"+Ft.host!=o.protocol+\"//\"+o.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&\"string\"!=typeof m.data&&(m.data=E.param(m.data,m.traditional)),Mt(Ht,m,t,x),h)return x;for(r in(g=E.event&&m.global)&&0==E.active++&&E.event.trigger(\"ajaxStart\"),m.type=m.type.toUpperCase(),m.hasContent=!At.test(m.type),d=m.url.replace(Pt,\"\"),m.hasContent?m.data&&m.processData&&0===(m.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&(m.data=m.data.replace(Tt,\"+\")):(i=m.url.slice(d.length),m.data&&(d+=(bt.test(d)?\"&\":\"?\")+m.data,delete m.data),!1===m.cache&&(d=d.replace(Dt,\"$1\"),i=(bt.test(d)?\"&\":\"?\")+\"_=\"+Ct+++i),m.url=d+i),m.ifModified&&(E.lastModified[d]&&x.setRequestHeader(\"If-Modified-Since\",E.lastModified[d]),E.etag[d]&&x.setRequestHeader(\"If-None-Match\",E.etag[d])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&x.setRequestHeader(\"Content-Type\",m.contentType),x.setRequestHeader(\"Accept\",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+(\"*\"!==m.dataTypes[0]?\", \"+_t+\"; q=0.01\":\"\"):m.accepts[\"*\"]),m.headers)x.setRequestHeader(r,m.headers[r]);if(m.beforeSend&&(!1===m.beforeSend.call(v,x,m)||h))return x.abort();if(a=\"abort\",C.add(m.complete),x.done(m.success),x.fail(m.error),u=Mt(Lt,m,t,x)){if(x.readyState=1,g&&w.trigger(\"ajaxSend\",[x,m]),h)return x;m.async&&0<m.timeout&&(f=R.setTimeout(function(){x.abort(\"timeout\")},m.timeout));try{h=!1,u.send(l,c)}catch(e){if(h)throw e;c(-1,e)}}else c(-1,\"No Transport\");function c(e,t,n,o){var r,i,l,s,a,c=t;h||(h=!0,f&&R.clearTimeout(f),u=void 0,p=o||\"\",x.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var o,r,i,l,s=e.contents,a=e.dataTypes;for(;\"*\"===a[0];)a.shift(),void 0===o&&(o=e.mimeType||t.getResponseHeader(\"Content-Type\"));if(o)for(r in s)if(s[r]&&s[r].test(o)){a.unshift(r);break}if(a[0]in n)i=a[0];else{for(r in n){if(!a[0]||e.converters[r+\" \"+a[0]]){i=r;break}l||(l=r)}i=i||l}if(i)return i!==a[0]&&a.unshift(i),n[i]}(m,x,n)),s=function(e,t,n,o){var r,i,l,s,a,c={},u=e.dataTypes.slice();if(u[1])for(l in e.converters)c[l.toLowerCase()]=e.converters[l];i=u.shift();for(;i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!a&&o&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=i,i=u.shift())if(\"*\"===i)i=a;else if(\"*\"!==a&&a!==i){if(!(l=c[a+\" \"+i]||c[\"* \"+i]))for(r in c)if((s=r.split(\" \"))[1]===i&&(l=c[a+\" \"+s[0]]||c[\"* \"+s[0]])){!0===l?l=c[r]:!0!==c[r]&&(i=s[0],u.unshift(s[1]));break}if(!0!==l)if(l&&e.throws)t=l(t);else try{t=l(t)}catch(e){return{state:\"parsererror\",error:l?e:\"No conversion from \"+a+\" to \"+i}}}return{state:\"success\",data:t}}(m,s,x,r),r?(m.ifModified&&((a=x.getResponseHeader(\"Last-Modified\"))&&(E.lastModified[d]=a),(a=x.getResponseHeader(\"etag\"))&&(E.etag[d]=a)),204===e||\"HEAD\"===m.type?c=\"nocontent\":304===e?c=\"notmodified\":(c=s.state,i=s.data,l=s.error,r=!l)):(l=c,!e&&c||(c=\"error\",e<0&&(e=0))),x.status=e,x.statusText=(t||c)+\"\",r?y.resolveWith(v,[i,c,x]):y.rejectWith(v,[x,c,l]),x.statusCode(b),b=void 0,g&&w.trigger(r?\"ajaxSuccess\":\"ajaxError\",[x,m,r?i:l]),C.fireWith(v,[x,c]),g&&(w.trigger(\"ajaxComplete\",[x,m]),--E.active||E.event.trigger(\"ajaxStop\")))}return x},getJSON:function(e,t,n){return E.get(e,t,n,\"json\")},getScript:function(e,t){return E.get(e,void 0,t,\"script\")}}),E.each([\"get\",\"post\"],function(e,r){E[r]=function(e,t,n,o){return E.isFunction(t)&&(o=o||n,n=t,t=void 0),E.ajax(E.extend({url:e,type:r,dataType:o,data:t,success:n},E.isPlainObject(e)&&e))}}),E._evalUrl=function(e){return E.ajax({url:e,type:\"GET\",dataType:\"script\",cache:!0,async:!1,global:!1,throws:!0})},E.fn.extend({wrapAll:function(e){var t;return this[0]&&(E.isFunction(e)&&(e=e.call(this[0])),t=E(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return E.isFunction(n)?this.each(function(e){E(this).wrapInner(n.call(this,e))}):this.each(function(){var e=E(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=E.isFunction(t);return this.each(function(e){E(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not(\"body\").each(function(){E(this).replaceWith(this.childNodes)}),this}}),E.expr.pseudos.hidden=function(e){return!E.expr.pseudos.visible(e)},E.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new R.XMLHttpRequest}catch(e){}};var jt={0:200,1223:204},Vt=E.ajaxSettings.xhr();m.cors=!!Vt&&\"withCredentials\"in Vt,m.ajax=Vt=!!Vt,E.ajaxTransport(function(r){var i,l;if(m.cors||Vt&&!r.crossDomain)return{send:function(e,t){var n,o=r.xhr();if(o.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(n in r.xhrFields)o[n]=r.xhrFields[n];for(n in r.mimeType&&o.overrideMimeType&&o.overrideMimeType(r.mimeType),r.crossDomain||e[\"X-Requested-With\"]||(e[\"X-Requested-With\"]=\"XMLHttpRequest\"),e)o.setRequestHeader(n,e[n]);i=function(e){return function(){i&&(i=l=o.onload=o.onerror=o.onabort=o.onreadystatechange=null,\"abort\"===e?o.abort():\"error\"===e?\"number\"!=typeof o.status?t(0,\"error\"):t(o.status,o.statusText):t(jt[o.status]||o.status,o.statusText,\"text\"!==(o.responseType||\"text\")||\"string\"!=typeof o.responseText?{binary:o.response}:{text:o.responseText},o.getAllResponseHeaders()))}},o.onload=i(),l=o.onerror=i(\"error\"),void 0!==o.onabort?o.onabort=l:o.onreadystatechange=function(){4===o.readyState&&R.setTimeout(function(){i&&l()})},i=i(\"abort\");try{o.send(r.hasContent&&r.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}}),E.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),E.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/\\b(?:java|ecma)script\\b/},converters:{\"text script\":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter(\"script\",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type=\"GET\")}),E.ajaxTransport(\"script\",function(n){var o,r;if(n.crossDomain)return{send:function(e,t){o=E(\"<script>\").prop({charset:n.scriptCharset,src:n.url}).on(\"load error\",r=function(e){o.remove(),r=null,e&&t(\"error\"===e.type?404:200,e.type)}),S.head.appendChild(o[0])},abort:function(){r&&r()}}});var Bt,qt=[],Ot=/(=)\\?(?=&|$)|\\?\\?/;E.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var e=qt.pop()||E.expando+\"_\"+Ct++;return this[e]=!0,e}}),E.ajaxPrefilter(\"json jsonp\",function(e,t,n){var o,r,i,l=!1!==e.jsonp&&(Ot.test(e.url)?\"url\":\"string\"==typeof e.data&&0===(e.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&Ot.test(e.data)&&\"data\");if(l||\"jsonp\"===e.dataTypes[0])return o=e.jsonpCallback=E.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,l?e[l]=e[l].replace(Ot,\"$1\"+o):!1!==e.jsonp&&(e.url+=(bt.test(e.url)?\"&\":\"?\")+e.jsonp+\"=\"+o),e.converters[\"script json\"]=function(){return i||E.error(o+\" was not called\"),i[0]},e.dataTypes[0]=\"json\",r=R[o],R[o]=function(){i=arguments},n.always(function(){void 0===r?E(R).removeProp(o):R[o]=r,e[o]&&(e.jsonpCallback=t.jsonpCallback,qt.push(o)),i&&E.isFunction(r)&&r(i[0]),i=r=void 0}),\"script\"}),m.createHTMLDocument=((Bt=S.implementation.createHTMLDocument(\"\").body).innerHTML=\"<form></form><form></form>\",2===Bt.childNodes.length),E.parseHTML=function(e,t,n){return\"string\"!=typeof e?[]:(\"boolean\"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?(t=S.implementation.createHTMLDocument(\"\"),(o=t.createElement(\"base\")).href=S.location.href,t.head.appendChild(o)):t=S),r=T.exec(e),i=!n&&[],r?[t.createElement(r[1])]:(r=me([e],t,i),i&&i.length&&E(i).remove(),E.merge([],r.childNodes)));var o,r,i},E.fn.load=function(e,t,n){var o,r,i,l=this,s=e.indexOf(\" \");return-1<s&&(o=gt(e.slice(s)),e=e.slice(0,s)),E.isFunction(t)?(n=t,t=void 0):t&&\"object\"==typeof t&&(r=\"POST\"),0<l.length&&E.ajax({url:e,type:r||\"GET\",dataType:\"html\",data:t}).done(function(e){i=arguments,l.html(o?E(\"<div>\").append(E.parseHTML(e)).find(o):e)}).always(n&&function(e,t){l.each(function(){n.apply(this,i||[e.responseText,t,e])})}),this},E.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E.expr.pseudos.animated=function(t){return E.grep(E.timers,function(e){return t===e.elem}).length},E.offset={setOffset:function(e,t,n){var o,r,i,l,s,a,c=E.css(e,\"position\"),u=E(e),d={};\"static\"===c&&(e.style.position=\"relative\"),s=u.offset(),i=E.css(e,\"top\"),a=E.css(e,\"left\"),(\"absolute\"===c||\"fixed\"===c)&&-1<(i+a).indexOf(\"auto\")?(o=u.position(),l=o.top,r=o.left):(l=parseFloat(i)||0,r=parseFloat(a)||0),E.isFunction(t)&&(t=t.call(e,n,E.extend({},s))),null!=t.top&&(d.top=t.top-s.top+l),null!=t.left&&(d.left=t.left-s.left+r),\"using\"in t?t.using.call(e,d):u.css(d)}},E.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){E.offset.setOffset(this,t,e)});var e,n,o,r,i=this[0];return i?i.getClientRects().length?(o=i.getBoundingClientRect(),e=i.ownerDocument,n=e.documentElement,r=e.defaultView,{top:o.top+r.pageYOffset-n.clientTop,left:o.left+r.pageXOffset-n.clientLeft}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n=this[0],o={top:0,left:0};return\"fixed\"===E.css(n,\"position\")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),k(e[0],\"html\")||(o=e.offset()),o={top:o.top+E.css(e[0],\"borderTopWidth\",!0),left:o.left+E.css(e[0],\"borderLeftWidth\",!0)}),{top:t.top-o.top-E.css(n,\"marginTop\",!0),left:t.left-o.left-E.css(n,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&\"static\"===E.css(e,\"position\");)e=e.offsetParent;return e||ve})}}),E.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(t,r){var i=\"pageYOffset\"===r;E.fn[t]=function(e){return q(this,function(e,t,n){var o;if(E.isWindow(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===n)return o?o[r]:e[t];o?o.scrollTo(i?o.pageXOffset:n,i?n:o.pageYOffset):e[t]=n},t,e,arguments.length)}}),E.each([\"top\",\"left\"],function(e,n){E.cssHooks[n]=Ve(m.pixelPosition,function(e,t){if(t)return t=je(e,n),Me.test(t)?E(e).position()[n]+\"px\":t})}),E.each({Height:\"height\",Width:\"width\"},function(l,s){E.each({padding:\"inner\"+l,content:s,\"\":\"outer\"+l},function(o,i){E.fn[i]=function(e,t){var n=arguments.length&&(o||\"boolean\"!=typeof e),r=o||(!0===e||!0===t?\"margin\":\"border\");return q(this,function(e,t,n){var o;return E.isWindow(e)?0===i.indexOf(\"outer\")?e[\"inner\"+l]:e.document.documentElement[\"client\"+l]:9===e.nodeType?(o=e.documentElement,Math.max(e.body[\"scroll\"+l],o[\"scroll\"+l],e.body[\"offset\"+l],o[\"offset\"+l],o[\"client\"+l])):void 0===n?E.css(e,t,r):E.style(e,t,n,r)},s,n?e:void 0,n)}})}),E.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,o){return this.on(t,e,n,o)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\"**\"):this.off(t,e||\"**\",n)}}),E.holdReady=function(e){e?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=k,\"function\"==typeof define&&define.amd&&define(\"jquery\",[],function(){return E});var zt=R.jQuery,Xt=R.$;return E.noConflict=function(e){return R.$===E&&(R.$=Xt),e&&R.jQuery===E&&(R.jQuery=zt),E},e||(R.jQuery=R.$=E),E})},438:function(e,t,n){ /*! * jquery.event.drag - v 2.3.0 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com * Open Source MIT License - http://threedubmedia.com/code/license */ var f=e(444);f.fn.drag=function(e,t,n){var o=\"string\"==typeof e?e:\"\",r=f.isFunction(e)?e:f.isFunction(t)?t:null;return 0!==o.indexOf(\"drag\")&&(o=\"drag\"+o),n=(e==r?t:n)||{},r?this.on(o,n,r):this.trigger(o)};var h=f.event,o=h.special,g=o.drag={defaults:{which:1,distance:0,not:\":input\",handle:null,relative:!1,drop:!0,click:!1},datakey:\"dragdata\",noBubble:!0,add:function(e){var n=f.data(this,g.datakey),o=e.data||{};n.related+=1,f.each(g.defaults,function(e,t){void 0!==o[e]&&(n[e]=o[e])})},remove:function(){f.data(this,g.datakey).related-=1},setup:function(){if(!f.data(this,g.datakey)){var e=f.extend({related:0},g.defaults);f.data(this,g.datakey,e),h.add(this,\"touchstart mousedown\",g.init,e),this.attachEvent&&this.attachEvent(\"ondragstart\",g.dontstart)}},teardown:function(){var e=f.data(this,g.datakey)||{};e.related||(f.removeData(this,g.datakey),h.remove(this,\"touchstart mousedown\",g.init),g.textselect(!0),this.detachEvent&&this.detachEvent(\"ondragstart\",g.dontstart))},init:function(e){if(!g.touched){var t,n=e.data;if(!(0!=e.which&&0<n.which&&e.which!=n.which)&&!f(e.target).is(n.not)&&(!n.handle||f(e.target).closest(n.handle,e.currentTarget).length)&&(g.touched=\"touchstart\"==e.type?this:null,n.propagates=1,n.mousedown=this,n.interactions=[g.interaction(this,n)],n.target=e.target,n.pageX=e.pageX,n.pageY=e.pageY,n.dragging=null,t=g.hijack(e,\"draginit\",n),n.propagates))return(t=g.flatten(t))&&t.length&&(n.interactions=[],f.each(t,function(){n.interactions.push(g.interaction(this,n))})),n.propagates=n.interactions.length,!1!==n.drop&&o.drop&&o.drop.handler(e,n),g.textselect(!1),g.touched?h.add(g.touched,\"touchmove touchend\",g.handler,n):h.add(document,\"mousemove mouseup\",g.handler,n),!(!g.touched||n.live)&&void 0}},interaction:function(e,t){var n=e&&e.ownerDocument&&f(e)[t.relative?\"position\":\"offset\"]()||{top:0,left:0};return{drag:e,callback:new g.callback,droppable:[],offset:n}},handler:function(e){var t=e.data;switch(e.type){case!t.dragging&&\"touchmove\":e.preventDefault();case!t.dragging&&\"mousemove\":if(Math.pow(e.pageX-t.pageX,2)+Math.pow(e.pageY-t.pageY,2)<Math.pow(t.distance,2))break;e.target=t.target,g.hijack(e,\"dragstart\",t),t.propagates&&(t.dragging=!0);case\"touchmove\":e.preventDefault();case\"mousemove\":if(t.dragging){if(g.hijack(e,\"drag\",t),t.propagates){!1!==t.drop&&o.drop&&o.drop.handler(e,t);break}e.type=\"mouseup\"}case\"touchend\":case\"mouseup\":default:g.touched?h.remove(g.touched,\"touchmove touchend\",g.handler):h.remove(document,\"mousemove mouseup\",g.handler),t.dragging&&(!1!==t.drop&&o.drop&&o.drop.handler(e,t),g.hijack(e,\"dragend\",t)),g.textselect(!0),!1===t.click&&t.dragging&&f.data(t.mousedown,\"suppress.click\",(new Date).getTime()+5),t.dragging=g.touched=!1}},hijack:function(n,o,r,e,t){if(r){var i,l,s,a={event:n.originalEvent,type:n.type},c=o.indexOf(\"drop\")?\"drag\":\"drop\",u=e||0,d=isNaN(e)?r.interactions.length:e;n.type=o;var p=function(){};n.originalEvent=new f.Event(a.event,{preventDefault:p,stopPropagation:p,stopImmediatePropagation:p}),r.results=[];do{if(l=r.interactions[u]){if(\"dragend\"!==o&&l.cancelled)continue;s=g.properties(n,r,l),l.results=[],f(t||l[c]||r.droppable).each(function(e,t){if(s.target=t,!(n.isPropagationStopped=function(){return!1})===(i=t?h.dispatch.call(t,n,s):null)?(\"drag\"==c&&(l.cancelled=!0,r.propagates-=1),\"drop\"==o&&(l[c][e]=null)):\"dropinit\"==o&&l.droppable.push(g.element(i)||t),\"dragstart\"==o&&(l.proxy=f(g.element(i)||l.drag)[0]),l.results.push(i),delete n.result,\"dropinit\"!==o)return i}),r.results[u]=g.flatten(l.results),\"dropinit\"==o&&(l.droppable=g.flatten(l.droppable)),\"dragstart\"!=o||l.cancelled||s.update()}}while(++u<d);return n.type=a.type,n.originalEvent=a.event,g.flatten(r.results)}},properties:function(e,t,n){var o=n.callback;return o.drag=n.drag,o.proxy=n.proxy||n.drag,o.startX=t.pageX,o.startY=t.pageY,o.deltaX=e.pageX-t.pageX,o.deltaY=e.pageY-t.pageY,o.originalX=n.offset.left,o.originalY=n.offset.top,o.offsetX=o.originalX+o.deltaX,o.offsetY=o.originalY+o.deltaY,o.drop=g.flatten((n.drop||[]).slice()),o.available=g.flatten((n.droppable||[]).slice()),o},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(e){return f.map(e,function(e){return e&&e.jquery?f.makeArray(e):e&&e.length?g.flatten(e):e})},textselect:function(e){f(document)[e?\"off\":\"on\"](\"selectstart\",g.dontstart).css(\"MozUserSelect\",e?\"\":\"none\"),document.unselectable=e?\"off\":\"on\"},dontstart:function(){return!1},callback:function(){}};g.callback.prototype={update:function(){o.drop&&this.available.length&&f.each(this.available,function(e){o.drop.locate(this,e)})}};var r=h.dispatch;h.dispatch=function(e){if(!(0<f.data(this,\"suppress.\"+e.type)-(new Date).getTime()))return r.apply(this,arguments);f.removeData(this,\"suppress.\"+e.type)},o.draginit=o.dragstart=o.dragend=g},439:function(e,t,n){ /*! * jquery.event.drop - v 2.3.0 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com * Open Source MIT License - http://threedubmedia.com/code/license */ var f=e(444);f.fn.drop=function(e,t,n){var o=\"string\"==typeof e?e:\"\",r=f.isFunction(e)?e:f.isFunction(t)?t:null;return 0!==o.indexOf(\"drop\")&&(o=\"drop\"+o),n=(e==r?t:n)||{},r?this.on(o,n,r):this.trigger(o)},f.drop=function(e){e=e||{},g.multi=!0===e.multi?1/0:!1===e.multi?1:isNaN(e.multi)?g.multi:e.multi,g.delay=e.delay||g.delay,g.tolerance=f.isFunction(e.tolerance)?e.tolerance:null===e.tolerance?null:g.tolerance,g.mode=e.mode||g.mode||\"intersect\"};var o=f.event,h=o.special,g=f.event.special.drop={multi:1,delay:20,mode:\"overlap\",targets:[],datakey:\"dropdata\",noBubble:!0,add:function(e){var t=f.data(this,g.datakey);t.related+=1},remove:function(){f.data(this,g.datakey).related-=1},setup:function(){if(!f.data(this,g.datakey)){f.data(this,g.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),g.targets.push(this)}},teardown:function(){var e=f.data(this,g.datakey)||{};if(!e.related){f.removeData(this,g.datakey);var t=this;g.targets=f.grep(g.targets,function(e){return e!==t})}},handler:function(e,t){var n;if(t)switch(e.type){case\"mousedown\":case\"touchstart\":n=f(g.targets),\"string\"==typeof t.drop&&(n=n.filter(t.drop)),n.each(function(){var e=f.data(this,g.datakey);e.active=[],e.anyactive=0,e.winner=0}),t.droppable=n,h.drag.hijack(e,\"dropinit\",t);break;case\"mousemove\":case\"touchmove\":g.event=e,g.timer||g.tolerate(t);break;case\"mouseup\":case\"touchend\":g.timer=clearTimeout(g.timer),t.propagates&&(h.drag.hijack(e,\"drop\",t),h.drag.hijack(e,\"dropend\",t))}},locate:function(e,t){var n=f.data(e,g.datakey),o=f(e),r=o.offset()||{},i=o.outerHeight(),l=o.outerWidth(),s={elem:e,width:l,height:i,top:r.top,left:r.left,right:r.left+l,bottom:r.top+i};return n&&(n.location=s,n.index=t,n.elem=e),s},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(e){var t,n,o,r,i,l,s,a,c=0,u=e.interactions.length,d=[g.event.pageX,g.event.pageY],p=g.tolerance||g.modes[g.mode];do{if(a=e.interactions[c]){if(!a)return;a.drop=[],i=[],l=a.droppable.length,p&&(o=g.locate(a.proxy)),t=0;do{if(s=a.droppable[t]){if(r=f.data(s,g.datakey),!(n=r.location))continue;r.winner=p?p.call(g,g.event,o,n):g.contains(n,d)?1:0,i.push(r)}}while(++t<l);for(i.sort(g.sort),t=0;(r=i[t])&&(r.winner&&a.drop.length<g.multi?(r.active[c]||r.anyactive||(!1!==h.drag.hijack(g.event,\"dropstart\",e,c,r.elem)[0]?(r.active[c]=1,r.anyactive+=1):r.winner=0),r.winner&&a.drop.push(r.elem)):r.active[c]&&1==r.anyactive&&(h.drag.hijack(g.event,\"dropend\",e,c,r.elem),r.active[c]=0,r.anyactive-=1)),++t<l;);}}while(++c<u);g.last&&d[0]==g.last.pageX&&d[1]==g.last.pageY?delete g.timer:g.timer=setTimeout(function(){g.tolerate(e)},g.delay),g.last=g.event}};h.dropinit=h.dropstart=h.dropend=g},440:function(e,t,n){var d=e(444),p=e(442);t.exports={CheckboxSelectColumn:function(e){var l,t=new p.EventHandler,s={},a=d.extend(!0,{},{columnId:\"_checkbox_selector\",cssClass:null,toolTip:\"Select/Deselect All\",width:30},e);function n(e,t){var n,o,r=l.getSelectedRows(),i={};for(o=0;o<r.length;o++)n=r[o],i[n]=!0,i[n]!==s[n]&&(l.invalidateRow(n),delete s[n]);for(o in s)l.invalidateRow(o);s=i,l.render(),r.length&&r.length==l.getDataLength()?l.updateColumnHeader(a.columnId,\"<input type='checkbox' checked='checked'>\",a.toolTip):l.updateColumnHeader(a.columnId,\"<input type='checkbox'>\",a.toolTip)}function o(e,t){32==e.which&&l.getColumns()[t.cell].id===a.columnId&&(l.getEditorLock().isActive()&&!l.getEditorLock().commitCurrentEdit()||i(t.row),e.preventDefault(),e.stopImmediatePropagation())}function r(e,t){if(l.getColumns()[t.cell].id===a.columnId&&d(e.target).is(\":checkbox\")){if(l.getEditorLock().isActive()&&!l.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();i(t.row),e.stopPropagation(),e.stopImmediatePropagation()}}function i(t){s[t]?l.setSelectedRows(d.grep(l.getSelectedRows(),function(e){return e!=t})):l.setSelectedRows(l.getSelectedRows().concat(t))}function c(e,t){if(t.column.id==a.columnId&&d(e.target).is(\":checkbox\")){if(l.getEditorLock().isActive()&&!l.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();if(d(e.target).is(\":checked\")){for(var n=[],o=0;o<l.getDataLength();o++)n.push(o);l.setSelectedRows(n)}else l.setSelectedRows([]);e.stopPropagation(),e.stopImmediatePropagation()}}function u(e,t,n,o,r){return r?s[e]?\"<input type='checkbox' checked='checked'>\":\"<input type='checkbox'>\":null}d.extend(this,{init:function(e){l=e,t.subscribe(l.onSelectedRowsChanged,n).subscribe(l.onClick,r).subscribe(l.onHeaderClick,c).subscribe(l.onKeyDown,o)},destroy:function(){t.unsubscribeAll()},deSelectRows:function(e){var t,n=e.length,o=[];for(t=0;t<n;t++)s[e[t]]&&(o[o.length]=e[t]);l.setSelectedRows(d.grep(l.getSelectedRows(),function(e){return o.indexOf(e)<0}))},selectRows:function(e){var t,n=e.length,o=[];for(t=0;t<n;t++)s[e[t]]||(o[o.length]=e[t]);l.setSelectedRows(l.getSelectedRows().concat(o))},getColumnDefinition:function(){return{id:a.columnId,name:\"<input type='checkbox'>\",toolTip:a.toolTip,field:\"sel\",width:a.width,resizable:!1,sortable:!1,cssClass:a.cssClass,formatter:u}}})}}},441:function(e,t,n){var v=e(444),w=e(442);t.exports={RowSelectionModel:function(t){var c,n,o,u=[],r=this,i=new w.EventHandler,l={selectActiveRow:!0};function s(e){return function(){n||(n=!0,e.apply(this,arguments),n=!1)}}function d(e){for(var t=[],n=0;n<e.length;n++)for(var o=e[n].fromRow;o<=e[n].toRow;o++)t.push(o);return t}function p(e){for(var t=[],n=c.getColumns().length-1,o=0;o<e.length;o++)t.push(new w.Range(e[o],0,e[o],n));return t}function a(){return d(u)}function f(e){(u&&0!==u.length||e&&0!==e.length)&&(u=e,r.onSelectedRangesChanged.notify(u))}function h(e,t){o.selectActiveRow&&null!=t.row&&f([new w.Range(t.row,0,t.row,c.getColumns().length-1)])}function g(e){var t=c.getActiveCell();if(t&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&(38==e.which||40==e.which)){var n=a();n.sort(function(e,t){return e-t}),n.length||(n=[t.row]);var o,r=n[0],i=n[n.length-1];if(0<=(o=40==e.which?t.row<i||r==i?++i:++r:t.row<i?--i:--r)&&o<c.getDataLength()){c.scrollRowIntoView(o);var l=p(function(e,t){var n,o=[];for(n=e;n<=t;n++)o.push(n);for(n=t;n<e;n++)o.push(n);return o}(r,i));f(l)}e.preventDefault(),e.stopPropagation()}}function m(e){var n=c.getCellFromEvent(e);if(!n||!c.canCellBeActive(n.row,n.cell))return!1;if(!c.getOptions().multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;var t=d(u),o=v.inArray(n.row,t);if(-1===o&&(e.ctrlKey||e.metaKey))t.push(n.row),c.setActiveCell(n.row,n.cell);else if(-1!==o&&(e.ctrlKey||e.metaKey))t=v.grep(t,function(e,t){return e!==n.row}),c.setActiveCell(n.row,n.cell);else if(t.length&&e.shiftKey){var r=t.pop(),i=Math.min(n.row,r),l=Math.max(n.row,r);t=[];for(var s=i;s<=l;s++)s!==r&&t.push(s);t.push(r),c.setActiveCell(n.row,n.cell)}var a=p(t);return f(a),e.stopImmediatePropagation(),!0}v.extend(this,{getSelectedRows:a,setSelectedRows:function(e){f(p(e))},getSelectedRanges:function(){return u},setSelectedRanges:f,init:function(e){o=v.extend(!0,{},l,t),c=e,i.subscribe(c.onActiveCellChanged,s(h)),i.subscribe(c.onKeyDown,s(g)),i.subscribe(c.onClick,s(m))},destroy:function(){i.unsubscribeAll()},onSelectedRangesChanged:new w.Event})}}},442:function(e,t,n){function l(){var e=!1,t=!1;this.stopPropagation=function(){e=!0},this.isPropagationStopped=function(){return e},this.stopImmediatePropagation=function(){t=!0},this.isImmediatePropagationStopped=function(){return t}}function o(){this.__nonDataRow=!0}function r(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function i(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function s(){var t=null;this.isActive=function(e){return e?t===e:null!==t},this.activate=function(e){if(e!==t){if(null!==t)throw new Error(\"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController\");if(!e.commitCurrentEdit)throw new Error(\"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()\");if(!e.cancelCurrentEdit)throw new Error(\"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()\");t=e}},this.deactivate=function(e){if(t!==e)throw new Error(\"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one\");t=null},this.commitCurrentEdit=function(){return!t||t.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!t||t.cancelCurrentEdit()}}(r.prototype=new o).equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title},i.prototype=new o,t.exports={Event:function(){var i=[];this.subscribe=function(e){i.push(e)},this.unsubscribe=function(e){for(var t=i.length-1;0<=t;t--)i[t]===e&&i.splice(t,1)},this.notify=function(e,t,n){var o;t=t||new l,n=n||this;for(var r=0;r<i.length&&!t.isPropagationStopped()&&!t.isImmediatePropagationStopped();r++)o=i[r].call(n,t,e);return o}},EventData:l,EventHandler:function(){var o=[];this.subscribe=function(e,t){return o.push({event:e,handler:t}),e.subscribe(t),this},this.unsubscribe=function(e,t){for(var n=o.length;n--;)if(o[n].event===e&&o[n].handler===t)return o.splice(n,1),void e.unsubscribe(t);return this},this.unsubscribeAll=function(){for(var e=o.length;e--;)o[e].event.unsubscribe(o[e].handler);return o=[],this}},Range:function(e,t,n,o){void 0===n&&void 0===o&&(n=e,o=t);this.fromRow=Math.min(e,n),this.fromCell=Math.min(t,o),this.toRow=Math.max(e,n),this.toCell=Math.max(t,o),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell},this.toString=function(){return this.isSingleCell()?\"(\"+this.fromRow+\":\"+this.fromCell+\")\":\"(\"+this.fromRow+\":\"+this.fromCell+\" - \"+this.toRow+\":\"+this.toCell+\")\"}},NonDataRow:o,Group:r,GroupTotals:i,EditorLock:s,GlobalEditorLock:new s,keyCode:{BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,ESC:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,C:67,V:86},preClickClassName:\"slick-edit-preclick\"}},443:function _(require,module,exports){ /** * @license * (c) 2009-2016 Michael Leibman * michael{dot}leibman{at}gmail{dot}com * http://github.com/mleibman/slickgrid * * Distributed under MIT license. * All rights reserved. * * SlickGrid v2.3 * * NOTES: * Cell/row DOM manipulations are done directly bypassing jQuery's DOM manipulation methods. * This increases the speed dramatically, but can only be done safely because there are no event handlers * or data associated with any cell/row DOM nodes. Cell editors must make sure they implement .destroy() * and do proper cleanup. */ var $=require(444),Slick=require(442),scrollbarDimensions,maxSupportedCssHeight;function SlickGrid(container,data,columns,options){$.fn.drag||require(438),$.fn.drop||require(439);var defaults={explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:\"flashing\",selectedCellCssClass:\"selected\",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:\"new-row\",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0},columnDefaults={name:\"\",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid=\"slickgrid_\"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacer,$footerRow,$footerRowScroller,$footerRowSpacer,$preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,sortIndicatorCssClass=\"slick-sort-indicator\",tabbingDirection=1,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],pagingActive=!1,pagingIsLastPage=!1,h_editorLoader=null,h_render=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],postProcessgroupId=0,counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent,cssShow={position:\"absolute\",visibility:\"hidden\",display:\"block\"},$hiddenParents,oldProps=[];function init(){if(($container=container instanceof $?container:$(container)).length<1)throw new Error(\"SlickGrid requires a valid container, \"+container+\" does not exist in the DOM.\");cacheCssForHiddenInit(),maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),options=$.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,columnsById={};for(var e=0;e<columns.length;e++){var t=columns[e]=$.extend({},columnDefaults,columns[e]);columnsById[t.id]=e,t.minWidth&&t.width<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&t.width>t.maxWidth&&(t.width=t.maxWidth)}if(options.enableColumnReorder&&!$.fn.sortable)throw new Error(\"SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded\");editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css(\"overflow\",\"hidden\").css(\"outline\",0).addClass(uid).addClass(\"ui-widget\"),/relative|absolute|fixed/.test($container.css(\"position\"))||$container.css(\"position\",\"relative\"),$focusSink=$(\"<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>\").appendTo($container),options.createPreHeaderPanel&&($preHeaderPanelScroller=$(\"<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container),$preHeaderPanel=$(\"<div />\").appendTo($preHeaderPanelScroller),$preHeaderPanelSpacer=$(\"<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>\").css(\"width\",getCanvasWidth()+scrollbarDimensions.width+\"px\").appendTo($preHeaderPanelScroller),options.showPreHeaderPanel||$preHeaderPanelScroller.hide()),$headerScroller=$(\"<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container),($headers=$(\"<div class='slick-header-columns' style='left:-1000px' />\").appendTo($headerScroller)).width(getHeadersWidth()),$headerRowScroller=$(\"<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container),$headerRow=$(\"<div class='slick-headerrow-columns' />\").appendTo($headerRowScroller),$headerRowSpacer=$(\"<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>\").css(\"width\",getCanvasWidth()+scrollbarDimensions.width+\"px\").appendTo($headerRowScroller),$topPanelScroller=$(\"<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container),$topPanel=$(\"<div class='slick-top-panel' style='width:10000px' />\").appendTo($topPanelScroller),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),($viewport=$(\"<div class='slick-viewport' style='width:100%;overflow:auto;outline:0;position:relative;;'>\").appendTo($container)).css(\"overflow-y\",options.autoHeight?\"hidden\":\"auto\"),$canvas=$(\"<div class='grid-canvas' />\").appendTo($viewport),options.createFooterRow&&($footerRowScroller=$(\"<div class='slick-footerrow ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container),$footerRow=$(\"<div class='slick-footerrow-columns' />\").appendTo($footerRowScroller),$footerRowSpacer=$(\"<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>\").css(\"width\",getCanvasWidth()+scrollbarDimensions.width+\"px\").appendTo($footerRowScroller),options.showFooterRow||$footerRowScroller.hide()),options.numberedMultiColumnSort&&(sortIndicatorCssClass=\"slick-sort-indicator-numbered\"),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,viewportW=parseFloat($.css($container[0],\"width\",!0)),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.on(\"selectstart.ui\",function(e){return $(e.target).is(\"input,textarea\")}),updateColumnCaches(),createColumnHeaders(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.on(\"resize.slickgrid\",resizeCanvas),$viewport.on(\"scroll\",handleScroll),$headerScroller.on(\"contextmenu\",handleHeaderContextMenu).on(\"click\",handleHeaderClick).on(\"mouseenter\",\".slick-header-column\",handleHeaderMouseEnter).on(\"mouseleave\",\".slick-header-column\",handleHeaderMouseLeave),$headerRowScroller.on(\"scroll\",handleHeaderRowScroll),options.createFooterRow&&$footerRowScroller.on(\"scroll\",handleFooterRowScroll),options.createPreHeaderPanel&&$preHeaderPanelScroller.on(\"scroll\",handlePreHeaderPanelScroll),$focusSink.add($focusSink2).on(\"keydown\",handleKeyDown),$canvas.on(\"keydown\",handleKeyDown).on(\"click\",handleClick).on(\"dblclick\",handleDblClick).on(\"contextmenu\",handleContextMenu).on(\"draginit\",handleDragInit).on(\"dragstart\",{distance:3},handleDragStart).on(\"drag\",handleDrag).on(\"dragend\",handleDragEnd).on(\"mouseenter\",\".slick-cell\",handleMouseEnter).on(\"mouseleave\",\".slick-cell\",handleMouseLeave),navigator.userAgent.toLowerCase().match(/webkit/)&&navigator.userAgent.toLowerCase().match(/macintosh/)&&$canvas.on(\"mousewheel\",handleMouseWheel),restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){($hiddenParents=$container.parents().addBack().not(\":visible\")).each(function(){var e={};for(var t in cssShow)e[t]=this.style[t],this.style[t]=cssShow[t];oldProps.push(e)})}function restoreCssFromHiddenInit(){$hiddenParents.each(function(e){var t=oldProps[e];for(var n in cssShow)this.style[n]=t[n]})}function registerPlugin(e){plugins.unshift(e),e.init(self)}function unregisterPlugin(e){for(var t=plugins.length;0<=t;t--)if(plugins[t]===e){plugins[t].destroy&&plugins[t].destroy(),plugins.splice(t,1);break}}function setSelectionModel(e){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),(selectionModel=e)&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var e=$(\"<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>\").appendTo(\"body\"),t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}function getColumnTotalWidth(e){for(var t=0,n=0,o=columns.length;n<o;n++){var r=columns[n].width;t+=r}return e&&(t+=scrollbarDimensions.width),t}function getHeadersWidth(){var e=getColumnTotalWidth(!0);return Math.max(e,viewportW)+1e3}function getCanvasWidth(){for(var e=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,t=0,n=columns.length;n--;)t+=columns[n].width;return options.fullWidthRows?Math.max(t,e):t}function updateCanvasWidth(e){var t=canvasWidth;(canvasWidth=getCanvasWidth())!=t&&($canvas.width(canvasWidth),$headerRow.width(canvasWidth),options.createFooterRow&&$footerRow.width(canvasWidth),options.createPreHeaderPanel&&$preHeaderPanel.width(canvasWidth),$headers.width(getHeadersWidth()),viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width);var n=canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0);$headerRowSpacer.width(n),options.createFooterRow&&$footerRowSpacer.width(n),options.createPreHeaderPanel&&$preHeaderPanelSpacer.width(n),(canvasWidth!=t||e)&&applyColumnWidths()}function disableSelection(e){e&&e.jquery&&e.attr(\"unselectable\",\"on\").css(\"MozUserSelect\",\"none\").on(\"selectstart.ui\",function(){return!1})}function getMaxSupportedCssHeight(){for(var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=$(\"<div style='display:none' />\").appendTo(document.body);;){var o=2*e;if(n.css(\"height\",o),t<o||n.height()!==o)break;e=o}return n.remove(),e}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function bindAncestorScrollEvents(){for(var e=$canvas[0];(e=e.parentNode)!=document.body&&null!=e;)if(e==$viewport[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight){var t=$(e);$boundAncestors=$boundAncestors?$boundAncestors.add(t):t,t.on(\"scroll.\"+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.off(\"scroll.\"+uid),$boundAncestors=null)}function updateColumnHeader(e,t,n){if(initialized){var o=getColumnIndex(e);if(null!=o){var r=columns[o],i=$headers.children().eq(o);i&&(void 0!==t&&(columns[o].name=t),void 0!==n&&(columns[o].toolTip=n),trigger(self.onBeforeHeaderCellDestroy,{node:i[0],column:r,grid:self}),i.attr(\"title\",n||\"\").children().eq(0).html(t),trigger(self.onHeaderCellRendered,{node:i[0],column:r,grid:self}))}}}function getHeaderRow(){return $headerRow[0]}function getFooterRow(){return $footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getHeaderRowColumn(e){var t=getColumnIndex(e),n=$headerRow.children().eq(t);return n&&n[0]}function getFooterRowColumn(e){var t=getColumnIndex(e),n=$footerRow.children().eq(t);return n&&n[0]}function createColumnHeaders(){function e(){$(this).addClass(\"ui-state-hover\")}function t(){$(this).removeClass(\"ui-state-hover\")}$headers.find(\".slick-header-column\").each(function(){var e=$(this).data(\"column\");e&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:e,grid:self})}),$headers.empty(),$headers.width(getHeadersWidth()),$headerRow.find(\".slick-headerrow-column\").each(function(){var e=$(this).data(\"column\");e&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:e,grid:self})}),$headerRow.empty(),options.createFooterRow&&($footerRow.find(\".slick-footerrow-column\").each(function(){var e=$(this).data(\"column\");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e})}),$footerRow.empty());for(var n=0;n<columns.length;n++){var o=columns[n],r=$(\"<div class='ui-state-default slick-header-column' />\").html(\"<span class='slick-column-name'>\"+o.name+\"</span>\").width(o.width-headerColumnWidthDiff).attr(\"id\",\"\"+uid+o.id).attr(\"title\",o.toolTip||\"\").data(\"column\",o).addClass(o.headerCssClass||\"\").appendTo($headers);if((options.enableColumnReorder||o.sortable)&&r.on(\"mouseenter\",e).on(\"mouseleave\",t),o.sortable&&(r.addClass(\"slick-header-sortable\"),r.append(\"<span class='\"+sortIndicatorCssClass+\"' />\")),trigger(self.onHeaderCellRendered,{node:r[0],column:o,grid:self}),options.showHeaderRow){var i=$(\"<div class='ui-state-default slick-headerrow-column l\"+n+\" r\"+n+\"'></div>\").data(\"column\",o).appendTo($headerRow);trigger(self.onHeaderRowCellRendered,{node:i[0],column:o,grid:self})}if(options.createFooterRow&&options.showFooterRow){var l=$(\"<div class='ui-state-default slick-footerrow-column l\"+n+\" r\"+n+\"'></div>\").data(\"column\",o).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:l[0],column:o})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&(\"function\"==typeof options.enableColumnReorder?options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger):setupColumnReorder())}function setupColumnSort(){$headers.click(function(e){if(e.metaKey=e.metaKey||e.ctrlKey,!$(e.target).hasClass(\"slick-resizable-handle\")){var t=$(e.target).closest(\".slick-header-column\");if(t.length){var n=t.data(\"column\");if(n.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var o=null,r=0;r<sortColumns.length;r++)if(sortColumns[r].columnId==n.id){(o=sortColumns[r]).sortAsc=!o.sortAsc;break}var i=!!o;options.tristateMultiColumnSort?(o||(o={columnId:n.id,sortAsc:n.defaultSortAsc}),i&&o.sortAsc&&(sortColumns.splice(r,1),o=null),options.multiColumnSort||(sortColumns=[]),!o||i&&options.multiColumnSort||sortColumns.push(o)):e.metaKey&&options.multiColumnSort?o&&sortColumns.splice(r,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),o?0==sortColumns.length&&sortColumns.push(o):(o={columnId:n.id,sortAsc:n.defaultSortAsc},sortColumns.push(o))),setSortColumns(sortColumns),0<sortColumns.length&&(options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:$.map(sortColumns,function(e){return{sortCol:columns[getColumnIndex(e.columnId)],sortAsc:e.sortAsc}}),grid:self},e):trigger(self.onSort,{multiColumnSort:!1,sortCol:n,sortAsc:sortColumns[0].sortAsc,grid:self},e))}}}})}function setupColumnReorder(){$headers.filter(\":ui-sortable\").sortable(\"destroy\"),$headers.sortable({containment:\"parent\",distance:3,axis:\"x\",cursor:\"default\",tolerance:\"intersection\",helper:\"clone\",placeholder:\"slick-sortable-placeholder ui-state-default slick-header-column\",start:function(e,t){t.placeholder.width(t.helper.outerWidth()-headerColumnWidthDiff),$(t.helper).addClass(\"slick-header-column-active\")},beforeStop:function(e,t){$(t.helper).removeClass(\"slick-header-column-active\")},stop:function(e){if(getEditorLock().commitCurrentEdit()){for(var t=$headers.sortable(\"toArray\"),n=[],o=0;o<t.length;o++)n.push(columns[getColumnIndex(t[o].replace(uid,\"\"))]);setColumns(n),trigger(self.onColumnsReordered,{grid:self}),e.stopPropagation(),setupColumnResize()}else $(this).sortable(\"cancel\")}})}function setupColumnResize(){var s,a,c,u,d,p,n,o;(u=$headers.children()).find(\".slick-resizable-handle\").remove(),u.each(function(e,t){e>=columns.length||columns[e].resizable&&(void 0===n&&(n=e),o=e)}),void 0!==n&&u.each(function(l,e){l>=columns.length||l<n||options.forceFitColumns&&o<=l||($(e),$(\"<div class='slick-resizable-handle' />\").appendTo(e).on(\"dragstart\",function(e,t){if(!getEditorLock().commitCurrentEdit())return!1;c=e.pageX,$(this).parent().addClass(\"slick-header-column-active\");var n=null,o=null;if(u.each(function(e,t){e>=columns.length||(columns[e].previousWidth=$(t).outerWidth())}),options.forceFitColumns)for(o=n=0,s=l+1;s<columns.length;s++)(a=columns[s]).resizable&&(null!==o&&(a.maxWidth?o+=a.maxWidth-a.previousWidth:o=null),n+=a.previousWidth-Math.max(a.minWidth||0,absoluteColumnMinWidth));var r=0,i=0;for(s=0;s<=l;s++)(a=columns[s]).resizable&&(null!==i&&(a.maxWidth?i+=a.maxWidth-a.previousWidth:i=null),r+=a.previousWidth-Math.max(a.minWidth||0,absoluteColumnMinWidth));null===n&&(n=1e5),null===r&&(r=1e5),null===o&&(o=1e5),null===i&&(i=1e5),p=c+Math.min(n,i),d=c-Math.min(r,o)}).on(\"drag\",function(e,t){var n,o,r=Math.min(p,Math.max(d,e.pageX))-c;if(r<0){for(o=r,s=l;0<=s;s--)(a=columns[s]).resizable&&(n=Math.max(a.minWidth||0,absoluteColumnMinWidth),o&&a.previousWidth+o<n?(o+=a.previousWidth-n,a.width=n):(a.width=a.previousWidth+o,o=0));if(options.forceFitColumns)for(o=-r,s=l+1;s<columns.length;s++)(a=columns[s]).resizable&&(o&&a.maxWidth&&a.maxWidth-a.previousWidth<o?(o-=a.maxWidth-a.previousWidth,a.width=a.maxWidth):(a.width=a.previousWidth+o,o=0))}else{for(o=r,s=l;0<=s;s--)(a=columns[s]).resizable&&(o&&a.maxWidth&&a.maxWidth-a.previousWidth<o?(o-=a.maxWidth-a.previousWidth,a.width=a.maxWidth):(a.width=a.previousWidth+o,o=0));if(options.forceFitColumns)for(o=-r,s=l+1;s<columns.length;s++)(a=columns[s]).resizable&&(n=Math.max(a.minWidth||0,absoluteColumnMinWidth),o&&a.previousWidth+o<n?(o+=a.previousWidth-n,a.width=n):(a.width=a.previousWidth+o,o=0))}applyColumnHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths()}).on(\"dragend\",function(e,t){var n;for($(this).parent().removeClass(\"slick-header-column-active\"),s=0;s<columns.length;s++)a=columns[s],n=$(u[s]).outerWidth(),a.previousWidth!==n&&a.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{grid:self})}))})}function getVBoxDelta(n){var o=0;return $.each([\"borderTopWidth\",\"borderBottomWidth\",\"paddingTop\",\"paddingBottom\"],function(e,t){o+=parseFloat(n.css(t))||0}),o}function measureCellPaddingAndBorder(){var n,e=[\"borderLeftWidth\",\"borderRightWidth\",\"paddingLeft\",\"paddingRight\"],t=[\"borderTopWidth\",\"borderBottomWidth\",\"paddingTop\",\"paddingBottom\"],o=$.fn.jquery.split(\".\");jQueryNewWidthBehaviour=1==o[0]&&8<=o[1]||2<=o[0],n=$(\"<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>\").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,\"border-box\"!=n.css(\"box-sizing\")&&\"border-box\"!=n.css(\"-moz-box-sizing\")&&\"border-box\"!=n.css(\"-webkit-box-sizing\")&&($.each(e,function(e,t){headerColumnWidthDiff+=parseFloat(n.css(t))||0}),$.each(t,function(e,t){headerColumnHeightDiff+=parseFloat(n.css(t))||0})),n.remove();var r=$(\"<div class='slick-row' />\").appendTo($canvas);n=$(\"<div class='slick-cell' id='' style='visibility:hidden'>-</div>\").appendTo(r),cellWidthDiff=cellHeightDiff=0,\"border-box\"!=n.css(\"box-sizing\")&&\"border-box\"!=n.css(\"-moz-box-sizing\")&&\"border-box\"!=n.css(\"-webkit-box-sizing\")&&($.each(e,function(e,t){cellWidthDiff+=parseFloat(n.css(t))||0}),$.each(t,function(e,t){cellHeightDiff+=parseFloat(n.css(t))||0})),r.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$(\"<style type='text/css' rel='stylesheet' />\").appendTo($(\"head\"));for(var e=options.rowHeight-cellHeightDiff,t=[\".\"+uid+\" .slick-header-column { left: 1000px; }\",\".\"+uid+\" .slick-top-panel { height:\"+options.topPanelHeight+\"px; }\",\".\"+uid+\" .slick-preheader-panel { height:\"+options.preHeaderPanelHeight+\"px; }\",\".\"+uid+\" .slick-headerrow-columns { height:\"+options.headerRowHeight+\"px; }\",\".\"+uid+\" .slick-footerrow-columns { height:\"+options.footerRowHeight+\"px; }\",\".\"+uid+\" .slick-cell { height:\"+e+\"px; }\",\".\"+uid+\" .slick-row { height:\"+options.rowHeight+\"px; }\"],n=0;n<columns.length;n++)t.push(\".\"+uid+\" .l\"+n+\" { }\"),t.push(\".\"+uid+\" .r\"+n+\" { }\");$style[0].styleSheet?$style[0].styleSheet.cssText=t.join(\" \"):$style[0].appendChild(document.createTextNode(t.join(\" \")))}function getColumnCssRules(e){var t;if(!stylesheet){var n=document.styleSheets;for(t=0;t<n.length;t++)if((n[t].ownerNode||n[t].owningElement)==$style[0]){stylesheet=n[t];break}if(!stylesheet)throw new Error(\"Cannot find stylesheet.\");columnCssRulesL=[],columnCssRulesR=[];var o,r,i=stylesheet.cssRules||stylesheet.rules;for(t=0;t<i.length;t++){var l=i[t].selectorText;(o=/\\.l\\d+/.exec(l))?(r=parseInt(o[0].substr(2,o[0].length-2),10),columnCssRulesL[r]=i[t]):(o=/\\.r\\d+/.exec(l))&&(r=parseInt(o[0].substr(2,o[0].length-2),10),columnCssRulesR[r]=i[t])}}return{left:columnCssRulesL[e],right:columnCssRulesR[e]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{grid:self});for(var e=plugins.length;e--;)unregisterPlugin(plugins[e]);options.enableColumnReorder&&$headers.filter(\":ui-sortable\").sortable(\"destroy\"),unbindAncestorScrollEvents(),$container.off(\".slickgrid\"),removeCssRules(),$canvas.off(\"draginit dragstart dragend drag\"),$container.empty().removeClass(uid)}function trigger(e,t,n){return n=n||new Slick.EventData,(t=t||{}).grid=self,e.notify(t,n,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function autosizeColumns(){var e,t,n,o=[],r=0,i=0,l=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(e=0;e<columns.length;e++)t=columns[e],o.push(t.width),i+=t.width,t.resizable&&(r+=t.width-Math.max(t.minWidth,absoluteColumnMinWidth));for(n=i;l<i&&r;){var s=(i-l)/r;for(e=0;e<columns.length&&l<i;e++){t=columns[e];var a=o[e];if(!(!t.resizable||a<=t.minWidth||a<=absoluteColumnMinWidth)){var c=Math.max(t.minWidth,absoluteColumnMinWidth),u=Math.floor(s*(a-c))||1;u=Math.min(u,a-c),i-=u,r-=u,o[e]-=u}}if(n<=i)break;n=i}for(n=i;i<l;){var d=l/i;for(e=0;e<columns.length&&i<l;e++){t=columns[e];var p,f=o[e];p=!t.resizable||t.maxWidth<=f?0:Math.min(Math.floor(d*f)-f,t.maxWidth-f||1e6)||1,i+=p,o[e]+=i<=l?p:0}if(i<=n)break;n=i}var h=!1;for(e=0;e<columns.length;e++)columns[e].rerenderOnResize&&columns[e].width!=o[e]&&(h=!0),columns[e].width=o[e];applyColumnHeaderWidths(),updateCanvasWidth(!0),h&&(invalidateAllRows(),render())}function applyColumnHeaderWidths(){if(initialized){for(var e,t=0,n=$headers.children(),o=columns.length;t<o;t++)e=$(n[t]),jQueryNewWidthBehaviour?e.outerWidth()!==columns[t].width&&e.outerWidth(columns[t].width):e.width()!==columns[t].width-headerColumnWidthDiff&&e.width(columns[t].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var e,t,n=0,o=0;o<columns.length;o++)e=columns[o].width,(t=getColumnCssRules(o)).left.style.left=n+\"px\",t.right.style.right=canvasWidth-n-e+\"px\",n+=columns[o].width}function setSortColumn(e,t){setSortColumns([{columnId:e,sortAsc:t}])}function setSortColumns(e){sortColumns=e;var o=options.numberedMultiColumnSort&&1<sortColumns.length,r=$headers.children(),i=r.removeClass(\"slick-header-column-sorted\").find(\".\"+sortIndicatorCssClass).removeClass(\"slick-sort-indicator-asc slick-sort-indicator-desc\");o&&i.text(\"\"),$.each(sortColumns,function(e,t){null==t.sortAsc&&(t.sortAsc=!0);var n=getColumnIndex(t.columnId);null!=n&&(i=r.eq(n).addClass(\"slick-header-column-sorted\").find(\".\"+sortIndicatorCssClass).addClass(t.sortAsc?\"slick-sort-indicator-asc\":\"slick-sort-indicator-desc\"),o&&i.text(e+1))})}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,t){selectedRows=[];for(var n={},o=0;o<t.length;o++)for(var r=t[o].fromRow;r<=t[o].toRow;r++){n[r]||(selectedRows.push(r),n[r]={});for(var i=t[o].fromCell;i<=t[o].toCell;i++)canCellBeSelected(r,i)&&(n[r][columns[i].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,n),trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),grid:self},e)}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var e=0,t=0,n=columns.length;t<n;t++)columnPosLeft[t]=e,columnPosRight[t]=e+columns[t].width,e+=columns[t].width}function setColumns(e){columns=e,columnsById={};for(var t=0;t<columns.length;t++){var n=columns[t]=$.extend({},columnDefaults,columns[t]);columnsById[n.id]=t,n.minWidth&&n.width<n.minWidth&&(n.width=n.minWidth),n.maxWidth&&n.width>n.maxWidth&&(n.width=n.maxWidth)}updateColumnCaches(),initialized&&(invalidateAllRows(),createColumnHeaders(),removeCssRules(),createCssRules(),resizeCanvas(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(e,t){getEditorLock().commitCurrentEdit()&&(makeActiveCellNormal(),options.enableAddRow!==e.enableAddRow&&invalidateRow(getDataLength()),options=$.extend(options,e),validateAndEnforceOptions(),$viewport.css(\"overflow-y\",options.autoHeight?\"hidden\":\"auto\"),t||render())}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1)}function setData(e,t){data=e,invalidateAllRows(),updateRowCount(),t&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data.length}function getDataLengthIncludingAddNew(){return getDataLength()+(options.enableAddRow&&(!pagingActive||pagingIsLastPage)?1:0)}function getDataItem(e){return data.getItem?data.getItem(e):data[e]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(e){options.showTopPanel!=e&&((options.showTopPanel=e)?$topPanelScroller.slideDown(\"fast\",resizeCanvas):$topPanelScroller.slideUp(\"fast\",resizeCanvas))}function setHeaderRowVisibility(e){options.showHeaderRow!=e&&((options.showHeaderRow=e)?$headerRowScroller.slideDown(\"fast\",resizeCanvas):$headerRowScroller.slideUp(\"fast\",resizeCanvas))}function setFooterRowVisibility(e){options.showFooterRow!=e&&((options.showFooterRow=e)?$footerRowScroller.slideDown(\"fast\",resizeCanvas):$footerRowScroller.slideUp(\"fast\",resizeCanvas))}function setPreHeaderPanelVisibility(e){options.showPreHeaderPanel!=e&&((options.showPreHeaderPanel=e)?$preHeaderPanelScroller.slideDown(\"fast\",resizeCanvas):$preHeaderPanelScroller.slideUp(\"fast\",resizeCanvas))}function getContainerNode(){return $container.get(0)}function getRowTop(e){return options.rowHeight*e-offset}function getRowFromPosition(e){return Math.floor((e+offset)/options.rowHeight)}function scrollTo(e){e=Math.max(e,0),e=Math.min(e,th-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0));var t=offset;page=Math.min(n-1,Math.floor(e/ph)),offset=Math.round(page*cj);var o=e-offset;if(offset!=t){var r=getVisibleRange(o);cleanupRows(r),updateRowPositions()}prevScrollTop!=o&&(vScrollDir=prevScrollTop+t<o+offset?1:-1,$viewport[0].scrollTop=lastRenderedScrollTop=scrollTop=prevScrollTop=o,trigger(self.onViewportChanged,{grid:self}))}function defaultFormatter(e,t,n,o,r){return null==n?\"\":(n+\"\").replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}function getFormatter(e,t){var n=data.getItemMetadata&&data.getItemMetadata(e),o=n&&n.columns&&(n.columns[t.id]||n.columns[getColumnIndex(t.id)]);return o&&o.formatter||n&&n.formatter||t.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(t)||options.defaultFormatter}function getEditor(e,t){var n=columns[t],o=data.getItemMetadata&&data.getItemMetadata(e),r=o&&o.columns;return r&&r[n.id]&&void 0!==r[n.id].editor?r[n.id].editor:r&&r[t]&&void 0!==r[t].editor?r[t].editor:n.editor||options.editorFactory&&options.editorFactory.getEditor(n)}function getDataItemValueForColumn(e,t){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(e,t):e[t.field]}function appendRowHtml(e,t,n,o){var r=getDataItem(t),i=t<o&&!r,l=\"slick-row\"+(i?\" loading\":\"\")+(t===activeRow?\" active\":\"\")+(t%2==1?\" odd\":\" even\");r||(l+=\" \"+options.addNewRowCssClass);var s,a,c=data.getItemMetadata&&data.getItemMetadata(t);c&&c.cssClasses&&(l+=\" \"+c.cssClasses),e.push(\"<div class='ui-widget-content \"+l+\"' style='top:\"+getRowTop(t)+\"px'>\");for(var u=0,d=columns.length;u<d;u++){if(a=columns[u],s=1,c&&c.columns){var p=c.columns[a.id]||c.columns[u];\"*\"===(s=p&&p.colspan||1)&&(s=d-u)}if(columnPosRight[Math.min(d-1,u+s-1)]>n.leftPx){if(columnPosLeft[u]>n.rightPx)break;appendCellHtml(e,t,u,s,r)}1<s&&(u+=s-1)}e.push(\"</div>\")}function appendCellHtml(e,t,n,o,r){var i=columns[n],l=\"slick-cell l\"+n+\" r\"+Math.min(columns.length-1,n+o-1)+(i.cssClass?\" \"+i.cssClass:\"\");for(var s in t===activeRow&&n===activeCell&&(l+=\" active\"),cellCssClasses)cellCssClasses[s][t]&&cellCssClasses[s][t][i.id]&&(l+=\" \"+cellCssClasses[s][t][i.id]);var a=null;r&&(a=getDataItemValueForColumn(r,i));var c=getFormatter(t,i)(t,n,a,i,r),u=trigger(self.onBeforeAppendCell,{row:t,cell:n,grid:self,value:a,dataContext:r})||\"\";u+=c.addClasses?(u?\" \":\"\")+c.addClasses:\"\",e.push(\"<div class='\"+l+(u?\" \"+u:\"\")+\"'>\"),r&&e.push(\"object\"!=typeof c?c:c.text),e.push(\"</div>\"),rowsCache[t].cellRenderQueue.push(n),rowsCache[t].cellColSpans[n]=o}function cleanupRows(e){for(var t in rowsCache)(t=parseInt(t,10))!==activeRow&&(t<e.top||t>e.bottom)&&removeRowFromCache(t);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){for(var e in currentEditor&&makeActiveCellNormal(),rowsCache)removeRowFromCache(e);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function queuePostProcessedRowForCleanup(e,t,n){for(var o in postProcessgroupId++,t)t.hasOwnProperty(o)&&postProcessedCleanupQueue.push({actionType:\"C\",groupId:postProcessgroupId,node:e.cellNodesByColumnIdx[0|o],columnIdx:0|o,rowIdx:n});postProcessedCleanupQueue.push({actionType:\"R\",groupId:postProcessgroupId,node:e.rowNode}),$(e.rowNode).detach()}function queuePostProcessedCellForCleanup(e,t,n){postProcessedCleanupQueue.push({actionType:\"C\",groupId:postProcessgroupId,node:e,columnIdx:t,rowIdx:n}),$(e).detach()}function removeRowFromCache(e){var t=rowsCache[e];t&&(rowNodeFromLastMouseWheelEvent===t.rowNode?(t.rowNode.style.display=\"none\",zombieRowNodeFromLastMouseWheelEvent=rowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent=t,zombieRowPostProcessedFromLastMouseWheelEvent=postProcessedRows[e]):options.enableAsyncPostRenderCleanup&&postProcessedRows[e]?queuePostProcessedRowForCleanup(t,postProcessedRows[e],e):$canvas[0].removeChild(t.rowNode),delete rowsCache[e],delete postProcessedRows[e],renderedRows--,counter_rows_removed++)}function invalidateRows(e){var t,n;if(e&&e.length){for(vScrollDir=0,n=e.length,t=0;t<n;t++)currentEditor&&activeRow===e[t]&&makeActiveCellNormal(),rowsCache[e[t]]&&removeRowFromCache(e[t]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(e){invalidateRows([e])}function applyFormatResultToCellNode(e,t,n){\"object\"==typeof e?(t.innerHTML=e.text,e.removeClasses&&!n&&t.removeClass(e.removeClasses),e.addClasses&&t.addClass(e.addClasses)):t.innerHTML=e}function updateCell(e,t){var n=getCellNode(e,t);if(n){var o=columns[t],r=getDataItem(e);if(currentEditor&&activeRow===e&&activeCell===t)currentEditor.loadValue(r);else{var i=r?getFormatter(e,o)(e,t,getDataItemValueForColumn(r,o),o,r):\"\";applyFormatResultToCellNode(i,n),invalidatePostProcessingResults(e)}}}function updateRow(e){var t=rowsCache[e];if(t){ensureCellNodesInRowsCache(e);var n=getDataItem(e);for(var o in t.cellNodesByColumnIdx)if(t.cellNodesByColumnIdx.hasOwnProperty(o)){var r=columns[o|=0],i=t.cellNodesByColumnIdx[o];e===activeRow&&o===activeCell&&currentEditor?currentEditor.loadValue(n):n?applyFormatResultToCellNode(getFormatter(e,r)(e,o,getDataItemValueForColumn(n,r),r,n),i):i.innerHTML=\"\"}invalidatePostProcessingResults(e)}}function getViewportHeight(){return parseFloat($.css($container[0],\"height\",!0))-parseFloat($.css($container[0],\"paddingTop\",!0))-parseFloat($.css($container[0],\"paddingBottom\",!0))-parseFloat($.css($headerScroller[0],\"height\"))-getVBoxDelta($headerScroller)-(options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0)-(options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0)-(options.createFooterRow&&options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0)-(options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0)}function resizeCanvas(){initialized&&(viewportH=options.autoHeight?options.rowHeight*getDataLengthIncludingAddNew():getViewportHeight(),numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportW=parseFloat($.css($container[0],\"width\",!0)),options.autoHeight||$viewport.height(viewportH),options.forceFitColumns&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render())}function updatePagingStatusFromView(e){pagingActive=0!==e.pageSize,pagingIsLastPage=e.pageNum==e.totalPages-1}function updateRowCount(){if(initialized){var e=getDataLength(),t=getDataLengthIncludingAddNew(),o=t+(options.leaveSpaceForNewRows?numVisibleRows-1:0),r=viewportHasVScroll;viewportHasVScroll=!options.autoHeight&&o*options.rowHeight>viewportH,viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width,makeActiveCellNormal();var i=e-1;for(var l in rowsCache)i<l&&removeRowFromCache(l);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&i<activeRow&&resetActiveCell();var s=h;(th=Math.max(options.rowHeight*o,viewportH-scrollbarDimensions.height))<maxSupportedCssHeight?(h=ph=th,n=1,cj=0):(ph=(h=maxSupportedCssHeight)/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==s&&($canvas.css(\"height\",h),scrollTop=$viewport[0].scrollTop);var a=scrollTop+offset<=th-viewportH;0==th||0==scrollTop?page=offset=0:scrollTo(a?scrollTop+offset:th-viewportH),h!=s&&options.autoHeight&&resizeCanvas(),options.forceFitColumns&&r!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(e,t){return null==e&&(e=scrollTop),null==t&&(t=scrollLeft),{top:getRowFromPosition(e),bottom:getRowFromPosition(e+viewportH)+1,leftPx:t,rightPx:t+viewportW}}function getRenderedRange(e,t){var n=getVisibleRange(e,t),o=Math.round(viewportH/options.rowHeight);return-1==vScrollDir?(n.top-=o,n.bottom+=3):1==vScrollDir?(n.top-=3,n.bottom+=o):(n.top-=3,n.bottom+=3),n.top=Math.max(0,n.top),n.bottom=Math.min(getDataLengthIncludingAddNew()-1,n.bottom),n.leftPx-=viewportW,n.rightPx+=viewportW,n.leftPx=Math.max(0,n.leftPx),n.rightPx=Math.min(canvasWidth,n.rightPx),n}function ensureCellNodesInRowsCache(e){var t=rowsCache[e];if(t&&t.cellRenderQueue.length)for(var n=t.rowNode.lastChild;t.cellRenderQueue.length;){var o=t.cellRenderQueue.pop();n=(t.cellNodesByColumnIdx[o]=n).previousSibling}}function cleanUpCells(e,t){var n,o,r=rowsCache[t],i=[];for(var l in r.cellNodesByColumnIdx)if(r.cellNodesByColumnIdx.hasOwnProperty(l)){l|=0;var s=r.cellColSpans[l];(columnPosLeft[l]>e.rightPx||columnPosRight[Math.min(columns.length-1,l+s-1)]<e.leftPx)&&(t==activeRow&&l==activeCell||i.push(l))}for(postProcessgroupId++;null!=(n=i.pop());)o=r.cellNodesByColumnIdx[n],options.enableAsyncPostRenderCleanup&&postProcessedRows[t]&&postProcessedRows[t][n]?queuePostProcessedCellForCleanup(o,n,t):r.rowNode.removeChild(o),delete r.cellColSpans[n],delete r.cellNodesByColumnIdx[n],postProcessedRows[t]&&delete postProcessedRows[t][n],0}function cleanUpAndRenderCells(e){for(var t,n,o,r=[],i=[],l=e.top,s=e.bottom;l<=s;l++)if(t=rowsCache[l]){ensureCellNodesInRowsCache(l),cleanUpCells(e,l),n=0;var a=data.getItemMetadata&&data.getItemMetadata(l);a=a&&a.columns;for(var c=getDataItem(l),u=0,d=columns.length;u<d&&!(columnPosLeft[u]>e.rightPx);u++)if(null==(o=t.cellColSpans[u])){if(o=1,a){var p=a[columns[u].id]||a[u];\"*\"===(o=p&&p.colspan||1)&&(o=d-u)}columnPosRight[Math.min(d-1,u+o-1)]>e.leftPx&&(appendCellHtml(r,l,u,o,c),n++),u+=1<o?o-1:0}else u+=1<o?o-1:0;n&&(n,i.push(l))}if(r.length){var f,h,g=document.createElement(\"div\");for(g.innerHTML=r.join(\"\");null!=(f=i.pop());){var m;for(t=rowsCache[f];null!=(m=t.cellRenderQueue.pop());)h=g.lastChild,t.rowNode.appendChild(h),t.cellNodesByColumnIdx[m]=h}}}function renderRows(e){for(var t=$canvas[0],n=[],o=[],r=!1,i=getDataLength(),l=e.top,s=e.bottom;l<=s;l++)rowsCache[l]||(renderedRows++,o.push(l),rowsCache[l]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(n,l,e,i),activeCellNode&&activeRow===l&&(r=!0),counter_rows_rendered++);if(o.length){var a=document.createElement(\"div\");a.innerHTML=n.join(\"\");for(var l=0,s=o.length;l<s;l++)rowsCache[o[l]].rowNode=t.appendChild(a.firstChild);r&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(e){for(var t in postProcessedRows[e])postProcessedRows[e].hasOwnProperty(t)&&(postProcessedRows[e][t]=\"C\");postProcessFromRow=Math.min(postProcessFromRow,e),postProcessToRow=Math.max(postProcessToRow,e),startPostProcessing()}function updateRowPositions(){for(var e in rowsCache)rowsCache[e].rowNode.style.top=getRowTop(e)+\"px\"}function render(){if(initialized){var e=getVisibleRange(),t=getRenderedRange();cleanupRows(t),lastRenderedScrollLeft!=scrollLeft&&cleanUpAndRenderCells(t),renderRows(t),postProcessFromRow=e.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,e.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null}}function handleHeaderRowScroll(){var e=$headerRowScroller[0].scrollLeft;e!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=e)}function handleFooterRowScroll(){var e=$footerRowScroller[0].scrollLeft;e!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=e)}function handlePreHeaderPanelScroll(){var e=$preHeaderPanelScroller[0].scrollLeft;e!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=e)}function handleScroll(){scrollTop=$viewport[0].scrollTop,scrollLeft=$viewport[0].scrollLeft;var e=Math.abs(scrollTop-prevScrollTop),t=Math.abs(scrollLeft-prevScrollLeft);if(t&&(prevScrollLeft=scrollLeft,$headerScroller[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScroller[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScroller[0].scrollLeft=scrollLeft),options.createPreHeaderPanel&&($preHeaderPanelScroller[0].scrollLeft=scrollLeft)),e)if(vScrollDir=prevScrollTop<scrollTop?1:-1,prevScrollTop=scrollTop,e<viewportH)scrollTo(scrollTop+offset);else{var o=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),offset=Math.round(page*cj),o!=offset&&invalidateAllRows()}(t||e)&&(h_render&&clearTimeout(h_render),(20<Math.abs(lastRenderedScrollTop-scrollTop)||20<Math.abs(lastRenderedScrollLeft-scrollLeft))&&(options.forceSyncScrolling||Math.abs(lastRenderedScrollTop-scrollTop)<viewportH&&Math.abs(lastRenderedScrollLeft-scrollLeft)<viewportW?render():h_render=setTimeout(render,50),trigger(self.onViewportChanged,{grid:self}))),trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop,grid:self})}function asyncPostProcessRows(){for(var e=getDataLength();postProcessFromRow<=postProcessToRow;){var t=0<=vScrollDir?postProcessFromRow++:postProcessToRow--,n=rowsCache[t];if(n&&!(e<=t)){for(var o in postProcessedRows[t]||(postProcessedRows[t]={}),ensureCellNodesInRowsCache(t),n.cellNodesByColumnIdx)if(n.cellNodesByColumnIdx.hasOwnProperty(o)){var r=columns[o|=0],i=postProcessedRows[t][o];if(r.asyncPostRender&&\"R\"!==i){var l=n.cellNodesByColumnIdx[o];l&&r.asyncPostRender(l,t,getDataItem(t),r,\"C\"===i),postProcessedRows[t][o]=\"R\"}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function asyncPostProcessCleanupRows(){if(0<postProcessedCleanupQueue.length){for(var e=postProcessedCleanupQueue[0].groupId;0<postProcessedCleanupQueue.length&&postProcessedCleanupQueue[0].groupId==e;){var t=postProcessedCleanupQueue.shift();if(\"R\"==t.actionType&&$(t.node).remove(),\"C\"==t.actionType){var n=columns[t.columnIdx];n.asyncPostRenderCleanup&&t.node&&n.asyncPostRenderCleanup(t.node,t.rowIdx,n)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(e,t){var n,o,r,i;for(var l in rowsCache){if(i=t&&t[l],r=e&&e[l],i)for(o in i)r&&i[o]==r[o]||(n=getCellNode(l,getColumnIndex(o)))&&$(n).removeClass(i[o]);if(r)for(o in r)i&&i[o]==r[o]||(n=getCellNode(l,getColumnIndex(o)))&&$(n).addClass(r[o])}}function addCellCssStyles(e,t){if(cellCssClasses[e])throw new Error(\"addCellCssStyles: cell CSS hash with key '\"+e+\"' already exists.\");updateCellCssStylesOnRenderedRows(cellCssClasses[e]=t,null),trigger(self.onCellCssStylesChanged,{key:e,hash:t,grid:self})}function removeCellCssStyles(e){cellCssClasses[e]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[e]),delete cellCssClasses[e],trigger(self.onCellCssStylesChanged,{key:e,hash:null,grid:self}))}function setCellCssStyles(e,t){var n=cellCssClasses[e];updateCellCssStylesOnRenderedRows(cellCssClasses[e]=t,n),trigger(self.onCellCssStylesChanged,{key:e,hash:t,grid:self})}function getCellCssStyles(e){return cellCssClasses[e]}function flashCell(e,t,n){if(n=n||100,rowsCache[e]){var o=$(getCellNode(e,t)),r=function(e){e&&setTimeout(function(){o.queue(function(){o.toggleClass(options.cellFlashingCssClass).dequeue(),r(e-1)})},n)};r(4)}}function handleMouseWheel(e){var t=$(e.target).closest(\".slick-row\")[0];t!=rowNodeFromLastMouseWheelEvent&&(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent!=t&&(options.enableAsyncPostRenderCleanup&&zombieRowPostProcessedFromLastMouseWheelEvent?queuePostProcessedRowForCleanup(zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent):$canvas[0].removeChild(zombieRowNodeFromLastMouseWheelEvent),zombieRowPostProcessedFromLastMouseWheelEvent=zombieRowCacheFromLastMouseWheelEvent=zombieRowNodeFromLastMouseWheelEvent=null,options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()),rowNodeFromLastMouseWheelEvent=t)}function handleDragInit(e,t){var n=getCellFromEvent(e);if(!n||!cellExists(n.row,n.cell))return!1;var o=trigger(self.onDragInit,t,e);return!!e.isImmediatePropagationStopped()&&o}function handleDragStart(e,t){var n=getCellFromEvent(e);if(!n||!cellExists(n.row,n.cell))return!1;var o=trigger(self.onDragStart,t,e);return!!e.isImmediatePropagationStopped()&&o}function handleDrag(e,t){return trigger(self.onDrag,t,e)}function handleDragEnd(e,t){trigger(self.onDragEnd,t,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell,grid:self},e);var t=e.isImmediatePropagationStopped(),n=Slick.keyCode;if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)e.which!=n.TAB||!e.shiftKey||e.ctrlKey||e.altKey||(t=navigatePrev());else{if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&-1<currentEditor.keyCaptureList.indexOf(e.which))return;if(e.which==n.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else e.which==n.PAGE_DOWN?(navigatePageDown(),t=!0):e.which==n.PAGE_UP?(navigatePageUp(),t=!0):e.which==n.LEFT?t=navigateLeft():e.which==n.RIGHT?t=navigateRight():e.which==n.UP?t=navigateUp():e.which==n.DOWN?t=navigateDown():e.which==n.TAB?t=navigateNext():e.which==n.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable()),t=!0)}if(t){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}}function handleClick(e){currentEditor||(e.target!=document.activeElement||$(e.target).hasClass(\"slick-cell\"))&&setFocus();var t=getCellFromEvent(e);if(t&&(null===currentEditor||activeRow!=t.row||activeCell!=t.cell)&&(trigger(self.onClick,{row:t.row,cell:t.cell,grid:self},e),!e.isImmediatePropagationStopped()&&canCellBeActive(t.row,t.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()))){scrollRowIntoView(t.row,!1);var n=e.target&&e.target.className===Slick.preClickClassName;setActiveCellInternal(getCellNode(t.row,t.cell),null,n)}}function handleContextMenu(e){var t=$(e.target).closest(\".slick-cell\",$canvas);0!==t.length&&(activeCellNode===t[0]&&null!==currentEditor||trigger(self.onContextMenu,{grid:self},e))}function handleDblClick(e){var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onDblClick,{row:t.row,cell:t.cell,grid:self},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(t.row,t.cell,!0))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$(this).data(\"column\"),grid:self},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$(this).data(\"column\"),grid:self},e)}function handleHeaderContextMenu(e){var t=$(e.target).closest(\".slick-header-column\",\".slick-header-columns\"),n=t&&t.data(\"column\");trigger(self.onHeaderContextMenu,{column:n,grid:self},e)}function handleHeaderClick(e){var t=$(e.target).closest(\".slick-header-column\",\".slick-header-columns\"),n=t&&t.data(\"column\");n&&trigger(self.onHeaderClick,{column:n,grid:self},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{grid:self},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{grid:self},e)}function cellExists(e,t){return!(e<0||e>=getDataLength()||t<0||t>=columns.length)}function getCellFromPoint(e,t){for(var n=getRowFromPosition(t),o=0,r=0,i=0;i<columns.length&&r<e;i++)r+=columns[i].width,o++;return o<0&&(o=0),{row:n,cell:o-1}}function getCellFromNode(e){var t=/l\\d+/.exec(e.className);if(!t)throw new Error(\"getCellFromNode: cannot get cell - \"+e.className);return parseInt(t[0].substr(1,t[0].length-1),10)}function getRowFromNode(e){for(var t in rowsCache)if(rowsCache[t].rowNode===e)return 0|t;return null}function getCellFromEvent(e){var t=$(e.target).closest(\".slick-cell\",$canvas);if(!t.length)return null;var n=getRowFromNode(t[0].parentNode),o=getCellFromNode(t[0]);return null==n||null==o?null:{row:n,cell:o}}function getCellNodeBox(e,t){if(!cellExists(e,t))return null;for(var n=getRowTop(e),o=n+options.rowHeight-1,r=0,i=0;i<t;i++)r+=columns[i].width;var l=r+columns[t].width;return{top:n,left:r,bottom:o,right:l}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(e,t,n){scrollRowIntoView(e,n);var o=getColspan(e,t);internalScrollColumnIntoView(columnPosLeft[t],columnPosRight[t+(1<o?o-1:0)])}function internalScrollColumnIntoView(e,t){var n=scrollLeft+viewportW;e<scrollLeft?($viewport.scrollLeft(e),handleScroll(),render()):n<t&&($viewport.scrollLeft(Math.min(e,t-$viewport[0].clientWidth)),handleScroll(),render())}function scrollColumnIntoView(e){internalScrollColumnIntoView(columnPosLeft[e],columnPosRight[e])}function setActiveCellInternal(e,t,n,o){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass(\"active\"),rowsCache[activeRow]&&$(rowsCache[activeRow].rowNode).removeClass(\"active\"));null!=(activeCellNode=e)?(activeRow=getRowFromNode(activeCellNode.parentNode),activeCell=activePosX=getCellFromNode(activeCellNode),null==t&&(t=activeRow==getDataLength()||options.autoEdit),options.showCellSelection&&($(activeCellNode).addClass(\"active\"),$(rowsCache[activeRow].rowNode).addClass(\"active\")),options.editable&&t&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout(function(){makeActiveCellEditable(void 0,n)},options.asyncEditorLoadDelay):makeActiveCellEditable(void 0,n))):activeRow=activeCell=null,o||trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}}function isCellPotentiallyEditable(e,t){var n=getDataLength();return!(e<n&&!getDataItem(e))&&(!(columns[t].cannotTriggerInsert&&n<=e)&&!!getEditor(e,t))}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor,grid:self}),currentEditor.destroy(),currentEditor=null,activeCellNode){var e=getDataItem(activeRow);if($(activeCellNode).removeClass(\"editable invalid\"),e){var t=columns[activeCell],n=getFormatter(activeRow,t),o=n(activeRow,activeCell,getDataItemValueForColumn(e,t),t,e,self);applyFormatResultToCellNode(o,activeCellNode),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(e,t){if(activeCellNode){if(!options.editable)throw new Error(\"Grid : makeActiveCellEditable : should never get called when options.editable is false\");if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var n=columns[activeCell],o=getDataItem(activeRow);if(!1!==trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:o,column:n,grid:self})){getEditorLock().activate(editController),$(activeCellNode).addClass(\"editable\");var r=e||getEditor(activeRow,activeCell);e||r.suppressClearOnEdit||(activeCellNode.innerHTML=\"\"),currentEditor=new r({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:n,item:o||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),o&&(currentEditor.loadValue(o),t&&currentEditor.preClick&&currentEditor.preClick()),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}else setFocus()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(e){var t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:$(e).outerWidth(),height:$(e).outerHeight(),visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;for(var n=e.offsetParent;(e=e.parentNode)!=document.body&&null!=e;)t.visible&&e.scrollHeight!=e.offsetHeight&&\"visible\"!=$(e).css(\"overflowY\")&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!=e.offsetWidth&&\"visible\"!=$(e).css(\"overflowX\")&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===n&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,n=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width;return t}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{grid:self}),currentEditor)){var e=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(e.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(e)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell,grid:self}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(e,t){var n=e*options.rowHeight,o=(e+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);(e+1)*options.rowHeight>scrollTop+viewportH+offset?(scrollTo(t?n:o),render()):e*options.rowHeight<scrollTop+offset&&(scrollTo(t?o:n),render())}function scrollRowToTop(e){scrollTo(e*options.rowHeight),render()}function scrollPage(e){var t=e*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop)+t)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var n=activeRow+t,o=getDataLengthIncludingAddNew();o<=n&&(n=o-1),n<0&&(n=0);for(var r=0,i=null,l=activePosX;r<=activePosX;)canCellBeActive(n,r)&&(i=r),r+=getColspan(n,r);null!==i?(setActiveCellInternal(getCellNode(n,i)),activePosX=l):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function getColspan(e,t){var n=data.getItemMetadata&&data.getItemMetadata(e);if(!n||!n.columns)return 1;var o=n.columns[columns[t].id]||n.columns[t],r=o&&o.colspan;return r=\"*\"===r?columns.length-t:r||1}function findFirstFocusableCell(e){for(var t=0;t<columns.length;){if(canCellBeActive(e,t))return t;t+=getColspan(e,t)}return null}function findLastFocusableCell(e){for(var t=0,n=null;t<columns.length;)canCellBeActive(e,t)&&(n=t),t+=getColspan(e,t);return n}function gotoRight(e,t,n){if(t>=columns.length)return null;for(;(t+=getColspan(e,t))<columns.length&&!canCellBeActive(e,t););return t<columns.length?{row:e,cell:t,posX:t}:null}function gotoLeft(e,t,n){if(t<=0)return null;var o=findFirstFocusableCell(e);if(null===o||t<=o)return null;for(var r,i={row:e,cell:o,posX:o};;){if(!(r=gotoRight(i.row,i.cell,i.posX)))return null;if(r.cell>=t)return i;i=r}}function gotoDown(e,t,n){for(var o,r=getDataLengthIncludingAddNew();;){if(++e>=r)return null;for(o=t=0;t<=n;)t+=getColspan(e,o=t);if(canCellBeActive(e,o))return{row:e,cell:o,posX:n}}}function gotoUp(e,t,n){for(var o;;){if(--e<0)return null;for(o=t=0;t<=n;)t+=getColspan(e,o=t);if(canCellBeActive(e,o))return{row:e,cell:o,posX:n}}}function gotoNext(e,t,n){if(null==e&&null==t&&canCellBeActive(e=t=n=0,t))return{row:e,cell:t,posX:t};var o=gotoRight(e,t,n);if(o)return o;var r=null,i=getDataLengthIncludingAddNew();for(e===i-1&&e--;++e<i;)if(null!==(r=findFirstFocusableCell(e)))return{row:e,cell:r,posX:r};return null}function gotoPrev(e,t,n){if(null==e&&null==t&&(e=getDataLengthIncludingAddNew()-1,t=n=columns.length-1,canCellBeActive(e,t)))return{row:e,cell:t,posX:t};for(var o,r;!o&&!(o=gotoLeft(e,t,n));){if(--e<0)return null;t=0,null!==(r=findLastFocusableCell(e))&&(o={row:e,cell:r,posX:r})}return o}function navigateRight(){return navigate(\"right\")}function navigateLeft(){return navigate(\"left\")}function navigateDown(){return navigate(\"down\")}function navigateUp(){return navigate(\"up\")}function navigateNext(){return navigate(\"next\")}function navigatePrev(){return navigate(\"prev\")}function navigate(e){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&\"prev\"!=e&&\"next\"!=e)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus();tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1}[e];var t={up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext},n=t[e],o=n(activeRow,activeCell,activePosX);if(o){var r=o.row==getDataLength();return scrollCellIntoView(o.row,o.cell,!r),setActiveCellInternal(getCellNode(o.row,o.cell)),activePosX=o.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(e,t){return rowsCache[e]?(ensureCellNodesInRowsCache(e),rowsCache[e].cellNodesByColumnIdx[t]):null}function setActiveCell(e,t,n,o,r){initialized&&(e>getDataLength()||e<0||t>=columns.length||t<0||options.enableCellNavigation&&(scrollCellIntoView(e,t,!1),setActiveCellInternal(getCellNode(e,t),n,o,r)))}function canCellBeActive(e,t){if(!options.enableCellNavigation||e>=getDataLengthIncludingAddNew()||e<0||t>=columns.length||t<0)return!1;var n=data.getItemMetadata&&data.getItemMetadata(e);if(n&&\"boolean\"==typeof n.focusable)return n.focusable;var o=n&&n.columns;return o&&o[columns[t].id]&&\"boolean\"==typeof o[columns[t].id].focusable?o[columns[t].id].focusable:o&&o[t]&&\"boolean\"==typeof o[t].focusable?o[t].focusable:columns[t].focusable}function canCellBeSelected(e,t){if(e>=getDataLength()||e<0||t>=columns.length||t<0)return!1;var n=data.getItemMetadata&&data.getItemMetadata(e);if(n&&\"boolean\"==typeof n.selectable)return n.selectable;var o=n&&n.columns&&(n.columns[columns[t].id]||n.columns[t]);return o&&\"boolean\"==typeof o.selectable?o.selectable:columns[t].selectable}function gotoCell(e,t,n){if(initialized&&canCellBeActive(e,t)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(e,t,!1);var o=getCellNode(e,t);setActiveCellInternal(o,n||e===getDataLength()||options.autoEdit),currentEditor||setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow),t=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var n=currentEditor.validate();if(n.valid){if(activeRow<getDataLength()){var o={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:e,grid:self})},undo:function(){this.editor.applyValue(e,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:e,grid:self})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(e,t,o)):(o.execute(),makeActiveCellNormal())}else{var r={};currentEditor.applyValue(r,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:r,column:t,grid:self})}return!getEditorLock().isActive()}return $(activeCellNode).removeClass(\"invalid\"),$(activeCellNode).width(),$(activeCellNode).addClass(\"invalid\"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:n,row:activeRow,cell:activeCell,column:t,grid:self}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(e){for(var t=[],n=columns.length-1,o=0;o<e.length;o++)t.push(new Slick.Range(e[o],0,e[o],n));return t}function getSelectedRows(){if(!selectionModel)throw new Error(\"Selection model is not set\");return selectedRows}function setSelectedRows(e){if(!selectionModel)throw new Error(\"Selection model is not set\");selectionModel.setSelectedRanges(rowsToRanges(e))}this.debug=function(){var e=\"\";e+=\"\\ncounter_rows_rendered: \"+counter_rows_rendered,e+=\"\\ncounter_rows_removed: \"+counter_rows_removed,e+=\"\\nrenderedRows: \"+renderedRows,e+=\"\\nnumVisibleRows: \"+numVisibleRows,e+=\"\\nmaxSupportedCssHeight: \"+maxSupportedCssHeight,e+=\"\\nn(umber of pages): \"+n,e+=\"\\n(current) page: \"+page,e+=\"\\npage height (ph): \"+ph,e+=\"\\nvScrollDir: \"+vScrollDir,alert(e)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:\"2.3.4\",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onFooterRowCellRendered:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onBeforeFooterRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onBeforeAppendCell:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,updatePagingStatusFromView:updatePagingStatusFromView,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,scrollColumnIntoView:scrollColumnIntoView,getCanvasNode:getCanvasNode,getUID:getUID,getHeaderColumnWidthDiff:getHeaderColumnWidthDiff,getScrollbarDimensions:getScrollbarDimensions,getHeadersWidth:getHeadersWidth,getCanvasWidth:getCanvasWidth,focus:setFocus,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,navigatePageUp:navigatePageUp,navigatePageDown:navigatePageDown,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,getPreHeaderPanel:getPreHeaderPanel,setPreHeaderPanelVisibility:setPreHeaderPanelVisibility,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,setFooterRowVisibility:setFooterRowVisibility,getFooterRow:getFooterRow,getFooterRowColumn:getFooterRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}module.exports={Grid:SlickGrid}},444:function(e,t,n){t.exports=\"undefined\"!=typeof $?$:e(437)},445:function(e,t,n){var o=e(446),r=o.template;function i(e,t,n){return r(e,t,n)}i._=o,t.exports=i,\"function\"==typeof define&&define.amd?define(function(){return i}):\"undefined\"==typeof window&&\"undefined\"==typeof navigator||(window.UnderscoreTemplate=i)},446:function(e,t,n){ // (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors // Underscore may be freely distributed under the MIT license. var l={},o=Array.prototype,r=Object.prototype,i=o.slice,s=r.toString,a=r.hasOwnProperty,c=o.forEach,u=Object.keys,d=Array.isArray,p=function(){},f=p.each=p.forEach=function(e,t,n){if(null!=e)if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(var o=0,r=e.length;o<r;o++)if(t.call(n,e[o],o,e)===l)return}else for(var i=p.keys(e),o=0,r=i.length;o<r;o++)if(t.call(n,e[i[o]],i[o],e)===l)return};p.keys=u||function(e){if(e!==Object(e))throw new TypeError(\"Invalid object\");var t=[];for(var n in e)p.has(e,n)&&t.push(n);return t},p.defaults=function(n){return f(i.call(arguments,1),function(e){if(e)for(var t in e)void 0===n[t]&&(n[t]=e[t])}),n},p.isArray=d||function(e){return\"[object Array]\"===s.call(e)},p.has=function(e,t){if(!p.isArray(t))return null!=e&&a.call(e,t);for(var n=t.length,o=0;o<n;o++){var r=t[o];if(null==e||!a.call(e,r))return!1;e=e[r]}return!!n};var h={escape:{\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\"}},g={escape:new RegExp(\"[\"+p.keys(h.escape).join(\"\")+\"]\",\"g\")};p.each([\"escape\"],function(t){p[t]=function(e){return null==e?\"\":(\"\"+e).replace(g[t],function(e){return h[t][e]})}}),p.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var m=/(.)&#94;/,v={\"'\":\"'\",\"\\\\\":\"\\\\\",\"\\r\":\"r\",\"\\n\":\"n\",\"\\t\":\"t\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"},w=/\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;p.template=function(i,e,t){var n;t=p.defaults({},t,p.templateSettings);var o=new RegExp([(t.escape||m).source,(t.interpolate||m).source,(t.evaluate||m).source].join(\"|\")+\"|$\",\"g\"),l=0,s=\"__p+='\";i.replace(o,function(e,t,n,o,r){return s+=i.slice(l,r).replace(w,function(e){return\"\\\\\"+v[e]}),t&&(s+=\"'+\\n((__t=(\"+t+\"))==null?'':_.escape(__t))+\\n'\"),n&&(s+=\"'+\\n((__t=(\"+n+\"))==null?'':__t)+\\n'\"),o&&(s+=\"';\\n\"+o+\"\\n__p+='\"),l=r+e.length,e}),s+=\"';\\n\",t.variable||(s=\"with(obj||{}){\\n\"+s+\"}\\n\"),s=\"var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\\n\"+s+\"return __p;\\n\";try{n=new Function(t.variable||\"obj\",\"_\",s)}catch(e){throw e.source=s,e}if(e)return n(e,p);var r=function(e){return n.call(this,e,p)};return r.source=\"function(\"+(t.variable||\"obj\")+\"){\\n\"+s+\"}\",r},t.exports=p}},0,0)}(a.Bokeh)}(this); //# sourceMappingURL=bokeh-tables.min.js.map /* END bokeh-tables.min.js */ }, function(Bokeh) { /* BEGIN bokeh-gl.min.js */ /*! * Copyright (c) 2012, Anaconda, Inc. * All rights reserved. * * Redistribution and use in source and binary forms, with or without modification, * are permitted provided that the following conditions are met: * * Redistributions of source code must retain the above copyright notice, * this list of conditions and the following disclaimer. * * Redistributions in binary form must reproduce the above copyright notice, * this list of conditions and the following disclaimer in the documentation * and/or other materials provided with the distribution. * * Neither the name of Anaconda nor the names of any contributors * may be used to endorse or promote products derived from this software * without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF * THE POSSIBILITY OF SUCH DAMAGE. */ !function(t,e){var a;a=t.Bokeh,function(t,e,n){if(null!=a)return a.register_plugin(t,{\"models/glyphs/webgl/base\":447,\"models/glyphs/webgl/index\":448,\"models/glyphs/webgl/line.frag\":449,\"models/glyphs/webgl/line\":450,\"models/glyphs/webgl/line.vert\":451,\"models/glyphs/webgl/main\":452,\"models/glyphs/webgl/markers.frag\":453,\"models/glyphs/webgl/markers\":454,\"models/glyphs/webgl/markers.vert\":455},452);throw new Error(\"Cannot find Bokeh. You have to load it prior to loading plugins.\")}({447:function(t,e,n){var g=t(27),y=t(14),a=function(){function t(t,e){this.gl=t,this.glyph=e,this.nvertices=0,this.size_changed=!1,this.data_changed=!1,this.visuals_changed=!1,this.init()}return t.prototype.set_data_changed=function(t){t!=this.nvertices&&(this.nvertices=t,this.size_changed=!0),this.data_changed=!0},t.prototype.set_visuals_changed=function(){this.visuals_changed=!0},t.prototype.render=function(t,e,n){var a,s=[0,1,2],i=s[0],r=s[1],o=s[2],l=1,_=1,h=this.glyph.renderer.map_to_screen([i*l,r*l,o*l],[i*_,r*_,o*_]),c=h[0],f=h[1];if(isNaN(c[0]+c[1]+c[2]+f[0]+f[1]+f[2]))return y.logger.warn(\"WebGL backend (\"+this.glyph.model.type+\"): falling back to canvas rendering\"),!1;if(l=100/Math.min(Math.max(Math.abs(c[1]-c[0]),1e-12),1e12),_=100/Math.min(Math.max(Math.abs(f[1]-f[0]),1e-12),1e12),a=this.glyph.renderer.map_to_screen([i*l,r*l,o*l],[i*_,r*_,o*_]),c=a[0],f=a[1],1e-6<Math.abs(c[1]-c[0]-(c[2]-c[1]))||1e-6<Math.abs(f[1]-f[0]-(f[2]-f[1])))return y.logger.warn(\"WebGL backend (\"+this.glyph.model.type+\"): falling back to canvas rendering\"),!1;var d=[(c[1]-c[0])/l,(f[1]-f[0])/_],u=d[0],g=d[1],p=this.glyph.renderer.plot_view.gl.canvas,v=p.width,m=p.height,x={pixel_ratio:this.glyph.renderer.plot_view.canvas.pixel_ratio,width:v,height:m,dx:c[0]/u,dy:f[0]/g,sx:u,sy:g};return this.draw(e,n,x),!0},t}();function p(t,e){for(var n=new Float32Array(t),a=0,s=t;a<s;a++)n[a]=e;return n}function v(t,e){return void 0!==t[e].spec.value}n.BaseGLGlyph=a,n.line_width=function(t){return t<2&&(t=Math.sqrt(2*t)),t},n.fill_array_with_float=p,n.fill_array_with_vec=function(t,e,n){for(var a=new Float32Array(t*e),s=0;s<t;s++)for(var i=0;i<e;i++)a[s*e+i]=n[i];return a},n.visual_prop_is_singular=v,n.attach_float=function(t,e,n,a,s,i){if(s.doit)if(v(s,i))e.used=!1,t.set_attribute(n,\"float\",s[i].value());else{e.used=!0;var r=new Float32Array(s.cache[i+\"_array\"]);e.set_size(4*a),e.set_data(0,r),t.set_attribute(n,\"float\",e)}else e.used=!1,t.set_attribute(n,\"float\",[0])},n.attach_color=function(t,e,n,a,s,i){var r,o=i+\"_color\",l=i+\"_alpha\";if(s.doit)if(v(s,o)&&v(s,l))e.used=!1,r=g.color2rgba(s[o].value(),s[l].value()),t.set_attribute(n,\"vec4\",r);else{var _=void 0,h=void 0;e.used=!0,h=v(s,o)?function(){for(var t=[],e=0,n=a;e<n;e++)t.push(s[o].value());return t}():s.cache[o+\"_array\"],_=v(s,l)?p(a,s[l].value()):s.cache[l+\"_array\"];for(var c=new Float32Array(4*a),f=0,d=a;f<d;f++){r=g.color2rgba(h[f],_[f]);for(var u=0;u<4;u++)c[4*f+u]=r[u]}e.set_size(4*a*4),e.set_data(0,c),t.set_attribute(n,\"vec4\",e)}else e.used=!1,t.set_attribute(n,\"vec4\",[0,0,0,0])}},448:function(t,e,n){var a=t(387);a.__exportStar(t(450),n),a.__exportStar(t(454),n)},449:function(t,e,n){n.fragment_shader=\"\\nprecision mediump float;\\n\\nconst float PI = 3.14159265358979323846264;\\nconst float THETA = 15.0 * 3.14159265358979323846264/180.0;\\n\\nuniform sampler2D u_dash_atlas;\\n\\nuniform vec2 u_linecaps;\\nuniform float u_miter_limit;\\nuniform float u_linejoin;\\nuniform float u_antialias;\\nuniform float u_dash_phase;\\nuniform float u_dash_period;\\nuniform float u_dash_index;\\nuniform vec2 u_dash_caps;\\nuniform float u_closed;\\n\\nvarying vec4 v_color;\\nvarying vec2 v_segment;\\nvarying vec2 v_angles;\\nvarying vec2 v_texcoord;\\nvarying vec2 v_miter;\\nvarying float v_length;\\nvarying float v_linewidth;\\n\\n// Compute distance to cap ----------------------------------------------------\\nfloat cap( int type, float dx, float dy, float t, float linewidth )\\n{\\n float d = 0.0;\\n dx = abs(dx);\\n dy = abs(dy);\\n if (type == 0) discard; // None\\n else if (type == 1) d = sqrt(dx*dx+dy*dy); // Round\\n else if (type == 3) d = (dx+abs(dy)); // Triangle in\\n else if (type == 2) d = max(abs(dy),(t+dx-abs(dy))); // Triangle out\\n else if (type == 4) d = max(dx,dy); // Square\\n else if (type == 5) d = max(dx+t,dy); // Butt\\n return d;\\n}\\n\\n// Compute distance to join -------------------------------------------------\\nfloat join( in int type, in float d, in vec2 segment, in vec2 texcoord, in vec2 miter,\\n in float linewidth )\\n{\\n // texcoord.x is distance from start\\n // texcoord.y is distance from centerline\\n // segment.x and y indicate the limits (as for texcoord.x) for this segment\\n\\n float dx = texcoord.x;\\n\\n // Round join\\n if( type == 1 ) {\\n if (dx < segment.x) {\\n d = max(d,length( texcoord - vec2(segment.x,0.0)));\\n //d = length( texcoord - vec2(segment.x,0.0));\\n } else if (dx > segment.y) {\\n d = max(d,length( texcoord - vec2(segment.y,0.0)));\\n //d = length( texcoord - vec2(segment.y,0.0));\\n }\\n }\\n // Bevel join\\n else if ( type == 2 ) {\\n if (dx < segment.x) {\\n vec2 x = texcoord - vec2(segment.x,0.0);\\n d = max(d, max(abs(x.x), abs(x.y)));\\n\\n } else if (dx > segment.y) {\\n vec2 x = texcoord - vec2(segment.y,0.0);\\n d = max(d, max(abs(x.x), abs(x.y)));\\n }\\n /* Original code for bevel which does not work for us\\n if( (dx < segment.x) || (dx > segment.y) )\\n d = max(d, min(abs(x.x),abs(x.y)));\\n */\\n }\\n\\n return d;\\n}\\n\\nvoid main()\\n{\\n // If color is fully transparent we just discard the fragment\\n if( v_color.a <= 0.0 ) {\\n discard;\\n }\\n\\n // Test if dash pattern is the solid one (0)\\n bool solid = (u_dash_index == 0.0);\\n\\n // Test if path is closed\\n bool closed = (u_closed > 0.0);\\n\\n vec4 color = v_color;\\n float dx = v_texcoord.x;\\n float dy = v_texcoord.y;\\n float t = v_linewidth/2.0-u_antialias;\\n float width = 1.0; //v_linewidth; original code had dashes scale with line width, we do not\\n float d = 0.0;\\n\\n vec2 linecaps = u_linecaps;\\n vec2 dash_caps = u_dash_caps;\\n float line_start = 0.0;\\n float line_stop = v_length;\\n\\n // Apply miter limit; fragments too far into the miter are simply discarded\\n if( (dx < v_segment.x) || (dx > v_segment.y) ) {\\n float into_miter = max(v_segment.x - dx, dx - v_segment.y);\\n if (into_miter > u_miter_limit*v_linewidth/2.0)\\n discard;\\n }\\n\\n // Solid line --------------------------------------------------------------\\n if( solid ) {\\n d = abs(dy);\\n if( (!closed) && (dx < line_start) ) {\\n d = cap( int(u_linecaps.x), abs(dx), abs(dy), t, v_linewidth );\\n }\\n else if( (!closed) && (dx > line_stop) ) {\\n d = cap( int(u_linecaps.y), abs(dx)-line_stop, abs(dy), t, v_linewidth );\\n }\\n else {\\n d = join( int(u_linejoin), abs(dy), v_segment, v_texcoord, v_miter, v_linewidth );\\n }\\n\\n // Dash line --------------------------------------------------------------\\n } else {\\n float segment_start = v_segment.x;\\n float segment_stop = v_segment.y;\\n float segment_center= (segment_start+segment_stop)/2.0;\\n float freq = u_dash_period*width;\\n float u = mod( dx + u_dash_phase*width, freq);\\n vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0; // conversion to int-like\\n float dash_center= tex.x * width;\\n float dash_type = tex.y;\\n float _start = tex.z * width;\\n float _stop = tex.a * width;\\n float dash_start = dx - u + _start;\\n float dash_stop = dx - u + _stop;\\n\\n // Compute extents of the first dash (the one relative to v_segment.x)\\n // Note: this could be computed in the vertex shader\\n if( (dash_stop < segment_start) && (dash_caps.x != 5.0) ) {\\n float u = mod(segment_start + u_dash_phase*width, freq);\\n vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0; // conversion to int-like\\n dash_center= tex.x * width;\\n //dash_type = tex.y;\\n float _start = tex.z * width;\\n float _stop = tex.a * width;\\n dash_start = segment_start - u + _start;\\n dash_stop = segment_start - u + _stop;\\n }\\n\\n // Compute extents of the last dash (the one relatives to v_segment.y)\\n // Note: This could be computed in the vertex shader\\n else if( (dash_start > segment_stop) && (dash_caps.y != 5.0) ) {\\n float u = mod(segment_stop + u_dash_phase*width, freq);\\n vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0; // conversion to int-like\\n dash_center= tex.x * width;\\n //dash_type = tex.y;\\n float _start = tex.z * width;\\n float _stop = tex.a * width;\\n dash_start = segment_stop - u + _start;\\n dash_stop = segment_stop - u + _stop;\\n }\\n\\n // This test if the we are dealing with a discontinuous angle\\n bool discontinuous = ((dx < segment_center) && abs(v_angles.x) > THETA) ||\\n ((dx >= segment_center) && abs(v_angles.y) > THETA);\\n //if( dx < line_start) discontinuous = false;\\n //if( dx > line_stop) discontinuous = false;\\n\\n float d_join = join( int(u_linejoin), abs(dy),\\n v_segment, v_texcoord, v_miter, v_linewidth );\\n\\n // When path is closed, we do not have room for linecaps, so we make room\\n // by shortening the total length\\n if (closed) {\\n line_start += v_linewidth/2.0;\\n line_stop -= v_linewidth/2.0;\\n }\\n\\n // We also need to take antialias area into account\\n //line_start += u_antialias;\\n //line_stop -= u_antialias;\\n\\n // Check is dash stop is before line start\\n if( dash_stop <= line_start ) {\\n discard;\\n }\\n // Check is dash start is beyond line stop\\n if( dash_start >= line_stop ) {\\n discard;\\n }\\n\\n // Check if current dash start is beyond segment stop\\n if( discontinuous ) {\\n // Dash start is beyond segment, we discard\\n if( (dash_start > segment_stop) ) {\\n discard;\\n //gl_FragColor = vec4(1.0,0.0,0.0,.25); return;\\n }\\n\\n // Dash stop is before segment, we discard\\n if( (dash_stop < segment_start) ) {\\n discard; //gl_FragColor = vec4(0.0,1.0,0.0,.25); return;\\n }\\n\\n // Special case for round caps (nicer with this)\\n if( dash_caps.x == 1.0 ) {\\n if( (u > _stop) && (dash_stop > segment_stop ) && (abs(v_angles.y) < PI/2.0)) {\\n discard;\\n }\\n }\\n\\n // Special case for round caps (nicer with this)\\n if( dash_caps.y == 1.0 ) {\\n if( (u < _start) && (dash_start < segment_start ) && (abs(v_angles.x) < PI/2.0)) {\\n discard;\\n }\\n }\\n\\n // Special case for triangle caps (in & out) and square\\n // We make sure the cap stop at crossing frontier\\n if( (dash_caps.x != 1.0) && (dash_caps.x != 5.0) ) {\\n if( (dash_start < segment_start ) && (abs(v_angles.x) < PI/2.0) ) {\\n float a = v_angles.x/2.0;\\n float x = (segment_start-dx)*cos(a) - dy*sin(a);\\n float y = (segment_start-dx)*sin(a) + dy*cos(a);\\n if( x > 0.0 ) discard;\\n // We transform the cap into square to avoid holes\\n dash_caps.x = 4.0;\\n }\\n }\\n\\n // Special case for triangle caps (in & out) and square\\n // We make sure the cap stop at crossing frontier\\n if( (dash_caps.y != 1.0) && (dash_caps.y != 5.0) ) {\\n if( (dash_stop > segment_stop ) && (abs(v_angles.y) < PI/2.0) ) {\\n float a = v_angles.y/2.0;\\n float x = (dx-segment_stop)*cos(a) - dy*sin(a);\\n float y = (dx-segment_stop)*sin(a) + dy*cos(a);\\n if( x > 0.0 ) discard;\\n // We transform the caps into square to avoid holes\\n dash_caps.y = 4.0;\\n }\\n }\\n }\\n\\n // Line cap at start\\n if( (dx < line_start) && (dash_start < line_start) && (dash_stop > line_start) ) {\\n d = cap( int(linecaps.x), dx-line_start, dy, t, v_linewidth);\\n }\\n // Line cap at stop\\n else if( (dx > line_stop) && (dash_stop > line_stop) && (dash_start < line_stop) ) {\\n d = cap( int(linecaps.y), dx-line_stop, dy, t, v_linewidth);\\n }\\n // Dash cap left - dash_type = -1, 0 or 1, but there may be roundoff errors\\n else if( dash_type < -0.5 ) {\\n d = cap( int(dash_caps.y), abs(u-dash_center), dy, t, v_linewidth);\\n if( (dx > line_start) && (dx < line_stop) )\\n d = max(d,d_join);\\n }\\n // Dash cap right\\n else if( dash_type > 0.5 ) {\\n d = cap( int(dash_caps.x), abs(dash_center-u), dy, t, v_linewidth);\\n if( (dx > line_start) && (dx < line_stop) )\\n d = max(d,d_join);\\n }\\n // Dash body (plain)\\n else {// if( dash_type > -0.5 && dash_type < 0.5) {\\n d = abs(dy);\\n }\\n\\n // Line join\\n if( (dx > line_start) && (dx < line_stop)) {\\n if( (dx <= segment_start) && (dash_start <= segment_start)\\n && (dash_stop >= segment_start) ) {\\n d = d_join;\\n // Antialias at outer border\\n float angle = PI/2.+v_angles.x;\\n float f = abs( (segment_start - dx)*cos(angle) - dy*sin(angle));\\n d = max(f,d);\\n }\\n else if( (dx > segment_stop) && (dash_start <= segment_stop)\\n && (dash_stop >= segment_stop) ) {\\n d = d_join;\\n // Antialias at outer border\\n float angle = PI/2.+v_angles.y;\\n float f = abs((dx - segment_stop)*cos(angle) - dy*sin(angle));\\n d = max(f,d);\\n }\\n else if( dx < (segment_start - v_linewidth/2.)) {\\n discard;\\n }\\n else if( dx > (segment_stop + v_linewidth/2.)) {\\n discard;\\n }\\n }\\n else if( dx < (segment_start - v_linewidth/2.)) {\\n discard;\\n }\\n else if( dx > (segment_stop + v_linewidth/2.)) {\\n discard;\\n }\\n }\\n\\n // Distance to border ------------------------------------------------------\\n d = d - t;\\n if( d < 0.0 ) {\\n gl_FragColor = color;\\n } else {\\n d /= u_antialias;\\n gl_FragColor = vec4(color.rgb, exp(-d*d)*color.a);\\n }\\n}\\n\"},450:function(t,e,n){var a=t(387),s=t(456),i=t(447),r=t(451),o=t(449),l=t(27),_=function(){function t(t){this._atlas={},this._index=0,this._width=256,this._height=256,this.tex=new s.Texture2D(t),this.tex.set_wrapping(t.REPEAT,t.REPEAT),this.tex.set_interpolation(t.NEAREST,t.NEAREST),this.tex.set_size([this._height,this._width],t.RGBA),this.tex.set_data([0,0],[this._height,this._width],new Uint8Array(this._height*this._width*4)),this.get_atlas_data([1])}return t.prototype.get_atlas_data=function(t){var e=t.join(\"-\"),n=this._atlas[e];if(void 0===n){var a=this.make_pattern(t),s=a[0],i=a[1];this.tex.set_data([this._index,0],[1,this._width],new Uint8Array(s.map(function(t){return t+10}))),this._atlas[e]=[this._index/this._height,i],this._index+=1}return this._atlas[e]},t.prototype.make_pattern=function(t){1<t.length&&t.length%2&&(t=t.concat(t));for(var e=0,n=0,a=t;n<a.length;n++){var s=a[n];e+=s}for(var i=[],r=0,o=0,l=t.length+2;o<l;o+=2){var _=Math.max(1e-4,t[o%t.length]),h=Math.max(1e-4,t[(o+1)%t.length]);i.push(r,r+_),r+=_+h}for(var c=this._width,f=new Float32Array(4*c),o=0,l=c;o<l;o++){for(var d=void 0,u=void 0,g=void 0,p=e*o/(c-1),v=0,m=1e16,x=0,y=i.length;x<y;x++){var b=Math.abs(i[x]-p);b<m&&(v=x,m=b)}v%2==0?(g=p<=i[v]?1:0,u=i[v],d=i[v+1]):(g=p>i[v]?-1:0,u=i[v-1],d=i[v]),f[4*o+0]=i[v],f[4*o+1]=g,f[4*o+2]=u,f[4*o+3]=d}return[f,e]},t}(),h={miter:0,round:1,bevel:2},c={\"\":0,none:0,\".\":0,round:1,\")\":1,\"(\":1,o:1,\"triangle in\":2,\"<\":2,\"triangle out\":3,\">\":3,square:4,\"[\":4,\"]\":4,\"=\":4,butt:5,\"|\":5},f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.init=function(){var t=this.gl;this._scale_aspect=0;var e=r.vertex_shader,n=o.fragment_shader;this.prog=new s.Program(t),this.prog.set_shaders(e,n),this.index_buffer=new s.IndexBuffer(t),this.vbo_position=new s.VertexBuffer(t),this.vbo_tangents=new s.VertexBuffer(t),this.vbo_segment=new s.VertexBuffer(t),this.vbo_angles=new s.VertexBuffer(t),this.vbo_texcoord=new s.VertexBuffer(t),this.dash_atlas=new _(t)},e.prototype.draw=function(t,e,n){var a=e.glglyph;if(a.data_changed){if(!isFinite(n.dx)||!isFinite(n.dy))return;a._baked_offset=[n.dx,n.dy],a._set_data(),a.data_changed=!1}this.visuals_changed&&(this._set_visuals(),this.visuals_changed=!1);var s=n.sx,i=n.sy,r=Math.sqrt(s*s+i*i);s/=r,i/=r,Math.abs(this._scale_aspect-i/s)>Math.abs(.001*this._scale_aspect)&&(a._update_scale(s,i),this._scale_aspect=i/s),this.prog.set_attribute(\"a_position\",\"vec2\",a.vbo_position),this.prog.set_attribute(\"a_tangents\",\"vec4\",a.vbo_tangents),this.prog.set_attribute(\"a_segment\",\"vec2\",a.vbo_segment),this.prog.set_attribute(\"a_angles\",\"vec2\",a.vbo_angles),this.prog.set_attribute(\"a_texcoord\",\"vec2\",a.vbo_texcoord),this.prog.set_uniform(\"u_length\",\"float\",[a.cumsum]),this.prog.set_texture(\"u_dash_atlas\",this.dash_atlas.tex);var o=a._baked_offset;if(this.prog.set_uniform(\"u_pixel_ratio\",\"float\",[n.pixel_ratio]),this.prog.set_uniform(\"u_canvas_size\",\"vec2\",[n.width,n.height]),this.prog.set_uniform(\"u_offset\",\"vec2\",[n.dx-o[0],n.dy-o[1]]),this.prog.set_uniform(\"u_scale_aspect\",\"vec2\",[s,i]),this.prog.set_uniform(\"u_scale_length\",\"float\",[r]),this.I_triangles=a.I_triangles,this.I_triangles.length<65535)this.index_buffer.set_size(2*this.I_triangles.length),this.index_buffer.set_data(0,new Uint16Array(this.I_triangles)),this.prog.draw(this.gl.TRIANGLES,this.index_buffer);else{t=Array.from(this.I_triangles);for(var l=this.I_triangles.length,_=64008,h=[],c=0,f=Math.ceil(l/_);c<f;c++)h.push([]);for(var c=0,f=t.length;c<f;c++){var d=t[c]%_,u=Math.floor(t[c]/_);h[u].push(d)}for(var u=0,f=h.length;u<f;u++){var g=new Uint16Array(h[u]),p=u*_*4;0!==g.length&&(this.prog.set_attribute(\"a_position\",\"vec2\",a.vbo_position,0,2*p),this.prog.set_attribute(\"a_tangents\",\"vec4\",a.vbo_tangents,0,4*p),this.prog.set_attribute(\"a_segment\",\"vec2\",a.vbo_segment,0,2*p),this.prog.set_attribute(\"a_angles\",\"vec2\",a.vbo_angles,0,2*p),this.prog.set_attribute(\"a_texcoord\",\"vec2\",a.vbo_texcoord,0,2*p),this.index_buffer.set_size(2*g.length),this.index_buffer.set_data(0,g),this.prog.draw(this.gl.TRIANGLES,this.index_buffer))}}},e.prototype._set_data=function(){this._bake(),this.vbo_position.set_size(4*this.V_position.length),this.vbo_position.set_data(0,this.V_position),this.vbo_tangents.set_size(4*this.V_tangents.length),this.vbo_tangents.set_data(0,this.V_tangents),this.vbo_angles.set_size(4*this.V_angles.length),this.vbo_angles.set_data(0,this.V_angles),this.vbo_texcoord.set_size(4*this.V_texcoord.length),this.vbo_texcoord.set_data(0,this.V_texcoord)},e.prototype._set_visuals=function(){var t,e=l.color2rgba(this.glyph.visuals.line.line_color.value(),this.glyph.visuals.line.line_alpha.value()),n=c[this.glyph.visuals.line.line_cap.value()],a=h[this.glyph.visuals.line.line_join.value()];this.prog.set_uniform(\"u_color\",\"vec4\",e),this.prog.set_uniform(\"u_linewidth\",\"float\",[this.glyph.visuals.line.line_width.value()]),this.prog.set_uniform(\"u_antialias\",\"float\",[.9]),this.prog.set_uniform(\"u_linecaps\",\"vec2\",[n,n]),this.prog.set_uniform(\"u_linejoin\",\"float\",[a]),this.prog.set_uniform(\"u_miter_limit\",\"float\",[10]);var s=this.glyph.visuals.line.line_dash.value(),i=0,r=1;s.length&&(t=this.dash_atlas.get_atlas_data(s),i=t[0],r=t[1]),this.prog.set_uniform(\"u_dash_index\",\"float\",[i]),this.prog.set_uniform(\"u_dash_phase\",\"float\",[this.glyph.visuals.line.line_dash_offset.value()]),this.prog.set_uniform(\"u_dash_period\",\"float\",[r]),this.prog.set_uniform(\"u_dash_caps\",\"vec2\",[n,n]),this.prog.set_uniform(\"u_closed\",\"float\",[0])},e.prototype._bake=function(){for(var t,e,n,a,s,i,r,o,l=this.nvertices,_=new Float64Array(this.glyph._x),h=new Float64Array(this.glyph._y),c=r=new Float32Array(2*l),f=new Float32Array(2*l),d=o=new Float32Array(4*l),u=0,g=l;u<g;u++)c[2*u+0]=_[u]+this._baked_offset[0],c[2*u+1]=h[u]+this._baked_offset[1];this.tangents=e=new Float32Array(2*l-2);for(var u=0,g=l-1;u<g;u++)e[2*u+0]=r[2*(u+1)+0]-r[2*u+0],e[2*u+1]=r[2*(u+1)+1]-r[2*u+1];for(var u=0,g=l-1;u<g;u++)d[4*(u+1)+0]=e[2*u+0],d[4*(u+1)+1]=e[2*u+1],d[4*u+2]=e[2*u+0],d[4*u+3]=e[2*u+1];d[0]=e[0],d[1]=e[1],d[4*(l-1)+2]=e[2*(l-2)+0],d[4*(l-1)+3]=e[2*(l-2)+1];for(var p=new Float32Array(l),u=0,g=l;u<g;u++)p[u]=Math.atan2(o[4*u+0]*o[4*u+3]-o[4*u+1]*o[4*u+2],o[4*u+0]*o[4*u+2]+o[4*u+1]*o[4*u+3]);for(var u=0,g=l-1;u<g;u++)f[2*u+0]=p[u],f[2*u+1]=p[u+1];var v=4*l-4;this.V_position=a=new Float32Array(2*v),this.V_angles=n=new Float32Array(2*v),this.V_tangents=s=new Float32Array(4*v),this.V_texcoord=i=new Float32Array(2*v);for(var u=0,g=l;u<g;u++)for(var m=0;m<4;m++){for(var x=0;x<2;x++)a[2*(4*u+m-2)+x]=c[2*u+x],n[2*(4*u+m)+x]=f[2*u+x];for(var x=0;x<4;x++)s[4*(4*u+m-2)+x]=d[4*u+x]}for(var u=0,g=l;u<g;u++)i[2*(4*u+0)+0]=-1,i[2*(4*u+1)+0]=-1,i[2*(4*u+2)+0]=1,i[2*(4*u+3)+0]=1,i[2*(4*u+0)+1]=-1,i[2*(4*u+1)+1]=1,i[2*(4*u+2)+1]=-1,i[2*(4*u+3)+1]=1;var y=6*(l-1);this.I_triangles=t=new Uint32Array(y);for(var u=0,g=l;u<g;u++)t[6*u+0]=0+4*u,t[6*u+1]=1+4*u,t[6*u+2]=3+4*u,t[6*u+3]=2+4*u,t[6*u+4]=0+4*u,t[6*u+5]=3+4*u},e.prototype._update_scale=function(t,e){var n,a=this.nvertices,s=4*a-4,i=this.tangents,r=new Float32Array(a-1),o=new Float32Array(2*a);this.V_segment=n=new Float32Array(2*s);for(var l=0,_=a-1;l<_;l++)r[l]=Math.sqrt(Math.pow(i[2*l+0]*t,2)+Math.pow(i[2*l+1]*e,2));for(var h=0,l=0,_=a-1;l<_;l++)h+=r[l],o[2*(l+1)+0]=h,o[2*l+1]=h;for(var l=0,_=a;l<_;l++)for(var c=0;c<4;c++)for(var f=0;f<2;f++)n[2*(4*l+c)+f]=o[2*l+f];this.cumsum=h,this.vbo_segment.set_size(4*this.V_segment.length),this.vbo_segment.set_data(0,this.V_segment)},e}(i.BaseGLGlyph);n.LineGLGlyph=f},451:function(t,e,n){n.vertex_shader=\"\\nprecision mediump float;\\n\\nconst float PI = 3.14159265358979323846264;\\nconst float THETA = 15.0 * 3.14159265358979323846264/180.0;\\n\\nuniform float u_pixel_ratio;\\nuniform vec2 u_canvas_size, u_offset;\\nuniform vec2 u_scale_aspect;\\nuniform float u_scale_length;\\n\\nuniform vec4 u_color;\\nuniform float u_antialias;\\nuniform float u_length;\\nuniform float u_linewidth;\\nuniform float u_dash_index;\\nuniform float u_closed;\\n\\nattribute vec2 a_position;\\nattribute vec4 a_tangents;\\nattribute vec2 a_segment;\\nattribute vec2 a_angles;\\nattribute vec2 a_texcoord;\\n\\nvarying vec4 v_color;\\nvarying vec2 v_segment;\\nvarying vec2 v_angles;\\nvarying vec2 v_texcoord;\\nvarying vec2 v_miter;\\nvarying float v_length;\\nvarying float v_linewidth;\\n\\nfloat cross(in vec2 v1, in vec2 v2)\\n{\\n return v1.x*v2.y - v1.y*v2.x;\\n}\\n\\nfloat signed_distance(in vec2 v1, in vec2 v2, in vec2 v3)\\n{\\n return cross(v2-v1,v1-v3) / length(v2-v1);\\n}\\n\\nvoid rotate( in vec2 v, in float alpha, out vec2 result )\\n{\\n float c = cos(alpha);\\n float s = sin(alpha);\\n result = vec2( c*v.x - s*v.y,\\n s*v.x + c*v.y );\\n}\\n\\nvoid main()\\n{\\n bool closed = (u_closed > 0.0);\\n\\n // Attributes and uniforms to varyings\\n v_color = u_color;\\n v_linewidth = u_linewidth;\\n v_segment = a_segment * u_scale_length;\\n v_length = u_length * u_scale_length;\\n\\n // Scale to map to pixel coordinates. The original algorithm from the paper\\n // assumed isotropic scale. We obviously do not have this.\\n vec2 abs_scale_aspect = abs(u_scale_aspect);\\n vec2 abs_scale = u_scale_length * abs_scale_aspect;\\n\\n // Correct angles for aspect ratio\\n vec2 av;\\n av = vec2(1.0, tan(a_angles.x)) / abs_scale_aspect;\\n v_angles.x = atan(av.y, av.x);\\n av = vec2(1.0, tan(a_angles.y)) / abs_scale_aspect;\\n v_angles.y = atan(av.y, av.x);\\n\\n // Thickness below 1 pixel are represented using a 1 pixel thickness\\n // and a modified alpha\\n v_color.a = min(v_linewidth, v_color.a);\\n v_linewidth = max(v_linewidth, 1.0);\\n\\n // If color is fully transparent we just will discard the fragment anyway\\n if( v_color.a <= 0.0 ) {\\n gl_Position = vec4(0.0,0.0,0.0,1.0);\\n return;\\n }\\n\\n // This is the actual half width of the line\\n float w = ceil(u_antialias+v_linewidth)/2.0;\\n\\n vec2 position = (a_position + u_offset) * abs_scale;\\n\\n vec2 t1 = normalize(a_tangents.xy * abs_scale_aspect); // note the scaling for aspect ratio here\\n vec2 t2 = normalize(a_tangents.zw * abs_scale_aspect);\\n float u = a_texcoord.x;\\n float v = a_texcoord.y;\\n vec2 o1 = vec2( +t1.y, -t1.x);\\n vec2 o2 = vec2( +t2.y, -t2.x);\\n\\n // This is a join\\n // ----------------------------------------------------------------\\n if( t1 != t2 ) {\\n float angle = atan (t1.x*t2.y-t1.y*t2.x, t1.x*t2.x+t1.y*t2.y); // Angle needs recalculation for some reason\\n vec2 t = normalize(t1+t2);\\n vec2 o = vec2( + t.y, - t.x);\\n\\n if ( u_dash_index > 0.0 )\\n {\\n // Broken angle\\n // ----------------------------------------------------------------\\n if( (abs(angle) > THETA) ) {\\n position += v * w * o / cos(angle/2.0);\\n float s = sign(angle);\\n if( angle < 0.0 ) {\\n if( u == +1.0 ) {\\n u = v_segment.y + v * w * tan(angle/2.0);\\n if( v == 1.0 ) {\\n position -= 2.0 * w * t1 / sin(angle);\\n u -= 2.0 * w / sin(angle);\\n }\\n } else {\\n u = v_segment.x - v * w * tan(angle/2.0);\\n if( v == 1.0 ) {\\n position += 2.0 * w * t2 / sin(angle);\\n u += 2.0*w / sin(angle);\\n }\\n }\\n } else {\\n if( u == +1.0 ) {\\n u = v_segment.y + v * w * tan(angle/2.0);\\n if( v == -1.0 ) {\\n position += 2.0 * w * t1 / sin(angle);\\n u += 2.0 * w / sin(angle);\\n }\\n } else {\\n u = v_segment.x - v * w * tan(angle/2.0);\\n if( v == -1.0 ) {\\n position -= 2.0 * w * t2 / sin(angle);\\n u -= 2.0*w / sin(angle);\\n }\\n }\\n }\\n // Continuous angle\\n // ------------------------------------------------------------\\n } else {\\n position += v * w * o / cos(angle/2.0);\\n if( u == +1.0 ) u = v_segment.y;\\n else u = v_segment.x;\\n }\\n }\\n\\n // Solid line\\n // --------------------------------------------------------------------\\n else\\n {\\n position.xy += v * w * o / cos(angle/2.0);\\n if( angle < 0.0 ) {\\n if( u == +1.0 ) {\\n u = v_segment.y + v * w * tan(angle/2.0);\\n } else {\\n u = v_segment.x - v * w * tan(angle/2.0);\\n }\\n } else {\\n if( u == +1.0 ) {\\n u = v_segment.y + v * w * tan(angle/2.0);\\n } else {\\n u = v_segment.x - v * w * tan(angle/2.0);\\n }\\n }\\n }\\n\\n // This is a line start or end (t1 == t2)\\n // ------------------------------------------------------------------------\\n } else {\\n position += v * w * o1;\\n if( u == -1.0 ) {\\n u = v_segment.x - w;\\n position -= w * t1;\\n } else {\\n u = v_segment.y + w;\\n position += w * t2;\\n }\\n }\\n\\n // Miter distance\\n // ------------------------------------------------------------------------\\n vec2 t;\\n vec2 curr = a_position * abs_scale;\\n if( a_texcoord.x < 0.0 ) {\\n vec2 next = curr + t2*(v_segment.y-v_segment.x);\\n\\n rotate( t1, +v_angles.x/2.0, t);\\n v_miter.x = signed_distance(curr, curr+t, position);\\n\\n rotate( t2, +v_angles.y/2.0, t);\\n v_miter.y = signed_distance(next, next+t, position);\\n } else {\\n vec2 prev = curr - t1*(v_segment.y-v_segment.x);\\n\\n rotate( t1, -v_angles.x/2.0,t);\\n v_miter.x = signed_distance(prev, prev+t, position);\\n\\n rotate( t2, -v_angles.y/2.0,t);\\n v_miter.y = signed_distance(curr, curr+t, position);\\n }\\n\\n if (!closed && v_segment.x <= 0.0) {\\n v_miter.x = 1e10;\\n }\\n if (!closed && v_segment.y >= v_length)\\n {\\n v_miter.y = 1e10;\\n }\\n\\n v_texcoord = vec2( u, v*w );\\n\\n // Calculate position in device coordinates. Note that we\\n // already scaled with abs scale above.\\n vec2 normpos = position * sign(u_scale_aspect);\\n normpos += 0.5; // make up for Bokeh's offset\\n normpos /= u_canvas_size / u_pixel_ratio; // in 0..1\\n gl_Position = vec4(normpos*2.0-1.0, 0.0, 1.0);\\n gl_Position.y *= -1.0;\\n}\\n\"},452:function(t,e,n){t(448)},453:function(t,e,n){n.fragment_shader=function(t){return\"\\nprecision mediump float;\\nconst float SQRT_2 = 1.4142135623730951;\\nconst float PI = 3.14159265358979323846264;\\n//\\nuniform float u_antialias;\\n//\\nvarying vec4 v_fg_color;\\nvarying vec4 v_bg_color;\\nvarying float v_linewidth;\\nvarying float v_size;\\nvarying vec2 v_rotation;\\n\\n\"+t+\"\\n\\nvec4 outline(float distance, float linewidth, float antialias, vec4 fg_color, vec4 bg_color)\\n{\\n vec4 frag_color;\\n float t = linewidth/2.0 - antialias;\\n float signed_distance = distance;\\n float border_distance = abs(signed_distance) - t;\\n float alpha = border_distance/antialias;\\n alpha = exp(-alpha*alpha);\\n\\n // If fg alpha is zero, it probably means no outline. To avoid a dark outline\\n // shining through due to aa, we set the fg color to the bg color. Avoid if (i.e. branching).\\n float select = float(bool(fg_color.a));\\n fg_color.rgb = select * fg_color.rgb + (1.0 - select) * bg_color.rgb;\\n // Similarly, if we want a transparent bg\\n select = float(bool(bg_color.a));\\n bg_color.rgb = select * bg_color.rgb + (1.0 - select) * fg_color.rgb;\\n\\n if( border_distance < 0.0)\\n frag_color = fg_color;\\n else if( signed_distance < 0.0 ) {\\n frag_color = mix(bg_color, fg_color, sqrt(alpha));\\n } else {\\n if( abs(signed_distance) < (linewidth/2.0 + antialias) ) {\\n frag_color = vec4(fg_color.rgb, fg_color.a * alpha);\\n } else {\\n discard;\\n }\\n }\\n return frag_color;\\n}\\n\\nvoid main()\\n{\\n vec2 P = gl_PointCoord.xy - vec2(0.5, 0.5);\\n P = vec2(v_rotation.x*P.x - v_rotation.y*P.y,\\n v_rotation.y*P.x + v_rotation.x*P.y);\\n float point_size = SQRT_2*v_size + 2.0 * (v_linewidth + 1.5*u_antialias);\\n float distance = marker(P*point_size, v_size);\\n gl_FragColor = outline(distance, v_linewidth, u_antialias, v_fg_color, v_bg_color);\\n //gl_FragColor.rgb *= gl_FragColor.a; // pre-multiply alpha\\n}\\n\"},n.circle=\"\\nfloat marker(vec2 P, float size)\\n{\\n return length(P) - size/2.0;\\n}\\n\",n.square=\"\\nfloat marker(vec2 P, float size)\\n{\\n return max(abs(P.x), abs(P.y)) - size/2.0;\\n}\\n\",n.diamond=\"\\nfloat marker(vec2 P, float size)\\n{\\n float x = SQRT_2 / 2.0 * (P.x * 1.5 - P.y);\\n float y = SQRT_2 / 2.0 * (P.x * 1.5 + P.y);\\n float r1 = max(abs(x), abs(y)) - size / (2.0 * SQRT_2);\\n return r1 / SQRT_2;\\n}\\n\",n.hex=\"\\nfloat marker(vec2 P, float size)\\n{\\n vec2 q = abs(P);\\n return max(q.y * 0.57735 + q.x - 1.0 * size/2.0, q.y - 0.866 * size/2.0);\\n}\\n\",n.triangle=\"\\nfloat marker(vec2 P, float size)\\n{\\n P.y -= size * 0.3;\\n float x = SQRT_2 / 2.0 * (P.x * 1.7 - P.y);\\n float y = SQRT_2 / 2.0 * (P.x * 1.7 + P.y);\\n float r1 = max(abs(x), abs(y)) - size / 1.6;\\n float r2 = P.y;\\n return max(r1 / SQRT_2, r2); // Intersect diamond with rectangle\\n}\\n\",n.invertedtriangle=\"\\nfloat marker(vec2 P, float size)\\n{\\n P.y += size * 0.3;\\n float x = SQRT_2 / 2.0 * (P.x * 1.7 - P.y);\\n float y = SQRT_2 / 2.0 * (P.x * 1.7 + P.y);\\n float r1 = max(abs(x), abs(y)) - size / 1.6;\\n float r2 = - P.y;\\n return max(r1 / SQRT_2, r2); // Intersect diamond with rectangle\\n}\\n\",n.cross='\\nfloat marker(vec2 P, float size)\\n{\\n float square = max(abs(P.x), abs(P.y)) - size / 2.5; // 2.5 is a tweak\\n float cross = min(abs(P.x), abs(P.y)) - size / 100.0; // bit of \"width\" for aa\\n return max(square, cross);\\n}\\n',n.circlecross=\"\\nfloat marker(vec2 P, float size)\\n{\\n // Define quadrants\\n float qs = size / 2.0; // quadrant size\\n float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\\n float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\\n float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\\n float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\\n // Intersect main shape with quadrants (to form cross)\\n float circle = length(P) - size/2.0;\\n float c1 = max(circle, s1);\\n float c2 = max(circle, s2);\\n float c3 = max(circle, s3);\\n float c4 = max(circle, s4);\\n // Union\\n return min(min(min(c1, c2), c3), c4);\\n}\\n\",n.squarecross=\"\\nfloat marker(vec2 P, float size)\\n{\\n // Define quadrants\\n float qs = size / 2.0; // quadrant size\\n float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\\n float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\\n float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\\n float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\\n // Intersect main shape with quadrants (to form cross)\\n float square = max(abs(P.x), abs(P.y)) - size/2.0;\\n float c1 = max(square, s1);\\n float c2 = max(square, s2);\\n float c3 = max(square, s3);\\n float c4 = max(square, s4);\\n // Union\\n return min(min(min(c1, c2), c3), c4);\\n}\\n\",n.diamondcross=\"\\nfloat marker(vec2 P, float size)\\n{\\n // Define quadrants\\n float qs = size / 2.0; // quadrant size\\n float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\\n float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\\n float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\\n float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\\n // Intersect main shape with quadrants (to form cross)\\n float x = SQRT_2 / 2.0 * (P.x * 1.5 - P.y);\\n float y = SQRT_2 / 2.0 * (P.x * 1.5 + P.y);\\n float diamond = max(abs(x), abs(y)) - size / (2.0 * SQRT_2);\\n diamond /= SQRT_2;\\n float c1 = max(diamond, s1);\\n float c2 = max(diamond, s2);\\n float c3 = max(diamond, s3);\\n float c4 = max(diamond, s4);\\n // Union\\n return min(min(min(c1, c2), c3), c4);\\n}\\n\",n.x='\\nfloat marker(vec2 P, float size)\\n{\\n float circle = length(P) - size / 1.6;\\n float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0; // bit of \"width\" for aa\\n return max(circle, X);\\n}\\n',n.circlex='\\nfloat marker(vec2 P, float size)\\n{\\n float x = P.x - P.y;\\n float y = P.x + P.y;\\n // Define quadrants\\n float qs = size / 2.0; // quadrant size\\n float s1 = max(abs(x - qs), abs(y - qs)) - qs;\\n float s2 = max(abs(x + qs), abs(y - qs)) - qs;\\n float s3 = max(abs(x - qs), abs(y + qs)) - qs;\\n float s4 = max(abs(x + qs), abs(y + qs)) - qs;\\n // Intersect main shape with quadrants (to form cross)\\n float circle = length(P) - size/2.0;\\n float c1 = max(circle, s1);\\n float c2 = max(circle, s2);\\n float c3 = max(circle, s3);\\n float c4 = max(circle, s4);\\n // Union\\n float almost = min(min(min(c1, c2), c3), c4);\\n // In this case, the X is also outside of the main shape\\n float Xmask = length(P) - size / 1.6; // a circle\\n float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0; // bit of \"width\" for aa\\n return min(max(X, Xmask), almost);\\n}\\n',n.squarex=\"\\nfloat marker(vec2 P, float size)\\n{\\n float x = P.x - P.y;\\n float y = P.x + P.y;\\n // Define quadrants\\n float qs = size / 2.0; // quadrant size\\n float s1 = max(abs(x - qs), abs(y - qs)) - qs;\\n float s2 = max(abs(x + qs), abs(y - qs)) - qs;\\n float s3 = max(abs(x - qs), abs(y + qs)) - qs;\\n float s4 = max(abs(x + qs), abs(y + qs)) - qs;\\n // Intersect main shape with quadrants (to form cross)\\n float square = max(abs(P.x), abs(P.y)) - size/2.0;\\n float c1 = max(square, s1);\\n float c2 = max(square, s2);\\n float c3 = max(square, s3);\\n float c4 = max(square, s4);\\n // Union\\n return min(min(min(c1, c2), c3), c4);\\n}\\n\",n.asterisk='\\nfloat marker(vec2 P, float size)\\n{\\n // Masks\\n float diamond = max(abs(SQRT_2 / 2.0 * (P.x - P.y)), abs(SQRT_2 / 2.0 * (P.x + P.y))) - size / (2.0 * SQRT_2);\\n float square = max(abs(P.x), abs(P.y)) - size / (2.0 * SQRT_2);\\n // Shapes\\n float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0; // bit of \"width\" for aa\\n float cross = min(abs(P.x), abs(P.y)) - size / 100.0; // bit of \"width\" for aa\\n // Result is union of masked shapes\\n return min(max(X, diamond), max(cross, square));\\n}\\n'},454:function(t,e,n){var a=t(387),s=t(456),i=t(447),r=t(455),o=t(453),u=t(117),g=t(22),p=t(14),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.init=function(){var t=this.gl,e=r.vertex_shader,n=o.fragment_shader(this._marker_code);this.prog=new s.Program(t),this.prog.set_shaders(e,n),this.vbo_x=new s.VertexBuffer(t),this.prog.set_attribute(\"a_x\",\"float\",this.vbo_x),this.vbo_y=new s.VertexBuffer(t),this.prog.set_attribute(\"a_y\",\"float\",this.vbo_y),this.vbo_s=new s.VertexBuffer(t),this.prog.set_attribute(\"a_size\",\"float\",this.vbo_s),this.vbo_a=new s.VertexBuffer(t),this.prog.set_attribute(\"a_angle\",\"float\",this.vbo_a),this.vbo_linewidth=new s.VertexBuffer(t),this.vbo_fg_color=new s.VertexBuffer(t),this.vbo_bg_color=new s.VertexBuffer(t),this.index_buffer=new s.IndexBuffer(t)},e.prototype.draw=function(t,e,n){var a=e.glglyph,s=a.nvertices;if(a.data_changed){if(!isFinite(n.dx)||!isFinite(n.dy))return;a._baked_offset=[n.dx,n.dy],a._set_data(s),a.data_changed=!1}else this.glyph instanceof u.CircleView&&null!=this.glyph._radius&&(null==this.last_trans||n.sx!=this.last_trans.sx||n.sy!=this.last_trans.sy)&&(this.last_trans=n,this.vbo_s.set_data(0,new Float32Array(g.map(this.glyph.sradius,function(t){return 2*t}))));this.visuals_changed&&(this._set_visuals(s),this.visuals_changed=!1);var i=a._baked_offset;if(this.prog.set_uniform(\"u_pixel_ratio\",\"float\",[n.pixel_ratio]),this.prog.set_uniform(\"u_canvas_size\",\"vec2\",[n.width,n.height]),this.prog.set_uniform(\"u_offset\",\"vec2\",[n.dx-i[0],n.dy-i[1]]),this.prog.set_uniform(\"u_scale\",\"vec2\",[n.sx,n.sy]),this.prog.set_attribute(\"a_x\",\"float\",a.vbo_x),this.prog.set_attribute(\"a_y\",\"float\",a.vbo_y),this.prog.set_attribute(\"a_size\",\"float\",a.vbo_s),this.prog.set_attribute(\"a_angle\",\"float\",a.vbo_a),0!=t.length)if(t.length===s)this.prog.draw(this.gl.POINTS,[0,s]);else if(s<65535){var r=window.navigator.userAgent;0<r.indexOf(\"MSIE \")+r.indexOf(\"Trident/\")+r.indexOf(\"Edge/\")&&p.logger.warn(\"WebGL warning: IE is known to produce 1px sprites whith selections.\"),this.index_buffer.set_size(2*t.length),this.index_buffer.set_data(0,new Uint16Array(t)),this.prog.draw(this.gl.POINTS,this.index_buffer)}else{for(var o=[],l=0,_=Math.ceil(s/64e3);l<_;l++)o.push([]);for(var l=0,_=t.length;l<_;l++){var h=t[l]%64e3,c=Math.floor(t[l]/64e3);o[c].push(h)}for(var c=0,_=o.length;c<_;c++){var f=new Uint16Array(o[c]),d=64e3*c*4;0!==f.length&&(this.prog.set_attribute(\"a_x\",\"float\",a.vbo_x,0,d),this.prog.set_attribute(\"a_y\",\"float\",a.vbo_y,0,d),this.prog.set_attribute(\"a_size\",\"float\",a.vbo_s,0,d),this.prog.set_attribute(\"a_angle\",\"float\",a.vbo_a,0,d),this.vbo_linewidth.used&&this.prog.set_attribute(\"a_linewidth\",\"float\",this.vbo_linewidth,0,d),this.vbo_fg_color.used&&this.prog.set_attribute(\"a_fg_color\",\"vec4\",this.vbo_fg_color,0,4*d),this.vbo_bg_color.used&&this.prog.set_attribute(\"a_bg_color\",\"vec4\",this.vbo_bg_color,0,4*d),this.index_buffer.set_size(2*f.length),this.index_buffer.set_data(0,f),this.prog.draw(this.gl.POINTS,this.index_buffer))}}},e.prototype._set_data=function(t){var e=4*t;this.vbo_x.set_size(e),this.vbo_y.set_size(e),this.vbo_a.set_size(e),this.vbo_s.set_size(e);for(var n=new Float64Array(this.glyph._x),a=new Float64Array(this.glyph._y),s=0,i=t;s<i;s++)n[s]+=this._baked_offset[0],a[s]+=this._baked_offset[1];this.vbo_x.set_data(0,new Float32Array(n)),this.vbo_y.set_data(0,new Float32Array(a)),null!=this.glyph._angle&&this.vbo_a.set_data(0,new Float32Array(this.glyph._angle)),this.glyph instanceof u.CircleView&&null!=this.glyph._radius?this.vbo_s.set_data(0,new Float32Array(g.map(this.glyph.sradius,function(t){return 2*t}))):this.vbo_s.set_data(0,new Float32Array(this.glyph._size))},e.prototype._set_visuals=function(t){i.attach_float(this.prog,this.vbo_linewidth,\"a_linewidth\",t,this.glyph.visuals.line,\"line_width\"),i.attach_color(this.prog,this.vbo_fg_color,\"a_fg_color\",t,this.glyph.visuals.line,\"line\"),i.attach_color(this.prog,this.vbo_bg_color,\"a_bg_color\",t,this.glyph.visuals.fill,\"fill\"),this.prog.set_uniform(\"u_antialias\",\"float\",[.8])},e}(i.BaseGLGlyph);function _(n){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),Object.defineProperty(e.prototype,\"_marker_code\",{get:function(){return n},enumerable:!0,configurable:!0}),e}(l)}n.MarkerGLGlyph=l;var h=t(453);n.CircleGLGlyph=_(h.circle),n.SquareGLGlyph=_(h.square),n.DiamondGLGlyph=_(h.diamond),n.TriangleGLGlyph=_(h.triangle),n.InvertedTriangleGLGlyph=_(h.invertedtriangle),n.HexGLGlyph=_(h.hex),n.CrossGLGlyph=_(h.cross),n.CircleCrossGLGlyph=_(h.circlecross),n.SquareCrossGLGlyph=_(h.squarecross),n.DiamondCrossGLGlyph=_(h.diamondcross),n.XGLGlyph=_(h.x),n.CircleXGLGlyph=_(h.circlex),n.SquareXGLGlyph=_(h.squarex),n.AsteriskGLGlyph=_(h.asterisk)},455:function(t,e,n){n.vertex_shader=\"\\nprecision mediump float;\\nconst float SQRT_2 = 1.4142135623730951;\\n//\\nuniform float u_pixel_ratio;\\nuniform vec2 u_canvas_size;\\nuniform vec2 u_offset;\\nuniform vec2 u_scale;\\nuniform float u_antialias;\\n//\\nattribute float a_x;\\nattribute float a_y;\\nattribute float a_size;\\nattribute float a_angle; // in radians\\nattribute float a_linewidth;\\nattribute vec4 a_fg_color;\\nattribute vec4 a_bg_color;\\n//\\nvarying float v_linewidth;\\nvarying float v_size;\\nvarying vec4 v_fg_color;\\nvarying vec4 v_bg_color;\\nvarying vec2 v_rotation;\\n\\nvoid main (void)\\n{\\n v_size = a_size * u_pixel_ratio;\\n v_linewidth = a_linewidth * u_pixel_ratio;\\n v_fg_color = a_fg_color;\\n v_bg_color = a_bg_color;\\n v_rotation = vec2(cos(-a_angle), sin(-a_angle));\\n // Calculate position - the -0.5 is to correct for canvas origin\\n vec2 pos = (vec2(a_x, a_y) + u_offset) * u_scale; // in pixels\\n pos += 0.5; // make up for Bokeh's offset\\n pos /= u_canvas_size / u_pixel_ratio; // in 0..1\\n gl_Position = vec4(pos*2.0-1.0, 0.0, 1.0);\\n gl_Position.y *= -1.0;\\n gl_PointSize = SQRT_2 * v_size + 2.0 * (v_linewidth + 1.5*u_antialias);\\n}\\n\"},456:function(t,e,n){var a,s,o,i,r,p,d,l,u,x=function(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):t+e},g=function(t,e){if(null==e);else{if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(v(t,e[n]))return!0;return!1}if(e.constructor===Object){for(var a in e)if(t==a)return!0;return!1}if(e.constructor==String)return 0<=e.indexOf(t)}var s=Error(\"Not a container: \"+e);throw s.name=\"TypeError\",s},v=function t(e,n){if(null==e||null==n);else{if(Array.isArray(e)&&Array.isArray(n)){for(var a=0,s=e.length==n.length;s&&a<e.length;)s=t(e[a],n[a]),a+=1;return s}if(e.constructor===Object&&n.constructor===Object){var i=Object.keys(e),r=Object.keys(n);i.sort(),r.sort();for(var o,a=0,s=t(i,r);s&&a<i.length;)o=i[a],s=t(e[o],n[o]),a+=1;return s}}return e==n},_=function(t,e){if(void 0===t||\"undefined\"!=typeof window&&window===t||\"undefined\"!=typeof global&&global===t)throw\"Class constructor is called as a function.\";for(var n in t)void 0!==Object[n]||\"function\"!=typeof t[n]||t[n].nobind||(t[n]=t[n].bind(t));t.__init__&&t.__init__.apply(t,e)},m=function(t,e){if((\"number\"==typeof t)+(\"number\"==typeof e)===1){if(t.constructor===String)return h.call(t,e);if(e.constructor===String)return h.call(e,t);if(Array.isArray(e)){var n=t;t=e,e=n}if(Array.isArray(t)){for(var a=[],s=0;s<e;s++)a=a.concat(t);return a}}return t*e},y=function(t){return null===t||\"object\"!=typeof t?t:void 0!==t.length?!!t.length&&t:void 0!==t.byteLength?!!t.byteLength&&t:t.constructor!==Object||!!Object.getOwnPropertyNames(t).length&&t},b=function(t){if(!Array.isArray(this))return this.append.apply(this,arguments);this.push(t)},w=function(t,e){return this.constructor!==Object?this.get.apply(this,arguments):void 0!==this[t]?this[t]:void 0!==e?e:null},P=function(t){if(!Array.isArray(this))return this.remove.apply(this,arguments);for(var e=0;e<this.length;e++)if(v(this[e],t))return void this.splice(e,1);var n=Error(t);throw n.name=\"ValueError\",n},h=function(t){if(this.repeat)return this.repeat(t);if(t<1)return\"\";for(var e=\"\",n=this.valueOf();1<t;)1&t&&(e+=n),t>>=1,n+=n;return e+n},c=function(t){return this.constructor!==String?this.startswith.apply(this,arguments):0==this.indexOf(t)};u=window.console,l=function(t,e){var n,a,s,i,r,o,l;for(e=void 0===e?\"periodic check\":e,i=[];a=t.getError(),!(v(a,t.NO_ERROR)||y(i)&&v(a,i[i.length-1]));)b.call(i,a);if(i.length){for(r=\"\",\"object\"!=typeof(o=i)||Array.isArray(o)||(o=Object.keys(o)),l=0;l<o.length;l+=1)n=o[l],r=x(r,n);throw(s=new Error(\"RuntimeError:OpenGL got errors (\"+e+\"): \"+r)).name=\"RuntimeError\",s}return null},(s=function(){_(this,arguments)}).prototype._base_class=Object,s.prototype._class_name=\"GlooObject\",s.prototype.__init__=function(t){if(this._gl=t,this.handle=null,this._create(),null===this.handle)throw\"AssertionError: this.handle !== null\";return null},s.prototype._create=function(){var t;throw(t=new Error(\"NotImplementedError:\")).name=\"NotImplementedError\",t},((i=function(){_(this,arguments)}).prototype=Object.create(s.prototype))._base_class=s.prototype,i.prototype._class_name=\"Program\",i.prototype.UTYPEMAP={float:\"uniform1fv\",vec2:\"uniform2fv\",vec3:\"uniform3fv\",vec4:\"uniform4fv\",int:\"uniform1iv\",ivec2:\"uniform2iv\",ivec3:\"uniform3iv\",ivec4:\"uniform4iv\",bool:\"uniform1iv\",bvec2:\"uniform2iv\",bvec3:\"uniform3iv\",bvec4:\"uniform4iv\",mat2:\"uniformMatrix2fv\",mat3:\"uniformMatrix3fv\",mat4:\"uniformMatrix4fv\",sampler1D:\"uniform1i\",sampler2D:\"uniform1i\",sampler3D:\"uniform1i\"},i.prototype.ATYPEMAP={float:\"vertexAttrib1f\",vec2:\"vertexAttrib2f\",vec3:\"vertexAttrib3f\",vec4:\"vertexAttrib4f\"},i.prototype.ATYPEINFO={float:[1,5126],vec2:[2,5126],vec3:[3,5126],vec4:[4,5126]},i.prototype._create=function(){return this.handle=this._gl.createProgram(),this.locations={},this._unset_variables=[],this._validated=!1,this._samplers={},this._attributes={},this._known_invalid=[],null},i.prototype.delete=function(){return this._gl.deleteProgram(this.handle),null},i.prototype.activate=function(){return this._gl.useProgram(this.handle),null},i.prototype.deactivate=function(){return this._gl.useProgram(0),null},i.prototype.set_shaders=function(t,e){var n,a,s,i,r,o,l,_,h,c,f,d,u;for(o=this._gl,this._linked=!1,u=o.createShader(o.VERTEX_SHADER),r=o.createShader(o.FRAGMENT_SHADER),f=[[t,u,\"vertex\"],[e,r,\"fragment\"]],_=0;_<2;_+=1)if(n=(c=f[_])[0],l=c[1],d=c[2],o.shaderSource(l,n),o.compileShader(l),h=o.getShaderParameter(l,o.COMPILE_STATUS),!y(h))throw i=o.getShaderInfoLog(l),(s=new Error(\"RuntimeError:\"+x(\"errors in \"+d+\" shader:\\n\",i))).name=\"RuntimeError\",s;if(o.attachShader(this.handle,u),o.attachShader(this.handle,r),o.linkProgram(this.handle),!y(o.getProgramParameter(this.handle,o.LINK_STATUS)))throw(a=new Error(\"RuntimeError:Program link error:\\n\"+o.getProgramInfoLog(this.handle))).name=\"RuntimeError\",a;return this._unset_variables=this._get_active_attributes_and_uniforms(),o.detachShader(this.handle,u),o.detachShader(this.handle,r),o.deleteShader(u),o.deleteShader(r),this._known_invalid=[],this._linked=!0,null},i.prototype._get_active_attributes_and_uniforms=function(){var s,t,e,n,a,i,r,o,l,_,h,c,f,d,u,g,p,v,m;for(o=this._gl,this.locations={},d=new window.RegExp(\"(\\\\w+)\\\\s*(\\\\[(\\\\d+)\\\\])\\\\s*\"),a=o.getProgramParameter(this.handle,o.ACTIVE_UNIFORMS),t=o.getProgramParameter(this.handle,o.ACTIVE_ATTRIBUTES),v=[],\"object\"!=typeof(g=[[s=[],t,o.getActiveAttrib,o.getAttribLocation],[v,a,o.getActiveUniform,o.getUniformLocation]])||Array.isArray(g)||(g=Object.keys(g)),p=0;p<g.length;p+=1)for(m=g[p],e=(u=m)[0],n=u[1],i=u[2],r=u[3],l=0;l<n;l+=1){if(_=i.call(o,this.handle,l),f=_.name,c=f.match(d),y(c))for(f=c[1],h=0;h<_.size;h+=1)b.call(e,[f+\"[\"+h+\"]\",_.type]);else b.call(e,[f,_.type]);this.locations[f]=r.call(o,this.handle,f)}return x(function(){var t,e,n,a=[];for(\"object\"!=typeof(e=s)||Array.isArray(e)||(e=Object.keys(e)),n=0;n<e.length;n++)t=e[n],a.push(t[0]);return a}.apply(this),function(){var t,e,n,a=[];for(\"object\"!=typeof(e=v)||Array.isArray(e)||(e=Object.keys(e)),n=0;n<e.length;n++)t=e[n],a.push(t[0]);return a}.apply(this))},i.prototype.set_texture=function(t,e){var n,a,s;if(!y(this._linked))throw(n=new Error(\"RuntimeError:Cannot set uniform when program has no code\")).name=\"RuntimeError\",n;return a=w.call(this.locations,t,-1),y(a<0)?g(t,this._known_invalid)||(b.call(this._known_invalid,t),u.log(\"Variable \"+t+\" is not an active texture\")):(g(t,this._unset_variables)&&P.call(this._unset_variables,t),this.activate(),s=function(){return\"function\"==typeof this.keys?this.keys.apply(this,arguments):Object.keys(this)}.call(this._samplers).length,g(t,this._samplers)&&(s=this._samplers[t][this._samplers[t].length-1]),this._samplers[t]=[e._target,e.handle,s],this._gl.uniform1i(a,s)),null},i.prototype.set_uniform=function(t,e,n){var a,s,i,r,o,l,_;if(!y(this._linked))throw(i=new Error(\"RuntimeError:Cannot set uniform when program has no code\")).name=\"RuntimeError\",i;if(o=w.call(this.locations,t,-1),y(o<0))return g(t,this._known_invalid)||(b.call(this._known_invalid,t),u.log(\"Variable \"+t+\" is not an active uniform\")),null;if(g(t,this._unset_variables)&&P.call(this._unset_variables,t),s=1,c.call(e,\"mat\")||(a=w.call({int:\"float\",bool:\"float\"},e,function(t){if(this.constructor!==String)return this.lstrip.apply(this,arguments);t=void 0===t?\" \\t\\r\\n\":t;for(var e=0;e<this.length;e++)if(t.indexOf(this[e])<0)return this.slice(e);return\"\"}.call(e,\"ib\")),s=Math.floor(n.length/this.ATYPEINFO[a][0])),y(1<s))for(l=0;l<s;l+=1)g(t+\"[\"+l+\"]\",this._unset_variables)&&g(_=t+\"[\"+l+\"]\",this._unset_variables)&&P.call(this._unset_variables,_);return r=this.UTYPEMAP[e],this.activate(),c.call(e,\"mat\")?this._gl[r](o,!1,n):this._gl[r](o,n),null},i.prototype.set_attribute=function(t,e,n,a,s){var i,r,o,l,_,h,c,f;if(a=void 0===a?0:a,s=void 0===s?0:s,!y(this._linked))throw(r=new Error(\"RuntimeError:Cannot set attribute when program has no code\")).name=\"RuntimeError\",r;return h=n instanceof d,_=w.call(this.locations,t,-1),y(_<0)?g(t,this._known_invalid)||(b.call(this._known_invalid,t),y(h)&&y(0<s)||u.log(\"Variable \"+t+\" is not an active attribute\")):(g(t,this._unset_variables)&&P.call(this._unset_variables,t),this.activate(),y(h)?(f=this.ATYPEINFO[e],c=f[0],l=f[1],o=\"vertexAttribPointer\",i=[c,l,this._gl.FALSE,a,s],this._attributes[t]=[n.handle,_,o,i]):(o=this.ATYPEMAP[e],this._attributes[t]=[0,_,o,n])),null},i.prototype._pre_draw=function(){var t,e,n,a,s,i,r,o,l,_,h,c;for(c in this.activate(),r=this._samplers)r.hasOwnProperty(c)&&(c=r[c],l=(i=c)[0],o=i[1],_=i[2],this._gl.activeTexture(x(this._gl.TEXTURE0,_)),this._gl.bindTexture(l,o));for(c in s=this._attributes)s.hasOwnProperty(c)&&(c=s[c],h=(a=c)[0],e=a[1],n=a[2],t=a[3],y(h)?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,h),this._gl.enableVertexAttribArray(e)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),this._gl.disableVertexAttribArray(e)),this._gl[n].apply(this._gl,[].concat([e],t)));return y(this._validated)||(this._validated=!0,this._validate()),null},i.prototype._validate=function(){var t;if(this._unset_variables.length&&u.log(\"Program has unset variables: \"+this._unset_variables),this._gl.validateProgram(this.handle),!y(this._gl.getProgramParameter(this.handle,this._gl.VALIDATE_STATUS)))throw u.log(this._gl.getProgramInfoLog(this.handle)),(t=new Error(\"RuntimeError:Program validation error\")).name=\"RuntimeError\",t;return null},i.prototype.draw=function(t,e){var n,a,s,i,r;if(!y(this._linked))throw(a=new Error(\"RuntimeError:Cannot draw program if code has not been set\")).name=\"RuntimeError\",a;return l(this._gl,\"before draw\"),y(e instanceof o)?(this._pre_draw(),e.activate(),n=e._buffer_size/2,i=this._gl.UNSIGNED_SHORT,this._gl.drawElements(t,n,i,0),e.deactivate()):(s=(r=e)[0],n=r[1],y(n)&&(this._pre_draw(),this._gl.drawArrays(t,s,n))),l(this._gl,\"after draw\"),null},((a=function(){_(this,arguments)}).prototype=Object.create(s.prototype))._base_class=s.prototype,a.prototype._class_name=\"Buffer\",a.prototype._target=null,a.prototype._usage=35048,a.prototype._create=function(){return this.handle=this._gl.createBuffer(),this._buffer_size=0,null},a.prototype.delete=function(){return this._gl.deleteBuffer(this.handle),null},a.prototype.activate=function(){return this._gl.bindBuffer(this._target,this.handle),null},a.prototype.deactivate=function(){return this._gl.bindBuffer(this._target,null),null},a.prototype.set_size=function(t){return v(t,this._buffer_size)||(this.activate(),this._gl.bufferData(this._target,t,this._usage),this._buffer_size=t),null},a.prototype.set_data=function(t,e){return this.activate(),this._gl.bufferSubData(this._target,t,e),null},(d=function(){_(this,arguments)}).prototype=Object.create(a.prototype),d.prototype._base_class=a.prototype,d.prototype._class_name=\"VertexBuffer\",d.prototype._target=34962,(o=function(){_(this,arguments)}).prototype=Object.create(a.prototype),o.prototype._base_class=a.prototype,o.prototype._class_name=\"IndexBuffer\",o.prototype._target=34963,((r=function(){_(this,arguments)}).prototype=Object.create(s.prototype))._base_class=s.prototype,r.prototype._class_name=\"Texture2D\",r.prototype._target=3553,r.prototype._types={Int8Array:5120,Uint8Array:5121,Int16Array:5122,Uint16Array:5123,Int32Array:5124,Uint32Array:5125,Float32Array:5126},r.prototype._create=function(){return this.handle=this._gl.createTexture(),this._shape_format=null},r.prototype.delete=function(){return this._gl.deleteTexture(this.handle),null},r.prototype.activate=function(){return this._gl.bindTexture(this._target,this.handle),null},r.prototype.deactivate=function(){return this._gl.bindTexture(this._target,0),null},r.prototype._get_alignment=function(t){var e,n,a;for(\"object\"!=typeof(n=[4,8,2,1])||Array.isArray(n)||(n=Object.keys(n)),a=0;a<n.length;a+=1)if(e=n[a],v(t%e,0))return e;return null},r.prototype.set_wrapping=function(t,e){return this.activate(),this._gl.texParameterf(this._target,this._gl.TEXTURE_WRAP_S,t),this._gl.texParameterf(this._target,this._gl.TEXTURE_WRAP_T,e),null},r.prototype.set_interpolation=function(t,e){return this.activate(),this._gl.texParameterf(this._target,this._gl.TEXTURE_MIN_FILTER,t),this._gl.texParameterf(this._target,this._gl.TEXTURE_MAG_FILTER,e),null},r.prototype.set_size=function(t,e){var n,a,s;return n=(a=t)[0],s=a[1],v([n,s,e],this._shape_format)||(this._shape_format=[n,s,e],this.activate(),this._gl.texImage2D(this._target,0,e,s,n,0,e,this._gl.UNSIGNED_BYTE,null)),this.u_shape=[n,s],null},r.prototype.set_data=function(t,e,n){var a,s,i,r,o,l,_,h,c,f;if(v(e.length,2)&&(e=[e[0],e[1],1]),this.activate(),i=this._shape_format[2],o=(l=e)[0],h=l[1],l[2],f=(_=t)[0],c=_[1],null===(r=w.call(this._types,n.constructor.name,null)))throw(s=new Error(\"ValueError:Type \"+n.constructor.name+\" not allowed for texture\")).name=\"ValueError\",s;return a=this._get_alignment(m(e[e.length-2],e[e.length-1])),v(a,4)||this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,a),this._gl.texSubImage2D(this._target,0,c,f,h,o,i,r,n),v(a,4)||this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,4),null},((p=function(){_(this,arguments)}).prototype=Object.create(r.prototype))._base_class=r.prototype,p.prototype._class_name=\"Texture3DLike\",p.prototype.GLSL_SAMPLE_NEAREST=\"\\n vec4 sample3D(sampler2D tex, vec3 texcoord, vec3 shape, vec2 tiles) {\\n shape.xyz = shape.zyx; // silly row-major convention\\n float nrows = tiles.y, ncols = tiles.x;\\n // Don't let adjacent frames be interpolated into this one\\n texcoord.x = min(texcoord.x * shape.x, shape.x - 0.5);\\n texcoord.x = max(0.5, texcoord.x) / shape.x;\\n texcoord.y = min(texcoord.y * shape.y, shape.y - 0.5);\\n texcoord.y = max(0.5, texcoord.y) / shape.y;\\n\\n float zindex = floor(texcoord.z * shape.z);\\n\\n // Do a lookup in the 2D texture\\n float u = (mod(zindex, ncols) + texcoord.x) / ncols;\\n float v = (floor(zindex / ncols) + texcoord.y) / nrows;\\n\\n return texture2D(tex, vec2(u,v));\\n }\\n \",p.prototype.GLSL_SAMPLE_LINEAR=\"\\n vec4 sample3D(sampler2D tex, vec3 texcoord, vec3 shape, vec2 tiles) {\\n shape.xyz = shape.zyx; // silly row-major convention\\n float nrows = tiles.y, ncols = tiles.x;\\n // Don't let adjacent frames be interpolated into this one\\n texcoord.x = min(texcoord.x * shape.x, shape.x - 0.5);\\n texcoord.x = max(0.5, texcoord.x) / shape.x;\\n texcoord.y = min(texcoord.y * shape.y, shape.y - 0.5);\\n texcoord.y = max(0.5, texcoord.y) / shape.y;\\n\\n float z = texcoord.z * shape.z;\\n float zindex1 = floor(z);\\n float u1 = (mod(zindex1, ncols) + texcoord.x) / ncols;\\n float v1 = (floor(zindex1 / ncols) + texcoord.y) / nrows;\\n\\n float zindex2 = zindex1 + 1.0;\\n float u2 = (mod(zindex2, ncols) + texcoord.x) / ncols;\\n float v2 = (floor(zindex2 / ncols) + texcoord.y) / nrows;\\n\\n vec4 s1 = texture2D(tex, vec2(u1, v1));\\n vec4 s2 = texture2D(tex, vec2(u2, v2));\\n\\n return s1 * (zindex2 - z) + s2 * (z - zindex1);\\n }\\n \",p.prototype._get_tile_info=function(t){var e,n,a,s;if(n=this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),s=Math.floor(n/t[1]),s=Math.min(s,t[0]),a=window.Math.ceil(t[0]/s),y(m(a,t[2])>n))throw(e=new Error(\"RuntimeError:Cannot fit 3D data with shape \"+t+\" onto simulated 2D texture.\")).name=\"RuntimeError\",e;return[s,a]},p.prototype.set_size=function(t,e){var n,a,s,i;return i=this._get_tile_info(t),a=i[0],n=i[1],s=[m(t[1],a),m(t[2],n)],p.prototype._base_class.set_size.call(this,s,e),this.u_shape=[t[0],t[1],t[2]],this.u_tiles=[n,a],null},p.prototype.set_data=function(s,t,e){var n,a,i,r,o,l,_,h,c,f,d,u,g;if(v(t.length,3)&&(t=[t[0],t[1],t[2],1]),!function(t){for(var e=0;e<t.length;e++)if(!y(t[e]))return!1;return!0}(function(){var t,e,n,a=[];for(\"object\"!=typeof(e=s)||Array.isArray(e)||(e=Object.keys(e)),n=0;n<e.length;n++)t=e[n],a.push(v(t,0));return a}.apply(this)))throw(r=new Error(\"ValueError:Texture3DLike does not support nonzero offset (for now)\")).name=\"ValueError\",r;if(c=this._get_tile_info(t),l=c[0],o=c[1],h=[m(t[1],l),m(t[2],o),t[3]],v(o,1))p.prototype._base_class.set_data.call(this,[0,0],h,e);else for(n=e.constructor,g=new n(m(m(h[0],h[1]),h[2])),p.prototype._base_class.set_data.call(this,[0,0],h,g),u=0;u<t[0];u+=1)f=[Math.floor(u/o),u%o],_=f[0],a=f[1],i=Math.floor(e.length/t[0]),d=e.slice(m(u,i),m(u+1,i)),p.prototype._base_class.set_data.call(this,[m(_,t[1]),m(a,t[2])],t.slice(1),d);return null},e.exports={Buffer:a,GlooObject:s,IndexBuffer:o,Program:i,Texture2D:r,Texture3DLike:p,VertexBuffer:d,check_error:l,console:u}}})}(this); //# sourceMappingURL=bokeh-gl.min.js.map /* END bokeh-gl.min.js */ }, function(Bokeh) { Bokeh.set_log_level(\"info\"); }, function(Bokeh) { }, function(Bokeh) { console.log(\"Bokeh: injecting raw CSS\"); Bokeh.embed.inject_raw_css(\"/* BEGIN bokeh.min.css */\\n.bk-root{font-family:\\\"Helvetica Neue\\\",Helvetica,Arial,sans-serif;font-size:10pt;position:relative;width:auto;height:auto}.bk-root .bk-shading{position:absolute;display:block;border:1px dashed green}.bk-root .bk-tile-attribution a{color:black}.bk-root .bk-tool-icon-box-select{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg0kduFrowAAAIdJREFUWMPtVtEKwCAI9KL//4e9DPZ3+wP3KgOjNZouFYI4C8q7s7DtB1lGIeMoRMRinCLXg/ML3EcFqpjjloOyZxRntxpwQ8HsgHYARKFAtSFrCg3TCdMFCE1BuuALEXJLjC4qENsFVXCESZw38/kWLOkC/K4PcOc/Hj03WkoDT3EaWW9egQul6CUbq90JTwAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-box-zoom{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg82t254aQAAAkBJREFUWMPN11+E1FEUB/DPTFn2qaeIpcSwr5NlUyJiKWVXWUqvlUh/iE3RY9mUekkPPURtLKNRrFJEeuphGfUUaVliiX1aVjGs6aG7+XX9ZnZ+d2fTl2vmnHvPPfeee/79Sk+may2/UQq/q7Qu+bAJoxjHIKqB/wlfUMcMVqI9bLZ+DGIKwzlzQ2GcxCx2xwvKOUKlaHTiX8bHNspjDONHkOmJBW5jIof/FvPh/06MZOb6cRc7cGn1AKUE5cdzlM/gAr5F/O24H3xkFRfxAbVygvK+cIsspjGWo1zgjeFpxL+BvnLw7laBA4xjIFJwrgu52DoVjKdY4HBEX8dSF3JLYe1fe6UcYCii3xWQjdfuSTnAtoheKCC7GNED5Zx4L4qt61jbTLHA94geKSC7P7ZeShQ0Inoi1IJuEOeORooFXkV0FZNdZs5qvFfKAeqYy7nZ6yg//HG0MBfffh71lFrQDCW2EvEP4mt4okZUDftz9rmGZkotmMxJRtlisy+MTniAWrty3AlXw0hFM2TD89l+oNsoOJXjbIs4EpqNtTCLXbiZ0g+M4mFObj8U3vsNjoZCVcmk60ZwthpepLZkB/AsivWfOJZxtpUQHfWib7KWDwzjeegBZJSdKFiE2qJTFFTwElsi/unQ/awXrU4WGMD7nOJxBY/1EO2iYConq93CHT1GOwucjdqnRyFz+VcHmMNefMY9nNkA3SWUOoXhQviSWQ4huLIRFlirFixnQq/XaKXUgg2xQNGv4V7x/RcW+AXPB3h7H1PaiQAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-zoom-in{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgsUBmL8iQAAA2JJREFUWMO9l12IlFUYx3//MzPrLpSjkm5oN4FFIWVEl66IQlFYwtLOzozsjHdGRSCRF0sfBEXRVV0FQuQiLm5CZNBFgRRaRLVFhbJ2EdiN5gbK7toObTPn6eYdPTvNzPvOBz5Xh/ec5/n/n89zXtEHmZqeSXSuXBz/3zfdKvBWJHQrwZuRcP0El+QkbQXeBX6WZEgm6TtJk5lM5o4Lc+cV6qpf4Ga20Tm338zeATItVK9Ker6yvPzp4NDQ3+XieGsCU9MzTYumGbhz7m4ze9/MHgvBgItACrgfGAj2jgAvAYs3wlEujjc13kii8YyZrXXOfWhmo9GnFUlvOOemarVapVqtkslksmb2KjARqL62ecuWN9NxbRInzrldAXhV0uFSIfdew7G/gNLU9MwS8CwSmE3Oz88fcXG5blfpqVRq0Ix8VIAAX0XgrVL7HDCHGcCaWrV60LUBN8Dae58aQIxEqcA592I9M610JL0cpG/U9TIHJNKY3RV5z0R+7Nd4HZ0P1g/2RMBuegLAsRMnb4vT8d5vqKfMzOgtAlADrkmqGywmiMBTwfr3dC9j1Xv/r6Tvg/5/5ejxE6cO7M9faVbQZrYNOFSPmqQvVo9FKexvi5uWX58943aM7DwAfBDY+FbSCxP5sdkGx55GeguzrUEXPaSo2pFkAbiSZQCAzZJOmdkjwd6SpB/M7KykQTPbA2wDhoIzRzcNDx9MJwGNIXdJ0mEzmwbujL7dbma7gd03A7lKfnTOvf74nl0r6bonTUbujRSUCrm2d4L3/kvn3JPe+8+BDW2i9o+kT7z3kxP5sYsA6W47oE64TsR7P9tQL4vA2mh9WdIscKxUyJ0M7aR7acOGzikD65EQLEjaa2ZXzMwDFeB6qZBbbLTRE4EGeSaozNOZgYFf8qP7lmIvs354n0qlHpB0T7B9Ogl4IgJJrmjv/SiQjbrkD+BMUkfSbYATPdckrTOzkciWAXOlQu5cYgLdPEIapud9wMOR9zVJH3ViKx333mtHMJvNuoWFhZ3A+ojMcja77njXBEKwJJfTcqUyCIQ34Mf7nnh0paMnXacFuGoC1mr3AtuDfLzd8Zuyl+rfuGn4HLAD+Az4qZQf+61TAj0Noj8vX6oC35SL43u7teG6rf5+iXppwW7/JUL5D03qaFRvvUe+AAAAAElFTkSuQmCC\\\")}.bk-root .bk-tool-icon-zoom-out{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgsHgty9VwAAA0FJREFUWMO9l09oXFUUxn/fmXlpItppi22k7UJBRSlVkCytSAuKUloIdjKT0El3FXVXdVFKRVAQV7qQohsNwdA0UFvBhYtqUVyIVlRaogtFQVq7qSTVjA3z3nHzBq/jvPmTN/Ss7rv3nvN99/y794kByMzcfE/7picn/jenmwWeRUI3E7wdCRskuCSTdDfwBvCtJEdySV9KOhpF0e0/LF5SqKtBgbv7ZjObcvfXgShD9Zqk5+orKx8Oj4z8NT05kU1gZm6+bdK0Azezu9z9hLs/HoIBvwAF4H5gKFh7B3gBWFY3460kWve4+3oze9fdx9OpVUmvmNlMHMf1RqNBFEUldz8OHAxUX9q6bduryut+Sfvc/Wz62ZD0fK1afjND9y3gGSRwv1GMojstTxUUCoVhdyopEYDzKXjWwZ4FFnEHWBc3Goet00m7lZlZYQixKw0FZnakGZksHUnHgvCN5/KARBH37enpOVg58H13HV0Kxg/kIuD/ngSA2ZMLt3bTSZJkUzNk7k4+D0AM/CGpaXCyBw/sC8Y/qZd2GpZiuL9YLN4Sx/HpoP5/c/exQ1OVq+1yyt13SLoArEsJnMjlgfOffvK3u58Kprab2QezJxfG2iTzUzI70wRPG9jbmpmb95SNB9mpzp7/j2yVdNbdx4K565K+cvfPJQ27+x5gBzAS7Hlvy+jo4WIvoC3kWpcvS3rR3eeAO9K529x9N7C7zX6AC2b28hN7Hl1Vt44niVq13LUjmtlYkiQfA5s6eO+GpDNJkhw9NFX5ueNt2ARodyF1IHIN2JiOl4H16fiKpK+B2Vq1vBAqFAf4IJkGNiIhWJK0192vunsC1IE/a9XycquNXARa5OnApeeioaHvKuP7r3dTGsiLqFAo7JR0T7B8rhfwXARa2us4UEqr5Ffgs151i/08oTNKdIO770ptObBYq5Yv5ibQq/sl3Qc8lJ4+lnSqH1vFfp9koZRKJVtaWnqkWXqSVkqlDe+vmUDWpZMlK/X6MBDegKf3P/nYaj8ErN9fqZBYEsf3Ag8G8Xit33BaniTcvGX0IvAw8BHwTa1y4Md+CeRqRL9fudwAvpienNi7Vhu21uwflOT+L+i1X2TJP57iUvUFtHWsAAAAAElFTkSuQmCC\\\")}.bk-root .bk-tool-icon-help{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABltpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+NTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpBODVDNDBDMzIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDpBODVDNDBDNDIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkRlcml2ZWRGcm9tIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgPHN0UmVmOmluc3RhbmNlSUQ+eG1wLmlpZDpBODVDNDBDMTIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwvc3RSZWY6aW5zdGFuY2VJRD4KICAgICAgICAgICAgPHN0UmVmOmRvY3VtZW50SUQ+eG1wLmRpZDpBODVDNDBDMjIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwvc3RSZWY6ZG9jdW1lbnRJRD4KICAgICAgICAgPC94bXBNTTpEZXJpdmVkRnJvbT4KICAgICAgICAgPGRjOnN1YmplY3Q+CiAgICAgICAgICAgIDxyZGY6U2VxLz4KICAgICAgICAgPC9kYzpzdWJqZWN0PgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNjoxMToyOCAxMToxMTo4MjwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+UGl4ZWxtYXRvciAzLjY8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cphjt2AAAAT7SURBVFgJxRdbaFxFdGb2bhui227BWrsVKYgf2kJUbP9EUPuzEB803WTXJjH61Q/7Ya1+CMYKEVTsh4J/EpvY7BoabUiNiA8s1p+4KIhpoUUEselHqyS76TbZ3HuP58ydc3d2u4+IkQxczpz3mZkzZ86VYpXjvenpjZsLhUcliE4AuUuASAgptmt1EFdwPiclzIIUUwubNn17OJlcXo1p2UpodHRiux9xB1Eug1+slbzhFxGOKc851tu7/0oznYYBDA8Pt0U2tL8KQryIq2tvZqQhD0QJHRz3yqWhgYGBpXpydQMwqz6NCnurleCSADkJEfgKfOePqL80R/wV1ZaQyr1LenKfkPCkEPKeaj0xg7vxVL3duCmA0Vyuw/fl52hgBxsBED+h4Cv9z3R/zbRm8MTJTx7HQN7GQB6w5C4L4SX7M5lfLBpurjXMyvNIShiyi0l1pL8n9b7EDGPR8fHxzSsQ6XDB3618/xqo6Pk25V5MpVJllgHM1BO58RdQ612kOYZ+GXdij70TYQB05mpj+1kU5G2fB+l3PZtOf8NGx6ambnMXb3yAxg8wjSEG6OKKR9oicBQD+ZvpH2Wzj0lQpxCPG9qMv1x6hHNCsSAlHM7ZOa682vlI9tRDbvHGbD3nZAPpDoD/3JIrLpAs26UFkC3EMUA99hpfGtEBfJjNJnS2Gwnadnvl+Xw+iuc3DAJuNyIaSCHpilVldyDjjUxj3WDZIAhxhHHyRcdNuA7AAfUaXzVKODpzFiZ4/uLvh5G+m2no+C/pyIf7MqlEJB7bpqR6nXkEUfbeawuLaZsW2ISfNQ2vtaktQlGFQyIVGT0o2+2EC4iQNGwjBIN9qdQ5Qg4mk4X4rW3vCClLtowE2FOFUxKDfNmiZci3ovKKRFPh4FK9q4Zbdr+lKKJiA13TcHR2dmLBgdmQ0GAS2MZaEowY+XbAk09IvgtYZGp16SyvFhaHcIUh645t8T9DBCcnz5zZ4hZLu3DzK2QlL1QQa0Y+pHiJKPSuOGj3PmZTheM5w2TwqBxnvBZOTk7G5gvXJ5Aelms8wnJURL+olSWcfEhf6gDoUXPMq6ZlqbzWU2pE+3hi4s6F68tfIj9cBMlikr7Z0/P0b/X0yIcUXsDCF1WhtL4OROHaXk+xlkbV0Cu732Nmhc4peaWSg73pA8dq5RkvO37ldUTfXCKZv2q45MkhvG87WQEzpCCUSvV1d9GONBy3lMvgKSwrZig8gjAietWY0QriylO2jIo4yVbOSb7KB/qmI9BPKjHpSSXYauRyn92Nq9/Kcrj13x3s3v8D481glQ/0raiNYgX9njPSBOImbrHZePl+tfFmc9sH+Xaoh8NjOKSVdDMhjjYzQLy+dFceH5+IJQf9VYXX4tROg4ZFU8m31M3mfPEqUoJqCGJfvWpo2xnNfdrhC28n06SCeSzNZxlvBINGRXCtKS7EY1uV6V7HWAm38y1cXaXsMcOCvr9ySPj+af7A1U2HJXHzVNvUXVLIGyPf+jV0pf8GHoN+TLAyPkidTCi2RpPApmnR0Bd1zGRaB/B8Oj2HSw7LLbVR1MmskW8RdEWVXSJf3JbpAMgRtc4IZoxTh9qotQjCasm46M0YX9pV1VmbpvRH5OwwgdRtSg2vKaAz/1dNKVtb17Y8DCL4HVufHxMOYl1/zTgIgiYvBnFKfaNp3YjTdPz3n9Na8//X7/k/O1tdwopcZlcAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-hover{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4oVHp0SwAAAQJJREFUWMPtlsENgzAMRb8RQ5VJItFDOgaZAMaAA0iZpN3KPZSoEEHSQBCViI/G8pfNt/KAFFcPshPdoAGgZkYVVYjQAFCyFLN8tlAbXRwAxp61nc9XCkGERpZCxRDvBl0zoxp7K98GAACxxH29srNNmPsK2l7zHoHHXZDr+/9vwDfB3kgeSB5IHkgeOH0DmesJjSXi6pUvkYt5u9teVy6aWREDM0D0BRvmGRV5N6DsQkMzI64FidtI5t3AOKWaFhuioY8dlYf9TO1PREUh/9HVeAqzIThHgWZ6MuNmC1jiL1mK4pAzlKUojEmNsxcmL0J60tazWjLZFpClPbd9BMJfL95145YajN5RHQAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-crosshair{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADEUlEQVRYR81XXVIaQRCeHqug8CXmBNETaE4gniDwIgpVspxAbxC9ATkBkCpQ8gKeQDiB5AQxNyAvUlrldr7eHxyGXZi1rMJ5opbp7m++7un+htSGF204vsoMoNXrlzSpfWa1oxQfhAegCZGaEtPorHo8znIoJwCt6+td8uk7ApUQCIHTF4BNAWzImq8ap6cP68CsBdDp9i9ZqXM7ML79g/EnCWD+jgMKENKqWT+tXK0CkQqgNRjs0OxpQIqKhoMxaG6/6JeRnK7T6yO2UvVqhYSlLX+ryORfgKn9ORDFIy7ky41yGcwsr0QAQfDH5zucOswx819fs4egI9OFCcD8DjBF7VNbEX0JzdWEt3NHSSASAcCxBDqMgt/623kvyTgNgNjJIfTjk4D4FqaJR1715MjmYAmA5Bx3AwUXQL+t105KaTlcBSC26XRvhjEIoLiq1yqXpr8FAGG16/ug4IT27fxBWu7EiQuAiImJpEMKE6nYM30uAIDDttSUOPfJP7JzbjPhAiBIh9QE67vIvoOi9WJfCwDavf40ulpjbCqmUf+W753ezURuh7Dg1SqflwAEHU6pgfyBq9Y4qx0LG++2fnZ/eUzcstmdM2AWH+jfc+liWdBJfSENf8Lifi3GVwC9mybOfi5dzatWVrbbLIHNva8p5h/16gkaFiLGGxbufkoE6XguwePiXLF3XmMfCUCUAqtKXU7sumd1CowOuJEi3Pg1FBpjitIGhyvVSfvmjci6ZR+rFQfDiPVE2jFYeICQ+PoewwjC5h7CZld6DBdyu6nDSKgzOyIMhmhK5TTqXYbRorZYM46TmpKAAOrGWwSJJekSB1yqJNOzp1Gs7YJ0EDeySDIMtJbQHh6Kf/uFfNFZkolJICRmz0P8DKWZuIG2g1hpok+Mk0Qphs0h9lzMtWRoNvYLuVImUWrmPJDlBKeRBDfATGOpHkhw670QSHWGLLckmF1PTsMlYqMJpyUbiO0weiMMceqLVTcotnMCYAYJJbcuQrVgZFP0NOOJYpr62pf3AmrHfWUG4O7abefGAfwH7EXSMJafOlYAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-lasso-select{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgwlGP1qdAAABMBJREFUWMO9V1uIVVUY/r61z57ZMx4DnbzgkbQXL5iCJphlWdpIGY4jpFBkEiU9ZNaDRRcITcIwMwgxoQtU2IMXdAZfMjFvpERXYiSbysyBEXFmyuHMnLP32uvrwT2xnY5nxvHQ93Jg7fWv71/r//7L4a59TRgqJk+Z6v3a+sv0OI5nk5wu6VaSVZImAThHsgjgrKTvM5nMUWvtmf5n8HodCIKgOgzDhc65pSTrJQWDsSNpJX1ljHnDOfdT37oZLLHv+8OMMasKhcIJ59xHAJYMlhwAJGUAzJfUTHLFuFzOG5QDU6dNMyQfs9Yedc5tBpAD4IYYNQGoBrDtQnt7/b0LFrJsCHzfn2itfQfAnZLiazytA3AaQAuAiwDaEgeNpGkkswAWSBqRONB38b88z5uTKePt6iiKXkk8jq+iJC5LOmiMaTLGHLPWhmWeHr7vV0dRtATAapAzIVmSo51zyzIlbm2stesFPA6pKk0r6Ryg93y/ek8YFvPOOTg3cDSiKCoC2OP7/rEoirYm4rUkF12lAWNM1lr7lqQn0+QA8gI2jBg5cj6Aj8OwmB+KAKIoukhyp6SRJAUgl0ndPLDWPi9pJQCbuviXvu+/GIZhW1dnJ24UJFuTjCCA2ADA8sYGWmsXS3qmL94kDYAtkh4Nw7ANlQJ5U6INT1KrAYC9zQdykl7nFSj5fXp5Y8NWVBhy7mUAjqShMYdMXV2dJ2klyRwAJ8lIeuGWCRMP7N7frEqSG2OmAFhKshNAp5wrmO7u7jEAngPQm1S2z2pqapr+OPt7XEly0oxwzq2RdFmSD2AMgKKJouhhAL4kA+Cs53l7e3t7uytJHgRBreTWkXwkKVJnJD0B4GAGwIJE9R6AFufc6UqSZ7PZbD6ff5dkA4CQZEHSqwAOISmXtwGIE+F1SeqqIP8d+Xz+C0mLJYWSAODteXffczjdDQNJ0BWMCoLg5gqIbRTJNwHsljQhUb0luWPM2LE7Thw/9m/5NCT/TByxAOYWi8X6/gdWV1dnfN8fNRBxJpMZTXKdc+6IpFVJWAEgkvSJpA0X2tvtVTaSjgOYBCAEEADYSHK87/sfhmEYA9gShuEDkgzJHyWtB/B1irQ2juP7ADxkrX0wOUOpzmdpzEY590HJ7Ni1r2kSyZOSiv2+hSRjSTXp/QAukzySNJOJkmalyNIl10hqMcasdc61XDNcQRD8BnITgNp+36r6kfcNFMMlLQGwTNLMEuQGQBfJl2bdPru+HDkAZAqFQux53jZHEsC6aw0eg2gylNRBcqcx5v04ji999+03AwsWAOI4Lsy9a94WkisAnE5a5WCJYwCfA1g7LJudI2lTHMeXBm1faiQzxkyRtF3S5CTupeAB+KG2tnZFT0/P30NO2VKLzrmfAbwGMipjG5Oc0dPTc0Md05SZ5U4Q2FxChErtEYD7jTGNQ3UgM8Asv90Yc9I5LSKRlXSI5CxJa0jWSALJjKRnAewfkniT+vwf7N7fXHK9rq7O7+jo+BTA/NRrdBpjnnLOnUrvXd7YMPQXSBunneno6IhIHgYwW1JtkgmBpBkATlVMAwOk3nFJ+VSoqgCMr6gIy2FcLtdKspAedyQN/98caDt/3kpyabUmf8WvG/8A1vODTBVE/0MAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-pan{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4lKssI9gAAAOtJREFUWMPVll0KwyAMgNPgoc0JzDX2Mtgp3csKErSamGabIEUo/T6bHz0ezxdsjPJ5kvUDaROem7VJAp3gufkbtwtI+JYEOsHNEugIN0mgM1wtsVoF1MnyKtZHZBW4DVxoMh6jaAW0MTfnBAbALyUwCD6UwEB4VyJN4FXx4aqUAACgFLjzrsRP9AECAP4Cm88QtJeJrGivdeNdPpko+j1H7XzUB+6WYHmo4eDk4wj41XFMEfBZGXpK0F/eB+QhVcXslVo7i6eANjF5NYSojCN7wi05MJNgbfKiMaPZA75TBVKCrWWbnGrb3DPePZ9Bcbe/QecAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-xpan{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4X4hxZdgAAAMpJREFUWMPtlsEKwjAMhr/pwOOedINJe/PobWXCfAIvgo/nA4heOiilZQqN2yE5lpD/I38SWt3uD9aMHSuHAiiAAmwaYCqoM/0KMABtQYDW11wEaHyiEei28bWb8LGOkk5C4iEEgE11YBQWDyHGuAMD0CeS30IQPfACbC3o+Vd2bOIOWMCtoO1mC+ap3CfmoCokFs/SZd6E0ILjnzrhvFbyEJ2FIZzXyB6iZ3AkjITn8WOdSbbAoaD4NSW+tIZdQYBOPyQKoAAKkIsPv0se4A/1UC0AAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-ypan{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4anK0lywAAAMVJREFUWMPtlzEKwzAMRX/S7rlpIMXeOnaLaME36FLo8XqCdNFghGljyc4kgQi2Q/SUj0F/eL7eMMTKz6j9wNlYPGRrFcSoLH4XxQPvdQeYuPOlcLbw2dRTgqvoXEaolWM0aP4LYm0NkHYWzyFSSwlmzjw2sR6OvAXNwgEcwAEcwAEcwAEcoGYk20SiMCHlmVoCzACoojEqjHBmCeJOCOo1lgPA7Q8E8TvdjMmHuzsV3NFD4w+1t+Ai/gTx3qHuOFqdMQB8ASMwJX0IEHOeAAAAAElFTkSuQmCC\\\")}.bk-root .bk-tool-icon-range{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABCJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjU8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjMyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT4xPC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zMjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxkYzpzdWJqZWN0PgogICAgICAgICAgICA8cmRmOkJhZy8+CiAgICAgICAgIDwvZGM6c3ViamVjdD4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTgtMDQtMjhUMTQ6MDQ6NDk8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPlBpeGVsbWF0b3IgMy43PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrsrWBhAAAD60lEQVRYCcVWv2scRxSemZ097SHbSeWkcYwwclDhzr1Q5T6QE1LghP6BGNIYJGRWNlaZItiFK1mr+JAu4HQu0kjpU8sgF3ITAsaFg0hOvt2Zyfvmdsa7a610Unx44Zgf773vvfneezPHNzrbhn3CT3xC3wPXYOC8LDzqdi8YY/gwh4BeknS/2th6dr2kf94AOp3OFyWgMyziOPbMDxV9FTtJnl1ut795Xd0/YQ0/vtYQwMT1KXWCfr2IjOWwtNehwN4xL9ykTrm6Pzl58yLn3J+mKh9mXbT3uRjGEDph+O8/TjfP5dBp7Ha7AX7O3o5nZeD/0E/OGyXntDgzA0X6qmCnrVutVlrUWV9f/3xo+pwhGDhvEPHOjoxnZjJggXmMHzBQ7NGNp9vxk61fr0HR7e/u7pZzCGHlc7qwBYYTT7tJYSx1AQzppyFPft5apta9w7SKcn0b7P7+/jCsDQ5mbc0dCmIJGDN0ehdcjsmkm6A6KUeKFOTE11PLxrC7Ukqh3ylL2fT0NAP9q6ur6rRCJJYsbKB0JsbCKMuy+xREePDyxQPCz+Crlw062QcA5wBOOt1l6vIl2WiI9F1fN6Q+BBqit6hEC4Hk08GQJMn4myjSP7RavVxgdaVUh/3U6HCMsPr9pYnJKRziHtWQ+un58+hGs6nsjQSjpuTyKGN3CX+FBwHXSiEVgjP+O8X6N12kIePES+GzTKAkGbNp8yJsGUMVzz8jPKReiyAQRimy5/cjye5RpF8utFp/+nwmT7d/NMzcFkS7yjJNGDaPURQxIQThEQy0SyF4l5WJYYhBa816vZ6dU7A6CAhbZVow/pDe0O9hVOoCi13r4BgBAvJHqMSQL2vE/iH6IAXEwgrRVUmBoRRwnwJQT98xEeVeSUyB4dJ5nwJBKdCFFGRmUCcu7rwIYypCTblaChuNBhWODrman5ub+4v0rMNBt8z6Ezh7GksJQpCbm79cMQE7QBFm/X6f0rjWnv8WRYg/QdbUpwDAEBy8vPyA8rNGzg3a8MiElwiM7dAtRqNoNptjGPM1laVxP9umWEMGLOKhKUOJDtBwDmzsw9fC/CzHr9SGuCTi2LbbKvVtmqXpCjMihBFa79Wrt5fGx9PDzc3fmu32Lf8qFliwU9emKhBSp+kRKn/hu9k1COEDbFdt/BoKWOAkuEbdVYyoIXv8+I/QK9dMHEb1Knb7MHOv8LFFOsjzCVHWOD7Ltn+MXCRF4729vWMDK+p8rLkvwjLg4N4v741m5YuwCI9CvHp1Ha8gFdBoPnQAkGsYYGxxcfEI7QQlFCTGUXwjAz4tWF+EpymOWu7fglE7qsOvrYE6g4+9/x/vhRbMdLOCFgAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-polygon-select{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEjc1OfiVKAAAAe1JREFUWMPt1r9rU1EUB/DPK0XbqphFHETo4OCiFhwF0V1KHbRSROLqon+AUMVRRFBwEbRFMBiV+mMW/wIxi5OD1kERRVKRJHUwLvfBTZrU5OWBGXLgQu7Jfe98z/ec7z0vKa88b2q1BDtRHdAPBaylm1NzsxsOjPnPNt6WSWprbft+/c3I3zOAjhT1Y4+fvcjEQJIXnVECSa+AhqIHqlHH5lWCZoe+Gk4GRgDG86j9SAUdlDBSQaZhlOkuHyoVdJmsw98D1S5fM4NYM1LCpqM+Lwa240oLgmZzpVZvzKT75VLZcqksSZKWlQeAy/iORVwIvh31xvotvK7VG3Px4aWHj3Jl4C2uYSvq+Bn8v6LLbaVWb9zsBiKLCvbiNG7gLm7jAYqbPHMJMziZ9lsKoh8GtqCEVVzHftwJn+TFHp4/hg8BSCYVfMOZoPEv2NZGdy9WCGUr9toDR3E2/H4V6nwRe/BmgN65H1ZhvMuB3XiKIyFoGefwO6ysVkUlrNUNsyAK/jli533Q+Y8cJFvAeXyMS1CI/jiMr/gUtD2LQwMGr4R3p7bY3oQHQ5b38CT4D2AXXg6YcQXHpyYnlqKsi5iOAVSwL9zd7zJ09r+Cpwq72omFMazjT9Dnibym0dTkRDUKrrgwH7MwXVyYB38BstaGDfLUTsgAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-redo{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4itK+dVQAAAaFJREFUWMPt1L1rFFEUBfDfJDaBBSslIFjbaSFp1FJQFMVCHkzhKIqdUYOCoBgErVz8rCwiTDMwBCIKipDWyip/gxAIWAmBgBC0eYFh2Gx2l9lFcA5M8e59782Zc84dWrT435Hs1siLchqn43MS0zgW22vYxjesYjVLw3YjBPKinMUTBOwf8J5fKLGYpWFjJAJ5Uc7gIW6jM6Kim3iNZ1katgYmEL/6I+YasvY7Lg6iRpIX5VF8wuEe/XV8wGf8jN6LWTiAc7iEQ7ucPZ+lYW0vAtfwvlbfwCKW9gpXDOv1mJvZHiSO91MiyYsyiQSuxtpXXM7SsDmM5nlRdrCMMz3sOJWl4Xevc/vwBzdwAl+yNNwZxfRI+GxelK9ikHcwh8d4NNR/YFRES1ZwoTYdR7I0rNf3TzVNIGbmSvR/Bx08mIgCFSVu4l2ltIWD9WxNGR+W8KOynqnZ0rwCeVG+wa0hjrxtWoF5dAfc28V8Mib/n+Nev5dnabg/zgw87aNEN/bHOwVRiRe4Wym9zNKwMKkpgIWKEt24njxiJlq0aPFv4i9ZWXMSPPhE/QAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-reset{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4gWqH8eQAABLdJREFUWMPtlktsVGUUx3/nfvfOlLQaY2IiRRMQIRpI0PjamJhoVASDvNpCpYw1vJQYSVwZwIVQF6wwRHmkAUof9ElrI6VqDAXcID4TF0IiYQMkSlTokNCZ+b7jove2t+NMH7rQBWd3v+989/zP+Z8X3Jb/WGQySvUNTQBJESkNguAVYIWqzhaRhwBU9WcR+QXoymazn6jqzUQiMQSQzWZRVdal1vwzAI2tHQBPOuc2AbWTdOyQ53n7nHNfRwee51GzqoIQMCLDpr3x/tLQ0oZzrk5Vj0/BOEBt+KYuOlBVGlrahr0Wob27t3gEjnZ2AyQzmUwHsDgP6J/AYRE553neDwDOuUdU9QngNeCumK4TkRMhZUORcYC1qysLA6iuSQHIwkWLD6lqapQsuSmwTVV3h99I7EcAR462A2xR2Ilq6ehTaejvO1774kuLNALR33eclsaGsQDe3fYegHl43vyNwEeqGl1963mm2jl7YZRTQ82qlWP4HM6ZToC5ztkW4LHQoALru7s6Di5dvlIj/e6ujrEAWoZDn8hmMjXATMACGaAVuBjXTVVXFc/AxhaA+4zvn1DV+eHxVWPMAmvtb5GeMWZyZVhI2rt7qVy2pOh9U1snwIPW2vMi4oWJuBPYHkVAVScPoKmtkzVVK6cEMsyJraHhiCqJqJUwj/JRz7TW1iSSyR2rVyylqa0Ta+24Ic8vXaAEmDFc/l5Z2A/80OibuVyuz/f9ElUdHCmvw82t5HK5h6y1PYhsz2YyGw43t2KtBZHIGwB6+j4rCkBVUdV7gXrggnPuu8h4eP+xMeZS2D0rJYZ6AdAMzAt1b4nI26p6IFZOY8pugijcKSIHVLUK0LyST4vnrVfnWr3mjmP4QTATaERkXkypRFX3isjmuHdRJEK6Ckqquopp06bdKCkp2Sgi7XnGLcg7gzeutwNIiPYc8HixqIrIOlU9ONVIhHPEd851icgSVXUiskVV94gIqoonIt0i8gfQCfwae38e6BWRXuBZz5jZ8VbaOE4EIqlZVUEQBLlkMplS1QER2RwkEnsSyaREDUzyeNsvIhvCMqkH1kdIJ2o+k8iJB1LVVRfjZ6nqqlEAIbdVQGto8Lrv+/dbawcjAL7vc+6bs+zetetfLSHxniIFGofGGsU2oC7eOCbDfZ7nQawBOSAX74SF9oEPImOq+r7nmVmxb5raukZa8UReGmNmhbMkAwwBH467EYVZe49z7kdgenj8k7V2oTHm8kgdWcvrNdVFjR8cHkYzjDH9wLjDaEwEzpwa4MypgWvAjtjxfGNMj4jMiT+M+kFsZI/Q6Pv+HGNMT8w4wI7TAyevxXVPD5z8+zD64tRXAMHVK1eaVLUyVvuDqroV2BOnJF4ZIedviUidqt4Re9s+vbx8zZXLl7PR2+nl5Tz/zNOFp2FzxzGAklw22wUsLLaSKXwf8vhosZUM6PeDYEUum70VHfpBwKsVyyfeikOP6oBNwN1TrLbfgX3A1kKLzKeff8nLLzw38T5wZDgxn1LnNk5lLRfP26/OnR2hwfNYW2Atn9RCsrf+EECyrKysDFimqhXhyjY3VLkAXBKRDqA7nU6nS0tLhyIj6XSaN9bVclv+l/IXAmkwvZc+jNUAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-save{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4UexUIzAAAAIRJREFUWMNjXLhs5X+GAQRMDAMMWJDYjGhyf7CoIQf8x2H+f0KGM9M7BBio5FNcITo408CoA0YdQM1cwEhtB/ylgqMkCJmFLwrOQguj/xTg50hmkeyARAYGhlNUCIXjDAwM0eREwTUGBgbz0Ww46oBRB4w6YNQBow4YdcCIahP+H5EhAAAH2R8hH3Rg0QAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-tap-select{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzIwRUFGMDYyMjE2ODExOTdBNUNBNjVEQTY5OTRDRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCOTJBQzE0RDQ0RDUxMUU0QTE0ODk2NTE1M0M0MkZENCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCOTJBQzE0QzQ0RDUxMUU0QTE0ODk2NTE1M0M0MkZENCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgTWFjaW50b3NoIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTQ0QzIwMUM1RjIxNjgxMUE3QkFFMzhGRjc2NTI3MjgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzcyMEVBRjA2MjIxNjgxMTk3QTVDQTY1REE2OTk0Q0UiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6eYZ88AAADLklEQVR42rSXf2TUYRzHv7tuGcfE6Vwb5zLSSjEj7Y9KWqfEmFZJP+yPMdKKmUrrn0iUfjhWlLFi6YfNrF+StBoTo39iYkTGco4xxxG59P7k/T2PT8/37nu3bx9ezvPj+zyf5/PreS78bGLS8SmrwE6yje3NHJsDBTALpknBz6JhH3NiYAB0gHqPOVv52wJ6QQ48BzdAttTioRJjdeA8mAHHS2xuk3p+M8M16ipVQE49Ds6CiFO9RLjGONf05QLx6wPQaBlbBlPgJVgkP0ETiIJ2sB/E1XfimjfgBOOlKDUqCGOcqBcQnw6BYW5YTo4wbvQhMmCfGRemC2rBiGXzWUb+kM/NRZ6CHWBM9ce5R61NgX6ayhSJ5EPlItlDRNkz4JbFHf06BkSzHjXxM+gDv1S/mPUo2AXWgt9UUHL/IVhS8yUV1/EbV3o4N+NaoE9Fu/i827K5pNYHnqAVJECShWmAaddpscYFFXwR7vnXBRGlnUN/L6kqKJlxnRUuDbaDBiL+vst5d4gpcpBrqk/2jIgCKVUolhntplzivHmwh4stGOPfwBWwl/2dpp8p7xjQZqFLiQJtauKkivYm+kzccpK57yXfOUe+P23JqAnVbhMFmlXntCWnxbT31am9ZJ4BJifsUmNTqt0cYhA5ypympPg7VkEKunPbVb8cIG+0kyHLJZNR7fUMooUKFHAPkfQo58VLK+RzwRDd4FdWG9mjpaAXzqkJa1R7kQttqEABWXMjOOxxVRfnhRm5URX1prk/0pQHwNcKlchZ+jdpC+hFdVqO0my9Hj5dkYgCn1Rfh/KdlNDHrJhPqlDih+IfBd6qwpOgEqYMsorJ2HtWxtagLJDn/W3KRfPOZhoeBJfZPgVeGKeKrkQBh5dLXl25Ny3pc4/1fkTdbvFqFQgbxWeYD0hXulhQ0pYiM1jG547fcbMQpVnHTZEn9W3ljsCzwHxCdVteNHIZvQa7/7cC7nV6zHIfyFP9EXjFa7YxKAVqPP4bxhhoLWW+z9JyCb6M/MREg59/RlmmXbmneIybB+YC/ay+yrffqEddDzwGvKxxDmzhc0tc80XVgblqFfgjwAAPubcGjAOl1wAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-undo{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4em8Dh0gAAAatJREFUWMPt1rFrFFEQBvDfGhACASshkL/ALpWVrSAKEQV5sIULWlgZNSgIFkGIVQ412gkBt1lYLERREFJqJRaW1oHAoZUQsDqwecWy7N3tbe6C4H2wxc682Zn3zTfvLXPM8b8j6RqYF+UCzsfnHBawGt3fMcAX7GEvS8NgKgXkRbmMxwg41TLsN0psZmnodyogL8pFPMIdLHUk7hA7eJKl4U/rAuKu3+HslFr/FZezNPSTFslX8QErDe4DvMVH/Iq9F7VwGpdwZUjsPtaSFjv/1vCBPjaxO0xcNbHejLpZrrlvJCMCT+JzA+2fcC1Lw+GE4l3CG1yIptfjCtiKoqtiJ0vD3aM0Py/K57iIMxgkQxat4EdN7e9xdRzlk+LEEPvDWvIDXJ928sYxjL36icWK+VaWhlezOIqbGFirJd/H7szugrwoX+D2BDEvszSsT5OBdfRaru/F9dPXQF6U27g/KnmWhgctxqyzBrZGMNGL/rHI0nDkKXiKexXTsywNGx0OnFbFNk3BRoWJXnw//j+ivCi32/S8CxPVNiWOAdUiJtXITIqYY45/Cn8B2D97FYW2H+IAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-wheel-pan{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgswOmEYWAAABddJREFUWMO9l09oXNcVxn/n3vc0fzRjj2RHyIZ6ERuy6CarxJtS0pQSCsXNpqGFWK5tTHAwyqIGN7VdEts1LV04BEoxdlJnUbfNogtDCYWQRZOSxtAUCoFiJY0pWJVUjeTKM9LMe+9+Xcyb8ZMychuofeHCffeee7/vnXvOuefYlV/+mv932//tb91z/Y2rvxmMHQ+4FcEfOIGN4A+UwDDwoQScc7vM7AIwB8yZ2QXn3K77Ab6OgJnVgeOSbkqaBiaACUnTkm4Cx3OZzwf+qzcRQup1zNZ9RwDe+0YI4YKZTUn6zCGSMLOfAF/03r+QZdnyfwO+ePEiI6N1nPMgMDMkETLRbd2mXG8gCbd9YiIKIUxLKoLfBN7I+80+CUlTIYTp7RMT0b3Af37p8kh5y9gZcy4Fzt+5szqSaxkzUR7dwtrKMmaGW242d0t6vrD/He/90865o865o977p4F3Ctp4frnZ3L0Z+OryUrVSrZ0z8ZxhHjhcq1XPrS43q/0flDlK9XpPA2ma7gMeyvfPx3H8TJZlH4YQWiGEVpZlH8Zx/Awwn8s8lKbpvmq1ahvB641SXNk6dhLskNA2MIBtwKHK1vGTW8bKMRbAMgyPqWeETxUM8VSSJAv52JmZA0iSZMHMThWwnipXKp8hsLLcSaIR92oU8xjSayCQXotiHotG3Ku3m+0EOQwPQCDggMf7BzQajSs5eAk4B5zLx4O1vD2eJMmAQKliscgASJMw21pansFs1swQ/DNLmUmTMNuXX+taXHTDaj5OW612R1JZ0nFJJ/J+XFJ5aWmpA6S5bHV8fHsPHFU6q3pJCjtFxtrKMuXRLUUXXxdrRLazFOtUolZlsGhmACsgnHPTwJnCnjP5HMBKLotzxsTE9rgDL0t6LoriKsDIaB31ZEK+JxQJRHFUBR2NqLw8OTkZR0OC0ntm9k1JWU7OA4vD/mZ+YfElsANmNEKi75vztzB5M8uAr+bx48me88g757PQ1U5zNg52YH7hX8l6f+4Fi3c3BqHNmkI4YQOV2MGCNu9qHPYCewfzbrC+XSGcWEcgTRKA3wFfyzdDz5d+D3x9CIcfA4eBbQS9LscskgfLnHNPAnslvS/pbZDHLLPADpx9N9fqpSIBH8cxWZY9m6bpb4Ev5fN/iKLo2TRNgdx/eo8Wk5O7Ts/N/SOSdMjHdj4kmgkIEJLJzPZKetvMTkIvFLsR25Ml2gfuF5M7vnA66sdooJYkCSGERe/9VAjhzRxoKk3Tvg3U8nulVqvx8cyNpER2umM+SdOkbc5B8JhpqBdIgTRR24h+lpKen731aRIN7thscH9Zlv0d2F8YD2TIX7F2uw3A7ZWV1a0TYz9ca8cJZHRbuRuaDfUCw9/qJHamPOKToAwHtHN6lMvlSkH2o7wDMDo6WuGuQbbn5+YAKNcb3J5fSvrhtTY+vsOPuD1IOyRhMOkj9kSx29HfXB5RUnS964NT2+3vbGbxG9auO2cDNuV6A8NTb5TitBuOpQkfYD2vwOxgmvBB2g3Hto5X42EJyVsFlztbKpXGNgqVSqUxSWcLU2+tdToa9hasLjfPYlwGa+bTi8Dl1dvNsyvNtQQL9MO2w+HM7BqwlAtPdrvdq9773WAVsIr3fne3270KTOYyS2Z2bbXdHhogKmPj7YWF+VOSXs/v/9KdO+0fVBrjbRkgB/KIDBnYu9f/7D+ZmfmRxPd6qwB8YmZXcq1MAQ/nJhTM+OnDe/a8+PGNG9lm19V/D1Qw7HXZlcRa69+U6w38l5/4ipxzf5X0CPBILjcGPJH34pVcc8692FxcXLlXRnTwwH7+9P4f8aWe3fY59LIqo1NMyQBCCHNmdgx4BegUWefjDvCKmR0LIcz9L8nokSNH+PRvH4HC3YQ098pSbevg24qlmZmNmtmjkg4D3+j/tZldkvQXSa3PW5ptlpL3ZaIN99OS9F7+IgKUgSyEkNyv2nHT7DZX0dr9rpjua2l2r4rogRAYVqZvnPsPqVnpEXjEaB4AAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-wheel-zoom{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgskILvMJQAABTtJREFUWMPdl1+MXVUVxn/fPvf2zrSFmUKnoBCUdjRoVaIxEpO2JhilMYBCtBQS2hejpg1Uo2NUrIFAoyGmtiE+GHwQGtvQJhqDmKYRBv+URFsFDNCSptH60DJTO3dKnX/33rM/H7rvsDu9M20fDMaVnGTvtb69z7fWXmvtc/TEzqd4OyXwNsv/FwFJQVI/sA14SZKRLOlPkr5TrVYXHz70quYkEEK4TtI2YAgYkrQthHDdhV5uuw+43/ZrwCbgRttgY/tjtrc0m83X3/f+D6ydnJhYcB4BSZcBA7aP2d4ELAGW2N5k+xgwkDB0IH19CGGH7R8B1aQeAf4KvAw0ku4K2zu7uru3ApdPEyiKohd4TNKjtjt5h6RHgccSNrddbvuHtm9Jqoak7xVF8WFgdavV+pSk5cCObNmXgK++85prCj3z28HKqZMnH7D9YAY4BvwujT8BvCuL1INX9vVt+dfwcCvNb7f9q2RuSfrGvWu/sL2Nf3LX7pzvj4ENSGBPVarVd4fRkZFltjdmoMGiKO4IIWwIIWwoiuIOYDDzeOPoyMiyFLkum7WJCMDztrcrTTrIRuAQZ6NcK1utL4dWq/VZoC8BhqvV6l1lWb4YYxyLMY6VZflitVq9CxhOmL60hhCKeYiV7WMKIXw9jT1HpXw3c+bOAKzOjJubzebJrKQCQLPZPClpc7bP6rMYKtjXth2OMf7tIkr11Wz8oQDc1Fb09vY+kQw1YAuwJY2nbUluAnCWpKkaFl6IQIzxivaR2SYA89sJVK/Xp2x32R6w/a30DNjuqtfrU0ArYecDCEqgLqm94T0dEm9mBG7PxkdDlkBnkhebgIezNQ8nHcCZPL9ijE1Jf/bZZoPtzbavmqNZLbf9tSxq+yoduuJ+SZ+zXSZyBXCqU+d8fvC5yRUrV+0G2j3g2hDCLyXd/+Su3QdnvP/zCuH72LWsgf2k0oHlH2c2odlkxcpVEdgr6aDtjyb8x20/J+mA7T9I6rL9SWA5dne2/GdXLl58qNJh398An85yTMA+4DOz8Dgu6Zu2dwJXJ91ltm8Gbp7Fgb+EEB4aHhpq5CEtACqVyr3AC0AlPS8k3TSmQ2YPhhBuS/1/LpmS9JTtNTHGfwBU2uUALARotVqniqJYH2Pck85pfavVaufAwnQvnHc0McaDKVptebN94QAnJB0EdtjekydyZXqjs/0ZgLIs/w6sy8bnYGYJ63pgERKC05JutT1kOwITwL9tvzlzUQUYB+Zjs2DBgu6xsbGJZHstByZbezregcBXeCsEz1bnzXt5anLyzLq71zDLxTRdVgemdx0fv2e2w5thO5DbiqL4oKT3ZKpnpyYnz+SY2ZpTAPZmJfdIrVZbNBNUq9UW2X4kU+2dcf53Aj1pj2PA7y/6m1DS00A9za9uNBq7iqJYBuoGdRdFsazRaOzKSqye1rTbaa/tlbYrqXQP2X4FIA9/J1l39xrC0v7+w5IeB8XkwS1lWe6TGJAYKMty31tfO4qSHl/a3384I3CDpI+kzC4lnRfrue6GytEjR8oQwlY73gC0L4qlth/q0M1/LYWtR48cKQF6enrC6dOnVwGLEpnxnp7en4+O1i/tszzGOCTpPmB7ahb57QUwBWyXdF+McWg6MScmuoA8OX8xOlpvXGz422XYTsB/SnpA0h7bX5R0WzI9HUL4qe2XbI+dk3xl+V7gxoztD5jRI+YK/zkEEokx2/uB/RdzIfUtueqVN04cXwF8G3iHY3z9Urw/j8ClyhsnjrcS2Vv/J/8NLxT+/zqBTkcxU/cfEkyEAu3kmjAAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-box-edit{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4QfHjM1QAAAGRJREFUWMNjXLhsJcNAAiaGAQYsDAwM/+lsJ+OgCwGsLqMB+D8o08CoA0YdMOqAUQewDFQdMBoFIyoN/B/U7YFRB7DQIc7xyo9GwbBMA4xDqhxgISH1klXbDYk0QOseEeOgDgEAIS0JQleje6IAAAAASUVORK5CYII=\\\")}.bk-root .bk-tool-icon-poly-draw{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEjglo9eZgwAAAc5JREFUWMPt1zFrU1EUB/DfS4OmVTGDIChCP4BgnQXRxVHqIJUupp9AB8VBQcRBQUXIB9DWQoMRiXZzcnQSA34A7aAuHSJKkgo2LvfBrU3aJnlYkBy4vHcP557zP/9z3r33JdXa647N0kHSZd5Nn0rSxc8G3cXp85sMcnZZ8vge3osZ+l3vB8CWFA0iL14t79h210swAjACMAIwAjACkB90D/8/GchI9ve4nPwTBh5E9ws7OepzGWb9EddSn51Op9ZstadSg4VK1UKlKkmSDSMLALewiuNh/hVJq71Wxttmqz0dG88vPc+MgWP4grvYG3SLOBrZFFFrttqPe4HIDxh4GSei+98iSlusuYopXEAjBtEPA3tQwUpwluAbDm4TPJUz+BTW9l2Ce6G7L0X/Bw8D3T/7SKKIDzHg7QCcxjvcQAEtXAnrrg/RP0/DKPbqgcN4iVOR7gcO4dcQgRuoh7HSqwlP4n20m63jJu5n8MkWMYfP3UowhzdR8FU8w9iQwevBdyq3/27CMRzAE5yLuvsRLg+ZcR1nJ8YL81HWJUzGAPaFZwe/Q5MdyYDyNHgjzO90YyGHtVDncuiJchaHw8R4oREFV5qdiVmYLM3OgD9k5209/atmIAAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-point-draw{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEiERGWPELgAAA4RJREFUWMO1lr1uG1cQhb9ztdRSP7AF1QxgwKlcuZSqRC9gWUUUINWqTh5AnaFOnVPEteQmRuhCURqWsSqqc9IolREXdEvQBElxtdw7KURSFEVKu4w8wAKLxdw9Z+bMnRmZGXfZ29//II8th4WwGVNyIoQLYB5vxA9Caq04iUd9A+7ZlsNC2I7TdSd2hZXMJKlnTqp9jtl/GBaqoyQ0noFKpUIzBicYYc+DEFpxkglc4oVJa5gvDn8v1xV2irG3FM4NSVwjUKlUaMcpJhCGmSEJQ6QGD8M5WnHCd8+f3QCXpPLx8WNwv0j6Bm9FMK7FJ3WBE+R/2t7c/GBmFvSBrzRTCsyTDjXrxUgEMtpxynJYmJoBJ4VAybwVARgvL7Oik0okCodnKpVKX7P0leiVMb0VvbJT+upznK4vh0GIeQwwQStJkHQD3MwsCALTJRG7Qrdrj5m/djgYaIa0hlkRdJk26XEgC9txurccBtVW3IudBImmZuACUP+ZlIDBt9FKcubYNTcAH/X0RYM1E7utJPlqe+uZzPxUcEkiSS4sTT95n15Mud0xWC0o2PAWOCdK3KYZlFxfM+tHOcnMzNr1es18ug+cgsVjP4yBU/Ppfrter1m/+l0+zYygML1xRVHU7TSb1cSzBzoBzszsH+AMdJJ49jrNZjWKou6wBnwOzcyndBpNbuueURR1Dw8Pq35p9cc5p/Dy9Dypt7jXrtdGwQECS9NPhr6Gq6txUzNigE6zydLK6lTw12/KT4FGFEUfJX2YJNONq5tVs4ODA7sD/DnwJ/BoADZuE3tHFs12dna6d4C/BI6AlbyzI8ii2TTw12/KK33gb2cdXsNZoAntbZC2SeO4c9592k/5eNQbiwvFd1kJuFGwLJr1wSPg/SwpvyFBHufOeXcFeAlE97U/uCxOY+P3b+Bn4B3Q+L8EdJfD4a+/AbC4UBzPxiPg3wlHZquB28Cn2IuR9x3gr3uV4DbwfvSDOvi4uFA8BDZmIRHkjHpS9Ht9iRqd8+5G3g05mAGcQbsdiX5QJ428G7Kygo8XYdb1/K4NWVmjzkNge2sz84bs+ELmpDDLtqWsNZBXgvmw8CTtpWVMT7x5YWBjLARnwZfKQNYN2U2LPvrh+5nBt7c2M2/It9bArCTKR8eZN+SJ13AScPnoODeRdqNenH+wul5w2gUr2WUjMFAt8bZ/0axX/wNnv4H8vTFb1QAAAABJRU5ErkJggg==\\\")}.bk-root .bk-tool-icon-poly-edit{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gELFi46qJmxxAAABV9JREFUWMOdl19vFFUYxn9n9u9sCyylUIzWUoMQBAWCMdEEIt6xIRQSLIEKtvHe6AcA4yeQb7CAUNJy0daLeomJN8SEULAC2kBBapBKoLvbmdl/c14vdmY7u91tF95kknPOnHmf95znPc97Ro2OTeBbdjFDT3c32ZxVHUOE9kSMB0/m6ExuoJn1H+ur6Y+OTfD50SMN5168OgrAlyf7CfuD+z7+iDs3p8hkLUQ0iFQ/yFl5Nm/qonfHVva+s32Zw9GxCYILsZ08tpNfBhbs+1YN4OH9+7huGdECSBVfqUosbsllfmauBqiR+cCNwOr7AEo8pPHJnymXykhg5fUWjoQpl0vVvhZhbSzGoUOHqgBlt6B6uruj2Zy1E9jo0fhfeyL2x4Mnc8VErK0KUEOB64JSyptfG4RSytsJjUJVxw2lsFy3urL9nx1Qd25ObctkrVMi+jQivd7U2ZyV/3Hzpq7h3h1b/7p9Y0o8v8rwAbTWrGpSocN/FGDlbAI0Rl23PCBan0Ok158H9Ipwzi25A/Mzc9Gl/BYx/E4kYqC1NKRARNAaDCNUM27Z+Zr+ouXs0q4+LSLBHPYCFkTkC6uU39kwCdsS7WRKmaYUiAhdnZ3MPX2K4+QjQI+C94A93rMzm8ltMwyDeDzWjMZeEb2pYQDdW3vITU2jtUZ5QThOPgm8C7wP7J15OPsBsB3oWpGnVWisCeDS1VHj4vBI92+/3tgB7Ab2AruAXiDBK5oIOkhtkEYRNRuJhObrd8Dl9ewf4D5wG7hVLpen29vb5wzD+BrkbBMaL3d1dk5nsrnlFDTTFWAWmAZueWD3gCemGde2k2fw1Al1YXhEvjozoO49eczdqekrWmsc2zlrmvEKOGoW1GUjFLqSk2KpJrCLwyMCPAP+BO54QL8DM6YZX/ClsP9YnwKkXnIBP4jdIpJRpdJTCYdMwwi98KU0Hjc/dDILNyUcwTCWdOSMJ0TRmBktGRhLugu0xyLk7CIqVNm+0bGJptl1YXikD0grpY4Rjc4a8Fbgdab/6OGbAJeCUuyJnnHmZH9pbSyGuBXV8NUwlUpR1EWyixmSyTWEwqGlJ2Swbo2JXbAAfgDGgGQA9I1A9t1tlq0AxrXxn0ilUpw4fhQqYkH/sT41OTnJJwf2s6FjI5mshdYa7bqVR2uezr9MJmJt14FvGrh/O9D+e6UkM/xyCuCqEKCYnJyUTKFQrZDHjxzGshwWLQcRsOz8Hi85P23id0ug/XilAMLBmm4tPGdoaKjSH5+oAGrhwvBI9SjZTn4QSK9yenoD7dlrExPoJlXW8G8ytpNHxRKk02lGxsdRKFwXLNvx5yY94HQLGhGk4LFCYQSqaE0AwWM1eOoEbR0dKBSW7bC4mKuffxs4D/wCLKwQQPAUzIkslfp6cVomROWSolh0GjldAM4nzDi2k9/i5UAzC9aKfwNJ3zgJg9YEvN6+C7SHgKm69+sD7RfNnKTTaZRPQfAut4oFV//IS7gkcB34VlVo8kGzphlfB+DU+TfNGBpZtRastvrvARJmfMF28ge9sc2B9/PNnCilMIDwK6y8/ow/Ai4kvILTljAXvDvEvrqKSUs60KolzPjBxspavQD2tKqCAGF/Ba+xE/Wbilu54wZV8NEKF5fXzQHl/bh4hUsE0WAXSlDMYcQSrQXgCmsTseXHsJkNnjqBFGwKJaHsKlxtUHYVhbLCzr1kaOA4bcn1y1Swmb+iLpJKpVrfgdpfsiVVCYcgluwgnU7jEgJ4s5UkLFtWYyHyEg0/N1q1tmQH+YXnAMFr97Nmv3p+0QsHQRsF8qpBOE5+rb9Nkaj50tVQKjqh4OU3GNL/1/So3vuUgbAAAAAASUVORK5CYII=\\\")}.bk-root .bk-grid-row,.bk-root .bk-grid-column{display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap}.bk-root .bk-grid-row>*,.bk-root .bk-grid-column>*{flex-shrink:0;-webkit-flex-shrink:0}.bk-root .bk-grid-row{flex-direction:row;-webkit-flex-direction:row}.bk-root .bk-grid-column{flex-direction:column;-webkit-flex-direction:column}.bk-root .bk-canvas-wrapper{position:relative;font-size:12pt}.bk-root .bk-canvas,.bk-root .bk-canvas-overlays,.bk-root .bk-canvas-events{position:absolute;top:0;left:0;width:100%;height:100%}.bk-root .bk-canvas-map{position:absolute;border:0}.bk-root .bk-logo{margin:5px;position:relative;display:block;background-repeat:no-repeat}.bk-root .bk-logo.bk-grey{filter:url(\\\"data:image/svg+xml;utf8,<svg xmlns=\\\\'http://www.w3.org/2000/svg\\\\'><filter id=\\\\'grayscale\\\\'><feColorMatrix type=\\\\'matrix\\\\' values=\\\\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\\\\'/></filter></svg>#grayscale\\\");filter:gray;-webkit-filter:grayscale(100%)}.bk-root .bk-logo-notebook{display:inline-block;vertical-align:middle;margin-right:5px}.bk-root .bk-logo-small{width:20px;height:20px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==)}.bk-root .bk-toolbar,.bk-root .bk-toolbar *{box-sizing:border-box;margin:0;padding:0}.bk-root .bk-toolbar,.bk-root .bk-button-bar{display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none}.bk-root .bk-toolbar .bk-logo{flex-shrink:0;-webkit-flex-shrink:0}.bk-root .bk-toolbar-above,.bk-root .bk-toolbar-below{flex-direction:row;-webkit-flex-direction:row;justify-content:flex-end;-webkit-justify-content:flex-end}.bk-root .bk-toolbar-above .bk-button-bar,.bk-root .bk-toolbar-below .bk-button-bar{display:flex;display:-webkit-flex;flex-direction:row;-webkit-flex-direction:row}.bk-root .bk-toolbar-above .bk-logo,.bk-root .bk-toolbar-below .bk-logo{order:1;-webkit-order:1;margin-left:5px}.bk-root .bk-toolbar-left,.bk-root .bk-toolbar-right{flex-direction:column;-webkit-flex-direction:column;justify-content:flex-start;-webkit-justify-content:flex-start}.bk-root .bk-toolbar-left .bk-button-bar,.bk-root .bk-toolbar-right .bk-button-bar{display:flex;display:-webkit-flex;flex-direction:column;-webkit-flex-direction:column}.bk-root .bk-toolbar-left .bk-logo,.bk-root .bk-toolbar-right .bk-logo{order:0;-webkit-order:0;margin-bottom:5px}.bk-root .bk-toolbar-button{width:30px;height:30px;background-size:60%;background-color:transparent;background-repeat:no-repeat;background-position:center center}.bk-root .bk-toolbar-button:hover{background-color:#f9f9f9}.bk-root .bk-toolbar-button:focus{outline:0}.bk-root .bk-toolbar-button::-moz-focus-inner{border:0}.bk-root .bk-toolbar-above .bk-toolbar-button{border-bottom:2px solid transparent}.bk-root .bk-toolbar-above .bk-toolbar-button.bk-active{border-bottom-color:#26aae1}.bk-root .bk-toolbar-below .bk-toolbar-button{border-top:2px solid transparent}.bk-root .bk-toolbar-below .bk-toolbar-button.bk-active{border-top-color:#26aae1}.bk-root .bk-toolbar-right .bk-toolbar-button{border-left:2px solid transparent}.bk-root .bk-toolbar-right .bk-toolbar-button.bk-active{border-left-color:#26aae1}.bk-root .bk-toolbar-left .bk-toolbar-button{border-right:2px solid transparent}.bk-root .bk-toolbar-left .bk-toolbar-button.bk-active{border-right-color:#26aae1}.bk-root .bk-button-bar+.bk-button-bar:before{content:\\\" \\\";display:inline-block;background-color:lightgray}.bk-root .bk-toolbar-above .bk-button-bar+.bk-button-bar:before,.bk-root .bk-toolbar-below .bk-button-bar+.bk-button-bar:before{height:10px;width:1px}.bk-root .bk-toolbar-left .bk-button-bar+.bk-button-bar:before,.bk-root .bk-toolbar-right .bk-button-bar+.bk-button-bar:before{height:1px;width:10px}.bk-root .bk-tooltip{font-family:\\\"HelveticaNeue-Light\\\",\\\"Helvetica Neue Light\\\",\\\"Helvetica Neue\\\",Helvetica,Arial,\\\"Lucida Grande\\\",sans-serif;font-weight:300;font-size:12px;position:absolute;padding:5px;border:1px solid #e5e5e5;background-color:white;pointer-events:none;opacity:.95}.bk-root .bk-tooltip>div:not(:first-child){margin-top:5px;border-top:#e5e5e5 1px dashed}.bk-root .bk-tooltip.bk-left.bk-tooltip-arrow::before{position:absolute;margin:-7px 0 0 0;top:50%;width:0;height:0;border-style:solid;border-width:7px 0 7px 0;border-color:transparent;content:\\\" \\\";display:block;left:-10px;border-right-width:10px;border-right-color:#909599}.bk-root .bk-tooltip.bk-left::before{left:-10px;border-right-width:10px;border-right-color:#909599}.bk-root .bk-tooltip.bk-right.bk-tooltip-arrow::after{position:absolute;margin:-7px 0 0 0;top:50%;width:0;height:0;border-style:solid;border-width:7px 0 7px 0;border-color:transparent;content:\\\" \\\";display:block;right:-10px;border-left-width:10px;border-left-color:#909599}.bk-root .bk-tooltip.bk-right::after{right:-10px;border-left-width:10px;border-left-color:#909599}.bk-root .bk-tooltip.bk-above::before{position:absolute;margin:0 0 0 -7px;left:50%;width:0;height:0;border-style:solid;border-width:0 7px 0 7px;border-color:transparent;content:\\\" \\\";display:block;top:-10px;border-bottom-width:10px;border-bottom-color:#909599}.bk-root .bk-tooltip.bk-below::after{position:absolute;margin:0 0 0 -7px;left:50%;width:0;height:0;border-style:solid;border-width:0 7px 0 7px;border-color:transparent;content:\\\" \\\";display:block;bottom:-10px;border-top-width:10px;border-top-color:#909599}.bk-root .bk-tooltip-row-label{text-align:right;color:#26aae1}.bk-root .bk-tooltip-row-value{color:default}.bk-root .bk-tooltip-color-block{width:12px;height:12px;margin-left:5px;margin-right:5px;outline:#ddd solid 1px;display:inline-block}.rendered_html .bk-root .bk-tooltip table,.rendered_html .bk-root .bk-tooltip tr,.rendered_html .bk-root .bk-tooltip th,.rendered_html .bk-root .bk-tooltip td{border:0;padding:1px}\\n/* END bokeh.min.css */\"); console.log(\"Bokeh: injecting raw CSS\"); Bokeh.embed.inject_raw_css(\"/* BEGIN bokeh-widgets.min.css */\\n@charset \\\"UTF-8\\\";.bk-root{/*!\\n * Pikaday\\n * Copyright \\u00a9 2014 David Bushell | BSD & MIT license | http://dbushell.com/\\n */}.bk-root .bk-noUi-target,.bk-root .bk-noUi-target *{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-user-select:none;-ms-touch-action:none;touch-action:none;-ms-user-select:none;-moz-user-select:none;user-select:none;-moz-box-sizing:border-box;box-sizing:border-box}.bk-root .bk-noUi-target{position:relative;direction:ltr}.bk-root .bk-noUi-base{width:100%;height:100%;position:relative;z-index:1}.bk-root .bk-noUi-connect{position:absolute;right:0;top:0;left:0;bottom:0}.bk-root .bk-noUi-origin{position:absolute;height:0;width:0}.bk-root .bk-noUi-handle{position:relative;z-index:1}.bk-root .bk-noUi-state-tap .bk-noUi-connect,.bk-root .bk-noUi-state-tap .bk-noUi-origin{-webkit-transition:top .3s,right .3s,bottom .3s,left .3s;transition:top .3s,right .3s,bottom .3s,left .3s}.bk-root .bk-noUi-state-drag *{cursor:inherit !important}.bk-root .bk-noUi-base,.bk-root .bk-noUi-handle{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.bk-root .bk-noUi-horizontal{height:18px}.bk-root .bk-noUi-horizontal .bk-noUi-handle{width:34px;height:28px;left:-17px;top:-6px}.bk-root .bk-noUi-vertical{width:18px}.bk-root .bk-noUi-vertical .bk-noUi-handle{width:28px;height:34px;left:-6px;top:-17px}.bk-root .bk-noUi-target{background:#fafafa;border-radius:4px;border:1px solid #d3d3d3;box-shadow:inset 0 1px 1px #f0f0f0,0 3px 6px -5px #BBB}.bk-root .bk-noUi-connect{background:#3fb8af;border-radius:4px;box-shadow:inset 0 0 3px rgba(51,51,51,0.45);-webkit-transition:background 450ms;transition:background 450ms}.bk-root .bk-noUi-draggable{cursor:ew-resize}.bk-root .bk-noUi-vertical .bk-noUi-draggable{cursor:ns-resize}.bk-root .bk-noUi-handle{border:1px solid #d9d9d9;border-radius:3px;background:#FFF;cursor:default;box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #ebebeb,0 3px 6px -3px #BBB}.bk-root .bk-noUi-active{box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #DDD,0 3px 6px -3px #BBB}.bk-root .bk-noUi-handle:before,.bk-root .bk-noUi-handle:after{content:\\\"\\\";display:block;position:absolute;height:14px;width:1px;background:#e8e7e6;left:14px;top:6px}.bk-root .bk-noUi-handle:after{left:17px}.bk-root .bk-noUi-vertical .bk-noUi-handle:before,.bk-root .bk-noUi-vertical .bk-noUi-handle:after{width:14px;height:1px;left:6px;top:14px}.bk-root .bk-noUi-vertical .bk-noUi-handle:after{top:17px}.bk-root [disabled] .bk-noUi-connect{background:#b8b8b8}.bk-root [disabled].bk-noUi-target,.bk-root [disabled].bk-noUi-handle,.bk-root [disabled] .bk-noUi-handle{cursor:not-allowed}.bk-root .bk-noUi-pips,.bk-root .bk-noUi-pips *{-moz-box-sizing:border-box;box-sizing:border-box}.bk-root .bk-noUi-pips{position:absolute;color:#999}.bk-root .bk-noUi-value{position:absolute;white-space:nowrap;text-align:center}.bk-root .bk-noUi-value-sub{color:#ccc;font-size:10px}.bk-root .bk-noUi-marker{position:absolute;background:#CCC}.bk-root .bk-noUi-marker-sub{background:#AAA}.bk-root .bk-noUi-marker-large{background:#AAA}.bk-root .bk-noUi-pips-horizontal{padding:10px 0;height:80px;top:100%;left:0;width:100%}.bk-root .bk-noUi-value-horizontal{-webkit-transform:translate3d(-50%,50%,0);transform:translate3d(-50%,50%,0)}.bk-root .bk-noUi-marker-horizontal.bk-noUi-marker{margin-left:-1px;width:2px;height:5px}.bk-root .bk-noUi-marker-horizontal.bk-noUi-marker-sub{height:10px}.bk-root .bk-noUi-marker-horizontal.bk-noUi-marker-large{height:15px}.bk-root .bk-noUi-pips-vertical{padding:0 10px;height:100%;top:0;left:100%}.bk-root .bk-noUi-value-vertical{-webkit-transform:translate3d(0,50%,0);transform:translate3d(0,50%,0);padding-left:25px}.bk-root .bk-noUi-marker-vertical.bk-noUi-marker{width:5px;height:2px;margin-top:-1px}.bk-root .bk-noUi-marker-vertical.bk-noUi-marker-sub{width:10px}.bk-root .bk-noUi-marker-vertical.bk-noUi-marker-large{width:15px}.bk-root .bk-noUi-tooltip{display:block;position:absolute;border:1px solid #d9d9d9;border-radius:3px;background:#fff;color:#000;padding:5px;text-align:center;white-space:nowrap}.bk-root .bk-noUi-horizontal .bk-noUi-tooltip{-webkit-transform:translate(-50%,0);transform:translate(-50%,0);left:50%;bottom:120%}.bk-root .bk-noUi-vertical .bk-noUi-tooltip{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);top:50%;right:120%}.bk-root .bk-noUi-handle{cursor:grab;cursor:-webkit-grab}.bk-root .bk-noUi-handle.bk-noUi-active{cursor:grabbing;cursor:-webkit-grabbing}.bk-root .bk-noUi-tooltip{display:none;white-space:nowrap}.bk-root .bk-noUi-handle:hover .bk-noUi-tooltip{display:block}.bk-root .bk-noUi-horizontal{width:100%;height:10px}.bk-root .bk-noUi-horizontal .bk-noUi-handle{width:14px;height:18px;left:-7px;top:-5px}.bk-root .bk-noUi-vertical{width:10px;height:100%}.bk-root .bk-noUi-vertical .bk-noUi-handle{width:18px;height:14px;left:-5px;top:-7px}.bk-root .bk-noUi-handle:after,.bk-root .bk-noUi-handle:before{display:none}.bk-root .bk-noUi-connect{box-shadow:none}.bk-root fieldset{padding:0;margin:0;border:0;min-width:0}.bk-root legend{display:block;width:100%;padding:0;margin-bottom:17px;line-height:inherit;color:#333;border:0;border-bottom:1px solid #e5e5e5}.bk-root label{display:inline-block;margin-bottom:5px}.bk-root input[type=\\\"search\\\"]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.bk-root input[type=\\\"radio\\\"],.bk-root input[type=\\\"checkbox\\\"]{margin:4px 0 0;margin-top:1px \\\\9;line-height:normal}.bk-root input[type=\\\"file\\\"]{display:block}.bk-root input[type=\\\"range\\\"]{display:block;width:100%}.bk-root select[multiple],.bk-root select[size]{height:auto}.bk-root input[type=\\\"file\\\"]:focus,.bk-root input[type=\\\"radio\\\"]:focus,.bk-root input[type=\\\"checkbox\\\"]:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.bk-root output{display:block;padding-top:7px;line-height:1.42857143;color:#555}.bk-root .bk-bs-form-control{display:block;height:31px;padding:0 12px;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px}.bk-root .bk-bs-form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,0.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,0.6)}.bk-root .bk-bs-form-control::-moz-placeholder{color:#999;opacity:1}.bk-root .bk-bs-form-control:-ms-input-placeholder{color:#999}.bk-root .bk-bs-form-control::-webkit-input-placeholder{color:#999}.bk-root .bk-bs-form-control[disabled],.bk-root .bk-bs-form-control[readonly],fieldset[disabled] .bk-root .bk-bs-form-control{cursor:not-allowed;background-color:#eee;opacity:1}textarea.bk-root .bk-bs-form-control{height:auto}.bk-root input[type=\\\"search\\\"]{-webkit-appearance:none}.bk-root input[type=\\\"date\\\"]{line-height:31px}.bk-root .bk-bs-form-group{margin-bottom:15px}.bk-root .bk-bs-radio,.bk-root .bk-bs-checkbox{display:block;min-height:17px;margin-top:10px;margin-bottom:10px;padding-left:20px}.bk-root .bk-bs-radio label,.bk-root .bk-bs-checkbox label{display:inline;font-weight:normal;cursor:pointer}.bk-root .bk-bs-radio input[type=\\\"radio\\\"],.bk-root .bk-bs-radio-inline input[type=\\\"radio\\\"],.bk-root .bk-bs-checkbox input[type=\\\"checkbox\\\"],.bk-root .bk-bs-checkbox-inline input[type=\\\"checkbox\\\"]{float:left;margin-left:-20px}.bk-root .bk-bs-radio+.bk-bs-radio,.bk-root .bk-bs-checkbox+.bk-bs-checkbox{margin-top:-5px}.bk-root .bk-bs-radio-inline,.bk-root .bk-bs-checkbox-inline{display:inline-block;padding-left:20px;margin-bottom:0;vertical-align:middle;font-weight:normal;cursor:pointer}.bk-root .bk-bs-radio-inline+.bk-bs-radio-inline,.bk-root .bk-bs-checkbox-inline+.bk-bs-checkbox-inline{margin-top:0;margin-left:10px}.bk-root input[type=\\\"radio\\\"][disabled],.bk-root input[type=\\\"checkbox\\\"][disabled],.bk-root .bk-bs-radio[disabled],.bk-root .bk-bs-radio-inline[disabled],.bk-root .bk-bs-checkbox[disabled],.bk-root .bk-bs-checkbox-inline[disabled],fieldset[disabled] .bk-root input[type=\\\"radio\\\"],fieldset[disabled] .bk-root input[type=\\\"checkbox\\\"],fieldset[disabled] .bk-root .bk-bs-radio,fieldset[disabled] .bk-root .bk-bs-radio-inline,fieldset[disabled] .bk-root .bk-bs-checkbox,fieldset[disabled] .bk-root .bk-bs-checkbox-inline{cursor:not-allowed}.bk-root .bk-bs-input-sm{height:28px;padding:5px 10px;font-size:11px;line-height:1.5;border-radius:3px}select.bk-root .bk-bs-input-sm{height:28px;line-height:28px}textarea.bk-root .bk-bs-input-sm,select[multiple].bk-root .bk-bs-input-sm{height:auto}.bk-root .bk-bs-input-lg{height:42px;padding:10px 16px;font-size:15px;line-height:1.33;border-radius:6px}select.bk-root .bk-bs-input-lg{height:42px;line-height:42px}textarea.bk-root .bk-bs-input-lg,select[multiple].bk-root .bk-bs-input-lg{height:auto}.bk-root .bk-bs-has-feedback{position:relative}.bk-root .bk-bs-has-feedback .bk-bs-form-control{padding-right:38.75px}.bk-root .bk-bs-has-feedback .bk-bs-form-control-feedback{position:absolute;top:22px;right:0;display:block;width:31px;height:31px;line-height:31px;text-align:center}.bk-root .bk-bs-has-success .bk-bs-help-block,.bk-root .bk-bs-has-success .bk-bs-control-label,.bk-root .bk-bs-has-success .bk-bs-radio,.bk-root .bk-bs-has-success .bk-bs-checkbox,.bk-root .bk-bs-has-success .bk-bs-radio-inline,.bk-root .bk-bs-has-success .bk-bs-checkbox-inline{color:#3c763d}.bk-root .bk-bs-has-success .bk-bs-form-control{border-color:#3c763d;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.bk-root .bk-bs-has-success .bk-bs-form-control:focus{border-color:#2b542c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #67b168;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #67b168}.bk-root .bk-bs-has-success .bk-bs-input-group-addon{color:#3c763d;border-color:#3c763d;background-color:#dff0d8}.bk-root .bk-bs-has-success .bk-bs-form-control-feedback{color:#3c763d}.bk-root .bk-bs-has-warning .bk-bs-help-block,.bk-root .bk-bs-has-warning .bk-bs-control-label,.bk-root .bk-bs-has-warning .bk-bs-radio,.bk-root .bk-bs-has-warning .bk-bs-checkbox,.bk-root .bk-bs-has-warning .bk-bs-radio-inline,.bk-root .bk-bs-has-warning .bk-bs-checkbox-inline{color:#8a6d3b}.bk-root .bk-bs-has-warning .bk-bs-form-control{border-color:#8a6d3b;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.bk-root .bk-bs-has-warning .bk-bs-form-control:focus{border-color:#66512c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #c0a16b;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #c0a16b}.bk-root .bk-bs-has-warning .bk-bs-input-group-addon{color:#8a6d3b;border-color:#8a6d3b;background-color:#fcf8e3}.bk-root .bk-bs-has-warning .bk-bs-form-control-feedback{color:#8a6d3b}.bk-root .bk-bs-has-error .bk-bs-help-block,.bk-root .bk-bs-has-error .bk-bs-control-label,.bk-root .bk-bs-has-error .bk-bs-radio,.bk-root .bk-bs-has-error .bk-bs-checkbox,.bk-root .bk-bs-has-error .bk-bs-radio-inline,.bk-root .bk-bs-has-error .bk-bs-checkbox-inline{color:#a94442}.bk-root .bk-bs-has-error .bk-bs-form-control{border-color:#a94442;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.bk-root .bk-bs-has-error .bk-bs-form-control:focus{border-color:#843534;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #ce8483;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #ce8483}.bk-root .bk-bs-has-error .bk-bs-input-group-addon{color:#a94442;border-color:#a94442;background-color:#f2dede}.bk-root .bk-bs-has-error .bk-bs-form-control-feedback{color:#a94442}.bk-root .bk-bs-form-control-static{margin-bottom:0}.bk-root .bk-bs-help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}@media(min-width:768px){.bk-root .bk-bs-form-inline .bk-bs-form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.bk-root .bk-bs-form-inline .bk-bs-form-control{display:inline-block;width:auto;vertical-align:middle}.bk-root .bk-bs-form-inline .bk-bs-input-group>.bk-bs-form-control{width:100%}.bk-root .bk-bs-form-inline .bk-bs-control-label{margin-bottom:0;vertical-align:middle}.bk-root .bk-bs-form-inline .bk-bs-radio,.bk-root .bk-bs-form-inline .bk-bs-checkbox{display:inline-block;margin-top:0;margin-bottom:0;padding-left:0;vertical-align:middle}.bk-root .bk-bs-form-inline .bk-bs-radio input[type=\\\"radio\\\"],.bk-root .bk-bs-form-inline .bk-bs-checkbox input[type=\\\"checkbox\\\"]{float:none;margin-left:0}.bk-root .bk-bs-form-inline .bk-bs-has-feedback .bk-bs-form-control-feedback{top:0}}.bk-root .bk-bs-form-horizontal .bk-bs-control-label,.bk-root .bk-bs-form-horizontal .bk-bs-radio,.bk-root .bk-bs-form-horizontal .bk-bs-checkbox,.bk-root .bk-bs-form-horizontal .bk-bs-radio-inline,.bk-root .bk-bs-form-horizontal .bk-bs-checkbox-inline{margin-top:0;margin-bottom:0;padding-top:7px}.bk-root .bk-bs-form-horizontal .bk-bs-radio,.bk-root .bk-bs-form-horizontal .bk-bs-checkbox{min-height:24px}.bk-root .bk-bs-form-horizontal .bk-bs-form-group{margin-left:-15px;margin-right:-15px}.bk-root .bk-bs-form-horizontal .bk-bs-form-control-static{padding-top:7px}@media(min-width:768px){.bk-root .bk-bs-form-horizontal .bk-bs-control-label{text-align:right}}.bk-root .bk-bs-form-horizontal .bk-bs-has-feedback .bk-bs-form-control-feedback{top:0;right:15px}.bk-root .bk-bs-btn{display:inline-block;margin-bottom:0;font-weight:normal;text-align:center;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:12px;line-height:1.42857143;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.bk-root .bk-bs-btn:focus,.bk-root .bk-bs-btn:active:focus,.bk-root .bk-bs-btn.bk-bs-active:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.bk-root .bk-bs-btn:hover,.bk-root .bk-bs-btn:focus{color:#333;text-decoration:none}.bk-root .bk-bs-btn:active,.bk-root .bk-bs-btn.bk-bs-active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.bk-root .bk-bs-btn.bk-bs-disabled,.bk-root .bk-bs-btn[disabled],fieldset[disabled] .bk-root .bk-bs-btn{cursor:not-allowed;pointer-events:none;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}.bk-root .bk-bs-btn-default{color:#333;background-color:#fff;border-color:#ccc}.bk-root .bk-bs-btn-default:hover,.bk-root .bk-bs-btn-default:focus,.bk-root .bk-bs-btn-default:active,.bk-root .bk-bs-btn-default.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-default{color:#333;background-color:#ebebeb;border-color:#adadad}.bk-root .bk-bs-btn-default:active,.bk-root .bk-bs-btn-default.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-default{background-image:none}.bk-root .bk-bs-btn-default.bk-bs-disabled,.bk-root .bk-bs-btn-default[disabled],fieldset[disabled] .bk-root .bk-bs-btn-default,.bk-root .bk-bs-btn-default.bk-bs-disabled:hover,.bk-root .bk-bs-btn-default[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-default:hover,.bk-root .bk-bs-btn-default.bk-bs-disabled:focus,.bk-root .bk-bs-btn-default[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-default:focus,.bk-root .bk-bs-btn-default.bk-bs-disabled:active,.bk-root .bk-bs-btn-default[disabled]:active,fieldset[disabled] .bk-root .bk-bs-btn-default:active,.bk-root .bk-bs-btn-default.bk-bs-disabled.bk-bs-active,.bk-root .bk-bs-btn-default[disabled].bk-bs-active,fieldset[disabled] .bk-root .bk-bs-btn-default.bk-bs-active{background-color:#fff;border-color:#ccc}.bk-root .bk-bs-btn-default .bk-bs-badge{color:#fff;background-color:#333}.bk-root .bk-bs-btn-primary{color:#fff;background-color:#428bca;border-color:#357ebd}.bk-root .bk-bs-btn-primary:hover,.bk-root .bk-bs-btn-primary:focus,.bk-root .bk-bs-btn-primary:active,.bk-root .bk-bs-btn-primary.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-primary{color:#fff;background-color:#3276b1;border-color:#285e8e}.bk-root .bk-bs-btn-primary:active,.bk-root .bk-bs-btn-primary.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-primary{background-image:none}.bk-root .bk-bs-btn-primary.bk-bs-disabled,.bk-root .bk-bs-btn-primary[disabled],fieldset[disabled] .bk-root .bk-bs-btn-primary,.bk-root .bk-bs-btn-primary.bk-bs-disabled:hover,.bk-root .bk-bs-btn-primary[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-primary:hover,.bk-root .bk-bs-btn-primary.bk-bs-disabled:focus,.bk-root .bk-bs-btn-primary[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-primary:focus,.bk-root .bk-bs-btn-primary.bk-bs-disabled:active,.bk-root .bk-bs-btn-primary[disabled]:active,fieldset[disabled] .bk-root .bk-bs-btn-primary:active,.bk-root .bk-bs-btn-primary.bk-bs-disabled.bk-bs-active,.bk-root .bk-bs-btn-primary[disabled].bk-bs-active,fieldset[disabled] .bk-root .bk-bs-btn-primary.bk-bs-active{background-color:#428bca;border-color:#357ebd}.bk-root .bk-bs-btn-primary .bk-bs-badge{color:#428bca;background-color:#fff}.bk-root .bk-bs-btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.bk-root .bk-bs-btn-success:hover,.bk-root .bk-bs-btn-success:focus,.bk-root .bk-bs-btn-success:active,.bk-root .bk-bs-btn-success.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-success{color:#fff;background-color:#47a447;border-color:#398439}.bk-root .bk-bs-btn-success:active,.bk-root .bk-bs-btn-success.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-success{background-image:none}.bk-root .bk-bs-btn-success.bk-bs-disabled,.bk-root .bk-bs-btn-success[disabled],fieldset[disabled] .bk-root .bk-bs-btn-success,.bk-root .bk-bs-btn-success.bk-bs-disabled:hover,.bk-root .bk-bs-btn-success[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-success:hover,.bk-root .bk-bs-btn-success.bk-bs-disabled:focus,.bk-root .bk-bs-btn-success[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-success:focus,.bk-root .bk-bs-btn-success.bk-bs-disabled:active,.bk-root .bk-bs-btn-success[disabled]:active,fieldset[disabled] .bk-root .bk-bs-btn-success:active,.bk-root .bk-bs-btn-success.bk-bs-disabled.bk-bs-active,.bk-root .bk-bs-btn-success[disabled].bk-bs-active,fieldset[disabled] .bk-root .bk-bs-btn-success.bk-bs-active{background-color:#5cb85c;border-color:#4cae4c}.bk-root .bk-bs-btn-success .bk-bs-badge{color:#5cb85c;background-color:#fff}.bk-root .bk-bs-btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.bk-root .bk-bs-btn-info:hover,.bk-root .bk-bs-btn-info:focus,.bk-root .bk-bs-btn-info:active,.bk-root .bk-bs-btn-info.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-info{color:#fff;background-color:#39b3d7;border-color:#269abc}.bk-root .bk-bs-btn-info:active,.bk-root .bk-bs-btn-info.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-info{background-image:none}.bk-root .bk-bs-btn-info.bk-bs-disabled,.bk-root .bk-bs-btn-info[disabled],fieldset[disabled] .bk-root .bk-bs-btn-info,.bk-root .bk-bs-btn-info.bk-bs-disabled:hover,.bk-root .bk-bs-btn-info[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-info:hover,.bk-root .bk-bs-btn-info.bk-bs-disabled:focus,.bk-root .bk-bs-btn-info[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-info:focus,.bk-root .bk-bs-btn-info.bk-bs-disabled:active,.bk-root .bk-bs-btn-info[disabled]:active,fieldset[disabled] .bk-root .bk-bs-btn-info:active,.bk-root .bk-bs-btn-info.bk-bs-disabled.bk-bs-active,.bk-root .bk-bs-btn-info[disabled].bk-bs-active,fieldset[disabled] .bk-root .bk-bs-btn-info.bk-bs-active{background-color:#5bc0de;border-color:#46b8da}.bk-root .bk-bs-btn-info .bk-bs-badge{color:#5bc0de;background-color:#fff}.bk-root .bk-bs-btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.bk-root .bk-bs-btn-warning:hover,.bk-root .bk-bs-btn-warning:focus,.bk-root .bk-bs-btn-warning:active,.bk-root .bk-bs-btn-warning.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-warning{color:#fff;background-color:#ed9c28;border-color:#d58512}.bk-root .bk-bs-btn-warning:active,.bk-root .bk-bs-btn-warning.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-warning{background-image:none}.bk-root .bk-bs-btn-warning.bk-bs-disabled,.bk-root .bk-bs-btn-warning[disabled],fieldset[disabled] .bk-root .bk-bs-btn-warning,.bk-root .bk-bs-btn-warning.bk-bs-disabled:hover,.bk-root .bk-bs-btn-warning[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-warning:hover,.bk-root .bk-bs-btn-warning.bk-bs-disabled:focus,.bk-root .bk-bs-btn-warning[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-warning:focus,.bk-root .bk-bs-btn-warning.bk-bs-disabled:active,.bk-root .bk-bs-btn-warning[disabled]:active,fieldset[disabled] .bk-root .bk-bs-btn-warning:active,.bk-root .bk-bs-btn-warning.bk-bs-disabled.bk-bs-active,.bk-root .bk-bs-btn-warning[disabled].bk-bs-active,fieldset[disabled] .bk-root .bk-bs-btn-warning.bk-bs-active{background-color:#f0ad4e;border-color:#eea236}.bk-root .bk-bs-btn-warning .bk-bs-badge{color:#f0ad4e;background-color:#fff}.bk-root .bk-bs-btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.bk-root .bk-bs-btn-danger:hover,.bk-root .bk-bs-btn-danger:focus,.bk-root .bk-bs-btn-danger:active,.bk-root .bk-bs-btn-danger.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-danger{color:#fff;background-color:#d2322d;border-color:#ac2925}.bk-root .bk-bs-btn-danger:active,.bk-root .bk-bs-btn-danger.bk-bs-active,.bk-bs-open .bk-bs-dropdown-toggle.bk-root .bk-bs-btn-danger{background-image:none}.bk-root .bk-bs-btn-danger.bk-bs-disabled,.bk-root .bk-bs-btn-danger[disabled],fieldset[disabled] .bk-root .bk-bs-btn-danger,.bk-root .bk-bs-btn-danger.bk-bs-disabled:hover,.bk-root .bk-bs-btn-danger[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-danger:hover,.bk-root .bk-bs-btn-danger.bk-bs-disabled:focus,.bk-root .bk-bs-btn-danger[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-danger:focus,.bk-root .bk-bs-btn-danger.bk-bs-disabled:active,.bk-root .bk-bs-btn-danger[disabled]:active,fieldset[disabled] .bk-root .bk-bs-btn-danger:active,.bk-root .bk-bs-btn-danger.bk-bs-disabled.bk-bs-active,.bk-root .bk-bs-btn-danger[disabled].bk-bs-active,fieldset[disabled] .bk-root .bk-bs-btn-danger.bk-bs-active{background-color:#d9534f;border-color:#d43f3a}.bk-root .bk-bs-btn-danger .bk-bs-badge{color:#d9534f;background-color:#fff}.bk-root .bk-bs-btn-link{color:#428bca;font-weight:normal;cursor:pointer;border-radius:0}.bk-root .bk-bs-btn-link,.bk-root .bk-bs-btn-link:active,.bk-root .bk-bs-btn-link[disabled],fieldset[disabled] .bk-root .bk-bs-btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.bk-root .bk-bs-btn-link,.bk-root .bk-bs-btn-link:hover,.bk-root .bk-bs-btn-link:focus,.bk-root .bk-bs-btn-link:active{border-color:transparent}.bk-root .bk-bs-btn-link:hover,.bk-root .bk-bs-btn-link:focus{color:#2a6496;text-decoration:underline;background-color:transparent}.bk-root .bk-bs-btn-link[disabled]:hover,fieldset[disabled] .bk-root .bk-bs-btn-link:hover,.bk-root .bk-bs-btn-link[disabled]:focus,fieldset[disabled] .bk-root .bk-bs-btn-link:focus{color:#999;text-decoration:none}.bk-root .bk-bs-btn-lg{padding:10px 16px;font-size:15px;line-height:1.33;border-radius:6px}.bk-root .bk-bs-btn-sm{padding:5px 10px;font-size:11px;line-height:1.5;border-radius:3px}.bk-root .bk-bs-btn-xs{padding:1px 5px;font-size:11px;line-height:1.5;border-radius:3px}.bk-root .bk-bs-btn-block{display:block;width:100%;padding-left:0;padding-right:0}.bk-root .bk-bs-btn-block+.bk-bs-btn-block{margin-top:5px}.bk-root input[type=\\\"submit\\\"].bk-bs-btn-block,.bk-root input[type=\\\"reset\\\"].bk-bs-btn-block,.bk-root input[type=\\\"button\\\"].bk-bs-btn-block{width:100%}.bk-root .bk-bs-caret{display:inline-block;width:0;height:0;margin-left:2px;vertical-align:middle;border-top:4px solid;border-right:4px solid transparent;border-left:4px solid transparent}.bk-root .bk-bs-dropdown{position:relative}.bk-root .bk-bs-dropdown-toggle:focus{outline:0}.bk-root .bk-bs-dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;font-size:12px;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175);background-clip:padding-box}.bk-root .bk-bs-dropdown-menu.bk-bs-pull-right{right:0;left:auto}.bk-root .bk-bs-dropdown-menu .bk-bs-divider{height:1px;margin:7.5px 0;overflow:hidden;background-color:#e5e5e5}.bk-root .bk-bs-dropdown-menu>li>a{display:block;padding:3px 20px;clear:both;font-weight:normal;line-height:1.42857143;color:#333;white-space:nowrap}.bk-root .bk-bs-dropdown-menu>li>a:hover,.bk-root .bk-bs-dropdown-menu>li>a:focus{text-decoration:none;color:#262626;background-color:#f5f5f5}.bk-root .bk-bs-dropdown-menu>.bk-bs-active>a,.bk-root .bk-bs-dropdown-menu>.bk-bs-active>a:hover,.bk-root .bk-bs-dropdown-menu>.bk-bs-active>a:focus{color:#fff;text-decoration:none;outline:0;background-color:#428bca}.bk-root .bk-bs-dropdown-menu>.bk-bs-disabled>a,.bk-root .bk-bs-dropdown-menu>.bk-bs-disabled>a:hover,.bk-root .bk-bs-dropdown-menu>.bk-bs-disabled>a:focus{color:#999}.bk-root .bk-bs-dropdown-menu>.bk-bs-disabled>a:hover,.bk-root .bk-bs-dropdown-menu>.bk-bs-disabled>a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.bk-bs-Microsoft.bk-bs-gradient(enabled = false);cursor:not-allowed}.bk-root .bk-bs-open>.bk-bs-dropdown-menu{display:block}.bk-root .bk-bs-open>a{outline:0}.bk-root .bk-bs-dropdown-menu-right{left:auto;right:0}.bk-root .bk-bs-dropdown-menu-left{left:0;right:auto}.bk-root .bk-bs-dropdown-header{display:block;padding:3px 20px;font-size:11px;line-height:1.42857143;color:#999}.bk-root .bk-bs-dropdown-backdrop{position:fixed;left:0;right:0;bottom:0;top:0;z-index:990}.bk-root .bk-bs-pull-right>.bk-bs-dropdown-menu{right:0;left:auto}.bk-root .bk-bs-dropup .bk-bs-caret,.bk-root .bk-bs-navbar-fixed-bottom .bk-bs-dropdown .bk-bs-caret{border-top:0;border-bottom:4px solid;content:\\\"\\\"}.bk-root .bk-bs-dropup .bk-bs-dropdown-menu,.bk-root .bk-bs-navbar-fixed-bottom .bk-bs-dropdown .bk-bs-dropdown-menu{top:auto;bottom:100%;margin-bottom:1px}@media(min-width:768px){.bk-root .bk-bs-navbar-right .bk-bs-dropdown-menu{left:auto;right:0}.bk-root .bk-bs-navbar-right .bk-bs-dropdown-menu-left{left:0;right:auto}}.bk-root .bk-bs-btn-group,.bk-root .bk-bs-btn-group-vertical{position:relative;display:inline-block;vertical-align:middle}.bk-root .bk-bs-btn-group>.bk-bs-btn,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn{position:relative;float:left}.bk-root .bk-bs-btn-group>.bk-bs-btn:hover,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:hover,.bk-root .bk-bs-btn-group>.bk-bs-btn:focus,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:focus,.bk-root .bk-bs-btn-group>.bk-bs-btn:active,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:active,.bk-root .bk-bs-btn-group>.bk-bs-btn.bk-bs-active,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn.bk-bs-active{z-index:2}.bk-root .bk-bs-btn-group>.bk-bs-btn:focus,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:focus{outline:0}.bk-root .bk-bs-btn-group .bk-bs-btn+.bk-bs-btn,.bk-root .bk-bs-btn-group .bk-bs-btn+.bk-bs-btn-group,.bk-root .bk-bs-btn-group .bk-bs-btn-group+.bk-bs-btn,.bk-root .bk-bs-btn-group .bk-bs-btn-group+.bk-bs-btn-group{margin-left:-1px}.bk-root .bk-bs-btn-toolbar{margin-left:-5px}.bk-root .bk-bs-btn-toolbar .bk-bs-btn-group,.bk-root .bk-bs-btn-toolbar .bk-bs-input-group{float:left}.bk-root .bk-bs-btn-toolbar>.bk-bs-btn,.bk-root .bk-bs-btn-toolbar>.bk-bs-btn-group,.bk-root .bk-bs-btn-toolbar>.bk-bs-input-group{margin-left:5px}.bk-root .bk-bs-btn-group>.bk-bs-btn:not(:first-child):not(:last-child):not(.bk-bs-dropdown-toggle){border-radius:0}.bk-root .bk-bs-btn-group>.bk-bs-btn:first-child{margin-left:0}.bk-root .bk-bs-btn-group>.bk-bs-btn:first-child:not(:last-child):not(.bk-bs-dropdown-toggle){border-bottom-right-radius:0;border-top-right-radius:0}.bk-root .bk-bs-btn-group>.bk-bs-btn:last-child:not(:first-child),.bk-root .bk-bs-btn-group>.bk-bs-dropdown-toggle:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0}.bk-root .bk-bs-btn-group>.bk-bs-btn-group{float:left}.bk-root .bk-bs-btn-group>.bk-bs-btn-group:not(:first-child):not(:last-child)>.bk-bs-btn{border-radius:0}.bk-root .bk-bs-btn-group>.bk-bs-btn-group:first-child>.bk-bs-btn:last-child,.bk-root .bk-bs-btn-group>.bk-bs-btn-group:first-child>.bk-bs-dropdown-toggle{border-bottom-right-radius:0;border-top-right-radius:0}.bk-root .bk-bs-btn-group>.bk-bs-btn-group:last-child>.bk-bs-btn:first-child{border-bottom-left-radius:0;border-top-left-radius:0}.bk-root .bk-bs-btn-group .bk-bs-dropdown-toggle:active,.bk-root .bk-bs-btn-group.bk-bs-open .bk-bs-dropdown-toggle{outline:0}.bk-root .bk-bs-btn-group>.bk-bs-btn+.bk-bs-dropdown-toggle{padding-left:8px;padding-right:8px}.bk-root .bk-bs-btn-group>.bk-bs-btn-lg+.bk-bs-dropdown-toggle{padding-left:12px;padding-right:12px}.bk-root .bk-bs-btn-group.bk-bs-open .bk-bs-dropdown-toggle{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.bk-root .bk-bs-btn-group.bk-bs-open .bk-bs-dropdown-toggle.bk-bs-btn-link{-webkit-box-shadow:none;box-shadow:none}.bk-root .bk-bs-btn .bk-bs-caret{margin-left:0}.bk-root .bk-bs-btn-lg .bk-bs-caret{border-width:5px 5px 0;border-bottom-width:0}.bk-root .bk-bs-dropup .bk-bs-btn-lg .bk-bs-caret{border-width:0 5px 5px}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group>.bk-bs-btn{display:block;float:none;width:100%;max-width:100%}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group>.bk-bs-btn{float:none}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn+.bk-bs-btn,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn+.bk-bs-btn-group,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group+.bk-bs-btn,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group+.bk-bs-btn-group{margin-top:-1px;margin-left:0}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:not(:first-child):not(:last-child){border-radius:0}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:first-child:not(:last-child){border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn:last-child:not(:first-child){border-bottom-left-radius:4px;border-top-right-radius:0;border-top-left-radius:0}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group:not(:first-child):not(:last-child)>.bk-bs-btn{border-radius:0}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group:first-child:not(:last-child)>.bk-bs-btn:last-child,.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group:first-child:not(:last-child)>.bk-bs-dropdown-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0}.bk-root .bk-bs-btn-group-vertical>.bk-bs-btn-group:last-child:not(:first-child)>.bk-bs-btn:first-child{border-top-right-radius:0;border-top-left-radius:0}.bk-root .bk-bs-btn-group-justified{display:table;width:100%;table-layout:fixed;border-collapse:separate}.bk-root .bk-bs-btn-group-justified>.bk-bs-btn,.bk-root .bk-bs-btn-group-justified>.bk-bs-btn-group{float:none;display:table-cell;width:1%}.bk-root .bk-bs-btn-group-justified>.bk-bs-btn-group .bk-bs-btn{width:100%}.bk-root .bk-bs-btn-group>.bk-bs-btn>input[type=\\\"radio\\\"],.bk-root .bk-bs-btn-group>.bk-bs-btn>input[type=\\\"checkbox\\\"]{display:none}.bk-root .bk-bs-input-group{position:relative;display:table;border-collapse:separate}.bk-root .bk-bs-input-group[class*=\\\"col-\\\"]{float:none;padding-left:0;padding-right:0}.bk-root .bk-bs-input-group .bk-bs-form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.bk-root .bk-bs-input-group-lg>.bk-bs-form-control,.bk-root .bk-bs-input-group-lg>.bk-bs-input-group-addon,.bk-root .bk-bs-input-group-lg>.bk-bs-input-group-btn>.bk-bs-btn{height:42px;padding:10px 16px;font-size:15px;line-height:1.33;border-radius:6px}select.bk-root .bk-bs-input-group-lg>.bk-bs-form-control,select.bk-root .bk-bs-input-group-lg>.bk-bs-input-group-addon,select.bk-root .bk-bs-input-group-lg>.bk-bs-input-group-btn>.bk-bs-btn{height:42px;line-height:42px}textarea.bk-root .bk-bs-input-group-lg>.bk-bs-form-control,textarea.bk-root .bk-bs-input-group-lg>.bk-bs-input-group-addon,textarea.bk-root .bk-bs-input-group-lg>.bk-bs-input-group-btn>.bk-bs-btn,select[multiple].bk-root .bk-bs-input-group-lg>.bk-bs-form-control,select[multiple].bk-root .bk-bs-input-group-lg>.bk-bs-input-group-addon,select[multiple].bk-root .bk-bs-input-group-lg>.bk-bs-input-group-btn>.bk-bs-btn{height:auto}.bk-root .bk-bs-input-group-sm>.bk-bs-form-control,.bk-root .bk-bs-input-group-sm>.bk-bs-input-group-addon,.bk-root .bk-bs-input-group-sm>.bk-bs-input-group-btn>.bk-bs-btn{height:28px;padding:5px 10px;font-size:11px;line-height:1.5;border-radius:3px}select.bk-root .bk-bs-input-group-sm>.bk-bs-form-control,select.bk-root .bk-bs-input-group-sm>.bk-bs-input-group-addon,select.bk-root .bk-bs-input-group-sm>.bk-bs-input-group-btn>.bk-bs-btn{height:28px;line-height:28px}textarea.bk-root .bk-bs-input-group-sm>.bk-bs-form-control,textarea.bk-root .bk-bs-input-group-sm>.bk-bs-input-group-addon,textarea.bk-root .bk-bs-input-group-sm>.bk-bs-input-group-btn>.bk-bs-btn,select[multiple].bk-root .bk-bs-input-group-sm>.bk-bs-form-control,select[multiple].bk-root .bk-bs-input-group-sm>.bk-bs-input-group-addon,select[multiple].bk-root .bk-bs-input-group-sm>.bk-bs-input-group-btn>.bk-bs-btn{height:auto}.bk-root .bk-bs-input-group-addon,.bk-root .bk-bs-input-group-btn,.bk-root .bk-bs-input-group .bk-bs-form-control{display:table-cell}.bk-root .bk-bs-input-group-addon:not(:first-child):not(:last-child),.bk-root .bk-bs-input-group-btn:not(:first-child):not(:last-child),.bk-root .bk-bs-input-group .bk-bs-form-control:not(:first-child):not(:last-child){border-radius:0}.bk-root .bk-bs-input-group-addon,.bk-root .bk-bs-input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.bk-root .bk-bs-input-group-addon{padding:6px 12px;font-size:12px;font-weight:normal;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.bk-root .bk-bs-input-group-addon.bk-bs-input-sm{padding:5px 10px;font-size:11px;border-radius:3px}.bk-root .bk-bs-input-group-addon.bk-bs-input-lg{padding:10px 16px;font-size:15px;border-radius:6px}.bk-root .bk-bs-input-group-addon input[type=\\\"radio\\\"],.bk-root .bk-bs-input-group-addon input[type=\\\"checkbox\\\"]{margin-top:0}.bk-root .bk-bs-input-group .bk-bs-form-control:first-child,.bk-root .bk-bs-input-group-addon:first-child,.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-btn,.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-btn-group>.bk-bs-btn,.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-dropdown-toggle,.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-btn:not(:last-child):not(.bk-bs-dropdown-toggle),.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-btn-group:not(:last-child)>.bk-bs-btn{border-bottom-right-radius:0;border-top-right-radius:0}.bk-root .bk-bs-input-group-addon:first-child{border-right:0}.bk-root .bk-bs-input-group .bk-bs-form-control:last-child,.bk-root .bk-bs-input-group-addon:last-child,.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-btn,.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-btn-group>.bk-bs-btn,.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-dropdown-toggle,.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-btn:not(:first-child),.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-btn-group:not(:first-child)>.bk-bs-btn{border-bottom-left-radius:0;border-top-left-radius:0}.bk-root .bk-bs-input-group-addon:last-child{border-left:0}.bk-root .bk-bs-input-group-btn{position:relative;font-size:0;white-space:nowrap}.bk-root .bk-bs-input-group-btn>.bk-bs-btn{position:relative}.bk-root .bk-bs-input-group-btn>.bk-bs-btn+.bk-bs-btn{margin-left:-1px}.bk-root .bk-bs-input-group-btn>.bk-bs-btn:hover,.bk-root .bk-bs-input-group-btn>.bk-bs-btn:focus,.bk-root .bk-bs-input-group-btn>.bk-bs-btn:active{z-index:2}.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-btn,.bk-root .bk-bs-input-group-btn:first-child>.bk-bs-btn-group{margin-right:-1px}.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-btn,.bk-root .bk-bs-input-group-btn:last-child>.bk-bs-btn-group{margin-left:-1px}.bk-root .bk-bs-nav{margin-bottom:0;padding-left:0;list-style:none}.bk-root .bk-bs-nav>li{position:relative;display:block}.bk-root .bk-bs-nav>li>span{position:relative;display:block;padding:10px 15px}.bk-root .bk-bs-nav>li>span:hover,.bk-root .bk-bs-nav>li>span:focus{text-decoration:none;background-color:#eee}.bk-root .bk-bs-nav>li.bk-bs-disabled>span{color:#999}.bk-root .bk-bs-nav>li.bk-bs-disabled>span:hover,.bk-root .bk-bs-nav>li.bk-bs-disabled>span:focus{color:#999;text-decoration:none;background-color:transparent;cursor:not-allowed}.bk-root .bk-bs-nav-tabs{border-bottom:1px solid #ddd}.bk-root .bk-bs-nav-tabs>li{float:left;margin-bottom:-1px}.bk-root .bk-bs-nav-tabs>li>span{margin-right:2px;line-height:1.42857143;border:1px solid transparent;border-radius:4px 4px 0 0}.bk-root .bk-bs-nav-tabs>li>span:hover{border-color:#eee #eee #ddd;cursor:pointer}.bk-root .bk-bs-nav-tabs>li.bk-bs-active>span,.bk-root .bk-bs-nav-tabs>li.bk-bs-active>span:hover,.bk-root .bk-bs-nav-tabs>li.bk-bs-active>span:focus{color:#555;background-color:#fff;border:1px solid #ddd;border-bottom-color:transparent;cursor:default}.bk-root .bk-bs-tab-content>.bk-bs-tab-pane{display:none}.bk-root .bk-bs-tab-content>.bk-bs-active{display:block}.bk-root .pika-single{z-index:9999;display:block;position:relative;color:#333;background:#fff;border:1px solid #ccc;border-bottom-color:#bbb;font-family:\\\"Helvetica Neue\\\",Helvetica,Arial,sans-serif}.bk-root .pika-single:before,.bk-root .pika-single:after{content:\\\" \\\";display:table}.bk-root .pika-single:after{clear:both}.bk-root .pika-single{*zoom:1}.bk-root .pika-single.is-hidden{display:none}.bk-root .pika-single.is-bound{position:absolute;box-shadow:0 5px 15px -5px rgba(0,0,0,0.5)}.bk-root .pika-lendar{float:left;width:240px;margin:8px}.bk-root .pika-title{position:relative;text-align:center}.bk-root .pika-label{display:inline-block;*display:inline;position:relative;z-index:9999;overflow:hidden;margin:0;padding:5px 3px;font-size:14px;line-height:20px;font-weight:bold;background-color:#fff}.bk-root .pika-title select{cursor:pointer;position:absolute;z-index:9998;margin:0;left:0;top:5px;filter:alpha(opacity=0);opacity:0}.bk-root .pika-prev,.bk-root .pika-next{display:block;cursor:pointer;position:relative;outline:0;border:0;padding:0;width:20px;height:30px;text-indent:20px;white-space:nowrap;overflow:hidden;background-color:transparent;background-position:center center;background-repeat:no-repeat;background-size:75% 75%;opacity:.5;*position:absolute;*top:0}.bk-root .pika-prev:hover,.bk-root .pika-next:hover{opacity:1}.bk-root .pika-prev,.bk-root .is-rtl .pika-next{float:left;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==');*left:0}.bk-root .pika-next,.bk-root .is-rtl .pika-prev{float:right;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=');*right:0}.bk-root .pika-prev.is-disabled,.bk-root .pika-next.is-disabled{cursor:default;opacity:.2}.bk-root .pika-select{display:inline-block;*display:inline}.bk-root .pika-table{width:100%;border-collapse:collapse;border-spacing:0;border:0}.bk-root .pika-table th,.bk-root .pika-table td{width:14.285714285714286%;padding:0}.bk-root .pika-table th{color:#999;font-size:12px;line-height:25px;font-weight:bold;text-align:center}.bk-root .pika-button{cursor:pointer;display:block;box-sizing:border-box;-moz-box-sizing:border-box;outline:0;border:0;margin:0;width:100%;padding:5px;color:#666;font-size:12px;line-height:15px;text-align:right;background:#f5f5f5}.bk-root .pika-week{font-size:11px;color:#999}.bk-root .is-today .pika-button{color:#3af;font-weight:bold}.bk-root .is-selected .pika-button,.bk-root .has-event .pika-button{color:#fff;font-weight:bold;background:#3af;box-shadow:inset 0 1px 3px #178fe5;border-radius:3px}.bk-root .has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.bk-root .is-disabled .pika-button,.bk-root .is-inrange .pika-button{background:#d5e9f7}.bk-root .is-startrange .pika-button{color:#fff;background:#6cb31d;box-shadow:none;border-radius:3px}.bk-root .is-endrange .pika-button{color:#fff;background:#3af;box-shadow:none;border-radius:3px}.bk-root .is-disabled .pika-button{pointer-events:none;cursor:default;color:#999;opacity:.3}.bk-root .is-outside-current-month .pika-button{color:#999;opacity:.3}.bk-root .is-selection-disabled{pointer-events:none;cursor:default}.bk-root .pika-button:hover,.bk-root .pika-row.pick-whole-week:hover .pika-button{color:#fff;background:#ff8000;box-shadow:none;border-radius:3px}.bk-root .pika-table abbr{border-bottom:0;cursor:help}.bk-root .bk-widget-box{overflow:visible;padding:5px 10px}.bk-root .bk-widget label{margin-bottom:2px}.bk-root .bk-widget{margin-top:10px}.bk-root .bk-widget h1:first-child,.bk-root .bk-widget h2:first-child,.bk-root .bk-widget h3:first-child,.bk-root .bk-widget h4:first-child,.bk-root .bk-widget h5:first-child,.bk-root .bk-widget h6:first-child,.bk-root .bk-widget p:first-child{margin-top:0}.bk-root .bk-widget-form-input{display:block;height:31px;padding:0 12px;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px}.bk-root .bk-widget-form-input:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,0.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,0.6)}.bk-root .bk-widget-form-input::-moz-placeholder{color:#999;opacity:1}.bk-root .bk-widget-form-input:-ms-input-placeholder{color:#999}.bk-root .bk-widget-form-input::-webkit-input-placeholder{color:#999}.bk-root .bk-widget-form-input[disabled],.bk-root .bk-widget-form-input[readonly],fieldset[disabled] .bk-root .bk-widget-form-input{cursor:not-allowed;background-color:#eee;opacity:1}textarea.bk-root .bk-widget-form-input{height:auto}.bk-root .bk-widget button{min-width:100%}.bk-root .bk-widget input[type=\\\"text\\\"]{min-width:90%}.bk-root .bk-widget select{min-width:97%}.bk-root .bk-bs-dropdown-toggle .bk-bs-caret{margin-left:5px}.bk-root .bk-bs-dropdown-menu{width:100%}.bk-root .bk-bs-nav-tabs{overflow:hidden}.bk-root .bk-slider label{margin-right:5px}.bk-root .bk-slider .bk-slider-value{display:inline-block;font-weight:600}.bk-root .bk-slider input,.bk-root .bk-slider .bk-slider-value{margin-bottom:5px}\\n/* END bokeh-widgets.min.css */\"); console.log(\"Bokeh: injecting raw CSS\"); Bokeh.embed.inject_raw_css(\"/* BEGIN bokeh-tables.min.css */\\n.bk-root .slick-header.ui-state-default,.bk-root .slick-headerrow.ui-state-default,.bk-root .slick-footerrow.ui-state-default{width:100%;overflow:hidden;border-left:0 !important}.bk-root .slick-header-columns,.bk-root .slick-headerrow-columns,.bk-root .slick-footerrow-columns{position:relative;white-space:nowrap;cursor:default;overflow:hidden}.bk-root .slick-header-column.ui-state-default{position:relative;display:inline-block;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:16px;line-height:16px;margin:0;padding:4px;border-right:1px solid silver;border-left:0 !important;border-top:0 !important;border-bottom:0 !important;float:left}.bk-root .slick-headerrow-column.ui-state-default,.bk-root .slick-footerrow-column.ui-state-default{padding:4px}.bk-root .slick-header-column-sorted{font-style:italic}.bk-root .slick-sort-indicator{display:inline-block;width:8px;height:5px;margin-left:4px;margin-top:6px;float:left}.bk-root .slick-sort-indicator-numbered{display:inline-block;width:8px;height:5px;margin-left:4px;margin-top:0;padding-left:1px;line-height:20px;float:left;font-family:Arial;font-style:normal;font-weight:bold;color:#6190cd}.bk-root .slick-sort-indicator-desc{background:url(images/sort-desc.gif)}.bk-root .slick-sort-indicator-asc{background:url(images/sort-asc.gif)}.bk-root .slick-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:col-resize;width:4px;right:0;top:0;height:100%}.bk-root .slick-sortable-placeholder{background:silver}.bk-root .grid-canvas{position:relative;outline:0}.bk-root .slick-row.ui-widget-content,.bk-root .slick-row.ui-state-active{position:absolute;border:0;width:100%}.bk-root .slick-cell,.bk-root .slick-headerrow-column,.bk-root .slick-footerrow-column{position:absolute;border:1px solid transparent;border-right:1px dotted silver;border-bottom-color:silver;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;vertical-align:middle;z-index:1;padding:1px 2px 2px 1px;margin:0;white-space:nowrap;cursor:default}.bk-root .slick-cell,.bk-root .slick-headerrow-column{border-bottom-color:silver}.bk-root .slick-footerrow-column{border-top-color:silver}.bk-root .slick-group-toggle{display:inline-block}.bk-root .slick-cell.highlighted{background:lightskyblue;background:rgba(0,0,255,0.2);-webkit-transition:all .5s;-moz-transition:all .5s;-o-transition:all .5s;transition:all .5s}.bk-root .slick-cell.flashing{border:1px solid red !important}.bk-root .slick-cell.editable{z-index:11;overflow:visible;background:white;border-color:black;border-style:solid}.bk-root .slick-cell:focus{outline:0}.bk-root .slick-reorder-proxy{display:inline-block;background:blue;opacity:.15;cursor:move}.bk-root .slick-reorder-guide{display:inline-block;height:2px;background:blue;opacity:.7}.bk-root .slick-selection{z-index:10;position:absolute;border:2px dashed black}.bk-root .slick-header-columns{background:url('images/header-columns-bg.gif') repeat-x center bottom;border-bottom:1px solid silver}.bk-root .slick-header-column{background:url('images/header-columns-bg.gif') repeat-x center bottom;border-right:1px solid silver}.bk-root .slick-header-column:hover,.bk-root .slick-header-column-active{background:white url('images/header-columns-over-bg.gif') repeat-x center bottom}.bk-root .slick-headerrow{background:#fafafa}.bk-root .slick-headerrow-column{background:#fafafa;border-bottom:0;height:100%}.bk-root .slick-row.ui-state-active{background:#f5f7d7}.bk-root .slick-row{position:absolute;background:white;border:0;line-height:20px}.bk-root .slick-row.selected{z-index:10;background:#dfe8f6}.bk-root .slick-cell{padding-left:4px;padding-right:4px}.bk-root .slick-group{border-bottom:2px solid silver}.bk-root .slick-group-toggle{width:9px;height:9px;margin-right:5px}.bk-root .slick-group-toggle.expanded{background:url(images/collapse.gif) no-repeat center center}.bk-root .slick-group-toggle.collapsed{background:url(images/expand.gif) no-repeat center center}.bk-root .slick-group-totals{color:gray;background:white}.bk-root .slick-group-select-checkbox{width:13px;height:13px;margin:3px 10px 0 0;display:inline-block}.bk-root .slick-group-select-checkbox.checked{background:url(images/GrpCheckboxY.png) no-repeat center center}.bk-root .slick-group-select-checkbox.unchecked{background:url(images/GrpCheckboxN.png) no-repeat center center}.bk-root .slick-cell.selected{background-color:beige}.bk-root .slick-cell.active{border-color:gray;border-style:solid}.bk-root .slick-sortable-placeholder{background:silver !important}.bk-root .slick-row.odd{background:#fafafa}.bk-root .slick-row.ui-state-active{background:#f5f7d7}.bk-root .slick-row.loading{opacity:.5}.bk-root .slick-cell.invalid{border-color:red;-moz-animation-duration:.2s;-webkit-animation-duration:.2s;-moz-animation-name:slickgrid-invalid-hilite;-webkit-animation-name:slickgrid-invalid-hilite}@-moz-keyframes slickgrid-invalid-hilite{from{box-shadow:0 0 6px red}to{box-shadow:none}}@-webkit-keyframes slickgrid-invalid-hilite{from{box-shadow:0 0 6px red}to{box-shadow:none}}.bk-root .slick-column-name,.bk-root .slick-sort-indicator{display:inline-block;float:left;margin-bottom:100px}.bk-root .slick-header-button{display:inline-block;float:right;vertical-align:top;margin:1px;margin-bottom:100px;height:15px;width:15px;background-repeat:no-repeat;background-position:center center;cursor:pointer}.bk-root .slick-header-button-hidden{width:0;-webkit-transition:.2s width;-ms-transition:.2s width;transition:.2s width}.bk-root .slick-header-column:hover>.slick-header-button{width:15px}.bk-root .slick-header-menubutton{position:absolute;right:0;top:0;bottom:0;width:14px;background-repeat:no-repeat;background-position:left center;background-image:url(../images/down.gif);cursor:pointer;display:none;border-left:thin ridge silver}.bk-root .slick-header-column:hover>.slick-header-menubutton,.bk-root .slick-header-column-active .slick-header-menubutton{display:inline-block}.bk-root .slick-header-menu{position:absolute;display:inline-block;margin:0;padding:2px;cursor:default}.bk-root .slick-header-menuitem{list-style:none;margin:0;padding:0;cursor:pointer}.bk-root .slick-header-menuicon{display:inline-block;width:16px;height:16px;vertical-align:middle;margin-right:4px;background-repeat:no-repeat;background-position:center center}.bk-root .slick-header-menucontent{display:inline-block;vertical-align:middle}.bk-root .slick-header-menuitem-disabled{color:silver}.bk-root .slick-columnpicker{border:1px solid #718bb7;background:#f0f0f0;padding:6px;-moz-box-shadow:2px 2px 2px silver;-webkit-box-shadow:2px 2px 2px silver;box-shadow:2px 2px 2px silver;min-width:100px;cursor:default}.bk-root .slick-columnpicker li{list-style:none;margin:0;padding:0;background:0}.bk-root .slick-columnpicker input{margin:4px}.bk-root .slick-columnpicker li a{display:block;padding:4px;font-weight:bold}.bk-root .slick-columnpicker li a:hover{background:white}.bk-root .slick-pager{width:100%;height:26px;border:1px solid gray;border-top:0;background:url('../images/header-columns-bg.gif') repeat-x center bottom;vertical-align:middle}.bk-root .slick-pager .slick-pager-status{display:inline-block;padding:6px}.bk-root .slick-pager .ui-icon-container{display:inline-block;margin:2px;border-color:gray}.bk-root .slick-pager .slick-pager-nav{display:inline-block;float:left;padding:2px}.bk-root .slick-pager .slick-pager-settings{display:block;float:right;padding:2px}.bk-root .slick-pager .slick-pager-settings *{vertical-align:middle}.bk-root .slick-pager .slick-pager-settings a{padding:2px;text-decoration:underline;cursor:pointer}.bk-root .slick-header-columns{background-image:url(\\\"data:image/gif;base64,R0lGODlhAgAYAIcAANDQ0Ovs7uzt7+3u8O7v8e/w8vDx8/Hy9Pn5+QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAAAP8ALAAAAAACABgAAAghABEIHEiwYMEDCA8YWMiwgMMCBAgMmDhAgIAAGAMAABAQADs=\\\")}.bk-root .slick-header-column{background-image:url(\\\"data:image/gif;base64,R0lGODlhAgAYAIcAANDQ0Ovs7uzt7+3u8O7v8e/w8vDx8/Hy9Pn5+QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAAAP8ALAAAAAACABgAAAghABEIHEiwYMEDCA8YWMiwgMMCBAgMmDhAgIAAGAMAABAQADs=\\\")}.bk-root .slick-header-column:hover,.bk-root .slick-header-column-active{background-image:url(\\\"data:image/gif;base64,R0lGODlhAgAWAIcAAKrM9tno++vz/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAAAP8ALAAAAAACABYAAAgUAAUIHEiwoIAACBMqXMhwIQAAAQEAOw==\\\")}.bk-root .slick-group-toggle.expanded{background-image:url(\\\"data:image/gif;base64,R0lGODlhCQAJAPcAAAFGeoCAgNXz/+v5/+v6/+z5/+36//L7//X8//j9/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAACQAJAAAIMwADCBxIUIDBgwIEChgwwECBAgQUFjBAkaJCABgxGlB4AGHCAAIQiBypEEECkScJqgwQEAA7\\\")}.bk-root .slick-group-toggle.collapsed{background-image:url(\\\"data:image/gif;base64,R0lGODlhCQAJAPcAAAFGeoCAgNXz/+v5/+v6/+z5/+36//L7//X8//j9/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAACQAJAAAIOAADCBxIUIDBgwIEChgwAECBAgQUFjAAQIABAwoBaNSIMYCAAwIqGlSIAEHFkiQTIBCgkqDLAAEBADs=\\\")}.bk-root .slick-group-select-checkbox.checked{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwQAADsEBuJFr7QAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAAEcSURBVChTjdI9S8NQFAbg/raQXVwCRRFE7GK7OXTwD+ikk066VF3a0ja0hQTyQdJrwNq0zrYSQRLEXMSWSlCIb8glqRcFD+9yz3nugXwU4n9XQqMoGjj36uBJsTwuaNo3EwBG4Yy7pe7Gv8YcvhJCGFVsjxsjxujj6OTSGlHv+U2WZUZbPWKOv1ZjT5a7pbIoiptbO5b73mwrjHa1B27l8VlTEIS1damlTnEE+EEN9/P8WrfH81qdAIGeXvTTmzltdCy46sEhxpKUINReZR9NnqZbr9puugxV3NjWh/k74WmmEdWhmUNy2jNmWRc6fZTVADCqao52u+DGWTACYNT3fRxwtatPufTNR4yCIGAUn5hS+vJHhWGY/ANx/A3tvdv+1tZmuwAAAABJRU5ErkJggg==\\\")}.bk-root .slick-group-select-checkbox.unchecked{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwQAADsEBuJFr7QAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAACXSURBVChT1dIxC4MwEAXg/v8/VOhQVDBNakV0KA6pxS4JhWRSIYPEJxwdDi1de7wleR+3JIf486w0hKCKRpSvvOhZcCmvNQBRuKqdah03U7UjNNH81rOaBYDo8SQaPX8JANFEaLaGBeAPaaY61rGksiN6TmR5H1j9CSoAosYYHLA7vTxYMvVEZa0liif23r93xjm3/oEYF8PiDn/I2FHCAAAAAElFTkSuQmCC\\\")}.bk-root .slick-sort-indicator-desc{background-image:url(\\\"data:image/gif;base64,R0lGODlhDQAFAIcAAGGQzUD/QOPu+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAANAAUAAAgeAAUAGEgQgIAACBEKLHgwYcKFBh1KFNhQosOKEgMCADs=\\\")}.bk-root .slick-sort-indicator-asc{background-image:url(\\\"data:image/gif;base64,R0lGODlhDQAFAIcAAGGQzUD/QOPu+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAANAAUAAAgbAAMIDABgoEGDABIeRJhQ4cKGEA8KmEiRosGAADs=\\\")}.bk-root .slick-header-menubutton{background-image:url(\\\"data:image/gif;base64,R0lGODlhDgAOAIABADtKYwAAACH5BAEAAAEALAAAAAAOAA4AAAISjI+py+0PHZgUsGobhTn6DxoFADs=\\\")}.bk-root .slick-pager{background-image:url(\\\"data:image/gif;base64,R0lGODlhAgAYAIcAANDQ0Ovs7uzt7+3u8O7v8e/w8vDx8/Hy9Pn5+QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAAAP8ALAAAAAACABgAAAghABEIHEiwYMEDCA8YWMiwgMMCBAgMmDhAgIAAGAMAABAQADs=\\\")}.bk-root .bk-data-table{font-size:11px}.bk-root .bk-data-table input[type=\\\"checkbox\\\"]{margin-left:4px;margin-right:4px}.bk-root .bk-data-table *{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}.bk-root .bk-data-table *:before,.bk-root .bk-data-table *:after{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}.bk-root .bk-cell-special-defaults{border-right-color:silver;border-right-style:solid;background:#f5f5f5}.bk-root .bk-cell-select{border-right-color:silver;border-right-style:solid;background:#f5f5f5}.bk-root .bk-cell-index{border-right-color:silver;border-right-style:solid;background:#f5f5f5;text-align:right;color:gray}.bk-root .bk-header-index .slick-column-name{float:right}.bk-root .slick-row.selected .bk-cell-index{background-color:transparent}.bk-root .slick-cell{padding-left:4px;padding-right:4px}.bk-root .slick-cell.active{border-style:dashed}.bk-root .slick-cell.editable{padding-left:0;padding-right:0}.bk-root .bk-cell-editor input,.bk-root .bk-cell-editor select{width:100%;height:100%;border:0;margin:0;padding:0;outline:0;background:transparent;vertical-align:baseline}.bk-root .bk-cell-editor input{padding-left:4px;padding-right:4px}.bk-root .bk-cell-editor-completion{font-size:11px}\\n/* END bokeh-tables.min.css */\"); } ]; function run_inline_js() { if ((root.Bokeh !== undefined) || (force === true)) { for (var i = 0; i < inline_js.length; i++) { inline_js[i].call(root, root.Bokeh); }} else if (Date.now() < root._bokeh_timeout) { setTimeout(run_inline_js, 100); } else if (!root._bokeh_failed_load) { console.log(\"Bokeh: BokehJS failed to load within specified timeout.\"); root._bokeh_failed_load = true; } else if (force !== true) { var cell = $(document.getElementById(null)).parents('.cell').data().cell; cell.output_area.append_execute_result(NB_LOAD_WARNING) } } if (root._bokeh_is_loading === 0) { console.log(\"Bokeh: BokehJS loaded, going straight to plotting\"); run_inline_js(); } else { load_libs(js_urls, function() { console.log(\"Bokeh: BokehJS plotting callback run at\", now()); run_inline_js(); }); } }(window)); div.bk-hbox { display: flex; justify-content: center; } div.bk-hbox div.bk-plot { padding: 8px; } div.bk-hbox div.bk-data-table { padding: 20px; } div.hololayout { display: flex; align-items: center; margin: 0; } div.holoframe { width: 75%; } div.holowell { display: flex; align-items: center; } form.holoform { background-color: #fafafa; border-radius: 5px; overflow: hidden; padding-left: 0.8em; padding-right: 0.8em; padding-top: 0.4em; padding-bottom: 0.4em; box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05); margin-bottom: 20px; border: 1px solid #e3e3e3; } div.holowidgets { padding-right: 0; width: 25%; } div.holoslider { min-height: 0 !important; height: 0.8em; width: 100%; } div.holoformgroup { padding-top: 0.5em; margin-bottom: 0.5em; } div.hologroup { padding-left: 0; padding-right: 0.8em; width: 100%; } .holoselect { width: 92%; margin-left: 0; margin-right: 0; } .holotext { padding-left: 0.5em; padding-right: 0; width: 100%; } .holowidgets .ui-resizable-se { visibility: hidden } .holoframe > .ui-resizable-se { visibility: hidden } .holowidgets .ui-resizable-s { visibility: hidden } /* CSS rules for noUISlider based slider used by JupyterLab extension */ .noUi-handle { width: 20px !important; height: 20px !important; left: -5px !important; top: -5px !important; } .noUi-handle:before, .noUi-handle:after { visibility: hidden; height: 0px; } .noUi-target { margin-left: 0.5em; margin-right: 0.5em; } var element = $('#6160f68e-bd22-4bfe-b16a-eb4ba12a1bf1'); function HoloViewsWidget() { } HoloViewsWidget.prototype.init_slider = function(init_val){ if(this.load_json) { this.from_json() } else { this.update_cache(); } } HoloViewsWidget.prototype.populate_cache = function(idx){ this.cache[idx].innerHTML = this.frames[idx]; if (this.embed) { delete this.frames[idx]; } } HoloViewsWidget.prototype.process_error = function(msg){ } HoloViewsWidget.prototype.from_json = function() { var data_url = this.json_path + this.id + '.json'; $.getJSON(data_url, $.proxy(function(json_data) { this.frames = json_data; this.update_cache(); this.update(0); }, this)); } HoloViewsWidget.prototype.dynamic_update = function(current){ if (current === undefined) { return } this.current = current; if (this.comm) { var msg = {comm_id: this.id+'_client', content: current} this.comm.send(msg); } } HoloViewsWidget.prototype.update_cache = function(force){ var frame_len = Object.keys(this.frames).length; for (var i=0; i<frame_len; i++) { if(!this.load_json || this.dynamic) { var frame = Object.keys(this.frames)[i]; } else { var frame = i; } if(!(frame in this.cache) || force) { if ((frame in this.cache) && force) { this.cache[frame].remove() } var div = document.createElement(\"div\"); var parent = document.getElementById(\"_anim_img\"+this.id); div.style.display = \"none\"; parent.appendChild(div) this.cache[frame] = div; var cache_id = \"_anim_img\"+this.id+\"_\"+frame; this.populate_cache(frame); } } } HoloViewsWidget.prototype.update = function(current){ if(current in this.cache) { for (var index in this.cache) { this.cache[index].style.display = \"none\"; } this.cache[current].style.display = \"\"; this.wait = false; } } HoloViewsWidget.prototype.init_comms = function() { var that = this HoloViews.comm_manager.register_target(this.plot_id, this.id, function (msg) { that.process_msg(msg) }) if (!this.cached || this.dynamic) { function ack_callback(msg) { msg = JSON.parse(msg.content.data); var comm_id = msg[\"comm_id\"] var comm_status = HoloViews.comm_status[comm_id]; if (that.queue.length > 0) { that.time = Date.now(); that.dynamic_update(that.queue[that.queue.length-1]); that.queue = []; } else { that.wait = false; } if ((msg.msg_type == \"Ready\") && msg.content) { console.log(\"Python callback returned following output:\", msg.content); } else if (msg.msg_type == \"Error\") { console.log(\"Python failed with the following traceback:\", msg['traceback']) } } var comm = HoloViews.comm_manager.get_client_comm(this.plot_id, this.id+'_client', ack_callback); return comm } } HoloViewsWidget.prototype.process_msg = function(msg) { } function SelectionWidget(frames, id, slider_ids, keyMap, dim_vals, notFound, load_json, mode, cached, json_path, dynamic, plot_id){ this.frames = frames; this.id = id; this.plot_id = plot_id; this.slider_ids = slider_ids; this.keyMap = keyMap this.current_frame = 0; this.current_vals = dim_vals; this.load_json = load_json; this.mode = mode; this.notFound = notFound; this.cached = cached; this.dynamic = dynamic; this.cache = {}; this.json_path = json_path; this.init_slider(this.current_vals[0]); this.queue = []; this.wait = false; if (!this.cached || this.dynamic) { this.comm = this.init_comms(); } } SelectionWidget.prototype = new HoloViewsWidget; SelectionWidget.prototype.get_key = function(current_vals) { var key = \"(\"; for (var i=0; i<this.slider_ids.length; i++) { var val = this.current_vals[i]; if (!(typeof val === 'string')) { if (val % 1 === 0) { val = val.toFixed(1); } else { val = val.toFixed(10); val = val.slice(0, val.length-1);} } key += \"'\" + val + \"'\"; if(i != this.slider_ids.length-1) { key += ', ';} else if(this.slider_ids.length == 1) { key += ',';} } key += \")\"; return this.keyMap[key]; } SelectionWidget.prototype.set_frame = function(dim_val, dim_idx){ this.current_vals[dim_idx] = dim_val; var key = this.current_vals; if (!this.dynamic) { key = this.get_key(key) } if (this.dynamic || !this.cached) { if ((this.time !== undefined) && ((this.wait) && ((this.time + 10000) > Date.now()))) { this.queue.push(key); return } this.queue = []; this.time = Date.now(); this.current_frame = key; this.wait = true; this.dynamic_update(key) } else if (key !== undefined) { this.update(key) } } /* Define the ScrubberWidget class */ function ScrubberWidget(frames, num_frames, id, interval, load_json, mode, cached, json_path, dynamic, plot_id){ this.slider_id = \"_anim_slider\" + id; this.loop_select_id = \"_anim_loop_select\" + id; this.id = id; this.plot_id = plot_id; this.interval = interval; this.current_frame = 0; this.direction = 0; this.dynamic = dynamic; this.timer = null; this.load_json = load_json; this.mode = mode; this.cached = cached; this.frames = frames; this.cache = {}; this.length = num_frames; this.json_path = json_path; document.getElementById(this.slider_id).max = this.length - 1; this.init_slider(0); this.wait = false; this.queue = []; if (!this.cached || this.dynamic) { this.comm = this.init_comms() } } ScrubberWidget.prototype = new HoloViewsWidget; ScrubberWidget.prototype.set_frame = function(frame){ this.current_frame = frame; var widget = document.getElementById(this.slider_id); if (widget === null) { this.pause_animation(); return } widget.value = this.current_frame; if (this.dynamic || !this.cached) { if ((this.time !== undefined) && ((this.wait) && ((this.time + 10000) > Date.now()))) { this.queue.push(frame); return } this.queue = []; this.time = Date.now(); this.wait = true; this.dynamic_update(frame) } else { this.update(frame) } } ScrubberWidget.prototype.get_loop_state = function(){ var button_group = document[this.loop_select_id].state; for (var i = 0; i < button_group.length; i++) { var button = button_group[i]; if (button.checked) { return button.value; } } return undefined; } ScrubberWidget.prototype.next_frame = function() { this.set_frame(Math.min(this.length - 1, this.current_frame + 1)); } ScrubberWidget.prototype.previous_frame = function() { this.set_frame(Math.max(0, this.current_frame - 1)); } ScrubberWidget.prototype.first_frame = function() { this.set_frame(0); } ScrubberWidget.prototype.last_frame = function() { this.set_frame(this.length - 1); } ScrubberWidget.prototype.slower = function() { this.interval /= 0.7; if(this.direction > 0){this.play_animation();} else if(this.direction < 0){this.reverse_animation();} } ScrubberWidget.prototype.faster = function() { this.interval *= 0.7; if(this.direction > 0){this.play_animation();} else if(this.direction < 0){this.reverse_animation();} } ScrubberWidget.prototype.anim_step_forward = function() { if(this.current_frame < this.length - 1){ this.next_frame(); }else{ var loop_state = this.get_loop_state(); if(loop_state == \"loop\"){ this.first_frame(); }else if(loop_state == \"reflect\"){ this.last_frame(); this.reverse_animation(); }else{ this.pause_animation(); this.last_frame(); } } } ScrubberWidget.prototype.anim_step_reverse = function() { if(this.current_frame > 0){ this.previous_frame(); } else { var loop_state = this.get_loop_state(); if(loop_state == \"loop\"){ this.last_frame(); }else if(loop_state == \"reflect\"){ this.first_frame(); this.play_animation(); }else{ this.pause_animation(); this.first_frame(); } } } ScrubberWidget.prototype.pause_animation = function() { this.direction = 0; if (this.timer){ clearInterval(this.timer); this.timer = null; } } ScrubberWidget.prototype.play_animation = function() { this.pause_animation(); this.direction = 1; var t = this; if (!this.timer) this.timer = setInterval(function(){t.anim_step_forward();}, this.interval); } ScrubberWidget.prototype.reverse_animation = function() { this.pause_animation(); this.direction = -1; var t = this; if (!this.timer) this.timer = setInterval(function(){t.anim_step_reverse();}, this.interval); } function extend(destination, source) { for (var k in source) { if (source.hasOwnProperty(k)) { destination[k] = source[k]; } } return destination; } function update_widget(widget, values) { if (widget.hasClass(\"ui-slider\")) { widget.slider('option', { min: 0, max: values.length-1, dim_vals: values, value: 0, dim_labels: values }) widget.slider('option', 'slide').call(widget, event, {value: 0}) } else { widget.empty(); for (var i=0; i<values.length; i++){ widget.append($(\"<option>\", { value: i, text: values[i] })) }; widget.data('values', values); widget.data('value', 0); widget.trigger(\"change\"); }; } function init_slider(id, plot_id, dim, values, next_vals, labels, dynamic, step, value, next_dim, dim_idx, delay, jQueryUI_CDN, UNDERSCORE_CDN) { // Slider JS Block START function loadcssfile(filename){ var fileref=document.createElement(\"link\") fileref.setAttribute(\"rel\", \"stylesheet\") fileref.setAttribute(\"type\", \"text/css\") fileref.setAttribute(\"href\", filename) document.getElementsByTagName(\"head\")[0].appendChild(fileref) } loadcssfile(\"https://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css\"); /* Check if jQuery and jQueryUI have been loaded otherwise load with require.js */ var jQuery = window.jQuery, // check for old versions of jQuery oldjQuery = jQuery && !!jQuery.fn.jquery.match(/&#94;1\\.[0-4](\\.|$)/), jquery_path = '', paths = {}, noConflict; var jQueryUI = jQuery.ui; // check for jQuery if (!jQuery || oldjQuery) { // load if it's not available or doesn't meet min standards paths.jQuery = jQuery; noConflict = !!oldjQuery; } else { // register the current jQuery define('jquery', [], function() { return jQuery; }); } if (!jQueryUI) { paths.jQueryUI = jQueryUI_CDN.slice(null, -3); } else { define('jQueryUI', [], function() { return jQuery.ui; }); } paths.underscore = UNDERSCORE_CDN.slice(null, -3); var jquery_require = { paths: paths, shim: { \"jQueryUI\": { exports:\"$\", deps: ['jquery'] }, \"underscore\": { exports: '_' } } } require.config(jquery_require); require([\"jQueryUI\", \"underscore\"], function(jUI, _){ if (noConflict) $.noConflict(true); var vals = values; if (dynamic && vals.constructor === Array) { var default_value = parseFloat(value); var min = parseFloat(vals[0]); var max = parseFloat(vals[vals.length-1]); var wstep = step; var wlabels = [default_value]; var init_label = default_value; } else { var min = 0; if (dynamic) { var max = Object.keys(vals).length - 1; var init_label = labels[value]; var default_value = values[value]; } else { var max = vals.length - 1; var init_label = labels[value]; var default_value = value; } var wstep = 1; var wlabels = labels; } function adjustFontSize(text) { var width_ratio = (text.parent().width()/8)/text.val().length; var size = Math.min(0.9, Math.max(0.6, width_ratio))+'em'; text.css('font-size', size); } var slider = $('#_anim_widget'+id+'_'+dim); slider.slider({ animate: \"fast\", min: min, max: max, step: wstep, value: default_value, dim_vals: vals, dim_labels: wlabels, next_vals: next_vals, slide: function(event, ui) { var vals = slider.slider(\"option\", \"dim_vals\"); var next_vals = slider.slider(\"option\", \"next_vals\"); var dlabels = slider.slider(\"option\", \"dim_labels\"); if (dynamic) { var dim_val = ui.value; if (vals.constructor === Array) { var label = ui.value; } else { var label = dlabels[ui.value]; } } else { var dim_val = vals[ui.value]; var label = dlabels[ui.value]; } var text = $('#textInput'+id+'_'+dim); text.val(label); adjustFontSize(text); HoloViews.index[plot_id].set_frame(dim_val, dim_idx); if (Object.keys(next_vals).length > 0) { var new_vals = next_vals[dim_val]; var next_widget = $('#_anim_widget'+id+'_'+next_dim); update_widget(next_widget, new_vals); } } }); slider.keypress(function(event) { if (event.which == 80 || event.which == 112) { var start = slider.slider(\"option\", \"value\"); var stop = slider.slider(\"option\", \"max\"); for (var i=start; i<=stop; i++) { var delay = i*delay; $.proxy(function doSetTimeout(i) { setTimeout($.proxy(function() { var val = {value:i}; slider.slider('value',i); slider.slider(\"option\", \"slide\")(null, val); }, slider), delay);}, slider)(i); } } if (event.which == 82 || event.which == 114) { var start = slider.slider(\"option\", \"value\"); var stop = slider.slider(\"option\", \"min\"); var count = 0; for (var i=start; i>=stop; i--) { var delay = count*delay; count = count + 1; $.proxy(function doSetTimeout(i) { setTimeout($.proxy(function() { var val = {value:i}; slider.slider('value',i); slider.slider(\"option\", \"slide\")(null, val); }, slider), delay);}, slider)(i); } } }); var textInput = $('#textInput'+id+'_'+dim) textInput.val(init_label); adjustFontSize(textInput); }); } function init_dropdown(id, plot_id, dim, vals, value, next_vals, labels, next_dim, dim_idx, dynamic) { var widget = $(\"#_anim_widget\"+id+'_'+dim); widget.data('values', vals) for (var i=0; i<vals.length; i++){ if (dynamic) { var val = vals[i]; } else { var val = i; } widget.append($(\"<option>\", { value: val, text: labels[i] })); }; widget.data(\"next_vals\", next_vals); widget.val(value); widget.on('change', function(event, ui) { if (dynamic) { var dim_val = parseInt(this.value); } else { var dim_val = $.data(this, 'values')[this.value]; } var next_vals = $.data(this, \"next_vals\"); if (Object.keys(next_vals).length > 0) { var new_vals = next_vals[dim_val]; var next_widget = $('#_anim_widget'+id+'_'+next_dim); update_widget(next_widget, new_vals); } var widgets = HoloViews.index[plot_id] if (widgets) { widgets.set_frame(dim_val, dim_idx); } }); } if (window.HoloViews === undefined) { window.HoloViews = {} window.PyViz = window.HoloViews } else if (window.PyViz === undefined) { window.PyViz = window.HoloViews } var _namespace = { init_slider: init_slider, init_dropdown: init_dropdown, comms: {}, comm_status: {}, index: {}, plot_index: {}, kernels: {}, receivers: {} } for (var k in _namespace) { if (!(k in window.HoloViews)) { window.HoloViews[k] = _namespace[k]; } } var JS_MIME_TYPE = 'application/javascript'; var HTML_MIME_TYPE = 'text/html'; var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json'; var CLASS_NAME = 'output'; /** * Render data to the DOM node */ function render(props, node) { var div = document.createElement(\"div\"); var script = document.createElement(\"script\"); node.appendChild(div); node.appendChild(script); } /** * Handle when a new output is added */ function handle_add_output(event, handle) { var output_area = handle.output_area; var output = handle.output; if (!output.data.hasOwnProperty(EXEC_MIME_TYPE)) { return } var id = output.metadata[EXEC_MIME_TYPE][\"id\"]; var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]); if (id !== undefined) { var nchildren = toinsert.length; toinsert[nchildren-1].children[0].innerHTML = output.data[HTML_MIME_TYPE]; toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE]; output_area._hv_plot_id = id; if ((window.Bokeh !== undefined) && (id in Bokeh.index)) { HoloViews.plot_index[id] = Bokeh.index[id]; } else { HoloViews.plot_index[id] = null; } } } /** * Handle when an output is cleared or removed */ function handle_clear_output(event, handle) { var id = handle.cell.output_area._hv_plot_id; if ((id === undefined) || !(id in HoloViews.plot_index)) { return; } var comm = window.HoloViews.comm_manager.get_client_comm(\"hv-extension-comm\", \"hv-extension-comm\", function () {}); if (comm !== null) { comm.send({event_type: 'delete', 'id': id}); } delete HoloViews.plot_index[id]; if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) { window.Bokeh.index[id].model.document.clear(); delete Bokeh.index[id]; } } /** * Handle kernel restart event */ function handle_kernel_cleanup(event, handle) { delete HoloViews.comms[\"hv-extension-comm\"]; window.HoloViews.plot_index = {} } /** * Handle update_display_data messages */ function handle_update_output(event, handle) { handle_clear_output(event, {cell: {output_area: handle.output_area}}) handle_add_output(event, handle) } function register_renderer(events, OutputArea) { function append_mime(data, metadata, element) { // create a DOM node to render to var toinsert = this.create_output_subarea( metadata, CLASS_NAME, EXEC_MIME_TYPE ); this.keyboard_manager.register_events(toinsert); // Render to node var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]}; render(props, toinsert[0]); element.append(toinsert); return toinsert } events.on('output_added.OutputArea', handle_add_output); events.on('output_updated.OutputArea', handle_update_output); events.on('clear_output.CodeCell', handle_clear_output); events.on('delete.Cell', handle_clear_output); events.on('kernel_ready.Kernel', handle_kernel_cleanup); OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, { safe: true, index: 0 }); } if (window.Jupyter !== undefined) { try { var events = require('base/js/events'); var OutputArea = require('notebook/js/outputarea').OutputArea; if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) { register_renderer(events, OutputArea); } } catch(err) { } } // Define Bokeh specific subclasses function BokehSelectionWidget() { SelectionWidget.apply(this, arguments); } function BokehScrubberWidget() { ScrubberWidget.apply(this, arguments); } // Let them inherit from the baseclasses BokehSelectionWidget.prototype = Object.create(SelectionWidget.prototype); BokehScrubberWidget.prototype = Object.create(ScrubberWidget.prototype); // Define methods to override on widgets var BokehMethods = { update_cache : function(){ for (var index in this.frames) { this.frames[index] = JSON.parse(this.frames[index]); } }, update : function(current){ if (current === undefined) { return; } var data = this.frames[current]; if (data !== undefined) { if (data.root in HoloViews.plot_index) { var doc = HoloViews.plot_index[data.root].model.document; } else { var doc = Bokeh.index[data.root].model.document; } doc.apply_json_patch(data.content); } }, init_comms: function() { if (Bokeh.protocol !== undefined) { this.receiver = new Bokeh.protocol.Receiver() } else { this.receiver = null; } return HoloViewsWidget.prototype.init_comms.call(this); }, process_msg : function(msg) { if (this.plot_id in HoloViews.plot_index) { var doc = HoloViews.plot_index[this.plot_id].model.document; } else { var doc = Bokeh.index[this.plot_id].model.document; } if (this.receiver === null) { return } var receiver = this.receiver; if (msg.buffers.length > 0) { receiver.consume(msg.buffers[0].buffer) } else { receiver.consume(msg.content.data) } const comm_msg = receiver.message; if ((comm_msg != null) && (doc != null)) { doc.apply_json_patch(comm_msg.content, comm_msg.buffers) } } } // Extend Bokeh widgets with backend specific methods extend(BokehSelectionWidget.prototype, BokehMethods); extend(BokehScrubberWidget.prototype, BokehMethods); window.HoloViews.BokehSelectionWidget = BokehSelectionWidget window.HoloViews.BokehScrubberWidget = BokehScrubberWidget function JupyterCommManager() { } JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) { if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) { var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager; comm_manager.register_target(comm_id, function(comm) { comm.on_msg(msg_handler); }); } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) { window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) { comm.onMsg = msg_handler; }); } } JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) { if (comm_id in window.PyViz.comms) { return window.PyViz.comms[comm_id]; } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) { var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager; var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id); if (msg_handler) { comm.on_msg(msg_handler); } } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) { var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id); comm.open(); if (msg_handler) { comm.onMsg = msg_handler; } } window.PyViz.comms[comm_id] = comm; return comm; } window.PyViz.comm_manager = new JupyterCommManager(); Holoviews verion: 1.10.7 In [8]: df = pd . read_csv ( 'stress_strain_data.csv' , sep = ',' , header = None , skiprows = 0 ) df . columns = [ 'strain' , 'stress' ] holoviews_curve = hv . Curve ( df ) # to export and read in the .html for display in this blog # Define the holoviews renderer object renderer = hv . renderer ( 'bokeh' ) # Convert holoviews renderer to bokeh figure then save using bokeh bokeh_plot = renderer . get_plot ( holoviews_curve ) . state # Export bokeh plot .html from bokeh.io import output_file , show output_file ( 'bokeh_plot_from_holoviews.html' , ) show ( bokeh_plot ) # Show the .html in the jupyter notebook from IPython.core.display import HTML HTML ( 'bokeh_plot_from_holoviews.html' ) INFO:bokeh.io.state:Session output file 'bokeh_plot_from_holoviews.html' already exists, will be overwritten. var element = $('#79b532f7-2d3b-4041-a18d-d3b0f454ee3c'); (function(root) { function embed_document(root) { var docs_json = {\"627c7d81-46b5-4421-b7e5-39a6ad0b36e6\":{\"roots\":{\"references\":[{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#30a2da\",\"line_width\":2,\"x\":{\"field\":\"strain\"},\"y\":{\"field\":\"stress\"}},\"id\":\"eda73851-4318-4f05-a82a-8b9d70401e24\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"e0838111-5690-450a-9cff-2eedab72ef10\",\"type\":\"BasicTicker\"},{\"attributes\":{\"dimension\":1,\"grid_line_color\":{\"value\":null},\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"e0838111-5690-450a-9cff-2eedab72ef10\",\"type\":\"BasicTicker\"}},\"id\":\"e17358aa-b37b-4fdc-898e-c3afe6851c3c\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"691fd9dc-6c36-49fd-a20f-c5668e840f8e\",\"type\":\"ResetTool\"},{\"attributes\":{},\"id\":\"e9ad8b60-9d04-48b2-a84c-0383750f6002\",\"type\":\"Selection\"},{\"attributes\":{\"axis_label\":\"stress\",\"bounds\":\"auto\",\"formatter\":{\"id\":\"817e50fc-a02e-462f-8611-d75b47c86c6d\",\"type\":\"BasicTickFormatter\"},\"major_label_orientation\":\"horizontal\",\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"e0838111-5690-450a-9cff-2eedab72ef10\",\"type\":\"BasicTicker\"}},\"id\":\"a927b865-9688-47f6-9450-07330c900060\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"36d89b7e-a2b0-48f2-b6e5-8808b183a5e2\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"below\":[{\"id\":\"c694cbb0-8973-4d39-9ed0-b2f11e1335f4\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"a927b865-9688-47f6-9450-07330c900060\",\"type\":\"LinearAxis\"}],\"min_border_bottom\":10,\"min_border_left\":10,\"min_border_right\":10,\"min_border_top\":10,\"plot_height\":300,\"plot_width\":300,\"renderers\":[{\"id\":\"c694cbb0-8973-4d39-9ed0-b2f11e1335f4\",\"type\":\"LinearAxis\"},{\"id\":\"39ea69e9-5ab6-4507-85ff-6c4911901499\",\"type\":\"Grid\"},{\"id\":\"a927b865-9688-47f6-9450-07330c900060\",\"type\":\"LinearAxis\"},{\"id\":\"e17358aa-b37b-4fdc-898e-c3afe6851c3c\",\"type\":\"Grid\"},{\"id\":\"685888e1-833f-4c93-85de-bb1f43c3f8a0\",\"type\":\"BoxAnnotation\"},{\"id\":\"01c84ce7-7764-42a8-ade9-a8c49d1b072e\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"708428c0-f4ee-4f6b-946a-e8cae6acc91f\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"25044781-8d82-47d8-bcd7-c98044b8ac12\",\"type\":\"Toolbar\"},\"x_range\":{\"id\":\"f3de3a0b-0a53-4717-b28b-7bb80944826c\",\"type\":\"Range1d\"},\"x_scale\":{\"id\":\"2ad1baf4-d751-4e9d-b3af-3bd50a3edc53\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"ba435adf-a8f0-4c76-ada6-955e614927ee\",\"type\":\"Range1d\"},\"y_scale\":{\"id\":\"ae1a7899-1608-43a7-b9fa-b485492496e4\",\"type\":\"LinearScale\"}},\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"callback\":null,\"end\":0.14681,\"reset_end\":0.14681,\"reset_start\":0.0},\"id\":\"f3de3a0b-0a53-4717-b28b-7bb80944826c\",\"type\":\"Range1d\"},{\"attributes\":{\"grid_line_color\":{\"value\":null},\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"6c91d09d-b090-4da2-9dbc-c7d658241194\",\"type\":\"BasicTicker\"}},\"id\":\"39ea69e9-5ab6-4507-85ff-6c4911901499\",\"type\":\"Grid\"},{\"attributes\":{\"source\":{\"id\":\"c8870bd1-69b8-4b76-81d1-80d1f3b7cef6\",\"type\":\"ColumnDataSource\"}},\"id\":\"53ca1dd0-243a-4aaa-9f3b-60a8ac86b05c\",\"type\":\"CDSView\"},{\"attributes\":{\"callback\":null,\"end\":413.5,\"reset_end\":413.5,\"reset_start\":0.0},\"id\":\"ba435adf-a8f0-4c76-ada6-955e614927ee\",\"type\":\"Range1d\"},{\"attributes\":{\"bottom_units\":\"screen\",\"fill_alpha\":{\"value\":0.5},\"fill_color\":{\"value\":\"lightgrey\"},\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":{\"value\":1.0},\"line_color\":{\"value\":\"black\"},\"line_dash\":[4,4],\"line_width\":{\"value\":2},\"plot\":null,\"render_mode\":\"css\",\"right_units\":\"screen\",\"top_units\":\"screen\"},\"id\":\"685888e1-833f-4c93-85de-bb1f43c3f8a0\",\"type\":\"BoxAnnotation\"},{\"attributes\":{},\"id\":\"d7d8be39-417a-4a53-853e-db87e7ce4a29\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#30a2da\",\"line_width\":2,\"x\":{\"field\":\"strain\"},\"y\":{\"field\":\"stress\"}},\"id\":\"8ac22cbc-998b-48f3-b7c4-6d4ae591adf1\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"83b48fcf-2c45-4f3b-b2a5-f85f34b58818\",\"type\":\"PanTool\"},{\"attributes\":{},\"id\":\"817e50fc-a02e-462f-8611-d75b47c86c6d\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"e21c3a3b-71b2-4836-bfd3-141c9589f585\",\"type\":\"SaveTool\"},{\"attributes\":{\"plot\":null,\"text\":\"\",\"text_color\":{\"value\":\"black\"},\"text_font_size\":{\"value\":\"12pt\"}},\"id\":\"708428c0-f4ee-4f6b-946a-e8cae6acc91f\",\"type\":\"Title\"},{\"attributes\":{},\"id\":\"dc05a4af-f37a-4d41-840a-bd004bb3ae1b\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"line_color\":\"#30a2da\",\"line_width\":2,\"x\":{\"field\":\"strain\"},\"y\":{\"field\":\"stress\"}},\"id\":\"3176d184-f57a-4aa2-9dc7-cbe0043f0a4a\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"2ad1baf4-d751-4e9d-b3af-3bd50a3edc53\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"6c91d09d-b090-4da2-9dbc-c7d658241194\",\"type\":\"BasicTicker\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_multi\":null,\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"e21c3a3b-71b2-4836-bfd3-141c9589f585\",\"type\":\"SaveTool\"},{\"id\":\"83b48fcf-2c45-4f3b-b2a5-f85f34b58818\",\"type\":\"PanTool\"},{\"id\":\"dc05a4af-f37a-4d41-840a-bd004bb3ae1b\",\"type\":\"WheelZoomTool\"},{\"id\":\"6af222fe-c474-4788-b4ad-1a296f8e6e92\",\"type\":\"BoxZoomTool\"},{\"id\":\"691fd9dc-6c36-49fd-a20f-c5668e840f8e\",\"type\":\"ResetTool\"}]},\"id\":\"25044781-8d82-47d8-bcd7-c98044b8ac12\",\"type\":\"Toolbar\"},{\"attributes\":{\"overlay\":{\"id\":\"685888e1-833f-4c93-85de-bb1f43c3f8a0\",\"type\":\"BoxAnnotation\"}},\"id\":\"6af222fe-c474-4788-b4ad-1a296f8e6e92\",\"type\":\"BoxZoomTool\"},{\"attributes\":{\"data_source\":{\"id\":\"c8870bd1-69b8-4b76-81d1-80d1f3b7cef6\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"3176d184-f57a-4aa2-9dc7-cbe0043f0a4a\",\"type\":\"Line\"},\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"eda73851-4318-4f05-a82a-8b9d70401e24\",\"type\":\"Line\"},\"nonselection_glyph\":{\"id\":\"8ac22cbc-998b-48f3-b7c4-6d4ae591adf1\",\"type\":\"Line\"},\"selection_glyph\":null,\"view\":{\"id\":\"53ca1dd0-243a-4aaa-9f3b-60a8ac86b05c\",\"type\":\"CDSView\"}},\"id\":\"01c84ce7-7764-42a8-ade9-a8c49d1b072e\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"axis_label\":\"strain\",\"bounds\":\"auto\",\"formatter\":{\"id\":\"d7d8be39-417a-4a53-853e-db87e7ce4a29\",\"type\":\"BasicTickFormatter\"},\"major_label_orientation\":\"horizontal\",\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"6c91d09d-b090-4da2-9dbc-c7d658241194\",\"type\":\"BasicTicker\"}},\"id\":\"c694cbb0-8973-4d39-9ed0-b2f11e1335f4\",\"type\":\"LinearAxis\"},{\"attributes\":{\"callback\":null,\"data\":{\"strain\":{\"__ndarray__\":\"AAAAAAAAAACZbisgYdZDP9fl7zkL1lM/Og7NhkbBXT9dsAqK1dVjPwl6XuCoy2g/Og7NhkbBbT/za5DujFtxP1Ab1elA1nM/45rxbEVRdj8+SjZo+ct4PyLElbN3Rns/Og7NhkbBfT/M3ghB/R2AP6nHEcaqnIE/FOl+TkF+hj+12sNeKGCLP1TjpZvEIJA/TdnpB3WRkj8dUgyQaAKVPxdIUPwYc5c/ED6UaMnjmT/htrbwvFScP9qs+lxtxZ4/1ZKOcjCboD/SjbCoiNOhP86I0t7gC6M/NsXjolpEpD80wAXZsnylP5z8Fp0staY/mPc404Ttpz8BNEqX/iWpP+AM/n4xW6o/3gcgtYmTqz9GRDF5A8ysP0I/U69bBK4/q3tkc9U8rz9UO8PUljqwP4jZy7bT1rA/Btfc0f9ysT+F1O3sKw+yP7hy9s5oq7I/N3AH6pRHsz9rDhDM0eOzP+kLIef9f7Q/aAkyAioctT+cpzrkZri1PxqlS/+SVLY/TkNU4c/wtj/NQGX8+4y3P0s+dhcoKbg/f9x++WTFuD/+2Y8UkWG5P+cYkL3e/bk/QzS6g9iZuj+8lpAPeja7PxiyutVz0rs/dM3km21uvD/sL7snDwu9P0hL5e0Ip70/pWYPtAJDvj8dyeU/pN++P3nkDwaee78/6/8c5ssLwD8nMQisHFrAP9U+HY8ZqMA/g0wychb2wD+/fR04Z0TBP22LMhtkksE/G5lH/mDgwT9YyjLEsS7CPwbYR6eufMI/tOVciqvKwj8=\",\"dtype\":\"float64\",\"shape\":[73]},\"stress\":{\"__ndarray__\":\"AAAAAAAAAAANAiuHFulFQBFYObTIllJA7FG4HoU7WkC4HoXrUTBhQArXo3A9MmVA7FG4HoV7aEBSuB6F60lqQD0K16NwTWtAFK5H4XoEbEAzMzMzM5tsQK5H4XoUHm1APQrXo3CVbUBmZmZmZv5tQKRwPQrXc25Aw/UoXI/Kb0CF61G4Hn1wQI/C9ShcC3FAAAAAAACQcUBSuB6F6w1yQDMzMzMzg3JAzczMzMz0ckDsUbgehV9zQD0K16NwxXNAKVyPwvUkdEBcj8L1KIB0QJqZmZmZ1XRAMzMzMzMndUDXo3A9CnN1QAAAAAAAvHVApHA9Ctf/dUBxPQrXo0B2QKRwPQrXe3ZAPQrXo3C1dkA9CtejcOl2QEjhehSuG3dA7FG4HoVLd0C4HoXrUXh3QClcj8L1oHdAcT0K16PId0A9CtejcO13QK5H4XoUEnhA16NwPQozeEAzMzMzM1N4QAAAAAAAcHhArkfhehSOeEBI4XoUrqd4QK5H4XoUwnhApHA9CtfbeEDD9Shcj/J4QLgehetRCHlAPQrXo3AdeUCkcD0K1y95QM3MzMzMRHlASOF6FK5XeUDsUbgehWd5QGZmZmZmdnlACtejcD2GeUAzMzMzM5N5QBSuR+F6oHlAj8L1KFyreUD2KFyPwrV5QGZmZmZmvnlA7FG4HoXHeUCF61G4Hs15QHsUrkfh0nlAexSuR+HWeUAAAAAAANh5QDMzMzMz03lApHA9CtfHeUDD9Shcj6Z5QOxRuB6FN3lAexSuR+Gyd0A=\",\"dtype\":\"float64\",\"shape\":[73]}},\"selected\":{\"id\":\"e9ad8b60-9d04-48b2-a84c-0383750f6002\",\"type\":\"Selection\"},\"selection_policy\":{\"id\":\"36d89b7e-a2b0-48f2-b6e5-8808b183a5e2\",\"type\":\"UnionRenderers\"}},\"id\":\"c8870bd1-69b8-4b76-81d1-80d1f3b7cef6\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"ae1a7899-1608-43a7-b9fa-b485492496e4\",\"type\":\"LinearScale\"}],\"root_ids\":[\"fbf27777-9025-403e-84cb-281108f37aab\"]},\"title\":\"Bokeh Application\",\"version\":\"0.13.0\"}}; var render_items = [{\"docid\":\"627c7d81-46b5-4421-b7e5-39a6ad0b36e6\",\"roots\":{\"fbf27777-9025-403e-84cb-281108f37aab\":\"a29189bc-5674-4cd4-ad99-47afc0f521ac\"}}]; root.Bokeh.embed.embed_items_notebook(docs_json, render_items); } if (root.Bokeh !== undefined) { embed_document(root); } else { var attempts = 0; var timer = setInterval(function(root) { if (root.Bokeh !== undefined) { embed_document(root); clearInterval(timer); } attempts++; if (attempts > 100) { console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\") clearInterval(timer); } }, 10, root) } })(window); Out[8]: Bokeh Plot Bokeh.set_log_level(\"info\"); {\"55ec18c4-c2db-4215-8df7-fb00b29e4558\":{\"roots\":{\"references\":[{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#30a2da\",\"line_width\":2,\"x\":{\"field\":\"strain\"},\"y\":{\"field\":\"stress\"}},\"id\":\"eda73851-4318-4f05-a82a-8b9d70401e24\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"e0838111-5690-450a-9cff-2eedab72ef10\",\"type\":\"BasicTicker\"},{\"attributes\":{\"dimension\":1,\"grid_line_color\":{\"value\":null},\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"e0838111-5690-450a-9cff-2eedab72ef10\",\"type\":\"BasicTicker\"}},\"id\":\"e17358aa-b37b-4fdc-898e-c3afe6851c3c\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"691fd9dc-6c36-49fd-a20f-c5668e840f8e\",\"type\":\"ResetTool\"},{\"attributes\":{},\"id\":\"e9ad8b60-9d04-48b2-a84c-0383750f6002\",\"type\":\"Selection\"},{\"attributes\":{\"axis_label\":\"stress\",\"bounds\":\"auto\",\"formatter\":{\"id\":\"817e50fc-a02e-462f-8611-d75b47c86c6d\",\"type\":\"BasicTickFormatter\"},\"major_label_orientation\":\"horizontal\",\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"e0838111-5690-450a-9cff-2eedab72ef10\",\"type\":\"BasicTicker\"}},\"id\":\"a927b865-9688-47f6-9450-07330c900060\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"36d89b7e-a2b0-48f2-b6e5-8808b183a5e2\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"below\":[{\"id\":\"c694cbb0-8973-4d39-9ed0-b2f11e1335f4\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"a927b865-9688-47f6-9450-07330c900060\",\"type\":\"LinearAxis\"}],\"min_border_bottom\":10,\"min_border_left\":10,\"min_border_right\":10,\"min_border_top\":10,\"plot_height\":300,\"plot_width\":300,\"renderers\":[{\"id\":\"c694cbb0-8973-4d39-9ed0-b2f11e1335f4\",\"type\":\"LinearAxis\"},{\"id\":\"39ea69e9-5ab6-4507-85ff-6c4911901499\",\"type\":\"Grid\"},{\"id\":\"a927b865-9688-47f6-9450-07330c900060\",\"type\":\"LinearAxis\"},{\"id\":\"e17358aa-b37b-4fdc-898e-c3afe6851c3c\",\"type\":\"Grid\"},{\"id\":\"685888e1-833f-4c93-85de-bb1f43c3f8a0\",\"type\":\"BoxAnnotation\"},{\"id\":\"01c84ce7-7764-42a8-ade9-a8c49d1b072e\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"708428c0-f4ee-4f6b-946a-e8cae6acc91f\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"25044781-8d82-47d8-bcd7-c98044b8ac12\",\"type\":\"Toolbar\"},\"x_range\":{\"id\":\"f3de3a0b-0a53-4717-b28b-7bb80944826c\",\"type\":\"Range1d\"},\"x_scale\":{\"id\":\"2ad1baf4-d751-4e9d-b3af-3bd50a3edc53\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"ba435adf-a8f0-4c76-ada6-955e614927ee\",\"type\":\"Range1d\"},\"y_scale\":{\"id\":\"ae1a7899-1608-43a7-b9fa-b485492496e4\",\"type\":\"LinearScale\"}},\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"callback\":null,\"end\":0.14681,\"reset_end\":0.14681,\"reset_start\":0.0},\"id\":\"f3de3a0b-0a53-4717-b28b-7bb80944826c\",\"type\":\"Range1d\"},{\"attributes\":{\"grid_line_color\":{\"value\":null},\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"6c91d09d-b090-4da2-9dbc-c7d658241194\",\"type\":\"BasicTicker\"}},\"id\":\"39ea69e9-5ab6-4507-85ff-6c4911901499\",\"type\":\"Grid\"},{\"attributes\":{\"source\":{\"id\":\"c8870bd1-69b8-4b76-81d1-80d1f3b7cef6\",\"type\":\"ColumnDataSource\"}},\"id\":\"53ca1dd0-243a-4aaa-9f3b-60a8ac86b05c\",\"type\":\"CDSView\"},{\"attributes\":{\"callback\":null,\"end\":413.5,\"reset_end\":413.5,\"reset_start\":0.0},\"id\":\"ba435adf-a8f0-4c76-ada6-955e614927ee\",\"type\":\"Range1d\"},{\"attributes\":{\"bottom_units\":\"screen\",\"fill_alpha\":{\"value\":0.5},\"fill_color\":{\"value\":\"lightgrey\"},\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":{\"value\":1.0},\"line_color\":{\"value\":\"black\"},\"line_dash\":[4,4],\"line_width\":{\"value\":2},\"plot\":null,\"render_mode\":\"css\",\"right_units\":\"screen\",\"top_units\":\"screen\"},\"id\":\"685888e1-833f-4c93-85de-bb1f43c3f8a0\",\"type\":\"BoxAnnotation\"},{\"attributes\":{},\"id\":\"d7d8be39-417a-4a53-853e-db87e7ce4a29\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#30a2da\",\"line_width\":2,\"x\":{\"field\":\"strain\"},\"y\":{\"field\":\"stress\"}},\"id\":\"8ac22cbc-998b-48f3-b7c4-6d4ae591adf1\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"83b48fcf-2c45-4f3b-b2a5-f85f34b58818\",\"type\":\"PanTool\"},{\"attributes\":{},\"id\":\"817e50fc-a02e-462f-8611-d75b47c86c6d\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"e21c3a3b-71b2-4836-bfd3-141c9589f585\",\"type\":\"SaveTool\"},{\"attributes\":{\"plot\":null,\"text\":\"\",\"text_color\":{\"value\":\"black\"},\"text_font_size\":{\"value\":\"12pt\"}},\"id\":\"708428c0-f4ee-4f6b-946a-e8cae6acc91f\",\"type\":\"Title\"},{\"attributes\":{},\"id\":\"dc05a4af-f37a-4d41-840a-bd004bb3ae1b\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"line_color\":\"#30a2da\",\"line_width\":2,\"x\":{\"field\":\"strain\"},\"y\":{\"field\":\"stress\"}},\"id\":\"3176d184-f57a-4aa2-9dc7-cbe0043f0a4a\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"2ad1baf4-d751-4e9d-b3af-3bd50a3edc53\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"6c91d09d-b090-4da2-9dbc-c7d658241194\",\"type\":\"BasicTicker\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_multi\":null,\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"e21c3a3b-71b2-4836-bfd3-141c9589f585\",\"type\":\"SaveTool\"},{\"id\":\"83b48fcf-2c45-4f3b-b2a5-f85f34b58818\",\"type\":\"PanTool\"},{\"id\":\"dc05a4af-f37a-4d41-840a-bd004bb3ae1b\",\"type\":\"WheelZoomTool\"},{\"id\":\"6af222fe-c474-4788-b4ad-1a296f8e6e92\",\"type\":\"BoxZoomTool\"},{\"id\":\"691fd9dc-6c36-49fd-a20f-c5668e840f8e\",\"type\":\"ResetTool\"}]},\"id\":\"25044781-8d82-47d8-bcd7-c98044b8ac12\",\"type\":\"Toolbar\"},{\"attributes\":{\"overlay\":{\"id\":\"685888e1-833f-4c93-85de-bb1f43c3f8a0\",\"type\":\"BoxAnnotation\"}},\"id\":\"6af222fe-c474-4788-b4ad-1a296f8e6e92\",\"type\":\"BoxZoomTool\"},{\"attributes\":{\"data_source\":{\"id\":\"c8870bd1-69b8-4b76-81d1-80d1f3b7cef6\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"3176d184-f57a-4aa2-9dc7-cbe0043f0a4a\",\"type\":\"Line\"},\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"eda73851-4318-4f05-a82a-8b9d70401e24\",\"type\":\"Line\"},\"nonselection_glyph\":{\"id\":\"8ac22cbc-998b-48f3-b7c4-6d4ae591adf1\",\"type\":\"Line\"},\"selection_glyph\":null,\"view\":{\"id\":\"53ca1dd0-243a-4aaa-9f3b-60a8ac86b05c\",\"type\":\"CDSView\"}},\"id\":\"01c84ce7-7764-42a8-ade9-a8c49d1b072e\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"axis_label\":\"strain\",\"bounds\":\"auto\",\"formatter\":{\"id\":\"d7d8be39-417a-4a53-853e-db87e7ce4a29\",\"type\":\"BasicTickFormatter\"},\"major_label_orientation\":\"horizontal\",\"plot\":{\"id\":\"fbf27777-9025-403e-84cb-281108f37aab\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"6c91d09d-b090-4da2-9dbc-c7d658241194\",\"type\":\"BasicTicker\"}},\"id\":\"c694cbb0-8973-4d39-9ed0-b2f11e1335f4\",\"type\":\"LinearAxis\"},{\"attributes\":{\"callback\":null,\"data\":{\"strain\":{\"__ndarray__\":\"AAAAAAAAAACZbisgYdZDP9fl7zkL1lM/Og7NhkbBXT9dsAqK1dVjPwl6XuCoy2g/Og7NhkbBbT/za5DujFtxP1Ab1elA1nM/45rxbEVRdj8+SjZo+ct4PyLElbN3Rns/Og7NhkbBfT/M3ghB/R2AP6nHEcaqnIE/FOl+TkF+hj+12sNeKGCLP1TjpZvEIJA/TdnpB3WRkj8dUgyQaAKVPxdIUPwYc5c/ED6UaMnjmT/htrbwvFScP9qs+lxtxZ4/1ZKOcjCboD/SjbCoiNOhP86I0t7gC6M/NsXjolpEpD80wAXZsnylP5z8Fp0staY/mPc404Ttpz8BNEqX/iWpP+AM/n4xW6o/3gcgtYmTqz9GRDF5A8ysP0I/U69bBK4/q3tkc9U8rz9UO8PUljqwP4jZy7bT1rA/Btfc0f9ysT+F1O3sKw+yP7hy9s5oq7I/N3AH6pRHsz9rDhDM0eOzP+kLIef9f7Q/aAkyAioctT+cpzrkZri1PxqlS/+SVLY/TkNU4c/wtj/NQGX8+4y3P0s+dhcoKbg/f9x++WTFuD/+2Y8UkWG5P+cYkL3e/bk/QzS6g9iZuj+8lpAPeja7PxiyutVz0rs/dM3km21uvD/sL7snDwu9P0hL5e0Ip70/pWYPtAJDvj8dyeU/pN++P3nkDwaee78/6/8c5ssLwD8nMQisHFrAP9U+HY8ZqMA/g0wychb2wD+/fR04Z0TBP22LMhtkksE/G5lH/mDgwT9YyjLEsS7CPwbYR6eufMI/tOVciqvKwj8=\",\"dtype\":\"float64\",\"shape\":[73]},\"stress\":{\"__ndarray__\":\"AAAAAAAAAAANAiuHFulFQBFYObTIllJA7FG4HoU7WkC4HoXrUTBhQArXo3A9MmVA7FG4HoV7aEBSuB6F60lqQD0K16NwTWtAFK5H4XoEbEAzMzMzM5tsQK5H4XoUHm1APQrXo3CVbUBmZmZmZv5tQKRwPQrXc25Aw/UoXI/Kb0CF61G4Hn1wQI/C9ShcC3FAAAAAAACQcUBSuB6F6w1yQDMzMzMzg3JAzczMzMz0ckDsUbgehV9zQD0K16NwxXNAKVyPwvUkdEBcj8L1KIB0QJqZmZmZ1XRAMzMzMzMndUDXo3A9CnN1QAAAAAAAvHVApHA9Ctf/dUBxPQrXo0B2QKRwPQrXe3ZAPQrXo3C1dkA9CtejcOl2QEjhehSuG3dA7FG4HoVLd0C4HoXrUXh3QClcj8L1oHdAcT0K16PId0A9CtejcO13QK5H4XoUEnhA16NwPQozeEAzMzMzM1N4QAAAAAAAcHhArkfhehSOeEBI4XoUrqd4QK5H4XoUwnhApHA9CtfbeEDD9Shcj/J4QLgehetRCHlAPQrXo3AdeUCkcD0K1y95QM3MzMzMRHlASOF6FK5XeUDsUbgehWd5QGZmZmZmdnlACtejcD2GeUAzMzMzM5N5QBSuR+F6oHlAj8L1KFyreUD2KFyPwrV5QGZmZmZmvnlA7FG4HoXHeUCF61G4Hs15QHsUrkfh0nlAexSuR+HWeUAAAAAAANh5QDMzMzMz03lApHA9CtfHeUDD9Shcj6Z5QOxRuB6FN3lAexSuR+Gyd0A=\",\"dtype\":\"float64\",\"shape\":[73]}},\"selected\":{\"id\":\"e9ad8b60-9d04-48b2-a84c-0383750f6002\",\"type\":\"Selection\"},\"selection_policy\":{\"id\":\"36d89b7e-a2b0-48f2-b6e5-8808b183a5e2\",\"type\":\"UnionRenderers\"}},\"id\":\"c8870bd1-69b8-4b76-81d1-80d1f3b7cef6\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"ae1a7899-1608-43a7-b9fa-b485492496e4\",\"type\":\"LinearScale\"}],\"root_ids\":[\"fbf27777-9025-403e-84cb-281108f37aab\"]},\"title\":\"Bokeh Application\",\"version\":\"0.13.0\"}} (function() { var fn = function() { Bokeh.safely(function() { (function(root) { function embed_document(root) { var docs_json = document.getElementById('9be700ee-dadb-480b-9bf1-23024a2b6a07').textContent; var render_items = [{\"docid\":\"55ec18c4-c2db-4215-8df7-fb00b29e4558\",\"roots\":{\"fbf27777-9025-403e-84cb-281108f37aab\":\"54df6a4f-d863-4018-9c36-491cdae73ee5\"}}]; root.Bokeh.embed.embed_items(docs_json, render_items); } if (root.Bokeh !== undefined) { embed_document(root); } else { var attempts = 0; var timer = setInterval(function(root) { if (root.Bokeh !== undefined) { embed_document(root); clearInterval(timer); } attempts++; if (attempts > 100) { console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\") clearInterval(timer); } }, 10, root) } })(window); }); }; if (document.readyState != \"loading\") fn(); else document.addEventListener(\"DOMContentLoaded\", fn); })(); Summary We plotted the same stress stain curve using four different Python plotting libraries: Pandas, Matplotlib, Altair and Bokeh( with Holoviews). Each library has it's strength. The Pandas plot was the quickest. And becuase we used pandas to import the .csv file, we were using Pandas already. Matplotlib is the most widley used Python plotting library and has the most examples to learn from. Matplotlib also has a ton of customization options. Compated to Matplotlib, Altair is a much newer library. Accoding to the Altair docs, \"Altair's API is simple, friendly and consistent\". I have less experience with Altair and it is currently more work for me to build a plot with Altair than with Matplotlib. I do like the opions to save Altair plots using the menu that comes up next to the plot. I don't have a use case to use the Vega editor option, but it is kind of neat. Bokeh plots require quite a bit of code, but the plots which are created look good and have responsive tools included. For a web-based plot, Bokeh is hard to beat. Holoviews provides a nice wrapper around Bokeh that makes using Bokeh a lot easier. Besides these four libraries, there are other plotting options in the Python ecosystem such as seaborn, plotly, gglot, pygal, and dash. Happy Plotting!","tags":"Plotting","url":"stress-strain-curve-with-4-libraries.html","loc":"stress-strain-curve-with-4-libraries.html"},{"title":"Plotting Histograms with matplotlib and Python","text":"Histograms are a useful type of statistics plot for engineers. A histogram is a type of bar plot that shows the frequency or number of values compared to a set of value ranges. Histogram plots can be created with Python and the plotting package matplotlib . The plt.hist() function creates histogram plots. Before matplotlib can be used, matplotlib must first be installed. To install matplotlib open the Anaconda Prompt (or use a terminal and pip ) and type: > conda install matplotlib or $ pip install matplotlib If you are using the Anaconda distribution of Python, matplotlib is already installed. To create a histogram with matplotlib , first import matplotlib with the standard line: import matplotlib.pyplot as plt The alias plt is commonly used for matplotlib's pyplot library and will look familiar to other programmers. In our first example, we will also import numpy with the line import numpy as np . We'll use numpy's random number generator to create a dataset for us to plot. If using a Jupyter notebook, include the line %matplotlib inline below the imports. In [1]: import matplotlib.pyplot as plt import numpy as np # if using a Jupyter notebook, includue: % matplotlib inline For our dataset, let's define a mean (average) mu = 80 and a standard deviation (spread) sigma = 7 . Then we'll use numpy's np.random.normal() function to produce an array of random numbers with a normal distribution. 200 random numbers is a sufficient quantity to plot. The general format of the np.random.normal() function is below: var = np . random . normal ( mean , stdev , size =< number of values > ) In [2]: mu = 80 sigma = 7 x = np . random . normal ( mu , sigma , size = 200 ) Matplotlib's plt.hist() function produces histogram plots. The first positional argument passed to plt.hist() is a list or array of values, the second positional argument denotes the number of bins on the histogram. plt . hist ( values , num_bins ) Similar to matplotlib line plots, bar plots and pie charts, a set of keyword arguments can be included in the plt.hist() function call. Specifying values for the keyword arguments customizes the histogram. Some keyword arguments we can use with plt.hist() are: density= histtype= facecolor= alpha= (opacity). In [3]: plt . hist ( x , 20 , density = True , histtype = 'bar' , facecolor = 'b' , alpha = 0.5 ) plt . show () Our next histogram example involves a list of commute times. Suppose the following commute times were recorded in a survey: 23, 25, 40, 35, 36, 47, 33, 28, 48, 34, 20, 37, 36, 23, 33, 36, 20, 27, 50, 34, 47, 18, 28, 52, 21, 44, 34, 13, 40, 49 Let's plot a histogram of these commute times. First, import matplotlib as in the previous example, and include %matplotib inline if using a Jupyter notebook. Then build a Python list of commute times from the survey data above. In [4]: import matplotlib.pyplot as plt # if using a Jupyter notebook, include: % matplotlib inline commute_times = [ 23 , 25 , 40 , 35 , 36 , 47 , 33 , 28 , 48 , 34 , 20 , 37 , 36 , 23 , 33 , 36 , 20 , 27 , 50 , 34 , 47 , 18 , 28 , 52 , 21 , 44 , 34 , 13 , 40 , 49 ] Now we'll call plt.hist() and include our commute_times list and specify 5 bins. In [5]: plt . hist ( commute_times , 5 ) plt . show () If we want our bins to have specific bin ranges, we can specify a list or array of bin edges in the keyword argument bins= . Let's also add some axis labels and a title to the histogram. A table of some keyword arguments used with plt.hist() is below: keyword argument description example bins= list of bin edges bins=[5, 10, 20, 30] density= if true , data is normalized density=false histtype= type of histogram: bar, stacked, step or step-filled histtype='bar' color= bar color color='b' edgecolor= bar edge color color='k' alpha= bar opacity alpha=0.5 Let's specify our bins in 15 min increments. This means our bin edges are [0,15,30,45,60] . We'll also specify density=False , color='b' (blue), edgecolor='k' (black), and alpha=0.5 (half transparent). The lines plt.xlabel() , plt.ylabel() , and plt.title() give our histogram axis labels and a title. plt.xticks() defines the location of the x-axis tick labels. If the bins are spaced out at 15 minute intervals, it makes sense to label the x-axis at these same intervals. In [6]: bin_edges = [ 0 , 15 , 30 , 45 , 60 ] plt . hist ( commute_times , bins = bin_edges , density = False , histtype = 'bar' , color = 'b' , edgecolor = 'k' , alpha = 0.5 ) plt . xlabel ( 'Commute time (min)' ) plt . xticks ([ 0 , 15 , 30 , 45 , 60 ]) plt . ylabel ( 'Number of commuters' ) plt . title ( 'Histogram of commute times' ) plt . show () Summary In this post we built two histograms with the matplotlib plotting package and Python. The first histogram contained an array of random numbers with a normal distribution. The second histogram was constructed from a list of commute times. The plt.hist() function takes a number of keyword arguments that allows us to customize the histogram.","tags":"matplotlib","url":"histogram-plots-with-matplotlib-and-python.html","loc":"histogram-plots-with-matplotlib-and-python.html"},{"title":"Statistics in Python using the statistics module","text":"In this post, we'll look at a couple of statistics functions in Python. These statistics functions are part of the Python Standard Library in the statistics module. The four functions we'll use in this post are common in statistics: mean - average value median - middle value mode - most often value standard deviation - spread of values To access Python's statistics functions, we need to import the functions from the statistics module using the statement: from statistics import mean , median , mode , stdev After the import statement, the functions mean() , median() , mode() and stdev() (standard deviation) can be used. Since the statistics module is part of the Python Standard Library, no external packages need to be installed. Let's imagine we have a data set of 5 test scores. The test scores are 60 , 83 , 91 and 100 . These test scores can be stored in a Python list. Python lists are defined with square brackets [ ] . Elements in Python lists are separated with commas. In [1]: from statistics import mean , median , mode , stdev test_scores = [ 60 , 83 , 83 , 91 , 100 ] Calculate the mean To calculate the mean, or average of our test scores, use the statistics module's mean() function. In [2]: mean ( test_scores ) Out[2]: 83.4 Calculate the median To calculate the median, or middle value of our test scores, use the statistics module's median() function. If there are an odd number of values, median() returns the middle value. If there are an even number of values median() returns an average of the two middle values. In [3]: median ( test_scores ) 83 Out[3]: 83 Calculate the mode To calculate the mode, or most often value of our test scores, use the statistics module's mode() function. If there is more than one number which occurs most often, mode() returns an error. >>> mode ([ 1 , 1 , 2 , 2 , 3 ]) StatisticsError : no unique mode ; found 2 equally common values If there is no value that occurs most often (all the values are unique or occur the same number of times), mode() also returns an error. >>> mode ([ 1 , 2 , 3 ]) StatisticsError : no unique mode ; found 3 equally common values In [4]: mode ( test_scores ) Out[4]: 83 Calculate the standard deviation To calculate the standard deviation, or spread of the test scores, use the statistics module's stdev() function. A large standard deviation indicates the data is spread out; a small standard deviation indicates the data is clustered close together. In [5]: stdev ( test_scores ) Out[5]: 14.842506526863986 Alternatively, we can import the whole statistics module at once (all the functions in the staticsitics module) using the the line: import statistics Then to use the functions from the module, we need to call the names statistics.mean() , statistics.median() , statistics.mode() , and statistics.stdev() . See below: In [6]: import statistics test_scores = [ 60 , 83 , 83 , 91 , 100 ] In [7]: statistics . mean ( test_scores ) Out[7]: 83.4 In [8]: statistics . median ( test_scores ) Out[8]: 83 In [9]: statistics . mode ( test_scores ) Out[9]: 83 In [10]: statistics . stdev ( test_scores ) Out[10]: 14.842506526863986 Summary The statistics module is part of the Python Standard Library. To use statistics module functions, you first have to import the functions with the line from statistics import <function_name> where <function_name> is the name of the function you want to use. Then you can call the <function_name>() and pass in a list of values. The following functions are part of Python's statistics module: statistics module function name description example result mean() mean mean or average mean([1,4,5,5]) 3.75 median() median middle value median([1,4,5,5]) 4.5 mode() mode most often mode([1,4,5,5]) 5 stdev() standard deviation spread of data stdev([1,4,5,5]) 1.892","tags":"statistics","url":"statistics-in-python-using-the-statistics-module.html","loc":"statistics-in-python-using-the-statistics-module.html"},{"title":"Solving Two Equations for Two Unknowns and a Statics Problem with SymPy and Python","text":"SymPy (http://www.sympy.org) is a Python library for symbolic math . In symbolic math, symbols represent mathematical expressions. In a numerical calculation , the value of pi is stored as an estimate of pi , a floating point number close to 3.14... . In a symbolic math expression , the value of pi is an exact value. SymPy can be used to solve two equations for two unknowns. Consider the set of two equations containing two variables below: $$ x + y - 5 = 0 $$$$ x - y + 3 = 0 $$ To solve this system of two equations for the two unknows $x$ and $y$, first the SymPy package needs to be imported. From the SymPy package, we'll use the functions symbols() , Eq() , and solve() . In [1]: import numpy as np from sympy import symbols , Eq , solve Next, we create two SymPy symbols objects, $x$ and $y$. Note, the string passed as an argument to the symbols() function, 'x y' , does not have any commas. The outputs of the symbols() function are the two symbols objects x and y . These outputs must be separated by a comma and are not surrounded by quotes. Be careful with syntax when you create SymPy symbols objects. In [2]: x , y = symbols ( 'x y' ) Now we define the two equations as SymPy equation objects using SymPy's Eq equation class. Equations in SymPy are assumed to be equal to zero. Both of our equations are equal to zero, so no modification is necessary before we pass the equations into Eq() . If the equations were not equal to zero, we would simply subtract the term on the right hand side of the equals sign from both sides of the equation. The subtraction opperation will result in an equation equal to zero. In [3]: eq1 = Eq ( x + y - 5 ) eq2 = Eq ( x - y + 3 ) After the symbols and equations are defined, we can use SymPy's solve() function to compute the value of $x$ and $y$. The first argument passed to the solve() function is a tuple of the two equations (eq1, eq2) . The second argument passed to the solve() function is a tuple of the variables we want to solve for (x, y) . In [4]: solve (( eq1 , eq2 ), ( x , y )) Out[4]: {x: 1, y: 4} The solution is stored in a Python dictionary. The dictionary keys are the symbols objects (the variables), and the dictionary values are the numerical solution. We can access the solutions in the dictionary using regular Python dictionary access syntax: dict[key] . In [5]: sol_dict = solve (( eq1 , eq2 ), ( x , y )) print ( f 'x = {sol_dict[x]} ' ) print ( f 'y = {sol_dict[y]} ' ) x = 1 y = 4 SymPy can be used to solve engineering problems. Consider the following engineering statics problem: GIVEN: A mass of 22 lbs is hung from a ring. The ring is supported by two cords, cord AC is 45 degrees above the horizontal to the left, and cord BC is 30 degrees above the horizontal to the right . $m$ = 22 lb $T_{AC}$ @ +45 degrees CW relative to -x-axis $T_{BC}$ @ +30 degress CCW relative to +x-axis FIND: The magnitude of tension in the cords AC and BC. ($T_{AC}$ and $T_{BC}$) SOLUTION: After constructing a Free Body Diagram of ring C, we see three forces acting on ring C: One force from cord AC, which we call $T_{AC}$. The second force is from cord BC, which we call $T_{BC}$. The third and final force acting on ring C is the force from cord CD, which is due to the box hanging straight down and equal to 22 lbs, which we call $m$. To solve for the magnitude of $T_{AC}$ and $T_{BC}$, we need to solve two equations for two unknowns. To accomplish this with SymPy , first we need to import sympy and the functions symbols , Eq and solve . In [6]: from sympy import symbols , Eq , solve Next, we'll define the symbolic math variables (that will be used in the equations) as SymPy symbols objects. Multiple symbolic math variables can be defined at the same time. Note the argument names (on the right-hand side of the assignment operator = ) need to be enclosed in quotes ' ' and separated by spaces, no commas. The object names (on the left-hand side of the assignment operator = ) are separated with commas, no quotes. In [7]: Tac , Tbc = symbols ( 'Tac Tbc' ) Next, two equations based on the sum of the forces in the x and y directions need to be defined. Assuming ring C is in static equilibrium: $$ \\Sigma \\vec{F} = 0 $$$$ \\Sigma F_{x} = 0 $$$$ \\Sigma F_{y} = 0 $$ The three forces operating on the ring are defined as: $$ {T_{ac}} = tension \\ in \\ cable \\ AC \\ $$$$ \\vec{T_{ac}} = - T_{ac} cos(45)\\hat{i} + T_{ac} sin(45)\\hat{j} $$$$ {T_{bc}} = tension \\ in \\ cable \\ BC $$$$ \\vec{T_{bc}} = T_{bc} cos(30)\\hat{i} + T_{bc} sin(30)\\hat{j} $$$$ \\vec{m} = 0 \\hat{i} - 22 \\hat{j} $$ Taking $\\Sigma F_{x} = 0$ (sum of the $\\hat{i}$ terms) produces: $$ - T_{ac} cos(45) + T_{bc} cos(30) = 0 $$ Taking $\\Sigma F_{y} = 0$ (sum of the $\\hat{j}$ terms) produces: $$ T_{ac} sin(45) + T_{bc} sin(30) - 22 = 0 $$ Our first equation, based on the sum of the forces in the x-direction (the $\\hat{i}$ terms) is: $$ - T_{ac} cos(45) + T_{bc} cos(30) = 0 $$ This equation can be represented as a Sympy equation object. Note the right-hand side of the equation is equal to 0 . Sympy equation objects are instantiated with expressions equal to zero. If the expression on the left-hand side of the equation was not equal to zero, we would simply subtract both sides of the equation by the term on the right-hand side of the equals sign, then use the resulting expression (equal to zero) to create the Sympy equation object. In [8]: eq1 = Eq ( - Tac * np . cos ( np . radians ( 45 )) + Tbc * np . cos ( np . radians ( 30 ))) print ( eq1 ) Eq(-0.707106781186548*Tac + 0.866025403784439*Tbc, 0) The second equation is based on the sum of the forces in the y-direction: $$ T_{ac} sin(45) + T_{bc} sin(30) - 22 = 0 $$ We'll define this second equation as a SymPy equation object as well: In [9]: eq2 = Eq ( Tac * np . sin ( np . radians ( 45 )) + Tbc * np . sin ( np . radians ( 30 )) - 22 ) print ( eq2 ) Eq(0.707106781186548*Tac + 0.5*Tbc - 22, 0) Finally, to solve the two equations for the two unknowns, $T_{ac}$ and $T_{bc}$, we use SymPy's solve() method. The first argument passed to solve() is a tuple of the equations we want to solve (eq1, eq2) , the second argument passed to solve() is a tuple of the variables we want to solve for (Tac, Tbc) . In [10]: solve (( eq1 , eq2 ),( Tac , Tbc )) Out[10]: {Tac: 19.7246603876972, Tbc: 16.1051177665153} The solution is saved in a Python dictionary. The dictionary keys are the variable names, and the dictionary values are the numeric solution. Note, when we access the solution dictionary, we need to use the SymPy symbol object names Tac and Tbc as the dictionary keys (as compared to using the strings 'Tac' and 'Tbc' as the dictionary keys). In [11]: sol_dict = solve (( eq1 , eq2 ), ( Tac , Tbc )) print ( f 'Tac = {round(sol_dict[Tac],1)} lb' ) print ( f 'Tbc = {round(sol_dict[Tbc],1)} lb' ) Tac = 19.7 lb Tbc = 16.1 lb Summary SymPy is a Python package for symbolic math. In this post, we solved a system of two equations for two unknows using SymPy . To do this, we created SymPy symbols objects and put these symbol objects into SymPy equation objects. We used SymPy's solve() method to calculate the solution. The solution is stored in a Python dictionary where the keys are the SymPy symbols objects and the values are the numeric solution.","tags":"sympy","url":"sympy-two-equations-for-two-unknows-and-statics-problem.html","loc":"sympy-two-equations-for-two-unknows-and-statics-problem.html"},{"title":"Solving Equations and Writing Expressions with SymPy and Python","text":"SymPy (http://www.sympy.org) is a Python library for symbolic math . In symbolic math, symbols are used to represent mathematical expressions. An example of a symbolic math expression is below: $$ x&#94;{2} + y&#94;{2} = z $$ In the expression above, we have the variables $x$, $y$ and $z$. If we define a second symbolic math expression as: $$ x = a + b $$ We can substitute in $a + b$ for $x$. The resulting expression is: $$ (a + b)&#94;{2} + y&#94;{2} = z $$$$ a&#94;{2} + 2ab + b&#94;{2} + y&#94;{2} = z $$ Solving for $y$ in terms of $a$,$b$ and $z$, results in: $$ y = \\sqrt{z - a&#94;{2} - 2ab - b&#94;{2}} $$ If we have numerical values for $z$, $a$ and $b$, we can use Python to calculate the value of $y$. However, if we don't have numerical values for $z$, $a$ and $b$, Python can also be used to rearrange terms of the expression and solve for the variable $y$ in terms of the other variables $z$, $a$ and $b$. Working with mathematical symbols in a programmatic way, instead of working with numerical values in a programmatic way, is called symbolic math. SymPy is a Python library for working with symbolic math. Before SymPy can be used, it needs to be installed. The installation of Sympy is accomplished using the Anaconda Prompt (or a terminal and pip ) with the command: > conda install sympy SymPy is included in the Anaconda distribution of Python. If you have the full Anaconda distribution, you will be notified that the SymPy library is already installed. Defining Variables in SymPy To define symbolic math variables with SymPy , first import the symbols() function from the SymPy module: In [1]: from sympy import symbols Symbolic math variables are declared using SymPy's symbols() function. Note, the arguments passed to the symbols() function (symbol names) are separated by a space, no comma, and surrounded by quotes. The output of the symbols() function are SymPy symbols objects. These output objects are separated by commas with no quotation marks. In [2]: x , y = symbols ( 'x y' ) Now that the symbols x and y are instantiated, a symbolic math expression using x and y can be created. A symbolic math expression is a combination of symbolic math variables with numbers and mathematical operators, such as + , - , / and * . The standard Python rules for working with numbers apply in SymPy symbolic math expressions. In [3]: expr = 2 * x + y Use the .subs() method to insert a numerical value into a symbolic math expression. The first argument of the .subs() method is the symbols object (the variable) and the second argument is the numerical value. In the expression above: $$ 2x + y $$ If we substitute: $$ x = 2 $$ The resulting expression is: $$ 2(2) + y $$$$ 4 +y $$ In [4]: expr . subs ( x , 2 ) Out[4]: y + 4 The .subs() method does not replace variables in place, .subs() only completes a one-time substitution. If we call expr after the .subs() method is applied, the original expr expression is returned. In [5]: expr Out[5]: 2*x + y In order to make the substitution permanent, a new expression object needs to be assigned to the output of the .subs() method. In [6]: expr = 2 * x + y expr2 = expr . subs ( x , 2 ) expr2 Out[6]: y + 4 SymPy variables can also be substituted into SymPy expressions In [7]: x , y , z = symbols ( 'x y z' ) expr = 2 * x + y expr2 = expr . subs ( x , z ) expr2 Out[7]: y + 2*z More complex substitutions can also be completed. Consider the following: $$ 2x + y $$ Substitute in: $$ y = 2x&#94;2 + z&#94;{-3} $$ Results in: $$ 2x + 2x&#94;2 + z&#94;{-3} $$ In [8]: x , y , z = symbols ( 'x y z' ) expr = 2 * x + y expr2 = expr . subs ( y , 2 * x ** 2 + z ** ( - 3 )) expr2 Out[8]: 2*x**2 + 2*x + z**(-3) A more practical example could involve a large expression and several variable substitutions. $$ n_0e&#94;{-Q_v/RT} $$$$ n_0 = 3.48 \\times 10&#94;{-6} $$$$ Q_v = 12,700 $$$$ R = 8.31 $$$$ T = 1000 + 273 $$ In [9]: from sympy import symbols , exp n0 , Qv , R , T = symbols ( 'n0 Qv R T' ) expr = n0 * exp ( - Qv / ( R * T )) Multiple SymPy subs() methods can be chained together to substitue multiple variables in one line of code. In [10]: expr . subs ( n0 , 3.48e-6 ) . subs ( Qv , 12700 ) . subs ( R , 8031 ) . subs ( T , 1000 + 273 ) Out[10]: 3.48e-6*exp(-12700/10223463) To evaluate an expression as a floating point number (get a numerical answer out), use Sympy's .evalf() method. In [11]: expr2 = expr . subs ( n0 , 3.48e-6 ) . subs ( Qv , 12700 ) . subs ( R , 8031 ) . subs ( T , 1000 + 273 ) expr2 . evalf () Out[11]: 3.47567968697765e-6 Defining Equations in Sympy We can define equations in SymPy using symbolic math variables. Equations in SymPy are different than expressions in SymPy . An expression does not have equality. An equation has equality. An equation is equal to something. In [1]: from sympy import symbols , Eq , solve In [2]: x , y = symbols ( 'x y' ) SymPy equations are instantiated as an object of the Eq class. After SymPy symbols are created, the symbols can be passed into an equation object. Let's create the equation: $$ 2x + y - 1 = 0 $$ In [3]: eq1 = Eq ( 2 * x - y - 1 ) Now let's create a second equation: $$ x + y - 5 = 0 $$ In [4]: eq2 = Eq ( x + y - 5 ) To solve the two equations for the two variables x and y , we'll use SymPy's solve() function. The solve() function takes two arguments, a tuple of the equations (eq1, eq2) and a tuple of the variables to solve for (x, y) . In [5]: sol = solve (( eq1 , eq2 ),( x , y )) sol Out[5]: {x: 2, y: 3} The SymPy solution object is a Python dictionary. The keys are the SymPy variable objects and the values are the numerical values these variables correspond to. In [6]: print ( f 'The solution is x = {sol[x]} , y = {sol[y]} ' ) The solution is x = 2, y = 3 Summary In this post, we looked at a Python package for symbolic math called SymPy . Using symbolic math, we can define expressions and equations exactly in terms of symbolic variables. We reviewed how to create a SymPy expression and substitue values and variables into the expression. Then we created to SymPy equation objects and solved two equations for two unknowns using SymPy's solve() function.","tags":"sympy","url":"sympy-expressions-and-equations.html","loc":"sympy-expressions-and-equations.html"},{"title":"Building an IoT Server with flask and Python - Part 6 - upload code to ESP8266-based WiFi weather stations","text":"This is the sixth part of a series of posts about building an Internet of Things (IoT) server with flask , Python and ESP8266 microcontrollers. In this post, we'll add some code to our ESP8266-based weather stations. The code we upload to the ESP8266 microcontrollers programs the WiFi weather stations to measure the temperature. After the ESP8266-based weather stations measure the temperature, the microcontroller executes a GET request to our flask IoT server web API. Table of contents: Introduction Hardware Setup Upload firmware Download the latest Micropython firmware .bin file Install the SiLabs driver for the Adafruit Feather Huzzah ESP8266 Connect the Adafruit Feather Huzzah ESP8266 board to the laptop Determine which serial port the Feather Huzzah is connected to Run esptool to upload the .bin file to the Feather Huzzah Construct .py files Upload .py files Test ESP8266-based weather stations Upload main.py Summary Introduction In the last post, we added a database to our flask IoT server. Each time our flask IoT server web API is hit with a valid URL, the data contained in the URL is saved as a record in a sqlite3 database on the server. Each time we browse to the main page of the flask IoT server site, we see the most recent temperature posted. The posted temperature is pulled from the sqlite3 database. In this post, we are going to create a couple new .py files and upload the .py files to the ESP8266-based WiFi weather stations. These .py files enable the ESP8266-based WiFi weather stations to measure the temperature, then post the temperature to our flask IoT server. Hardware Setup Before we upload any new code to the ESP8266-based weather stations, let's review the hardware setup. Below is a schematic of the ESP8266-based weather stations. The schematic shows an ESP8266 microcontroller (an Adafruit Feather Huzzah ESP8266 ) connected to a temperature sensor ( MCP9808 ) with jumper wires. Upload firmware If you are following along with this series, you might remember the ESP8266-based WiFi weather station hardware and software setup in the first post of the series . In case the Feather Huzzah ESP8266 microcontroller doesn't have an up-to-date version of Micropython on it, below are instructions detailing how to upload the Micropython firmware to the board. Download the latest Micropython firmware .bin file Go to GitHub and download the latest .bin firmware file. Move the .bin firmware file to a new micropython directory. The .bin firmware file is the version of Micropython that runs on the Adafruit Feather Huzzah ESP8266. Install the SiLabs driver for the Adafruit Feather Huzzah ESP8266 Before we can connect the Adafruit Feather Huzzah to the computer, we need a specific driver installed. For my Windows 10 laptop to see the Adafruit Feather Huzzah board, the CP210x USB to UART Bridge VCP driver needs to be downloaded from SiLabs and installed. Connect the Adafruit Feather Huzzah ESP8266 board to the laptop Use a micro-USB cable (the same kind of cable that charges many mobile phones) to connect the Feather Huzzah to the computer. Make sure that the micro-USB cable is a full USB data cable and not just a simple power cable. I had trouble getting the Feather Huzzah to work, and it turned out the reason was my micro-USB cable was only a charging cable. Charge-only cables cannot transfer data. Determine which serial port the Feather Huzzah is connected to Use Windows Device Manager to determine which serial port the Feather Huzzah board is connected to. We'll need the serial port as one of the parameters when we upload the .bin firmware file on the board. Look for something like Silicon Labs CP210x USB to UART Bridge (COM4) in the Ports (COM & LPT) menu. The USB to UART bridge is the Feather Huzzah ESP8266 microcontroller board. CP210x refers to the chip that handles serial communication on the Feather Huzzah, not the ESP8266 chip itself. Make a note of the number after (COM ) . It often comes up as (COM4) but it may be different on your computer. Run esptool to upload the .bin file to the Feather Huzzah On a local computer (not the server), open the Anaconda Prompt or a terminal and cd into the directory with the .bin firmware file. The .bin firmware file is called something like esp8266-20171101-v1.9.3.bin . Create and activate a new conda virtual environment and install esptool into the environment. > conda create -n micropython python=3.7 > conda activate micropython > (micropython) pip install esptool Before we write the .bin firmware file to the ESP8266, we'll first erase the flash memory on the little microcontroller using the esptool erase_flash command. Make sure to specify the --port you found in the Windows Device Manager. In my case the port was COM4 . > (micropython) esptool --port COM4 erase_flash Now it's time to write the .bin firmware file to the flash memory on the ESP8266 board using the esptool write_flash command. Make sure to use the exact .bin firmware file name. The .bin firmare filename is easy to mistype. --port has to be set as the port you found in the Windows Device Manager. ---baud is the baud rate (upload speed). I found that --baud 460800 worked, but you could also specify --baud 115200 , which is slower. The upload time was a matter of seconds with either baud rate. The 0 after --flash_size=detect means we want the firmware written at the start of the flash memory (the 0 th position) on the board. An issue I ran into was that I tried to use the command esptool.py instead of esptool as shown on the Micropython docs . The documentation for Micropython on the ESP8266 specifies the command esptool.py (including the .py file extension). The command esptool.py did work on my Windows 10 machine. Omitting the .py file extension, and running esptool worked instead. > (micropython) esptool --port COM4 --baud 460800 write_flash --flash_size=detect 0 esp8266-20171101-v1.9.3.bin Construct .py files Now that Micropython is loaded on the ESP8266 microcontroller, we'll construct a couple of .py files to load onto the board. The first file is wifitools.py . This module contains a couple of helper functions that allow the ESP8266 to connect to a WiFi network and make GET requests. # wifitools.py import urequests #https://docs.micropython.org/en/v1.8.6/esp8266/esp8266/tutorial/network_basics.html def connect ( SSID , password ): import network sta_if = network . WLAN ( network . STA_IF ) if not sta_if . isconnected (): print ( 'connecting to network...' ) sta_if . active ( True ) sta_if . connect ( SSID , password ) while not sta_if . isconnected (): pass print ( 'network config:' , sta_if . ifconfig ()) def getmac (): import network import ubinascii return ubinascii . hexlify ( network . WLAN () . config ( 'mac' ), ':' ) . decode () def flaskiot_post ( API_key , mac_address , field , data ): if not isinstance ( data , str ): data = str ( data ) if not isinstance ( field , str ): field = str ( field ) # https://freetemp.org/update/API_key=ASCIISTR/mac=6c:rf:7f:2b:0e:g8/field=1/data=72.3 base_url = 'https://freetemp.org/update' api_key_url = '/API_key=' + API_key mac_url = '/mac=' + mac_address field_url = '/field=' + field data_url = '/data=' + str ( data ) url = base_url + api_key_url + mac_url + field_url + data_url print ( url ) response = urequests . get ( url ) print ( response . text ) The second file MCP9808.py , contains a function to read the temperature off of the MCP9808 temperature sensor. # MCP9808.py # Functions for the MCP9808 temperature sensor # https://learn.adafruit.com/micropython-hardware-i2c-devices/i2c-master def readtemp (): import machine i2c = machine . I2C ( scl = machine . Pin ( 5 ), sda = machine . Pin ( 4 )) byte_data = bytearray ( 2 ) i2c . readfrom_mem_into ( 24 , 5 , byte_data ) value = byte_data [ 0 ] << 8 | byte_data [ 1 ] temp = ( value & 0xFFF ) / 16.0 if value & 0x1000 : temp -= 256.0 return temp The third file, config.py , contains the API key and mac address the ESP8266 uses in the GET requests to send a valid URL to our flask IoT server. config.py also contains the SSID and WiFi password of the wireless network. The constants API_key and mac should be set to the values used in the server script flaskapp.py . Make sure to add this file to .gitignore to keep it out of version control. # config.py # API keys, passwords, mac address # keep out of version control #api_key = config.API_KEY API_KEY = 'TGS894F' #ssid = config.SSID SSID = 'My WiFi Network' #password = config.WIFI_PASSWORD WIFI_PASSWORD = 'my_wifi_password' MAC_ADDRESS = '6c:ef:7r:3b:9d:e8' The fourth file - run.py , is a script with one primary function. The function programs the ESP8266 to: connect to the WiFi network read the temperature off of the MCP9808 temperature sensor try to post the temperature to our flask IoT server wait 1 minute # run.py # ESP8266 Feather Huzzah Weather Station, connected to flask IoT server import wifitools import MCP9808 import time import config def main (): ssid = config . SSID password = config . WIFI_PASSWORD api_key = config . API_KEY mac_address = config . MAC_ADDRESS field = '1' wifitools . connect ( ssid , password ) time . sleep ( 5 ) for i in range ( 60 * 8 ): data = MCP9808 . readtemp () try : wifitools . flaskiot_post ( api_key , mac_address , field , data ) except : pass time . sleep ( 60 ) Upload .py files We'll use a tool called ampy to upload the .py files to the board. Make sure ampy is installed in the virtual environment you're using. > conda activate micropython > (micropython) pip install ampy To upload the .py files, make sure the board is plugged into the computer with a USB data cable and use the ampy put command. Note the --port is specified. > (micropython)$ ampy --port COM4 put MCP9808.py > (micropython)$ ampy --port COM4 put wifitools.py > (micropython)$ ampy --port COM4 put config.py > (micropython)$ ampy --port COM4 put run.py > (micropython)$ ampy --port COM4 ls > boot.py wifitools.py MCP9808.py config.py run.py Test ESP8266-based weather stations Connect the ESP8266 to the local computer with a micro-USB cable. Use PuTTY to open up the Micropython REPL and try to run the main script in run.py >>> import run >>> run.main() The temperature is measured once a minute and posted to our flask IoT server. Open up a web browser to the server's main page and view the most recent data point. https://mydomain.com Upload main.py Now that we know our ESP8266-based WiFi weather stations are working correctly, we'll upload a main.py file to the board and start recording temperatures and sending the temperature to our flask IoT server web API. The main.py script runs automatically when the ESP8266 is powered up. The simple script contains an import and a line of code to run the main() function in run.py . # main.py # runs after boot.py import run try : run . main () except : print ( \"main() function in run.py could not be executed\" ) After the main.py script is constructed, upload it onto the ESP8266 with ampy . > (micropython) ampy --port COM4 put main.py > (micropython) ampy --port COM4 ls wifitools.py MCP9808.py config.py main.py run.py Now for the big payoff. Plug the ESP8266 into power, but disconnected from the local computer. Go to the main page on the flask-IoT server and see the temperature measured once a minute. https:mydomain.com Summary It works! We have a working Internet of Things (IoT) server that has a working web API that ESP8266-based WiFi weather stations can post to. Building the flask IoT server was a big project. It is great to have a set of WiFi weather stations that post the temperature to a server. I can view the temperature on my phone from anywhere with a cell phone connection. The ESP8266-based WiFi weather stations can be plugged in anywhere with power (or run on a battery) within my WiFi network. Using two of the stations, I can see the temperature outside the house and the temperature inside the house from anywhere.","tags":"flask","url":"flask-iot-server-upload-code-to-esp8266.html","loc":"flask-iot-server-upload-code-to-esp8266.html"},{"title":"Building an IoT Server with flask and Python - Part 5 Adding a Database","text":"This is the fifth part of a series of posts about building an Internet of Things (IoT) server with flask , Python and ESP8266 microcontrollers. In this post, we'll add a sqlite3 database to our flask IoT server to store all the temperature data points that come in from our ESP8266-based WiFi weather stations. We will also build out the main page of the flask IoT server site to display the most recent data points pulled from the database. Table of contents: Introduction Why a sqlite3 database? Database design Prototype the sqlite3 database Add the sqlite3 database to the server Update the main webpage with the newest database entry Restart the server Summary Next steps Introduction In the last post, we built in some validation for our flask IoT server web API so that only certain API keys and mac addresses are allowed. We also used Python's datetime module to add a time stamp to each data point as it comes into our flask IoT server. This is great, but it would be really awesome to save every data point that comes in. Right now, when a new data point comes into our server, the previous data point is erased. There are a couple of ways we could store the temperature data that comes in from our ESP8266-based WiFi weather stations: Save the data in a text file. Append a new line to the text file for each new data point. Save the data in a .csv file. Add a new line for each data point, separate fields on each line with a comma or tab. Save the data in a pandas dataframe. Store each data point as a row in the dataframe. Use a database to store the data. Each data point saved as a record in the database. Of the four options above, I decided to use a sqlite3 database to store the data coming in from the flask IoT server web API. Why a sqlite3 database? Why use a sqlite3 database? One of the key reasons is the sqlite3 module is part of the Python Standard Library. We don't have to install any external packages to use sqlite3 . A sqlite3 database is also light-weight and won't take up a lot of space on our server. But the real reason I choose to use sqlite3 is that the library has good documentation and I can build off the sqlite3 examples of others. Database design Before adding any data to the database, we need to think a little bit about database design. Our sqlite3 database is going to be a pretty simple database. I think of the database itself as a Microsoft Excel workbook, the whole Microsoft Excel .xlsx file. We will only employ one table in our sqlite3 database. I think a database table is like a sheet or tab in a Microsoft Excel file. Each data point from the WiFi weather stations will represent one record in the database. I think of a record as one row in a Microsoft Excel file. The web API we built brings in a couple of identifiers with each data point. Based on a valid URL such as: https://mydomain.com/update/API_key=PHDNGI2345/mac=6c:rf:7f:2b:0e:g8/field=1/data=72.3 In the URL above we've provided: update (to tell the flask IoT server to save the data point, not just serve a webpage) API_key = PHDNGI2345 (to identify the user) mac = 6c:rf:7f:2b:0e:g8 (to identify the ESP8266-based WiFi weather station) field = 1 (to specify a temperature data point, not a humidity data point) data = 72.3 (to specify the temperature is 72.3 degrees) Our database needs to be able to save these four fields: API_key mac field data As well as these two additional fields: date and time some sort of primary key that uniquely identifies each record Two example records in our database might look like: primary_key API_key mac field data date_time 1 PHDNGI2345 6c:rf:7f:2b:0e:g8 1 72.3 2018-09-10 08:23:45 PM 2 PHDNGI2345 6c:rf:7f:2b:0e:g8 1 83.2 2018-09-11 09:45:01 AM Prototype the sqlite3 database I didn't have a lot of experience building or using databases before this flask IoT server project. Before I started coding, I tried out a couple of sqlite3 commands in a Jupyter notebook. To create a new database, we first import sqlite3 and then instantiate a new database object with the sqlite3.connect() method. In [1]: import sqlite3 db = sqlite3 . connect ( \"name_database.db\" ) Next, we connect to the database with the sqlite3.connect() method and create a connection object called conn . Then, from the connection object conn , we create a cursor object called cur . The cursor object executes the database commands. The commands the cursor object cur executes are written in a database query language. Learning database query language is sort of like learning a whole new programming language. I am still note really familiar with the database language query commands or syntax. Before we can add records to the database, we need to create a table in the database. In [2]: # create a database called name_database.db # add one table to the database called names_table # add columns to the database table: Id, first_name, last_name, age conn = sqlite3 . connect ( 'name_database.db' ) cur = conn . cursor () cur . execute ( \"\"\"CREATE TABLE IF NOT EXISTS names_table ( Id INTEGER PRIMARY KEY AUTOINCREMENT, first_name text, last_name text, age integer )\"\"\" ) conn . commit () cur . close () conn . close () db . close () Now to add a new record to the database, we need to: connect to the database, creating a connection object conn create a cursor object cur based on the connection object execute commands on the cursor object cur to add a new record to the database commit the changes to the connection object conn close the cursor object close the connection object In [3]: conn = sqlite3 . connect ( 'name_database.db' ) cur = conn . cursor () cur . execute ( \"INSERT INTO names_table VALUES(:Id, :first_name, :last_name, :age)\" , { 'Id' : None , 'first_name' : 'Gabriella' , 'last_name' : 'Louise' , 'age' : int ( 8 ) }) conn . commit () cur . close () conn . close () Now let's see if we can retrieve the record we just added to the database. In [4]: conn = sqlite3 . connect ( 'name_database.db' ) cur = conn . cursor () cur . execute ( \"SELECT first_name, last_name, age, MAX(rowid) FROM names_table\" ) record = cur . fetchone () print ( record ) cur . close () conn . close () ('Gabriella', 'Louise', 8, 1) Let's add another record to the database In [5]: conn = sqlite3 . connect ( 'name_database.db' ) cur = conn . cursor () cur . execute ( \"INSERT INTO names_table VALUES(:Id, :first_name, :last_name, :age)\" , { 'Id' : None , 'first_name' : 'Maelle' , 'last_name' : 'Levin' , 'age' : int ( 5 ) }) conn . commit () cur . close () conn . close () And again let's see the most recent record: In [6]: conn = sqlite3 . connect ( 'name_database.db' ) cur = conn . cursor () cur . execute ( \"SELECT first_name, last_name, age, MAX(rowid) FROM names_table\" ) record = cur . fetchone () print ( record ) cur . close () conn . close () ('Maelle', 'Levin', 5, 2) In [ ]: Add the sqlite3 database to the server OK- after playing around with sqlite3 , let's add some code to our flask IoT server. Let's code in a database connection, cursor object creation and record execution. This code belongs in the \"/update/...\" route of the flaskapp.py file. $ cd ~ $ cd flaskapp $ nano flaskapp.py Within the flaskapp.py file, we'll add the database code. # flaskapp.py @app.route ( \"/update/API_key=<api_key>/mac=<mac>/field=<int:field>/data=<data>\" , methods = [ 'GET' ]) def write_data_point ( api_key , mac , field , data ): if ( api_key == API_KEY and mac == MAC_ADDRESS ): conn = sqlite3 . connect ( 'data.db' ) c = conn . cursor () t = datetime . datetime . now ( tz = pytz . utc ) date_time_str = t . isoformat () c . execute ( \"INSERT INTO data VALUES(:Id, :API_key, :date_time, :mac, :field, :data)\" , { 'Id' : None , 'API_key' : api_key , 'date_time' : date_time_str , 'mac' : mac , 'field' : int ( field ), 'data' : round ( float ( data ), 4 )}) conn . commit () c . close () conn . close () return render_template ( \"showrecent.html\" , data = data , time_stamp = date_time_str ) else : return render_template ( \"403.html\" ) At the top of this main flaskapp.py script, we'll also include a couple of lines to create the database when the flask app starts: # flaskapp.py if not os . path . isfile ( 'data.db' ): conn = sqlite3 . connect ( 'data.db' ) c = conn . cursor () c . execute ( \"\"\"CREATE TABLE data ( Id INTEGER PRIMARY KEY AUTOINCREMENT, API_key text, date_time text, mac text, field integer, data real )\"\"\" ) conn . commit () conn . close () Update the main webpage with the newest database entry Next, we'll update the main page of the flask IoT server, the home or \"/\" route. #flaskapp.py @app.route ( \"/\" ) def index (): conn = sqlite3 . connect ( 'data.db' ) c = conn . cursor () c . execute ( \"SELECT data, date_time, MAX(rowid) FROM data WHERE field=?\" , ( '1' ,)) row1 = c . fetchone () c . execute ( \"SELECT data, date_time, MAX(rowid) FROM data WHERE field=?\" , ( '2' ,)) row2 = c . fetchone () c . close () conn . close () data1 = str ( round (( float ( row1 [ 0 ]) * 1.8 ) + 32 )) data2 = str ( round (( float ( row2 [ 0 ]) * 1.8 ) + 32 )) time_str1 = row1 [ 1 ] t1 = dateutil . parser . parse ( time_str1 ) t_pst1 = t1 . astimezone ( pytz . timezone ( 'US/Pacific' )) time_stamp1 = t_pst1 . strftime ( '%I:%M:%S %p %b %d , %Y' ) time_str2 = row2 [ 1 ] t2 = dateutil . parser . parse ( time_str2 ) t_pst2 = t2 . astimezone ( pytz . timezone ( 'US/Pacific' )) time_stamp2 = t_pst2 . strftime ( '%I:%M:%S %p %b %d , %Y' ) return render_template ( \"showdoubletemp.html\" , data1 = data1 , time_stamp1 = time_stamp1 , data2 = data2 , time_stamp2 = time_stamp2 ) Restart the server Restart the flask IoT server with the following commands: $ sudo systemctl stop flaskapp $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp # ctrl-c to exit Let's try uploading a datapoint to the server using a valid URL. This GET request from a web browser will save a temperature data point in the database. https://mydomain.com/update/API_key=DTLZ3LBY/mac=5m:ct:7f:3b:0d:a8/field=1/data=30 Now let's upload another data point, this time using field=2 and data=15.2 . https://mydomain/update/API_key=DTLZ3LBY/mac=5m:ct:7f:3b:0d:a8/field=2/data=15.2 Now let's browse to the home page of the server and view the temperatures which were saved to the database. https://mydomain.com Summary It works! We have a working sqlite3 database. Each time the web API is hit with a valid URL from a web browser, a data point is saved as a record in the database. Each time we go to the main page of the flask IoT server site, we see the most recent temperatures posted. Next steps In the next post, we'll upload new .py files to our ESP8266-based WiFi weather stations. This will give the ESP8266-based WiFi weather stations the ability to post temperature data to our flask IoT server.","tags":"flask","url":"flask-iot-server-database.html","loc":"flask-iot-server-database.html"},{"title":"Building an IoT Server with flask and Python - Part 4 Validation and Timestamps","text":"This is the fourth part of a series of posts about building an Internet of Things (IoT) server with flask , Python and ESP8266 microcontrollers. In the last post of the series, we reviewed how to build a web API with flask which accepts temperature measurements. In this post, we'll build in some validation to our web API so that only certain API keys and mac addresses are allowed. We will also use Python's datetime module to time stamp each data point as it comes in. Table of contents: Introduction Why data validation? Validating incoming URLS Adding time stamps Restart the flask app and view the changes Summary Next steps Introduction Now that we have a web API, we can make GET requests using a web browser and see the output in the web page flask sends back. What's not to like? Well right now any string added to the URL specified by our web API will get through. We don't want just any WiFi weather station to upload data. What we need is some data validation. Why data validation? A web API is a web-based Application Programming Interface. That's a fancy way of saying a server that saves input or produces output based on the URL someone types into their web browser. An example URL that our flask IoT web server accepts is: https://mydomain.com/update/API_key=ASCIISTR/mac=6c:rf:7f:2b:0e:g8/field=1/data=72.3 In the URL above we've provided: update (to tell the IoT server to save the data point, not just serve a webpage) API_key = ASCIISTR (to identify the user) mac = 6c:rf:7f:2b:0e:g8 (to identify the ESP8255-based WiFi weather station) field = 1 (to specify this is a temperature data point, not a humidity data point) data = 72.3 (to specify the temperature is 72.3 degrees) Right now, any string following API_key= and mac= can be inserted into the URL. This allows anyone with an internet connection upload data to the server and potentially upload malicious code to the server. Since an arbitrary string can be inserted as API_key or mac , that arbitrary string will be read by our flask IoT server. To build in a bit more security into our server, we'll utilize a form of data validation . This means that our flask IoT server will only accept certain API_key= and mac= strings as part of a web API URL. Validating incoming URLS The data coming into our IoT server is only from two specific from ESP8266-based WiFi weather stations. There are a couple unique aspects to each of the ESP8266-based WiFi weather stations. A user: Each WiFi weather station has a user. In this case the user is me. I can set a unique API key that only I know. A mac address: A mac address is a unique address assigned to each piece of hardware. Each of the ESP8266-based WiFi weather stations has a different mac address. field: The ESP8266-based WiFi weather stations have the capability to output temperature and humidity. Right now we are just going to deal with temperature, but is will be nice to have an extra field available for multiple data outputs from the same device. There will be a limit to the number of fields one device can send. We'll limit the fields to 1-9 data: The temperature data that comes out of each ESP8266-based WiFi weather station. This is a float, but can be limited by length. If we put these 4 identifiers as part of our URL, our IoT server will provide the functionality the WiFi weather stations need. Below is the general form of a web API url that is valid: https://mydomain.com/update/API_key=GTW89NF3/mac=6c:rf:7f:2b:0e:g8/field=1/data=72.3 In the URL above we've provided: An API_key = GTW89NF3 A mac = mac=6c:rf:7f:2b:0e:g8 field = 1 data = 72.3 Now we need to program our flask IoT server to only accept URL's like the URL above, with a set of unique API_key's, mac addresses and limits on the field and data portions of the URL. On the server, create a new file called config.py . This file will contain the API_key and mac address that is acceptable. It is a good practice to keep these sorts of private keys in a separate file and out of version control. Make sure to add config.py to the .gitignore file if you are using git. #config.py API_key = GTW89NF3 mac = mac = 6 c : rf : 7 f : 2 b : 0 e : g8 Now, on the server, we'll modify the flaskapp.py file's imports section to import the API key and mac address strings from config.py . We can import variables as well as functions and classes from separate .py files. #flaskapp.py from flask import Flask , render_template , request from config import API_KEY , MAC_ADDRESS Now we'll modify the @app.route section of flaskapp.py : @app.route ( \"/update/API_key=<api_key>/mac=<mac>/field=<int:field>/data=<data>\" , methods = [ 'GET' ]) def write_data_point ( api_key , mac , field , data ): if ( api_key == API_KEY and mac == MAC_ADDRESS ): return render_template ( \"showrecent.html\" , data = data ) else : return render_template ( \"403.html\" ) A new template, 403.html that shows an error message, needs to be created in the templates directory. <!-- /templates/403.html --> <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=edge\" > < meta name = \"viewport\" content = \"width=device-width, initial-scale=1\" > < title > read temp </ title > <!-- Latest compiled and minified CSS --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" > <!-- Optional theme --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\" > <!-- Latest compiled and minified JavaScript --> < script src = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\" integrity = \"sha384-Tc5$> </head> <body> <div class=\" container-fluid \" > < div class = \"jumbotron\" > < hr class = \"my-4\" > < h1 class = \"display-4\" > API Call Invalid </ h1 > < p class = \"lead\" > The URL entered does not contain a valid API key or mac address </ p > < hr class = \"my-4> <p class=\" lead \" > < a class = \"btn btn-primary btn-lg\" href = \"/\" role = \"button\" > TO HOME </ a > </ p > </ div > </ div > </ body > </ html > Adding time stamps Our web API accepts data points, but it would be nice to see a time stamp of when the temperature was measured. With a time stamp connected to each data point, we can show a webpage with the temperature and when it was measured. Working with time in Python can be a little confusing. It seems like a simple concept, but times and dates are actually pretty complicated. Which time zone? Save seconds or minutes? What format will the time be in?. We need to answer these questions before building the code to record the time stamp. The way I want the time and date to look on a website our flask IoT server produces is: 05:18:48 PM Aug 17, 2018 Where 05:18:48 is the hour:minutes:seconds, AM or PM for the pacific time zone (in 12hour format), and the date Aug 17, 2018 is in the month day, year format. To show the timestamp in the format above, I used a helper library called pytz . According to the pytz documentation , pytz is a package for dealing with world timezone definitions in Python. We need to pip install the pytz package into the virtual environment that runs our flask app. See part of this post on how other Python packages were installed on the server. $ cd ~ $ mkdir flaskapp $ cd flaskapp $ python3.6 -m venv flaskappenv $ source flaskapp/bin/activate ( flaskappenv ) $ pip install pytz ( flaskappenv ) $ deactivate $ Now, the flaskapp.py file can be modified to include pytz and Python's datetime and dateutil libraries in the imports: #flaskapp.py from flask import Flask , render_template , request import datetime import os import dateutil.parser from config import API_KEY , MAC_ADDRESS import pytz Next, the @app.route section of the flask app can be modified to include the timestamp. Note that we now pass time_stamp=date_time_str to the \"showrecent.html\" template. We will also need to ensure the showrecent.html template accepts both of these arguments. @app.route ( \"/update/API_key=<api_key>/mac=<mac>/field=<int:field>/data=<data>\" , methods = [ 'GET' ]) def write_data_point ( api_key , mac , field , data ): if ( api_key == API_KEY and mac == MAC_ADDRESS ): t = datetime . datetime . now ( tz = pytz . timezone ( 'America/Los_Angeles' )) date_time_str = t . isoformat () return render_template ( \"showrecent.html\" , data = data , time_stamp = date_time_str ) else : return render_template ( \"403.html\" ) In the code above, t = datetime.datetime.now(tz=pytz.timezone('America/Los_Angeles')) saves the datetime when the URL comes in using the datetime module and the 'America/Los_Angeles' time zone from pytz . On the server, we will save the time stamps in the pacific time zone because that's where I live. When we render the template, we can include the PST time zone where we show the time and date. The showrecent.html template is below: <!-- /templates/showrecent.html --> <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=edge\" > < meta name = \"viewport\" content = \"width=device-width, initial-scale=1\" > < title > read temp </ title > < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" > <!-- Optional theme --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css> <!-- Latest compiled and minified JavaScript --> <script src=\" https: // maxcdn . bootstrapcdn . com / bootstrap / 3 . 3 . 7 / js / bootstrap . min . js \" integrity = \"sha384-Tc5\" > </ head > < body > < div class = \"container-fluid\" > < div class = \"jumbotron\" > < hr class = \"my-4\" > < h1 class = \"display-4\" > {{ data }} </ h1 > < p class = \"lead\" > Most Recent Data Point </ p > < hr class = \"my-4\" > < h1 class = \"display-4\" > {{ time_stamp }} </ h1 > < p class = \"lead\" > Most Recent Time Time Zone: PST </ p > < hr class = \"my-4> <p class=\" lead \" > < a class = \"btn btn-primary btn-lg\" href = \"/showrecent.html\" role = \"button\" > REFRESH </ a > </ p > </ div > </ div > </ body > </ html > Restart the flask app and view the changes Now we can restart the flask app and see if our modified web API works. We want to test to see if the 403.html template is rendered when a non-valid URL is entered. We also want to see the time-stamp rendered by showrecent.html when a valid URL is used. $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp # [ctrl-c] to exit. Now if we go to the web address: https://yourdomain.com//update/API_key=APGLMD/mac=a3:45:b5:c9/field=1/data=98.6 You should see the the 403 error template rendered. Because the URL above is an invalid URL. It does not contain a valid API key or mac address. But if you go to the web address: https://mydomain.com/update/API_key=GTW89NF3/mac=6c:rf:7f:2b:0e:g8/field=1/data=22.0 You should see the showrecent.html template rendered. This URL contains a valid API and mac address. Summary It works! When we browse to a URL without the correct API key or mac address, we're returned the 403 error page. If we browse to a valid URL, with the right API key and mac address, our flask IoT server shows the data point we uploaded with a time stamp included. Next steps In the next post in this series, we'll modify our flask IoT server to save the data points to a simple database. Then we'll build an html template to render the data from the database instead of just instantaneously based on the web API URL. sqlite3 here we come!","tags":"flask","url":"flask-iot-server-validation-time-stamps.html","loc":"flask-iot-server-validation-time-stamps.html"},{"title":"Solving a Circuit Diagram Problem with Python and SchemDraw","text":"In this post we will create a circuit diagram using a using a Python package called SchemDraw . Then we'll solve a problem using this circuit diagram and Python. In this post, we are going to solve a circuit diagram problem using Python and a package called SchemDraw . SchemDraw is a specialized Python package for drawing circuit diagrams. For SchemDraw documentation see: https://cdelker.bitbucket.io/SchemDraw/SchemDraw.html Given: The circuit diagram below with a driving voltage $V_t = 5.20 V$ and resistor values in the table below. A table of resistance values is below: V t = 5.20 V R 1 = 13.2 mΩ R 2 = 21.0 mΩ R 3 = 3.60 mΩ R 4 = 15.2 mΩ R 5 = 11.9 mΩ R 6 = 2.20 mΩ R 7 = 7.40 mΩ Find: V 6 and V 7 , the voltage drop across resistors R 6 and R 7 I 3 and I 6 , the current running through resistors R 3 and R 6 P 4 and P 7 , the power dissipated by resistors R 4 and R 7 Solution: First we'll import the necessary packages. I'm using a jupyter notebook, so the %matplotlib inline command is included. If you want high-resolution circuit diagrams, include the line: %config InlineBackend.figure_format = 'svg' at the top of the notebook will ensure high-resolution images. In [1]: import matplotlib.pyplot as plt # if using a jupyter notebook: include %matplotlib inline. If constructing a .py-file: comment out % matplotlib inline # if high-resolution images are desired: include %config InlineBackend.figure_format = 'svg' % config InlineBackend.figure_format = 'svg' import SchemDraw as schem import SchemDraw.elements as e Now we'll build the circuit diagram by creating a SchemDraw Drawing object and adding elements to it. In [2]: d = schem . Drawing ( unit = 2.5 ) R7 = d . add ( e . RES , d = 'right' , botlabel = '$R_7$' ) R6 = d . add ( e . RES , d = 'right' , botlabel = '$R_6$' ) d . add ( e . LINE , d = 'right' , l = 2 ) d . add ( e . LINE , d = 'right' , l = 2 ) R5 = d . add ( e . RES , d = 'up' , botlabel = '$R_5$' ) R4 = d . add ( e . RES , d = 'up' , botlabel = '$R_4$' ) d . add ( e . LINE , d = 'left' , l = 2 ) d . push () R3 = d . add ( e . RES , d = 'down' , toy = R6 . end , botlabel = '$R_3$' ) d . pop () d . add ( e . LINE , d = 'left' , l = 2 ) d . push () R2 = d . add ( e . RES , d = 'down' , toy = R6 . end , botlabel = '$R_2$' ) d . pop () R1 = d . add ( e . RES , d = 'left' , tox = R7 . start , label = '$R_1$' ) Vt = d . add ( e . BATTERY , d = 'up' , xy = R7 . start , toy = R1 . end , label = '$V_t$' , lblofst = 0.3 ) d . labelI ( Vt , arrowlen = 1.5 , arrowofst = 0.5 ) d . draw () d . save ( '7_resistors_3_loops.png' ) #d.save('7_resistors_3_loops.pdf') *{stroke-linecap:butt;stroke-linejoin:round;} Find R t Now we'll find the total resistance of the circuit R t using the individual resistances. First, define the resistances and driving voltage as variables. In [3]: Vt = 5.2 R1 = 0.0132 R2 = 0.021 R3 = 0.00360 R4 = 0.0152 R5 = 0.0119 R6 = 0.0022 R7 = 0.00740 Find R 45 and R 67 To simplify the circuit diagram, we'll combine the resistors in series. For resistors in a simple series circuit: $$ R_t = R_1 + R_2 + R_3 ... + R_n $$ Since resistors $R_4$ and $R_5$ are in simple series: $$ R_{45} = R_4 + R_5 $$ Since resistors $R_6$ and $R_7$ are in simple series: $$ R_{67} = R_6 + R_7 $$ We can easily calculate this with Python. After the calculation, we can use an fstring to print the results. Note the round() function is used on the inside of the fstring curly braces { } , in case there are some floating point math errors that lead to the values printing out as long floats. In [4]: R45 = R4 + R5 R67 = R6 + R7 print ( f 'R45 = {round(R45,7)} Ohm, R67 = {round(R67,5)} Ohm' ) R45 = 0.0271 Ohm, R67 = 0.0096 Ohm Let's redraw our circuit diagram to show the combined resistors. In [5]: d = schem . Drawing ( unit = 2.5 ) R67 = d . add ( e . RES , d = 'right' , botlabel = '$R_ {67} $' ) d . add ( e . LINE , d = 'right' , l = 2 ) d . add ( e . LINE , d = 'right' , l = 2 ) R45 = d . add ( e . RES , d = 'up' , botlabel = '$R_ {45} $' ) d . add ( e . LINE , d = 'left' , l = 2 ) d . push () R3 = d . add ( e . RES , d = 'down' , toy = R67 . end , botlabel = '$R_3$' ) d . pop () d . add ( e . LINE , d = 'left' , l = 2 ) d . push () R2 = d . add ( e . RES , d = 'down' , toy = R67 . end , botlabel = '$R_2$' ) d . pop () R1 = d . add ( e . RES , d = 'left' , tox = R67 . start , label = '$R_1$' ) Vt = d . add ( e . BATTERY , d = 'up' , xy = R67 . start , toy = R1 . end , label = '$V_t$' , lblofst = 0.3 ) d . labelI ( Vt , arrowlen = 1.5 , arrowofst = 0.5 ) d . draw () d . save ( '5_resistors_3_loops.png' ) #d.save('5_resistors_3_loops.pdf') *{stroke-linecap:butt;stroke-linejoin:round;} Find R 2345 Next we can combine the resistors in parallel. The resistors in parallel are $R_2$, $R_3$ and $R_{45}$. For a resistors in a simple parallel circuit: $$ \\frac{1}{R_t} = \\frac{1}{R_1} + \\frac{1}{R_2} + \\frac{1}{R_3} ... + \\frac{1}{R_n} $$ Since $R_2$, $R_3$ and $R_{45}$ are in parallel: $$ \\frac{1}{R_{2345}} = \\frac{1}{R_2} + \\frac{1}{R_3} + \\frac{1}{R_{45}} $$$$ R_{2345} = \\frac{1}{\\frac{1}{R_2} + \\frac{1}{R_3} + \\frac{1}{R_{45}}} $$ We can code this calculation in Python. To find the reciprocal, raise the combined sum to the negative one power. Remember, exponentiation is performed with a double asterisk ** in Python. In [6]: Vt = 5.2 R1 = 0.0132 R2 = 0.021 R3 = 0.00360 R4 = 0.0152 R5 = 0.0119 R6 = 0.0022 R7 = 0.00740 R45 = R4 + R5 R67 = R6 + R7 R2345 = (( 1 / R2 ) + ( 1 / R3 ) + ( 1 / R45 )) ** ( - 1 ) print ( f 'R2345 = {round(R2345,7)} Ohm' ) R2345 = 0.0027602 Ohm OK, now let's construct a new SchemDraw diagram of the simplified the circuit. In this diagram, we'll combine $R_2$, $R_3$ and $R_{45}$ into one big resistor, $R_{2345}$. In [7]: d = schem . Drawing ( unit = 2.5 ) R67 = d . add ( e . RES , d = 'right' , botlabel = '$R_ {67} $' ) R345 = d . add ( e . RES , d = 'up' , botlabel = '$R_ {2345} $' ) R1 = d . add ( e . RES , d = 'left' , tox = R67 . start , label = '$R_1$' ) Vt = d . add ( e . BATTERY , d = 'up' , xy = R67 . start , toy = R1 . end , label = '$V_t$' , lblofst = 0.3 ) d . labelI ( Vt , arrowlen = 1.5 , arrowofst = 0.5 ) d . draw () d . save ( '3_resistors_1_loop.png' ) #d.save('3_resistors_1_loop.pdf') *{stroke-linecap:butt;stroke-linejoin:round;} Find R t To find $R_t$, we again combine the resistors in series. The remaining resistors $R_1$, $R_{2345}$ and $R_{67}$ are in series: $$ R_{1234567} = R_1 + R_{2345} + R_{67} $$ We'll call the total resistance of the circuit $R_t$ which is equal to $R_{1234567}$ $$ R_t = R_{1234567} $$ Another calculation in Python. In [8]: Vt = 5.2 R1 = 0.0132 R2 = 0.021 R3 = 0.00360 R4 = 0.0152 R5 = 0.0119 R6 = 0.0022 R7 = 0.00740 R45 = R4 + R5 R67 = R6 + R7 R2345 = (( 1 / R2 ) + ( 1 / R3 ) + ( 1 / R45 )) ** ( - 1 ) Rt = R1 + R2345 + R67 print ( f 'Rt = {round(Rt,7)} Ohm' ) Rt = 0.0255602 Ohm Last circuit diagram. The simplest one. This SchemDraw diagram just includes $V_t$ and $R_t$. In [9]: d = schem . Drawing ( unit = 2.5 ) L2 = d . add ( e . LINE , d = 'right' ) Rt = d . add ( e . RES , d = 'up' , botlabel = '$R_ {t} $' ) L1 = d . add ( e . LINE , d = 'left' , tox = L2 . start ) Vt = d . add ( e . BATTERY , d = 'up' , xy = L2 . start , toy = L1 . end , label = '$V_t$' , lblofst = 0.3 ) d . labelI ( Vt , arrowlen = 1.5 , arrowofst = 0.5 ) d . draw () d . save ( '1_resistor_no_loops.png' ) #d.save('1_resistor_no_loops.pdf') *{stroke-linecap:butt;stroke-linejoin:round;} Find V 6 and V 7 Now that we've solved for the total resistance of the circuit $R_t$, we can find the total current running through the circuit using Ohm's Law $V = IR $. $$ V = IR $$$$ I = \\frac{V}{R} $$$$ I_t = \\frac{V_t}{R_t} $$ In [10]: Vt = 5.2 R1 = 0.0132 R2 = 0.021 R3 = 0.00360 R4 = 0.0152 R5 = 0.0119 R6 = 0.0022 R7 = 0.00740 R45 = R4 + R5 R67 = R6 + R7 R2345 = (( 1 / R2 ) + ( 1 / R3 ) + ( 1 / R45 )) ** ( - 1 ) Rt = R1 + R2345 + R67 It = Vt / Rt print ( f 'It = {round(It,2)} A' ) It = 203.44 A The total current of the circuit, $I_t$ is the same as the current running through resistor $R_6$ and resistor $R_7$. $$ I_t = I_6 = I_7 $$ We can apply Ohm's law to find $V_6$ now that we have $I_6$ and $I_7$. $$ V_6 = I_6 R_6 $$$$ V_7 = I_7 R_7 $$ In [11]: I6 = It I7 = It V6 = I6 * R6 V7 = I7 * R7 print ( f 'V6 = {round(V6,5)} V, V7 = {round(V7,5)} V' ) V6 = 0.44757 V, V7 = 1.50547 V Find I 3 and I 6 The total current of the circuit, $I_t$ is the same as the current running through resistor $R_{2345}$. $$ I_t = I_{2345} $$ We can apply Ohm's law to find $V_{2345}$ now that we have $I_{2345}$. $$ V_{2345} = I_{2345} R_{2345} $$ In [12]: I2345 = It V2345 = I2345 * R2345 print ( f 'V2345 = {round(V2345,5)} V' ) V2345 = 0.56153 V The voltage drop across resistor $R_3$ is the same as the voltage drop across resistor $R_{2345}$. $$ V_3 = V_{2345} $$ Since $V_3$ and $R_3$ are known, we can solve for $I_3$ using Ohm's law: $$ V = IR $$$$ I = \\frac{V}{R} $$$$ I_3 = \\frac{V_3}{R_3} $$ The current $I_6$ running through resistor $R_6$ is the same as the total current $I_t$. $$ I_6 = I_t $$ In [13]: V3 = V2345 I3 = V3 / R3 I6 = It print ( f 'I3 = {round(I3,2)} A, I6 = {round(I6,2)} A' ) I3 = 155.98 A, I6 = 203.44 A Find P 7 and P 4 Power is equal to voltage times current: $$ P = VI $$ According to Ohm's law: $$V = IR$$ If we substitute $V$ as $IR$ in the power equation we get: $$ P = (IR)(I) $$$$ P = I&#94;2 R $$ With a known $R_7$ and $I_7 = I_t$: $$ P_7 = {I_7}&#94;2 R_7 $$ In [14]: I7 = It P7 = R7 * I7 ** 2 print ( f 'P7 = {round(P7,2)} W' ) P7 = 306.27 W Current $I_{45}$ is equal to current $I_4$. Voltage $V_{45} = V_{2345}$. Using Ohm's Law again: $$ V = IR $$$$ I = \\frac{V}{R} $$$$ I_{45} = \\frac{V_{45}}{R_{45}} $$ In [15]: V45 = V2345 I45 = V45 / R45 print ( f 'I45 = {round(I45,3)} A' ) I45 = 20.721 A One more time using the power law: $$ P = I&#94;2 R $$ With a known $R_4$ and $I_4 = I_{45}$: $$ P_4 = {I_4}&#94;2 R_4 $$ In [16]: I4 = I45 P4 = R4 * I4 ** 2 print ( f 'P4 = {round(P4,4)} W' ) P4 = 6.5261 W Final Answer Let's print out all of the final values to three significant figures including units: In [17]: print ( f 'V6 = {round(V6,3)} V' ) print ( f 'V7 = {round(V7,2)} V' ) print ( f 'I3 = {round(I3,0)} A' ) print ( f 'I6 = {round(I6,0)} A' ) print ( f 'P4 = {round(P4,2)} W' ) print ( f 'P7 = {round(P7,0)} W' ) V6 = 0.448 V V7 = 1.51 V I3 = 156.0 A I6 = 203.0 A P4 = 6.53 W P7 = 306.0 W Conclusion SchemDraw is a great package for making circuit diagrams in Python. Python is also useful for doing calculations that involve lots of different values. Although none of the calculations in this problem were particularly difficult, keeping track of all the values as variables in Python can cut down on errors when there multiple calculations and many parameters to keep track of.","tags":"matplotlib","url":"circuit-diagram-problem-with-schemdraw.html","loc":"circuit-diagram-problem-with-schemdraw.html"},{"title":"Building an IoT Server with flask and Python - Part 3 Web API","text":"This is the third part of a series of posts about building an Internet of Things (IoT) server with flask , Python and ESP8266 microcontrollers. In the last post, we reviewed server and hardware setup. In this post, we'll build a web API with flask and push temperature data to our web API with a web browser. Table of contents: Introduction What is a web API? Web API Design Construct a flask web API Create a new route Create a new template Test the web API Summary Next steps Introduction We already have a working flask app hosted on Digital Ocean . Now we need to add a web API to the flask app's functionality. What is a web API? A web API is a web-based Application Programming Interface. That's a fancy way of saying a server that saves input or produces output based on a URL the server recieves from a web browser. An example of a web API is the ThingSpeak.com web API. When a web browser, like chrome, is directed to the followoing URL: https://api.thingspeak.com/channels/266256/fields/2/last.txt The response is a data entry stored on ThingSpeak.com that corresponds to: channel 266256 field 2 last entry .txt format If the URL pasted into the web browser is different, ThingSpeak.com's response will also be different. https://api.thingspeak.com/channels/9/fields/1/last.json The response to the URL above is a data entry stored on ThingSpeak.com that corresponds to: channel 9 field 1 last entry .json format Most web API's allow you to pull data off of their servers, but many web API's also give you the ability to put data up on their servers. If the URL pasted into the web browser is constructed in the format below, ThingSpeak.com will store a new data point. https://api.thingspeak.com/update?api_key=THECLASSAPIKEY&field1=87 The datapoint ThingSpeak.com stores when it recieves the GET request is: user with an API Key = THECLASSAPIKEY field = 1 data = 87 The web API we'll build with flask needs to fullfill the same two basic functions the ThingSpeak.com web API accomplishes: Output a data point based on the particular URL the flask IoT server receives Store a data point based on the particular URL the flask IoT server receives Web API Design We're going to mimic part of the ThingSpeak.com web API in our flask IoT server web API. In order to store a data point based on the URL the server recieves, we need to specify how the URL must be structured. Our ESP8266-based WiFi weather stations need to know the URL format in order to post data points on the flask IoT server. Data will be stored on our flask IoT server based on the URL the server recieves from the ESP8266-based WiFi weather stations. There are a couple unique aspects to each of the ESP8266-based WiFi weather stations: a user: Each WiFi weather station has a user. In this case the user is me. a mac address: A mac address is a unique address assigned to each piece of hardware. Each of the ESP8266-based WiFi weather stations has a different mac address. field: The ESP8266-based WiFi weather stations have the capability to output temperature and humidity. Right now we are just going to deal with temperature, but it would be nice to have an extra field available for multiple data streams (like temperature and humidity) from the same device. data: The temperature measurement which comes out of each ESP8266-based WiFi weather station. If we put these 4 identifiers as part of our web API URL, our IoT server will provide the functionality the WiFi weather stations need. The general form of our web API URL is below: https://mydomain.com/update/API_key=ASCIISTR/mac=6c:rf:7f:2b:0e:g8/field=1/data=72.3 In the URL above we've provided: update (to tell the IoT server to save the data point, not just serve a webpage) API_key=ASCIISTR (to identify the user) mac=6c:rf:7f:2b:0e:g8 (to identify the ESP8255-based WiFi weather station) field=1 (to specify the data is a temperature, not humidity) data=72.3 (to specify the temperature is 72.3 degrees) Now we need to make our flask IoT server save the data point when a URL like the one we specified above comes in. Construct a flask web API Building web API's in flask is pretty easy due to flask's option of including a variable in a route. The general syntax is below: @app.route ( \"/update/key=<route_var>\" , methods = [ 'GET' ]) def update ( route_var ): # code to run return render_template ( \"index.html\" ) In the code above, the route \"/update/key=<route_var>\" has a the variable <route_var> contained in it. The greater than/less than symbols < > tell flask there is a variable in the route. In the second line, the variable route_var (which came in from the @app.route() line) is passed as an argument to the update() function. Finally, the update() function returns a tempate called index.html . Create a new route There are four variables to assign in the @pp.route() URL of our flask web API: parameter purpose route variable API key unique identifier each user <api_key> mac address unique identifier for each ESP8266 device <mac> field denote temperature or humidity <field> data data point to save on the server <data> The complete @pp.route() URL for our web API looks like: \"/update/API_key=<api_key>/mac=<mac>/field=<int:field>/data=<data>\" We can now build a new @app.route() -function pair for this URL. Note we return a new template called update.html and pass the template the data point data . @app.route ( \"/update/API_key=<api_key>/mac=<mac>/field=<int:field>/data=<data>\" , methods = [ 'GET' ]) def update ( api_key , mac , field , data ): return render_template ( \"update.html\" , data = data ) Create a new template Since we are calling a new template, we need to construct a new template. The template update.html can have the same form as index.html . Let's create a new file and copy in the following html code and jinja fields. $ cd ~ $ cd flaskapp $ cd templates $ nano update.html The code for the new update.html template is below: <!-- update.html --> <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=edge\" > < meta name = \"viewport\" content = \"width=device-width, initial-scale=1\" > < title > show temp </ title > <!-- Latest compiled and minified CSS --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" integrity = \"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossorigin = \"anonymous\" > <!-- Optional theme --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\" integrity = \"sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp\" crossorigin = \"anonymous\" > <!-- Latest compiled and minified JavaScript --> < script src = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\" integrity = \"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa\" crossorigin = \"anonymous\" ></ script > </ head > < body > < div class = \"container-fluid\" > < div class = \"jumbotron\" > < hr class = \"my-4\" > < h1 class = \"display-4\" > {{ data }} </ h1 > < p class = \"lead\" > last temperature uploaded </ p > < hr class = \"my-4\" > </ div > </ div > </ body > </ html > Test the web API Now on our server, we can restart the flask app and see if our web API works. $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp # [ctrl-c] to exit. If we browse to the web address of the server, we should still see the same index template rendered. But now if we go to the web address: https://yourdomain.com//update/API_key=APGLMD/mac=a3:45:b5:c9/field=1/data=98.6 You see the update tempate rendered with a temperature of 98.6 shown. Summary It works! When we put a specific URL into our web browser, it causes the temperature we see on the web to change. Next steps In the next post, we'll modify our flask IoT server to do some validation of the input from the web API. We don't want just any person to bang away at the API and upload data points. We are also going to delve into Python's datetime module and add a datetime to each data point uploaded to our flask IoT server.","tags":"flask","url":"flask-iot-server-web-API.html","loc":"flask-iot-server-web-API.html"},{"title":"First Live Results Running Jupyter Hub in a College Class","text":"This is the eighth part of a multi-part series settting up Jupyter Hub for a college class. The Jupyter Hub Server is live and running! Students are logging in! In this quick post, I'll share my initial impressions running Jupyter Hub in the wild of a college engineering classroom. Posts in this series Why Jupyter Hub? Create ssh key, save to documents/ssh-keys Create a new Digital Ocean Droplet with a non-root sudo user Install Jupyter Hub on the server Apply SSL, link a domain name to the server and configure nginx Connect OAuth to Jupyter Hub Add a custom login page and assignments directory for each user on a Jupyter Hub server Initial first impressions of running Jupyter Hub live with students (this post) Last time In the last Jupyter Hub post , we added a custom login page to Jupyter Hub and built a way for a repo on GitHub to be pulled down and pre-populate each users' directory with assignments and notes. What the big deal was today The big deal today was that during lab this morning, 17 students (plus me) logged onto Jupyter Hub together - all at the same time - for the first time! I've tested the Jupyter Hub server for a couple weeks. One student logged in to the server and ran some notebooks. Another faculty member tested the server out too. But this morning was the first time all the students in one lab logged and ran notebooks all at the same time. What I was nervous about Before this morning, I was nervous about a couple of things in regards to the Jupyter Hub server students in the class will not be able to log in only some of the students will be able to log in the server will go down because everyone is logging in and using Jupyter Hub at the same time notes and assignments up on GitHub won't populate students' directory students won't be able to run notebooks at the same time because the server gets overloaded. What happened I'm pleased to report none of those worries came to fruition . What happened this morning was: All 17 students in the lab (plus me) logged into Juypter Hub successfully The Jupyter Hub server did not crash or run super slow when students logged in Each student got the assignments and notes from GitHub in their directory Students looked at notebooks and ran code cells at the same time The Jupyter Hub server never crashed What's next? Students have 3 labs using Jupyter Hub over the next 3 weeks. I'm interested to see (and really hope) we don't have any problems with the server in while students are completing their labs. Besides the server running, I'm also interested to see how the notes ( posted on Github ) and assignments ( posted on Github ) worked. Thank-you for all of your hard work. So far Jupyter Hub is working great! I want to say a big thank-you to Numfocus and the folks working on Project Jupyter. The Jupter Hub server is providing a diverse group of students an opportunity to learn Python programming without the hassle of any installation steps, administrator rights, PATH variables, virtual environments or complicated IDE's.","tags":"jupyter","url":"first-live-results-running-jupyter-hub.html","loc":"first-live-results-running-jupyter-hub.html"},{"title":"Building an IoT Server with flask and Python - Part 2 Set Up","text":"This post is the second part of a series of posts which detail building an Internet-of-Things (IoT) server with flask , Python and ESP8266 microcontrollers. In this post, we'll describe server setup and microcontroller hardware used in the project. Table of contents: Introduction Prerequisites Server Hardware The starting place Summary Next steps Introduction This flask IoT server project builds upon the ESP8266 WiFi weather station project and the flask app on Digital Ocean project . In the flask app on Digital Ocean project, a flask app pulled a measurement temperature down from ThingSpeak.com and displayed the temperature on a webpage. In the ESP8266 WiFi weather station project, an ESP8266 microcontroller (connected to a temperature sensor) posted the temperature up to ThingSpeak.com. The problem with using ThingSpeak.com as an IoT platform is there are limits to how often data can be posted. Building my own IoT server with flask is an exciting and interesting project and solves the \"only one data post every 15 seconds\" limitation imposed by ThingSpeak. Prerequisites Previously, I built a single page flask app that displays the temperature measured by WiFi weather stations. That single page flask app is running on a Digital Ocean cloud server. The flask app pulls a temperature data point using the ThingSpeak.com web API and displays the temperature on a webpage using flask and a jinja template. See the flask app hosted on Digital Ocean post to see the starting point for this project's flask IoT server. If you are starting from scratch, the prerequisites needed to build an Internet-of-Things server with flask , Python and ESP8266 microcontrollers are: Server A Digital Ocean cloud server (just called the server from here on out). See this post and part of this post. A domain name hooked up to the server. See part of this post. PuTTY or a terminal that can SSH into the server A non-root sudo user on the server. See part of this post. The following packages apt-get installed on the server: python3-pip python3-dev python3-setuptools python3-venv build-essential libssl-dev libffi-dev nginx A Python 3.6 virtual environment set up on the sever with flask and uwsgi pip install ed. See part of this post. uWSGI and NGINX installed on configured on the server. See part of this post. . The configuration files I used can be found on github: myproject.ini , wsgi.py , sites-avialable (nginx config) The flask app running as a system service. See this gist for the systemd flaskapp.service file. SSL attached to the domain name and NGINX instance. See part of this post and this post. The final web page produced by the flask app is below: Hardware The below is a list of hardware used to build the ESP8266-based WiFi weather stations. See this post and the Fritzing sketch below for hardware setup. Adafruit Feather Huzzah ESP8266 MCP9808 temperature sensor , BMP280 temperature sensor jumper wires , breadboard microUSB cable . Micropython firmware for the ESP8266 loaded on the ESP8266 board. See this post. The following .py files (available on github) were loaded onto the board with ampy : BMP280.py , MCP9808 , wifitools.py . See this post. Note that as part of this project, I'm using two ESP8266 microcontrollers. One ESP8266 is connected to a BMP280 temperature sensor and the other ESP8266 is connected to an MCP9808 temperature sensor. These two temperature sensors are leftover from previous projects (I would have used two of the same sensor, but one BMP280 and one MCP9808 is what I have lying around). One ESP8266-tempsensor combo is used to measure the temperature outside, the other ESP8266-tempsensor combo is used to measure the temperature inside. The starting place The flask app I built was relatively basic and mainly comprised of 2 files: flaskapp.py and index.html . The file structure on the Digital Ocean server looks like this: ~/ └── flaskapp ├── flaskapp.ini ├── flaskapp.py ├── flaskapp.sock ├── flaskappenv ├── templates │ ├── index.html └── wsgi.py The main file to run the flask app is flaskapp.py # flaskapp.py from flask import Flask , render_template import requests app = Flask ( __name__ ) @app.route ( \"/\" ) def index (): r = requests . get ( 'https://api.thingspeak.com/channels/254616/fields/1/last.txt' ) temp_c_in = r . text temp_f = str ( round ((( 9.0 / 5.0 ) * float ( temp_c_in ) + 32 ), 1 )) + ' F' return render_template ( \"index.html\" , temp = temp_f ) if __name__ == \"__main__\" : app . run ( host = '0.0.0.0' ) The only jinja template used by the flask app to build web pages was in the /templates directory and named index.html : <!-- index.html --> <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=edge\" > < meta name = \"viewport\" content = \"width=device-width, initial-scale=1\" > < title > show temp </ title > <!-- Latest compiled and minified CSS --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" integrity = \"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossorigin = \"anonymous\" > <!-- Optional theme --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\" integrity = \"sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp\" crossorigin = \"anonymous\" > <!-- Latest compiled and minified JavaScript --> < script src = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\" integrity = \"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa\" crossorigin = \"anonymous\" ></ script > </ head > < body > < div class = \"container-fluid\" > < div class = \"jumbotron\" > < hr class = \"my-4\" > < h1 class = \"display-4\" > {{ temp }} </ h1 > < p class = \"lead\" > temperature inside </ p > < hr class = \"my-4\" > </ div > </ div > </ body > </ html > With the flask app created and the domain name, nginx , uWSGI , systemd and SSL configured- the app is started on the server with: $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp # [ctrl-c] to exit. The resulting web page looks like this: Summary This post detailed the server setup and microcontroller hardware used in our IoT server with flask and Python project. The server running on Digital Ocean has a domain name connected to it and is running a nginx → uWSGI → flask web stack. The flask app currently returns a webpage with a temperature pulled from ThingSpeak.com. The hardware includes two Adafruit Feather Huzzah ESP8266 microcontrollers connected to temperature sensors. Next steps In the next post, we'll build a web API with flask and push temperature values up to our very own IoT server.","tags":"flask","url":"flask-iot-server-setup.html","loc":"flask-iot-server-setup.html"},{"title":"Building an IoT Server with Flask and Python - Part 1 Motivation","text":"This post is the first part of a series of blog posts about building an Internet-of-Things (IoT) server with flask , Python and ESP8266 microcontrollers. In this post we'll I'll discuss the problem I'm trying to solve and the issues I have with the current solution. We'll also review what the Internet-of-Things (IoT) is, and what an IoT server does. Table of contents: Introduction IoT Devices IoT Servers The Problem The Heat Problem The ThingSpeak.com Problem Proposed Solution IoT Server Requirements Project steps Next steps Introduction In the next couple of posts, I'm going to demonstrate how I built an Internet-of-Things server with flask and Python. The Internet-of-Things (IoT) is a network of computers, phones, tablets and physical devices like thermostats, garage door openers, light bulbs, doorbell cameras, weather stations connected to each other. When we talk about the Internet , we are usually referring to computers, tablets, phones and servers communicating with web pages, programs and apps. The Internet-of-Things builds on the Internet by including devices other than computers, phones, tablets and servers. IoT Devices I have two ESP8266-based WiFi weather stations. These little devices are part of the Internet-of-Things. The little WiFi weather stations cost about $20 each and run on very little power. The weather stations are made up of an ESP8266 microcontroller and a temperature sensor connected with jumper wires and a bread board. The ESP8266-based WiFi weather stations beam temperature measurements up to servers in the cloud. These WiFi weather stations are IoT devices . IoT Servers Servers that interact with Internet-of-Things devices (like my ESP8266-based WiFi weather stations) are called Internet-of-Things servers or IoT servers . IoT servers communicate with IoT devices . At the start of this project, the ESP8266-based WiFi weather stations communicated with ThingSpeak.com IoT servers. The WiFi weather stations send temperature measurements up to the ThingSpeak.com IoT servers where the data is saved. In a previous post I described how to build a flask single page web app that pulls temperature data from the ThingSpeak.com IoT servers using a web API. The Problem There are two problems I am trying to solve with this project. One problem is keeping the house cool in the summer heat. The other problem is ThingSpeak.com posting limits. The Heat Problem I live in Portland, OR and it was HOT last week. One day last week, the temperature outside climbed to 98 °F. I know if you live in Ft. Worth, TX- 98 °F isn't too severe. However, in the Pacific Northwest, 98 °F is HOT . One way to keep our house cool is to open windows at night and use fans to blow cold outside air into the hot, stuffy house. The question is: Question: \"When should I open windows and turn on fans to keep the house cool?\" During the day, it is hotter outside than inside, so I keep the windows closed. However, it has been so hot- that even after the sun goes down, it is still hotter outside than inside. What I want to know is: when does the temperature outside go lower than the temperature inside? When that I happens, I'll open the windows and blow cold, fresh air inside. I also want to know when the temperature outside gets hotter than the temperature inside. When that happens, I'll close the windows and turn off the fans. The ThingSpeak.com Problem Last week, the solution to knowing the temperature inside/temperature outside problem was tackled with ESP8266-based WiFi weather stations. One WiFi weather station is taped to a window outside my kids' room, and another WiFi weather station sat on top of my daughter's dresser. These WiFi weather stations measure temperature once every 60 seconds and post the temperature to ThingSpeak.com The WiFi weather stations connected to ThingSpeak.com worked pretty well. However, there were a couple of issues. One issue is the 15 second limit between data point uploads imposed ThingSpeak. With two weather stations publishing a data point every 60 seconds, it seems like the data points would be 30 seconds apart. On average every 30 seconds, one of the two weather stations publishes a temperature to ThingSpeak. But the 30-second interval between posts to ThingSpeak is dependant upon the two weather stations synched in time, so that the two stations measure and send temperatures 30 seconds apart. In practice, when I power up both ESP8266-based WiFi weather stations, it is hard to get one plugged in- then precisely 30 seconds- later plug the other one in. Plus if I unplug only one of the weather stations, it isn't practically possible to know when exactly to plug it back in. Maybe when it is plugged back in, one weather station takes a temperature at 0:02 minutes past the minute mark and the other weather station takes the temperature at 0:10 seconds past the minute mark. If that's the case, then the two temperature measurements are sent within one 15-second interval. Within one 15-second interval, ThingSpeak only records the data from one of weather stations. Proposed Solution I propose to solve this problem by building my own Internet-of-Things server with flask and Python. With my own IoT server, I can set the limit of how often devices (WiFi weather stations) can post data points. Since I only have two weather stations, the IoT server can accept data points at a faster rate than every 15 seconds. In addition to solving a problem, this project also interests me. I already built a single page web app with flask and Python . How can this previous project be taken further? One way of extending the previous project is to turn the single page web app into an IoT server. IoT Server Requirements What must our IoT server running flask and Python be able to do? The IoT server needs to fulfill two primary functions: Accept and store temperature measurements from two ESP8266-based WiFi weather stations Publish the temperature measured by two ESP8266-base WiFi weather stations to a webpage Project steps Building an IoT server with flask and Python is a multi-part problem. We can break the problem down into steps: Setup Build a flask -based server running in the cloud (Digital Ocean) assemble the hardware for the WiFi weather stations Construct a web API with flask and Python that accepts requests from web browsers and saves data points Add a database to the server to save the data points that come in from the WiFi weather stations Upload code on the ESP8266-based WiFi weather stations to send temperature measurements using the server's web API Next steps In the next post, we will complete the initial setup of the server and hardware. The server setup includes starting a new Droplet (a server) on Digital Ocean. The hardware setup includes connecting two ESP8266 microcontrollers to temperature sensors.","tags":"flask","url":"flask-iot-server-motivation.html","loc":"flask-iot-server-motivation.html"},{"title":"Building a single page Flask App on Digital Ocean","text":"In this post, we'll run through how to set up a single page flask app that shows a temperature pulled from ThingSpeak.com . ThingSpeak has nice looking graphs, but on ThingSpeak it is actually kind of hard to see the value of an individual data point. I want to be able to see the most recent temperature point recorded by my ESP8266 WiFi weather station project on a phone or tablet. By building a flask app and hosting it on Digital Ocean, I can now view the current temperature in a nice big font from anywhere. Table of contents: Set up a new Digital Ocean Droplet Create a new Droplet Login to server with PuTTY Create a non-root sudo user Copy SSH keys to the non-root sudo user Acquire and configure a domain name Purchase a domain name Point DNS severs at Digital Ocean Link the domain name to the server IP address Build the Flask App Install packages Create a virtual environment and install flask Build the first simple flask app Testing the first simple flask app Set up uWSGI and systemctl Configuring uWSGI Testing uWSGI Construct the uWSGI configuration file Construct a systemd file Test with systemctl Configure NGINX and apply SSL security Install NGINX Configure NGINX Apply SSL Security Add Bootstrap styling Pull the temperature from ThingSpeak.com with requests View the final flask app online Summary Set up a new Digital Ocean Droplet The flask app needs a server to run on. I choose Digital Ocean as my cloud server provider. Digital Ocean hosts virtual private servers that run in the cloud. Setting up a server on Digital Ocean is pretty cheap ($5/month) and quick. I host my Jupyter Hub server on Digital Ocean, so I am also more familiar with spinning up their servers compared to other cloud providers like Linode or AWS. I like their documentation. It is clear, concise and easy to follow. To set up the server for the flask app, I created a new Droplet on Digital Ocean. After creating a new server, it is best practice to create a non-root sudo user. Create a new Droplet Our flask single page web app built with Python will be hosted on Digital Ocean . To create a new cloud server, called a Droplet in DigitalOcean-speak, create an account on Digital Ocean. Once logged in select Create → Droplets in the upper right menu. The Digital Ocean Droplet options I choose were: Ubuntu 18.04.1 x64 Size: Memory 1G, SSD 25 GB, Transfer 1 TB, Price $5/mo Datacenter Region: San Fransisco 2 Additional Options: None SSH keys: Added all of my saved SSH keys . You need this to log into the server with PuTTY! Create the server with the big green [ Create ] button. After the Droplet is created, note the IP address of the server. We'll need the IP address of the droplet for the next step. Login to server with PuTTY Our first interaction with the server is to log in as root. Then we'll create a non-root sudo user to interact with the server from then on out. Open PuTTY and log onto the server as root. See a previous post on how to set up PuTTY on Windows 10. To log into the server as root, set the following in PuTYY: Hostname (or IP Address): The IP address of the server Port: 22 Connection Type: SSH Connection: Data: Auto-login username: root Connection: SSH: Auth: Private keyfile for Authentication: your saved private SSH key Create a non-root sudo user I followed the Digital Ocean Initial Server Setup Tutorial to create a non-root sudo user. The commands entered into the PuTTY SSH terminal are below. Note you should change the username to something other than peter . Here and in the Digital Ocean tutorial , a hash symbol # is shown before the commands. The hash # symbol should not be typed, it just represents the fact we are operating as root. # adduser peter # usermod -aG sudo peter # ufw allow OpenSSH # ufw enable Copy SSH keys to the non-root sudo user Next we'll move the SSH keys stored in the root user's profile to the new sudo user's profile (in my case peter ). I've had trouble moving SSH key files and setting permissions correctly in Linux. A Digital Ocean tutorial has a great line that copies the SSH Keys and sets the permissions correctly in one step. If you skip this step, you won't be able to log into the server as the new non-root sudo user you just created. Note you should change the user name from peter to whatever username you picked in the previous step. # rsync --archive --chown=peter:peter ~/.ssh /home/peter Now let's check if we can log into the server as the new user. Exit the PuTTY window by typing exit at the prompt. Open up a new SSH session in PuTTY. Set Connection → Data → Auto-login username as the non-root sudo user. (I put peter in the Auto-login username box). When the terminal window opens, you should see your username listed before the prompt. At the prompt, try the following command. Note the dollar sign $ does not need to be typed. The dollar sign $ is there to indicate the command prompt. $ sudo -l User peter may run the following commands on flask-app-server: ( ALL : ALL ) ALL You can type the command exit to close the PuTTY terminal. Acquire and configure a domain name To use secure SSL connections and https with our flask single page app, we need a real domain name. Purchase a domain name I bought my domain name at Google Domains for $12/year. The price seems reasonable and Digital Ocean has a tutorial that shows how to connect a google domains to Digital Ocean DNS servers. Point DNS severs at Digital Ocean Once the domain is purchased, the domain's Name Server needs to be pointed at Digital Ocean. Link the domain name to the server IP address On Digital Ocean, login and click [Create] → [Domains/DNS]. Type in the newly purchased domain name in the box and click [Add Domain]. Link the new Domain to the Digital Ocean Droplet by typing in the @ symbol in the [HOSTNAME] box and selecting the new Droplet name in the [WILL DIRECT TO] drop down box. Click [Create Record] to link the domain name to the server. You can also link www in the [HOSTNAME] box and select the new Droplet in the [WILL DIRECT TO] dropdown box to link www.yourdomain.com to the server. Build the Flask App Now that the server is set up and the domain name is routed to the server, it's time to actually build the flask single page web app. Install packages Before the single page flask app can be built, a number of packages need to be installed on the server. I followed along with this tutorial from Digital Ocean. Log onto the server with PuTTY and type the following commands: $ sudo apt-get update $ sudo apt-get upgrade $ sudo apt-get install python3-pip $ sudo apt-get install python3-dev $ sudo apt-get install python3-setuptools $ sudo apt-get install python3-venv $ sudo apt-get install build-essential libssl-dev libffi-dev Create a virtual environment and install flask Once the necessary libraries are installed, I created a virtual environment to run the flask app. I usually use conda to create virtual environments (see this post ), but since I'm not using the Anaconda distribution of Python for this flask app, venv will have to do instead. $ cd ~ $ mkdir flaskapp $ cd flaskapp $ python3.6 -m venv flaskappenv $ source flaskappenv/bin/activate With the virtual environment created and activated, install wheel , flask , uwsgi and requests with pip . We'll use requests a little later to pull down temperature data from ThingSpeak.com. Note that (flaskappenv) is shown before the command prompt when the virtual environment is active. Make sure to only pip install within the (flaskappenv) virtual environment. ( flaskappenv ) $ pip install wheel ( flaskappenv ) $ pip install flask ( flaskappenv ) $ pip install uwsgi ( flaskappenv ) $ pip install requests Build the first simple flask app With the Python packages installed, next we'll build a very simple version of the flask app and viewed it in a web browser. ( flaskappenv ) $ pwd # ~/flaskapp ( flaskappenv ) $ nano flaskapp.py In the flaskapp.py file, I included the bare minimum flask app to test the server: # flaskapp.py from flask import Flask app = Flask ( __name__ ) @app.route ( \"/\" ) def index (): return \"<h1>The temperature is 91.2 F</h1>\" if __name__ == \"__main__\" : app . run ( host = '0.0.0.0' ) A note about editing code in the nano text editor thru PuTTY: You can paste into a PuTTY terminal window using the right mouse button. Selecting text in PuTTY copies the text to the clip board. Don't use [ctrl-c] or [ctrl-v] to copy and paste in PuTTY. Exit the nano text editor with [ctrl-x]. Testing the first simple flask app With the first version of flaskapp.py complete, Let's run the flask app for the first time to test that everything is working properly. To run the flask app, I had to make sure I was in the virtual environment built earlier. I also needed to allow port 5000 open on the ufw firewall. Port 5000 is the default port flask runs on. (flaskappenv)$ sudo ufw allow 5000 (flaskappenv)$ python flaskapp.py It works! By pointing a browser to the Droplet IP address followed by :5000 , I can see the simple message: \"The temperature is 91.2 F\". 124.822.76.209:5000 Set up uWSGI and systemctl There are going to be two layers between the flask app and the outside internet. Get requests from web browsers will first come into NGINX then go to uWSGI before being passed to flask . Configuring uWSGI We installed uWSGI earlier when we pip installed flask . Now uWSGI needs to be configured and tested. I followed the Digital Ocean tutorial closely for this step. ( flaskappenv ) $ pwd # ~/flaskapp ( flaskappenv ) $ nano wsgi.py In the wsgi.py file, include: # wsgi.py from flaskapp import app if __name__ == \"__main__\" : app . run () Testing uWSGI Next, let's test the configuration. uWSGI can be run from the command line with a couple flags: ( flaskappenv ) $ uwsgi --socket 0 .0.0.0:5000 --protocol = http -w wsgi:app When I point a browser to the droplet IP address followed by :5000 , I see the simple message again: \"The temperature is 91.2 F\". The flask app still seems to be working! Construct the uWSGI configuration file Now for another layer of uWSGI goodness- building a uWSGI .ini configuration file. ( flaskappenv ) $ deactivate $ pwd # ~/flaskapp $ nano flaskapp.ini Inside the flaskapp.ini file, include the following: [uwsgi] module = wsgi:app master = true processes = 5 socket = flaskapp.sock chmod-socket = 660 vacuum = true die-on-term = true Construct a systemd file Because we want to have the flask app running all the time, let's create a systemd control file to get the flask app running as a system service on the server. $ sudo nano /etc/systemd/system/flaskapp.service In the flaskapp.service file, I included the following as described in the Digital Ocean tutorial . Note the username peter should be replaced with your non-root sudo user. [Unit] Description=uWSGI instance to serve flaskapp After=network.target [Service] User=peter Group=www-data WorkingDirectory=/home/peter/flaskapp Environment=\"PATH=/home/peter/flaskapp/flaskappenv/bin\" ExecStart=/home/peter/flaskapp/flaskappenv/bin/uwsgi --ini flaskapp.ini [Install] WantedBy=multi-user.target Test with systemctl After the flaskapp.service file is created, we need to reload the systemctl daemon before starting the flaskapp service. $ sudo systemctl daemon-reload $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp The status call should show the service as active (running) . Something like the message below. flaskapp.service - uWSGI instance to serve flaskapp Loaded: loaded (/etc/systemd/system/flaskapp.service; disabled; vendor preset Active: active (running) since Wed 2018-09-12 18:09:15 UTC; 7s ago Use [ctrl-c] to exit the status screen. [ctrl-c] will not stop the service. Configure NGINX and apply SSL security We'll use NGINX as a proxy server to work with uWSGI and the flask app. The general control flow resulting from GET request will be: GET request → NGINX → uWSGI → flaskapp Install NGINX Before we can use NGINX, NGINX needs to be installed on the server. Installation is a simple apt-get command. Note that NGINX starts running as soon as it is installed. $ sudo apt-get install nginx Configure NGINX To use NGINX as part of the web stack, we need to create a configuration file in the /etc/nginx/sites-available/ directory. The Digital Ocean tutorial was really helpful for this step. NGINX configuration was something I struggled with when I built my Jupyter Hub server . $ sudo nano /etc/nginx/sites-available/flaskapp Edit the flaskapp NGINX config file the /sites-available directory to include the following. Make sure to change the your_domain and www.your_domain fields: server { listen 80; server_name your_domain wwww.your_domain; location / { include uwsgi_params; uwsgi_pass unix:/home/peter/flaskapp/flaskapp.sock; } } Now we'll link the NGINX config file to the /etc/nginx/sites-enabled directory and restart NGINX with the new configuration. If something doesn't look right on the systemctl status screen, you can check for problems with the command sudo nginx -t . $ sudo ln -s /etc/nginx/sites-available/flaskapp /etc/nginx/sites-enabled $ sudo systemctl restart nginx $ sudo systemctl status nginx #ctrl-c to exit Now that NGINX and uWSGI are running, let's also shut off the :5000 development port. $ sudo ufw delete allow 5000 $ sudo ufw allow 'Nginx Full' Browse to the web address of the server. This time you won't need to append the address with :5000 . Also the web address can be your domain name, not just the server IP address You should see the message: \"The temperature is 91.2 F\". http://mydomain.com/ Apply SSL Security One of the reasons for getting a real domain name is so the server can run with SSL security and https. Adding SSL can be done with certbot , a Python program that assists with generating SSL certificates. I followed the Digital Ocean tutorial steps to acquire the certificate. Make sure to replace your_domain with your actual domain name. $ sudo add-apt-repository ppa:certbot/certbot $ sudo apt install python-certbot-nginx $ sudo certbot --nginx -d mydomain.com -d www.mydomain.com As part of the certbot setup, I selected option 2. 2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for new sites, or if you're confident your site works on HTTPS. You can undo this change by editing your web server's configuration. If certbot is successful, you will see a message similar to this: IMPORTANT NOTES : - Congratulations ! Your certificate and chain have been saved at : / etc / letsencrypt / live / mydomain . com / fullchain . pem Your key file has been saved at : / etc / letsencrypt / live / mydomain . com / privkey . pem ``` Now we no longer need to run NGINX with HTTP , since we can now run NGINX with HTTPS . All the HTTP traffic will be forwarded to HTTPS . ``` bash $ sudo ufw delete allow 'Nginx Full' $ sudo ufw allow 'Nginx HTTPS' Add Bootstrap styling The single page app is pretty basic right now. It also isn't designed to look good on phones or tablets. I plan on using my phone to view the flask app most of the time, so I decided to use bootstrap styling and the jumbotron component from bootstrap in the flask app. To keep things simple, I used the bootstrap CDN instead of installing the whole bootstrap package to the server. On the bootstrap3 install page is the content we need to add to the top of our .html template. To make the temperature display look nicer, I utilized the bootstrap jumbotron component . If you follow the link, you will see a couple lines of html that need to be included first in the <header> portion of the template. To add the bootstrap styling I created a jinga template called index.html and placed a modified version of the html for the jumbotron component and bootstrap CDN inside. On the server, we need to create a templates directory to store the jinja template. <main_app>/templates is the default location for jinga templates when running flask . $ cd ~/flaskapp $ mkdir templates $ cd templates $ nano index.html The index.html template contains a <header> with the bootstrap3 CDN and a <body> which contains the jumbotron component. <!-- index.html --> <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=edge\" > < meta name = \"viewport\" content = \"width=device-width, initial-scale=1\" > < title > show temp </ title > <!-- Latest compiled and minified CSS --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" integrity = \"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossorigin = \"anonymous\" > <!-- Optional theme --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\" integrity = \"sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp\" crossorigin = \"anonymous\" > <!-- Latest compiled and minified JavaScript --> < script src = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\" integrity = \"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa\" crossorigin = \"anonymous\" ></ script > </ head > < body > < div class = \"container-fluid\" > < div class = \"jumbotron\" > < hr class = \"my-4\" > < h1 class = \"display-4\" > 91.4 F </ h1 > < p class = \"lead\" > temperature inside </ p > < hr class = \"my-4\" > </ div > </ div > </ body > </ html > Now we need to modify the flaskapp.py file to point to our index.html template. A new flask function, render_template() is used. render_template must be included in the imports and is used as the return action of the @app.route(\"/\") index() function. $ nano ~/flaskapp/flaskapp.py The revised flaskapp.py file is below. # flaskapp.py from flask import Flask , render_template app = Flask ( __name__ ) @app.route ( \"/\" ) def index (): return render_template ( \"index.html\" ) if __name__ == \"__main__\" : app . run ( host = '0.0.0.0' ) We can view our changes by reloading the flaskapp system service and browsing to the server domain's main page. $ sudo systemctl stop flaskapp $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp # [ctrl-c] to exit Pull the temperature from ThingSpeak.com with requests The final step of this flask single page app project is to dynamically pull the temperature from ThingSpeak.com and show it as a web page. Right now the flask app only shows the static temperature 91.4 F . However, the whole point of the app is to see the current temperatures the WiFi weather stations measure. To grab the temperatures off of ThingSpeak.com, we'll use the requests package. According to the ThingSpeak.com web API documentation , the format of our GET request needs to be: https://api.thingspeak.com/channels/<channel_id>/fields/<field_id>/last.<format> <channel_id> corresponds to the channel number on ThingSpeak.com. My WiFi weather stations are on a public channel. <field_id> is the field number held by the ThingSpeak channel. Each ThingSpeak channel can have multiple fields. The temperature we care about is in field 1 . The <format> we want is .txt . We could grab .json or a .csv off of ThingSpeak, but since we only need one temperature reading at a time, .txt is the easiest. Let's try out the ThingSpeak web API using the Python REPL. Make sure requests is installed in the virtual environment before importing it. On the server try: $ source ~/flaskapp/flaskappenv/bin/activate ( flaskappenv ) $ python >>> import requests >>> r = requests.get ( 'https://api.thingspeak.com/channels/266256/fields/2/last.txt' ) >>> print ( r.text ) -1 >>> exit () ( flaskappenv ) $ deactivate $ Now we need to use this same web API call shown above in the flask app. Modify flaskapp.py to include the requests package and include the web API request as a line the index() function. I also included a line to convert the temperature from °F to °C. When the temperature value comes in from ThingSpeak, it is a string. The temperature value needs to be converted to a float before the °C to °F conversion can be accomplished. After the conversion, the temperature in °F needs to be converted back to a string. A string is needed because the temperature in °F is passed to the render_template() function as the parameter temp will be used in a revised version of our jinja template index.html . The extra argument in the render_template() function transfers the variable temp_f from the flaskapp.py file to the jinja template index.html . $ nano ~/flaskapp/flaskapp.py The modified flaskapp.py script is below: # flaskapp.py from flask import Flask , render_template import requests app = Flask ( __name__ ) @app.route ( \"/\" ) def index (): r = requests . get ( 'https://api.thingspeak.com/channels/254616/fields/1/last.txt' ) temp_c_in = r . text temp_f = str ( round ((( 9.0 / 5.0 ) * float ( temp_c_in ) + 32 ), 1 )) + ' F' return render_template ( \"index.html\" , temp = temp_f ) if __name__ == \"__main__\" : app . run ( host = '0.0.0.0' ) Finally, we need to modify the index.html template and test the whole flask app. We passed a parameter temp from flaskapp.py to this template. The temp parameter can be used programmatically in the jinja index.html template. The value stored in temp will end up displayed on the working web page. Jinja templates use code blocks that start and end with double curly brackets {{ }} . Our temp parameter goes into one of these blocks. $ cd ~/flaskapp/templates $ nano index.html The revised index.html file is below: <!-- index.html --> <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=edge\" > < meta name = \"viewport\" content = \"width=device-width, initial-scale=1\" > < title > show temp </ title > <!-- Latest compiled and minified CSS --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" integrity = \"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossorigin = \"anonymous\" > <!-- Optional theme --> < link rel = \"stylesheet\" href = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\" integrity = \"sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp\" crossorigin = \"anonymous\" > <!-- Latest compiled and minified JavaScript --> < script src = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\" integrity = \"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa\" crossorigin = \"anonymous\" ></ script > </ head > < body > < div class = \"container-fluid\" > < div class = \"jumbotron\" > < hr class = \"my-4\" > < h1 class = \"display-4\" > {{ temp }} </ h1 > < p class = \"lead\" > temperature inside </ p > < hr class = \"my-4\" > </ div > </ div > </ body > </ html > View the final flask app online With the changes to readtemp.py and index.html complete, we can restart the flask app system service and view our app with a web browser. $ sudo systemctl stop flaskapp $ sudo systemctl start flaskapp $ sudo systemctl status flaskapp # [ctrl-c] to exit The final single page flask web app is complete! If everything is working correctly, you should see the working app running on your domain looks like this. Summary It was a long process to construct this flask single page webapp project. A lot for technologies and languages were used. An incomplete list is below: cloud servers DNS Servers Linux SSH and SSH keys PuTTY Python Flask systemd uWSGI NGINX SSL and certbot web API's jinja templates html bootstrap That's a lot of stuff to go in one project. The next thing I'm thinking about is building a flask IoT (internet of things) server that accepts GET requests from ESP8266 weather stations . ThingSpeak.com works great as an IoT sever, but there are limits to how often data can be posted and how often data can be accessed. I think writing my own IoT server in flask would be fun too!","tags":"flask","url":"flask-app-on-digital-ocean.html","loc":"flask-app-on-digital-ocean.html"},{"title":"Upload Micropython Code to an Adafruit Feather Huzzah ESP8266","text":"This is the sixth part of a multi-part series on Micropython. In this post, we will upload .py files to an Adafruit Feather Huzzah ESP8266 board using Python and a Python package called ampy . At the end of the post we will have a working WiFi weather station that will post the temperature to ThingSpeak.com Before we can use the Microython REPL (the Micropython prompt) running on the Adafruit Feather Huzzah ESP8266, Micropython needs to be installed on the ESP8266 board and PuTTY needs to be installed on the computer to communicate with the board over a serial connection. See a previous post on how to install Micropython on an ESP8266 board and how to install PuTTY on a Windows 10 machine. Summary of Steps: Install ampy with pip Write Python code in .py files Upload the .py files to the board with ampy Unplug and power up the Feather Huzzah and watch the data on ThingSpeak.com 1. Install ampy with pip Ampy is a tool written by the good folks at Adafruit. Ampy is used to upload files onto the ESP8266. Since I'm using a virtual environment, I need to activate the virtual environment first before installing ampy . Note that the tool is called ampy , but we pip install ampy-adafruit . $ conda activate micropython ( micropython ) $ pip install ampy-adafruit ( micropython ) $ ampy --help 2. Write Python code in .py files Now we need to write the Python code in .py files that will run on the ESP8266 board. The board already contains two main Python files: boot.py and main.py . We can also add additional files to the board. boot.py is the file that runs first when the board is powered up. After boot.py runs, then main.py runs. We can add other .py files to the board to provide main.py some functions and classes to work with. We have two general things to do with our Feather board: read the temperature and post the temperature to the ThingSpeak.com. We'll use a different .py file for each of these two general tasks. The first module, MCP9808.py , will simplify reading temperature data off of the Adafruit MCP9808 temperature sensor breakout. We need to write a readtemp() function that parses out the temperature data from the I2C bus and outputs the temperature as a float. The readtemp() function needs to import the machine module to use the I2C bus. The machine module allows us to create a new I2C object. When we instantiate the I2C object object, we need to specify the scl and sda pins connected to the sensor. scl is the I2C clock line and sda is the I2C data line. on the Adafruit Feather Huzzah scl is pin 5 and sda is pin 4 . Then a new byte array variable needs to be created. A byte array is needed to store the temperature data when it comes over the I2C line from the sensor to the board. Then we need to read the sensor data using the i2c.readfrom_mem_into() function. The first argument is the I2C bus address of the sensor. In our case, the sensor is at I2C bus address 24 . You can use the line >>> i2c.scan() in the Micropython REPL to see this value. The next argument passed to the i2c.readfrom_mem_into() function is the register on the MCP9808 temperature sensor where the temperature value is stored. The temperature is stored on the MCP9808 in register 5 . When we access register 5 on the MCP9808, we read in the temperature. The final argument passed into the i2c.readfrom_mem_into() function is the byte array variable that stores the temperature data. The i2c.readfrom_mem_into() function modifies the variable passed to it as a function argument, rather than producing a variable which is the function output as most functions do. This is why we needed to first create the byte_data variable before calling the i2c.readfrom_mem_into() function. Finally, we need to do some post processing of the byte array to transform it into a temperature in degrees C. The complete readtemp() function is below: # MCP9808.py # Functions for the MCP9808 temperature sensor # https://learn.adafruit.com/micropython-hardware-i2c-devices/i2c-master def readtemp (): import machine i2c = machine . I2C ( scl = machine . Pin ( 5 ), sda = machine . Pin ( 4 )) byte_data = bytearray ( 2 ) i2c . readfrom_mem_into ( 24 , 5 , byte_data ) value = byte_data [ 0 ] << 8 | byte_data [ 1 ] temp = ( value & 0xFFF ) / 16.0 if value & 0x1000 : temp -= 256.0 return temp Now we'll build a Python file that contains a set of WiFi functions called wifitools.py . We used this same functionally in a previous post to connect the ESP8266 to a WiFi network. In addition to the WiFi functions, we also need a function to build the ThingSpeak.com web API URL. This is the URL we will request in order to get our temperature posted on ThingSpeak.com. #wifitools.py # Wifi connection and ThingSpeak.com post functions for an ESP8266 board running Micropython #https://docs.micropython.org/en/v1.8.6/esp8266/esp8266/tutorial/network_basics.html def connect ( SSID , password ): import network sta_if = network . WLAN ( network . STA_IF ) if not sta_if . isconnected (): print ( 'connecting to network...' ) sta_if . active ( True ) sta_if . connect ( SSID , password ) while not sta_if . isconnected (): pass print ( 'network config:' , sta_if . ifconfig ()) #https://docs.micropython.org/en/v1.8.6/esp8266/esp8266/tutorial/network_tcp.html def http_get ( url ): import socket _ , _ , host , path = url . split ( '/' , 3 ) addr = socket . getaddrinfo ( host , 80 )[ 0 ][ - 1 ] s = socket . socket () s . connect ( addr ) s . send ( bytes ( 'GET / %s HTTP/1.0 \\r\\n Host: %s \\r\\n\\r\\n ' % ( path , host ), 'utf8' )) while True : data = s . recv ( 100 ) if data : print ( str ( data , 'utf8' ), end = '' ) else : break def thingspeak_post ( API_key , data ): if not isinstance ( data , str ): data = str ( data ) if not isintance ( API_key , str ): API_key = str ( API_key ) base_url = 'https://api.thingspeak.com/update' API_key = '?api_key=' + API_key field = '&field1=' url = base_url + API_key + field + data http_get ( url ) Now let's write a script in a file called main.py which will use the functions in our wifitools.py and MCP9808.py files. This main.py script will import our MCP9808 and wifitools modules and use the wifitools.connect() function to connect the ESP8266 to a WiFi network. There is a time.sleep(5) line to allow the board time to connect to the WiFi network. Next we'll run a loop for a total of 8 hours (with 60 minutes in each hour). Inside the loop, we'll read the temperature off the MCP9808 using the MCP9808.readtemp() function and post the temperature to ThingSpeak.com using the wifitools.thingspeak_post() function. To read the temperature once a minute, we need to time.sleep(60) (wait 60 seconds) between each measurement. I also have one more .py file called config.py . This file simply contains three variables: SSID , WIFI_PASSWORD and API_KEY . By using a config file, we can keep our passwords and API keys out of version control. Like functions and classes, we can import variables defined in .py files for use in another script. # main.py # Adafruit Feather Huzzah ESP8266 WiFi Weather Station import wifitools import MCP9808 import time import config api_key = config . API_KEY ssid = config . SSID password = config . WIFI_PASSWORD wifitools . connect ( ssid , password ) time . sleep ( 5 ) for i in range ( 8 * 60 ): data = MCP9808 . readtemp () wifitools . thingspeak_post ( api_key , data ) time . sleep ( 60 ) 3. Upload the .py files to the board with ampy Once all the .py files are created, ensure the Adafruit Feather Huzzah ESP8266 board is connected with a USB cable to the computer. You will also need to know what serial port the Feather board is connected to. We'll upload the code files to the board using ampy . Make sure you are in the directory with the .py files and that you are working in the (micropython) virtual environment that has ampy installed in it. $ conda activate micropython ( micropython ) $ ampy --port COM4 put MCP9808.py ( micropython ) $ ampy --port COM4 put wifitools.py ( micropython ) $ ampy --port COM4 put main.py ( micropython ) $ ampy --port COM4 put config.py ( micropython ) $ ampy --port COM4 ls boot.py wifitools.py MCP9808.py config.py main.py 4. Unplug and power up the Feather Huzzah and watch the data on ThingSpeak.com The Feather Huzzah needs to be restarted to run the code we just uploaded. To restart the board, unplug and then replug the board's power. Once power is restored, the board will run through the boot.py script then start the main.py script. When the board runs the main.py script, the board will connect to the WiFi network, read the temperature from the sensor then upload the temperature to ThingSpeak.com. If we go to ThingSpeak.com, we should see the temperature plotted on our Channel's page. Congrats! You have a working weather station that is part of the Internet of Things. Now you can read the temperature from anywhere in the world with an internet connection!","tags":"micropython","url":"micropython-upload-code.html","loc":"micropython-upload-code.html"},{"title":"Using Micropython to connect an Adafruit Feather Huzzah ESP8266 to WiFi","text":"This is the fifth part of a multipart series on Micropython. In the last post we used the Micropython REPL (the Microcpython prompt) running on the Adafruit Feather Huzzah ESP8266 board to read the temperature off a temperature sensor. In this post, we are going to connect the Feather board to WiFi and post the temperature to ThingSpeak.com Before we can connect the Adafruit Feather Huzzah to WiFi, Micropython needs to be installed on the board and PuTTY needs to be installed on the computer to communicate with the board over serial. See a previous post on how to install Micropython on an ESP8266 board and how to install PuTTY on a Windows 10 machine. Summary of Steps: Wire up the temperature sensor to the Adafruit Feather Huzzah ESP8266 Use PuTTY to connect to the Adafruit Feather Huzzah ESP8266 board Run commands at the Micropython REPL to connect the Feather board to WiFi Upload the temperature to ThingSpeak.com 1. Wire up the temperature sensor to the Adafruit Feather Huzzah ESP8266 Wire up the MCP9808 temperature sensor to the Adafruit Feather Huzzah ESP8266 as shown in a previous post . 2. Use PuTTY to connect to the Adafruit Feather Huzzah ESP8266 board Connect the Feather to the computer using a USB data cable. Open PuTTY. Ensure the serial port (Serial line) is set correctly and the baud rate (speed) is set to 115200. 3. Run commands at the Micropython REPL to connect the Feather board to WiFi To connect the ESP8266 board to a WiFi network, we first need to import the network module and create an instance of the WLAN class. Next we use the connect method and our WiFi network's SSID and password to connect. We want to run our ESP8266 in station mode (like a laptop or phone) as opposed to access point mode (like a server). We can print the IP address of the board using the ifconfig() method. The commands below should be typed into the Micropython REPL. Note that 'SSDI' and 'password' should be replaced with an actual WiFi SSID and password. >>> import network >>> sta_if = network.WLAN(network.STA_IF) >>> sta_if.active(True) >>> sta_if.connect('SSID', 'password') >>> print('network config:', sta_if.ifconfig()) Now that the Feather board is connected to a WiFi network, we can use the board to read a webpage. In Micropython, reading webpages is done with sockets . A socket is a connection between the ESP8266 and the outside internet. >>> import socket >>> url = 'https://google.com' >>> _, _, host, path = url.split('/', 3) >>> addr = socket.getaddrinfo(host, 80)[0][-1] >>> s = socket.socket() >>> s.connect(addr) >>> s.send(bytes('GET /%s HTTP/1.0\\r\\nHost: %s\\r\\n\\r\\n' % (path, host), 'utf8')) >>> while True: .... data = s.recv(100) .... if data: .... print(str(data, 'utf8'), end='') .... else: .... break 4. Upload the temperature to ThingSpeak.com Now imagine our weather station is up and working and reads a temperature of 21 °C. We are going to push this temperature data reading (21 °C) up to ThingSpeak.com . ThingSpeak.com is an Internet of Things (IoT) cloud service provider. We'll upload the temperature to ThingSpeak.com using an http GET request in the format required by the ThingSpeak web API . Sign up for an account on ThingSpeak.com and create a new channel. In the ThingSpeak channel, create a new field called temperature . Note the ThingSpeak channel number and ThingSpeak write API key . The write API key will be needed to send our temperature up to ThingSpeak.com and the channel number is needed to view the temperature. At the Micropython REPL, we'll build a new function called http_get() which will initiate the http GET action by the Feather board. We can then feed this http_get() function a specific URL that will activate the ThingSpeak web API and post the temperature to the cloud on ThingSpeak.com. >>> def http_get(url): ... import socket ... _, _, host, path = url.split('/', 3) ... addr = socket.getaddrinfo(host, 80)[0][-1] ... s = socket.socket() ... s.connect(addr) ... s.send(bytes('GET /%s HTTP/1.0\\r\\nHost: %s\\r\\n\\r\\n' % (path, host), 'utf8')) ... while True: ... data = s.recv(100) ... if data: ... print(str(data, 'utf8'), end='') ... else: ... break Now we need to build the URL that will call the ThingSpeak web API. The URL contains four parts: A base domain, an API key, a field number and data. Let's assume our temperature data is 21 (for 21 °C). We can define these URL parts as strings then combine the stings to create one long URL. Note that you should include your actual API key here, not a bunch of XXXXXXX's. Since the entire URL is a string, it is important to assign the string '21' to the variable data instead of assigning the integer 21 . >>> base_url = 'https://api.thingspeak.com/update' >>> API_key = '?api_key=XXXXXXXXXXXXXX' >>> field = '&field1=' >>> data = '21' >>> url = base_url + API_key + field + data Now we can use the http_get() function and our URL to send the temperature 21 up to ThingSpeak.com >>> http_get(url) If you go to https://thingspeak.com/<your channel number> , you should see a new temperature point. Now let's read an actual temperature off of the MCP9808 temperature sensor and send that value up to ThingSpeak.com. >>> import machine >>> i2c = machine.I2C(scl=machine.Pin(5), sda=machine.Pin(4)) >>> byte_data = bytearray(2) >>> i2c.readfrom_mem_into(24, 5, byte_data) >>> value = byte_data[0] << 8 | byte_data[1] >>> temp = (value & 0xFFF) / 16.0 >>> if value & 0x1000: ... temp -= 256.0 ... print(temp) >>> base_url = 'https://api.thingspeak.com/update' >>> API_key = '?api_key=XXXXXXXXXXXXXX' >>> field = '&field1=' >>> data = str(temp) >>> url = base_url + API_key + field + data >>> http_get(url) Another data point should now be shown on ThingSpeak.com. Next steps Pretty amazing to have a little piece of hardware like the Feather Huzzah ESP8266 wirelessly upload a temperature measurement up to the cloud. It did require a lot of typing at the Micropython REPL though. In the next post, we'll build a couple of .py files to save the functions we wrote to read the temperature, build the URL and complete the http GET request. Then we will upload these .py files to the Feather board.","tags":"micropython","url":"micropython-wifi.html","loc":"micropython-wifi.html"},{"title":"Add a custom login page and assignments directory for each user on a Jupyter Hub server","text":"This is the seventh part of a multi-part series that shows how to set up Jupyter Hub for a college class. In this post, we build a pre-spawn hook that creates an \"assignments\" and \"notes\" directory with pre-constructed assignments and notes for each JupyterHub user. We also build a custom login pages that looks much more like our college login page and contains helpful links. Posts in this series Why Jupyter Hub? Create ssh key, save to documents/ssh-keys Create a new Digital Ocean Droplet with a non-root sudo user Install Jupyter Hub on the server Apply SSL, link a domain name to the server and configure nginx Connect OAuth to Jupyter Hub Add a custom login page and assignments directory for each user on a Jupyter Hub server (this post) Last time In the last post , we set JupyterHub to run as a system service in the background on our server. Then we added tried two different login systems: github and google. The github authentication system allowed user to log in with github usernames and passwords. The google authentication system allowed users to log in with their college usernames and passwords. Then we modified the jupyterhub_config.py file to all the creation of new users on the server even if the new usernames contained a dot. Steps in this post: Create a repo on github.com with the assignments and notes Add a pre-spawn hook in jupyterhub_config.py Create a templates directory and populate it with Jinja templates to create a new login page Modify the style.min.css file to apply styling to the login page 1. Create a repo on github.com with the assignments On github.com, create a new repo with the notes and assignments for the quarter. On a local computer, not the server, clone the github repo. This allows us to work on the notes and assignments locally. # local computer $ mkdir ENGR101 $ cd ENGR101 $ git init $ git remote add origin https : // github . com / ProfessorKazarinoff / ENGR101 . git $ git pull origin master On the local computer, not the server, build the assignment and notes for the quarter. I did this using jupyter notebooks. Then add, commit and push the changes up to github. # local computer $ git add . $ commit - m \"added assignments and notes\" $ git push origin master 2. Add a pre-spawn hook in jupyterhub_config.py Now we can go to the server and have the notebooks we created (and pushed up to github) pre-populate each users directory tree when they log into JupyterHub . We'll use a Python package called gitpython to help with pulling the notebooks down from github.com. Log into the server and install gitpython using conda : # on the server $ sudo apt - get update $ conda install - c conda - forge gitpython Now we need to modify the jupyterhub_config.py file to do a couple things: Run a pre-spawn hook function that runs before each user's jupyter notebook server is started and pull the assignments and notes down from github as part of the pre-spawn hook function. The pre-spawn hook function gets called every time a user logs into JupyterHub. This pre-spawn hook will run before the user's jupyter notebook server is created. In the pre-spawn hook, we want to check to see if the user has the assignments and notes pulled down from github already loaded. If the user doesn't have the assignments, then we want to pull the assignments down from github and put them in the user's directory tree. So first we need a function that will pull the repo down from github. Note the line uid = getpwnam(user).pw_uid and gid = getpwnam(user).pw_gid in the function below. These lines of code get the user's numerical unix user id and group id. The userid and group id are needed to assign the proper permissions to the files we pull down from github. When I first built the function, changing file permissions was not included. I could log onto jupterhub and see the notebooks pulled down from github, but I couldn't run or edit them. The problem was that the notebooks were pulled down from github by a sudo user and the jupyterhub user didn't have the permissions to write or execute any of the files. Building the permissions into the function with shutil.chown() solved the problem. # in jupyterhub_config.py def clone_repo ( user , git_url , repo_dir ): \"\"\" A function to clone a github repo into a specific directory of a user. \"\"\" Repo . clone_from ( git_url , repo_dir ) uid = getpwnam ( user ) . pw_uid gid = getpwnam ( user ) . pw_gid for root , dirs , files in os . walk ( repo_dir ): for d in dirs : shutil . chown ( os . path . join ( root , d ), user = uid , group = gid ) for f in files : shutil . chown ( os . path . join ( root , f ), user = uid , group = gid ) Now we'll build a pre-spawn hook function that will run when the spawner starts. The function will call the clone_repo() function and pull down the assignments from the github repo the first time a user logs into JupyterHub. After the assignments and notes are initially created, each subsequent time the user logs into JupyterHub, a new fresh set of assignments and notes are pulled down if ERASE_DIR is set to True . If ERASE_DIR is set to False , once the assignments and notes are downloaded, they will not be over-written. To run the pre-spawn hook function and the pull repo function, we need to make sure the following imports are present in our jupyterhub_config.py file: # jupyterhub_config.py import git , os , shutil from pwd import getpwnam The complete pre-spawn hook function is below: # in jupyterhub_config.py def create_dir_hook ( spawner ): \"\"\" A function to clone a github repo into a specific directory of a JupyterHub user when the server spawns a new notebook instance. \"\"\" username = spawner . user . name DIR_NAME = os . path . join ( \"/home\" , username ) git_url = \"https://github.com/ProfessorKazarinoff/ENGR101.git\" repo_dir = os . path . join ( DIR_NAME , 'notebooks' ) if ERASE_DIR == True : if os . path . isdir ( repo_dir ): shutil . rmtree ( repo_dir ) os . mkdir ( repo_dir ) clone_repo ( username , git_url , repo_dir ) if ERASE_DIR == False and not ( os . path . isdir ( repo_dir )): os . mkdir ( repo_dir ) clone_repo ( username , git_url , repo_dir ) if ERASE_DIR == False and os . path . isdir ( repo_dir ): pass The two functions need to be pasted into the jupyterhub_config.py file. Make sure the imports are present as well as an ERASE_DIR = True or ERASE_DIR = False line in the jupyterhub_config.py file too. Next we need to add a pre-spawn hook function to the spawner object in our jupyterhub_config.py file in the form of # in jupyterhub_config.py c . Spawner . pre_spawn_hook = create_dir_hook With these changes complete, we can restart jupyterhub using: $ sudo systemctl stop jupyterhub $ sudo systemctl start jupyterhub $ sudo systemctl status jupyterhub To exit the status screen use [Ctrl] + [c] 3. Create a templates directory and populate it with Jinja templates to create a new login page The JupyterHub login page looks like this: But our college login page looks lik this: For users to feel comfortable with logging into the JupyterHub server, we'll make the JupyterHub login page look more like the college login page. This was a time consuming and fussy task. It involved a lot of messing around with css and html. First a set of custom jinja templates need to be created. When JupyterHub runs, there is a set directory of jinja templates that build the html users see when they go to the site. These jinga templates are burried deep in the JupyterHub package code. For my JupyterHub installation on the server, I found the jinja template files in the /pkgs directory in anaconda3 . If you are using a virtual environment, the JupyterHub package directory name will likey be different: /home/peter/anaconda3/pkgs/jupyterhub-0.8.1-py36_0/share/jupyter/hub/templates/ ├── 404.html ├── admin.html ├── error.html ├── home.html ├── login.html ├── logout.html ├── page.html ├── spawn.html ├── spawn_pending.html └── token.html Now we need to copy these templates into our home directory. Once copied, we can modify the templates and create a new JupyterHub login page. The login.html file is the one that needs to be customized. $ cd /home/peter/anaconda3/pkgs/jupyterhub-0.8.1-py36_0/share/jupyter/hub/ $ cp -R templates /home/peter/templates/ $ cd ~ $ cd templates $ ls Open up the login.html file and modify it with any html that you want to show up when a user goes to the jupyter hub site. I messed around for WAY to long trying to get my custom login page to look like the college login page. An important piece of html that needs to stay in the login.html file is the <a> tag that links to the authentication url. The complete tag is detailed below <!–– login.html ––> <a role=\"button\" class=\"btn btn-jupyter btn-lg\" href=\"/hub/oauth_login?next=\"> Sign in with Portland Community College </a> I also kept in the jinga tag at the top of the file that brings in all of the formatting from login.html's parent template page.html <!–– login.html ––> {% extends \"page.html\" %} All the changes I made to the login template were inside the \"login\" block of login.html. You can find my complete login.html file here {% block login %} <!–– make changes here ––> {% endblock login %} Now we need to modify the jupyterhub_config.py file so that our new set of custom jinja templates are used instead of the default jinja templates. A problem I initially had was I set the directory path of the custom templates as /home/peter/templates and the login page didn't work as expected. When I changed the directory path to /home/peter/templates/ the problem was resolved. # jupyterhub_config.py # sets a custom html template at the login screen. c . JupyterHub . template_paths = [ '/home/peter/templates/' ] 4. Modify the style.min.css file to apply styling to the login page Finally the style.min.css file needs to be modified so that the login page styling looks a little more like the college login page. This is another thing I messed around with for a long time, a WAY to long time. I couldn't figure out a way to get JupyterHub to use a custom .css file. I tried creating a .css file in the new custom templates directory, but JupyterHub wouldn't copy it as a static asset when the server launched. I also tried putting a separate .css file deep inside of the JupyterHub package code. When the server ran, it seemed to copy the custom .css file (I could see the custom .css file using chrome's inspect element tool). But for some reason the custom .css file would be blank when server serve was running, even though the custom .css file contained a whole bunch of css code when viewed deep in the JupyterHub package code. The solution I finally got to work was modifying the style.min.css file itself that JupyterHub uses. This file is buried deep in the JupyterHub package code: home / peter / anaconda3 / pkgs / jupyterhub - 0 . 8 . 1 - py36_0 / share / jupyter / hub / static / css / ├── style . min . css └── style . min . css . map Modify the style.min.css file to include all the custom css styling desired (find my complete css file here ) With changes to the login.html file and style.min.css file complete, we can restart JupyterHub and view the changes rendered on the login page. $ sudo systemctl stop jupyterhub $ sudo systemctl start jupyterhub $ sudo systemctl status jupyterhub Below is the look of my modified login page in all it's custom html and css glory Summary In this post, we will built a pre-spawn hook that pulls down notes and assignments from github and adds it to each user's directory tree when their jupyter notebook server starts. We also constructed a custom login page by creating a custom jinja template ( login.html ) and modified the style.min.css file inside the JupyterHub package code. The resulting custom login pages looks a lot more like our college login page. Conclusion This concludes the Jupyter Hub series. We accomplished a lot to get a working version of Jupyter Hub up and running on a Digital Ocean server. Our Jupyter Hub deployment has the following features: Users don't need to install anything to edit and run Python code. Users just need a web browser and an internet connection. All users have a common set of installed Python packages and don't need to install any extra packages A custom domain name is hooked to JupyterHub instead of a numeric IP address JupyterHub runs on https and has SSL security Users can log into JupyterHub using their college usernames and passwords Each user's directory tree is pre-populated with assignments and notes pulled down from github The pre-populated assignments and notes can be run and modified by users. You can find the notes and assignments that pre-poplulate into each user's directory tree here You can find the various files that are part of the JupyterHub deployment here I Hope this series is helpful to anyone who wants to set up Jupyter Hub for their own class or team. After the course runs, I want to post the results of students using Jupyter Hub. The first course to use Jupyter Hub runs this summer quarter.","tags":"jupyter","url":"assignments-dir-and-custom-login-page-to-jupyterhub.html","loc":"assignments-dir-and-custom-login-page-to-jupyterhub.html"},{"title":"Adding Google OAuth and system service to a Jupyter Hub server","text":"This is the sixth part of a multi-part series that shows how to set up Jupyter Hub for a college class. In this post, we will set up jupyterhub to run as a system service in the background which will allow us to work on the server and run jupyterhub at the same time. Then we will add an authentication system so that users can log into our Jupyter Hub server using github usernames and passwords. Finally we will modify the authentication system so that users can log into our Jupyer Hub server using their google usernames and passwords. The same user name and password a student uses to access their college email. Posts in this series Why Jupyter Hub? Create ssh key, save to documents/ssh-keys Create a new Digital Ocean Droplet with a non-root sudo user Install Jupyter Hub on the server Apply SSL, link a domain name to the server and configure nginx Connect OAuth to Jupyter Hub (this post) Pre-populate each new user's directory tree to include three notebook assignments. Last time In the last post, we succeeded in getting jupyterhub to run on https and use SSL certificates. We created SSL certificates, modified the nginx config and modified the jupyterhub config. At the end of it we were able to get a working version of jupyter hub running SSL security. Steps in this post: Run jupterhub as a system service Test local OAuth Acquire github OAuth credentials Modify jupyterhub_config.py to use github OAuth Acquire google OAuth credentials Modify jupyterhub_config.py to use google OAuth 1. Run jupterhub as a system service Working off of this wiki To run jupyterhub as a system service, we need to create a service file in the /etc/systemd/system directory. cd into the directory and have a look around. You should see a couple files that end in .service $ cd /etc/systemd/system $ ls cloud-init.target.wants network-online.target.wants dbus-org.freedesktop.thermald.service paths.target.wants default.target.wants sockets.target.wants final.target.wants sshd.service getty.target.wants sysinit.target.wants graphical.target.wants syslog.service iscsi.service timers.target.wants multi-user.target.wants We'll create a new .service file called jupyterhub.service $ sudo nano jupyterhub.service In the file, add the following. Note that as part of the PATH environment variable /home/peter/anaconda3/bin is included. This is the path to our Anaconda environment. As part of the ExecStart we include a flag for our jupyterhub_config.py file. [Unit] Description = Jupyterhub After = syslog.target network.target [Service] User = root Environment = \"PATH=/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/home/peter/anaconda3/bin\" ExecStart = /home/peter/anaconda3/bin/jupyterhub -f /home/peter/jupyterhub_config.py [Install] WantedBy = multi-user.target Save and exit with [Ctrl-c] + [y]. Now we need to reload the system daemon and run jupyterhub as a system process using the command: sudo systemctl <start|stop|status> jupyterhub $ sudo systemctl daemon-reload $ sudo systemctl start jupyterhub We can see if jupyterhub is running with: $ sudo systemctl status jupyterhub Loaded: loaded ( /etc/systemd/system/jupyterhub.service ; Active: active ( running ) 2. Test local OAuth Now we can go to the server and log in as our non-root user, and log in as the other user we created kendra . A couple times I thought that jupyterhub was running after using systemctl start jupyterhub , but the hub wasn't working when I went to the hub's web address. It turned out that jupyterhub wasn't running when I keyed in systemctl status jupyterhub . Most times looking for an error and tracking down the the error worked, but one time it seemed to be a problem with the http-configurable-proxy. The following command will shut down the proxy if you get stuck like I did (insert the number corresponding to the configurable-http-proxy process after the kill command): $ ps aux | grep configurable-http-proxy $ kill #### 3. Acquire Github OAuth credentials A problem now is that if we go to the admin page on jupyter hub, we can't add new users. The users have to be added to the server using PuTTY first and then can be added to jupyterhub with the admin panel. This is OK for a small team or a couple users, but for a college class, creating a new user on the server for each student, then emailing out passwords... Ah! what a mess. So we need to give jupyterhub the authority to create new users from the admin panel and we need a way to have users login with a user name and password they already have. One of the ways students could log into Jupyter Hub is using their github credentials. This would require each student to have a github account. A github account for each student might be worth it to give students exposure to git and github as a tools. So let's give the github authenticator a whirl. The github authenticator is also pretty well documented for Jupyter Hub, so it's good authenticator to try first. To use the github authenticator, we need to install oauthenticator . I couldn't find oauthenticator on conda-forge. If it's on conda-forge, I would install it from there rather than PyPI. But for this one, I used pip . $ pip install conda install oauthenticator Now we need to log into github and create an OAuth App and copy the Client ID and Client Secret. The short version is: github profile → settings → Developer Settings → OAuth Apps → Register a new application Set the Homepage URL as: https : // notebooks . yourdomain . com / Set the Authorization call-back URL as: https : // notebooks . yourdomain . com / hub / oauth_callback in the App Settings page, we need to copy two settings: Client ID Client Secret These two long strings will need to be pasted into the jupyterhub_config.py file. 4. Modify jupyterhub_config.py to use github OAuth Now we'll edit the jupyterhub_config.py file to include a couple additional lines. Note in the configuration below, #c.Authenticator.whitelist is commented out. We want to see if a github user can log onto the server (which will automatically create a new user and spawn a jupyter notebook server) and run notebooks. Once we know the server is working, we can uncomment the white list and only allow in specific github usernames. Note c.LocalGitHubOAuthenticator.client_id and c.LocalGitHubOAuthenticator.client_secret are the long strings from our github OAuth App. #jupyterhub_config.py from oauthenticator.github import LocalGitHubOAuthenticator c . JupyterHub . authenticator_class = LocalGitHubOAuthenticator c . LocalGitHubOAuthenticator . oauth_callback_url = 'https://notebooks.problemsolvingwithpython.com/hub/oauth_callback' c . LocalGitHubOAuthenticator . client_id = 'xxxxxxxxxxxxxxxxxxxxxx' c . LocalGitHubOAuthenticator . client_secret = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' c . LocalGitHubOAuthenticator . create_system_users = True #c.Authenticator.whitelist = {'peter','kendra'} c . Authenticator . admin_users = { 'peter' } Restart jupyterhub with $ sudo systemctl stop jupyterhub $ sudo systemctl start jupyterhub $ sudo systemctl status jupyterhub Browse over to the hub's URL and we should be able to log in with a github username and password. 4. Google Authenticator Now that the github authenticator works, we are going to get into the weeds of getting the google authenticator to work. Why google authenticator instead of github? Our college uses the gmail suite for both staff and students. When students log onto their college email, they are logging into gmail. Students can use google calendar and google drive with their college email account as well. So it is probably best that students log into juypter hub using the same google login that they use to access their college email, google drive and calendar. First up we need to set up a google OAuth instance. I did this using my personal gmail account rather than my college gmail account. Some parts of google suite are not available in my college profile like youtube and developer tabs. To obtain the google OAuth credentials, we need to log into the google API console https://console.developers.google.com/ and select [Credentials] on the lefthand menu. Next we'll create a new OAuth credential under [Credentials] → [Create Credentials] → [OAuth client ID]: To create a set of google OAuth credentials you will need to input: Authorized JavaScript origins: https://notebooks.yourdomain.com callback url: https://notebooks.yourdomain.com/hub/oauth_callback After creating a new set of google OAuth credentials, note the: client ID client secret These two longs strings will be included in our revised jupyterhub configuration. Once we get our google OAuth credentials, we need to edit jupyterhub_conf.py . Note the google OAuth credentials need to replace 'xxxxxxxxxxxxxxx' #jupyterhub_conf.py import os c = get_config () c . JupyterHub . log_level = 10 c . Spawner . cmd = '/home/peter/anaconda3/bin/jupyterhub-singleuser' # For Google OAuth Authentication from oauthenticator.google import LocalGoogleOAuthenticator c . JupyterHub . authenticator_class = LocalGoogleOAuthenticator c . LocalGoogleOAuthenticator . create_system_users = True c . LocalGoogleOAuthenticator . hosted_domain = 'yourcollege.edu' c . LocalGoogleOAuthenticator . login_service = 'Your College Name' c . LocalGoogleOAuthenticator . oauth_callback_url = 'https://notebooks.yourserver.com/hub/oauth_callback' c . LocalGoogleOAuthenticator . oauth_client_id = 'xxxxxxxxxxxxxxxxxxxxx' c . LocalGoogleOAuthenticator . oauth_client_secret = 'xxxxxxxxxxxxxxxxxxx\" #c.JupyterHub.cookie_secret_file = '/srv/jupyterhub/jupyterhub_cookie_secret' c . Authenticator . add_user_cmd = [ 'adduser' , '-q' , '--gecos' , '\"\"' , '--disabled-password' , '--force-badname' ] c . Authenticator . whitelist = { 'studnet.username' , 'faculty.username' } c . Authenticator . admin_users = { 'faculty.username' } This little line: c . Authenticator . add_user_cmd = [ 'adduser' , '-q' , '--gecos' , '\"\"' , '--disabled-password' , '--force-badname' ] was a real gottacha. Our college email addresses are in the form: firstname.lastname@college.edu So jupyterhub was trying to create users with dots . in their usernames. This doesn't work in linux. I tried creating a new user with a dot in their username and it asked me to use the --force-badname flag. So that is what we'll add to the c.Authenticator.add_user_cmd list. Otherwise the users will be able to authenticate, buy they won't get a new account on the server and they won't be able to run notebooks. Restart jupyterhub and browse to the web address attached to the server. $ sudo systemctl stop jupyterhub $ sudo systemctl start jupyterhub $ sudo systemctl status jupyterhub # [ Ctrl + c ] to exit The login window should look something like: We can log in with our google user name and password (college username and password). Pretty sweet. Summary In this post, we set jupyterhub to run as a system service in the background which allowed us to work on the server and run jupyterhub at the same time. Then we added a github authentication system so that users could log into our Jupyter Hub server using their github usernames and passwords. Then we modified the authentication system to use google user names and passwords even if the usernames contained a dot. Next Steps Up next we will see if we can populate each new user's working directory tree with a couple of notebooks that will be the assignments for the quarter. We'll see if we can pull these down from github so that the assignments can be edited by instructors and viewed by the students before the quarter starts.","tags":"jupyter","url":"add-google-oauth-and-system-service-to-jupyterhub.html","loc":"add-google-oauth-and-system-service-to-jupyterhub.html"},{"title":"Adding SSL and a domain name to Jupyter Hub","text":"This is the fifth part of a multi-part series that shows how to set up Jupyter Hub for a college class. In this post, we are going to link a domain name to our server IP address, add SSL security and configure nginx to run as a proxy in between users and jupyterhub . Then we'll run jupyterhub over https using the SSL security we created. Posts in this series Why Jupyter Hub? Create ssh key, save to documents/ssh-keys Create a new Digital Ocean Droplet with a non-root sudo user Install Jupyter Hub on the server Apply SSL, link a domain name to the server and configure nginx (this post) Connect OAuth to Jupyter Hub Connect to Jupyter Hub as student Last time In the last post , we installed Anaconda on the server using a shell script. Then we installed some extra Python packages such as pint , pyserial and schemdraw to our base conda environment. Next we installed jupyterhub , opened up port 8000 and ran jupyterhub for the first time! And remember we shut down jupyter hub very quickly because we ran it without any SSL security. Steps in this post: Link domain name to server IP address Install nginx and modify ufw Obtain SSL certificates with certbot Create a cookie secret and a proxy auth token Modify nginx config Generate jupyterhub_config.py and modify Restart nginx and start jupyterhub, see if we can login Create an new user and restart jupyterhub . See if the new user can log in. 1. Link domain name to server IP address When we started Jupyter Hub in the previous post, it ran, we could log in, and we could run Python code. What's not to like, right? Well, security is the big problem. In the initial setup, Jupyter Hub was running under regular http, not https. With a web application that has usernames and passwords, like Jupyter Hub, having https and SSL security is best (or maybe manditory). In order to use https, we need to get an SSL certificate. And that SSL certificate should correspond to the domain name linked to our server. So the first step is getting the domain name and pointing it at Digital Ocean. The next step is linking the domain name to our Jupyter Hub server. Google Domains I purchased the domain problemsolvingwithpython.com from google domains . It costs $12/year which seems pretty reasonable and was easy to set up. After purchasing the domain, I added the Digital Ocean DNS servers as a set of custom name servers to my domain options on google domains. To add a set of custom name servers, click the button with the two bars under the DNS header. This will bring up a page where you can enter in the Digital Ocean DNS servers. The name servers to add are: ns1 . digitalocean . com ns2 . digitalocean . com ns3 . digitalocean . com Make sure to click the radio button [Use custom name servers] and click [save]. Digital Ocean DNS Now we are going to set our domain problemsolvingwithpython.com to link to the IP address of our server on Digital Ocean. Log into Digital Ocean and in the upper right select [Create] → [Domains/DNS] In the [Add a domain] field, type in the domain name without http, but including .com (or .edu/.org/.net) then click [Add Domain]. This will bring up a panel where we can add a DNS record. I want the notebook server to have the web address https://notebooks.problemsovlingwithpython.com So I entered notebooks in the text field. Then selected the droplet (server) that the web address will to route to. After completing this step, there will be a number of new DNS records. The ones I set up are below: It takes a couple minutes for the DNS switchover to complete. https://www.whatsmydns.net can be used to check the NS and A records of your domain and see if the domain name is getting through. The first time I set up DNS on Digital Ocean, I added the custom DNS servers to google domains but neglected to select the [use custom name servers] radio button on the google domains dashboard. It looked like the domain was routing to Digital Ocean, but actually the domain was just staying with google. Once I clicked the [use custom name servers] radio button and waited a couple minutes, the change over happened. It did take a bit of time though; not hours, but more than a few minutes. 2. Install nginx and modify ufw Now that the domain name is set up, the next step is to install and configure nginx. Nginx is an open source web server that can handle many concurrent web connections at the same time. For the nginx installation, I followed this tutorial from Digital Ocean. Use PuTTY to connect to the server with the non-root sudo user we set up before. Once logged in, we can update the system and install nginx. $ sudo apt-get update $ sudo apt-get install nginx Digital Ocean installs a firewall application called ufw. Check out which apps the ufw firewall can work with: $ sudo ufw app list We see a list of available ufw configurations to work with nginx. Available applications : Nginx Full Nginx HTTP Nginx HTTPS OpenSSH We want to allow in both http and https requests. Once a http request comes in, we'll use nginx to convert the http connection to a https connection. Select nginx full. Note the Capitalization in the command: $ sudo ufw allow 'Nginx Full' We can check out which ports ufw is allowing through with: $ sudo ufw status Note in the output how ufw is allowing nginx full and requests over port 8000. We opened port 8000 earlier, so we could see how jupyterhub works without a domain name or SSL. Once we get nginx running and hooked up to jupyterhub , we need to remember to close off port 8000 in ufw. Status : active To Action From -- ------ ---- 22 LIMIT Anywhere 2375 / tcp ALLOW Anywhere 2376 / tcp ALLOW Anywhere 8000 ALLOW Anywhere Nginx Full ALLOW Anywhere 22 ( v6 ) LIMIT Anywhere ( v6 ) 2375 / tcp ( v6 ) ALLOW Anywhere ( v6 ) 2376 / tcp ( v6 ) ALLOW Anywhere ( v6 ) 8000 ( v6 ) ALLOW Anywhere ( v6 ) Nginx Full ( v6 ) ALLOW Anywhere ( v6 ) Nginx will start running as soon at it is installed. We can see the status with: $ sudo systemctl status nginx In the output, we should see something like below. This mean nginx is running. Key in [ctrl-c] to exit the status dashboard. Active: active (running) since Thu 2018-05-17 04:51:16 UTC; 15min ago Main PID: 17126 (nginx) CGroup: /system.slice/nginx.service ├── 17126 nginx: master process /usr/sbin/nginx -g daemon on; master_pr └── 17127 nginx: worker process Now we can browse over to the domain (the domain we set up with Digital Ocean and google domains) and see the nginx start page. 3. Obtain SSL certificates with certbot With a domain name hooked up to our server, we'll now able to obtain an SSL certificate. I followed this presentation to install certbot, a program used to generate SSL certificates. $ cd ~ $ mkdir certbot $ cd certbot $ wget https://dl.eff.org/certbot-auto $ chmod a+x certbot-auto Before we can run certbot, we need to turn off nginx. When I first tried to run certbot, I was thrown an error: Problem binding to port 80 : Could not bind to IPv4 or IPv6 . Since we installed nginx earlier, and we confirmed that it's running, that means that port 80 is currently in use by nginx. We need to open up port 80 to certbot by temporarily shutting down nginx. Once nginx is stopped, we can run certbot and get our SSL certificate. We'll eventually have to restart nginx, but this can wait until after we change the nginx configuration file. If you are following along, make sure to change notebooks.problemsolvingwithpython.com to your domain. $ sudo systemctl stop nginx $ sudo systemctl status nginx # [ Ctrl ] + [ c ] to exit $ . / certbot - auto certonly -- standalone - d notebooks . problemsolvingwithpython . com If it worked and we got our SSL certificate, the output will be something like: IMPORTANT NOTES : - Congratulations ! Your certificate and chain have been saved at : / etc / letsencrypt / live / notebooks . problemsolvingwithpython . com / fullchain . pem Your key file has been saved at : / etc / letsencrypt / live / notebooks . problemsolvingwithpython . com / privkey . pem Your cert will expire on 2018 - 08 - 15 . Note the location of the fullchain.pem and privkey.pem files. We'll need to put these locations into the nginx configuration. We also need to allow nginx to access these files. I had trouble getting nginx to run and this presentation showed a way to give nginx access to the SSL key files. There is probably a more \"Linuxy\" way of giving nginx access to the cert files, but I messed around with the permission settings for a while, and this way worked. $ cd /etc/letsencrypt $ ls accounts archive csr keys live renewal renewal-hooks $ sudo chmod 777 -R archive/ $ sudo chmod 777 -R live/ 4. Create a cookie secret and a proxy auth token In addition to the SSL certificate, the Jupyter Hub docs on security basics specify that a cookie secret and poxy auth token should be created. To create the cookie secret: $ cd /srv $ mkdir jupyterhub $ cd jupyterhub $ sudo touch jupyterhub_cookie_secret $ sudo chown :sudo jupyterhub_cookie_secret $ sudo chmod g+rw jupyterhub_cookie_secret $ sudo openssl rand -hex 32 > jupyterhub_cookie_secret $ ls jupyterhub_cookie_secret $ sudo chmod 600 jupyterhub_cookie_secret $ ls -l -rw------- 1 root sudo 65 Sep 14 17 :41 jupyterhub_cookie_secret I had trouble with the cookie secret file because I missed where the jupyterhub docs show: The file must not be readable by group or other or the server won't start. The recommended permissions for the cookie secret file are 600 (owner-only rw). Now we have a cookie secret file. We need to make note of the location because we'll add this location to the jupyterhub_config.py file later. To generate the proxy auth token, we can use the same set of commands, but point to a different file. $ pwd # should be in /srv/jupyterhub $ sudo touch proxy_auth_token $ sudo chown :sudo proxy_auth_token $ sudo chmod g+rw proxy_auth_token $ sudo openssl rand -hex 32 > proxy_auth_token $ ls jupyterhub_cookie_secret proxy_auth_token $ sudo chmod 600 proxy_auth_token $ ls -l -rw------- 1 root sudo 65 Sep 14 17 :41 jupyterhub_cookie_secret -rw------- 1 root sudo 65 Sep 14 17 :47 proxy_auth_token Now if we list the contents of ~/srv/jupyterhub we should see: / srv / jupyterhub / ├── jupyterhub_cookie_secret └── proxy_auth_token Also we can generate a dhparam.pem file. I'm not exactly sure what the dhparam.pem file is, but I think it's good for security. First we need to cd into the /srv/jupyterhub directory. Next touch a new file called dhparam.pem. After that we can use chown and chmod to be able to write to the dhparams.pem file. The openssl dhparam command is used to generate the .pem file. Finally we modify the permissions again to 600 (owner-only rw). Note the location of this file as we will add it to the nginx config file. $ cd /srv/jupyterhub $ sudo touch dhparam.pem $ sudo chown :sudo dhparam.pem $ sudo chmod g+rw dhparam.pem $ sudo openssl dhparam -out /srv/jupyterhub/dhparam.pem 2048 $ sudo chmod 600 dhparam.pem $ ls -l -rw------- 1 root sudo 424 Sep 14 17 :59 dhparam.pem -rw------- 1 root sudo 65 Sep 14 17 :41 jupyterhub_cookie_secret -rw------- 1 root sudo 65 Sep 14 17 :47 proxy_auth_token 5. Modify nginx config The next step is to modify the nginx config file so that nginx uses our SSL certificates and routes requests on to jupyterhub . This was the hardest part for me when I set up the first server. The nginx config file isn't Python code or a bash script. I went through many different configurations until I got one that worked. The big initial problem was that I copied the sample nginx config that's up on the Jupyter Hub docs. But the nginx config posted on the jupyterhub docs is not a complete nginx config, it contains just the server portion. I didn't know that the whole server portion needed to be enclosed in another frame. To modify nginx.conf , cd into the /etc/nginx directory. The nginx.conf file should be there along with a couple other files and directories. $ cd /etc/nginx $ ls conf.d koi-utf nginx.conf sites-available ssl fastcgi.conf koi-win proxy_params sites-enabled uwsgi_params fastcgi_params mime.types scgi_params snippets win-utf $ sudo nano nginx.conf The nginx config that eventually worked for me is below. It can also be found here : Note the line which shows the path to the SSL certificates. This will change based on your domain and where certbot saved the .pem files to. ## Based on: https://github.com/calpolydatascience/jupyterhub-deploy-data301/blob/master/roles/nginx/templates/nginx.conf.j2 user www-data; worker_processes 4; pid /run/nginx.pid; events { worker_connections 1024; # multi_accept on; } http { include /etc/nginx/mime.types; default_type application/octet-stream; #top-level http config for websocket headers # from https://github.com/jupyterhub/jupyterhub/blob/master/docs/source/referen$ map $http_upgrade $connection_upgrade { default upgrade; '' close; } # All regular http requests on port 80 become SSL/HTTPS requests on port 32 server { listen 80; server_name notebooks.problemsolving101withpython.com; # Tell all requests to port 80 to be 302 redirected to HTTPS return 302 https://$host$request_uri; } server { #listen 443 ssl default_server; listen 443; ssl on; server_name notebooks.problemsovling101withpython.com; ## SSL Protocals ssl_certificate /etc/letsencrypt/live/notebooks.problemsolving101withpython.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/notebooks.problemsolving101withpython.com/privkey.pem; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; ssl_dhparam /srv/jupyterhub/dhparam.pem; # Make site accessible from http://localhost/ #server_name localhost; # certs sent to the client in SERVER HELLO are concatenated in ssl_session_timeout 1d; ssl_session_cache shared:SSL:50m; ssl_stapling on; ssl_stapling_verify on; # modern configuration. tweak to your needs. ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256'; # HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months) add_header Strict-Transport-Security max-age=15768000; location / { proxy_pass http://127.0.0.1:8000; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Host $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-NginX-Proxy true; #proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \"upgrade\"; } location ~ /.well-known { allow all; } } } Save and exit with [Ctrl] + [c] and [y] 6. Generate jupyterhub_config.py and modify Next, we'll generate a jupyterhub_config.py file and modify it a little bit. $ cd ~ $ jupyterhub --generate-config Now we'll modify the jupyterhub_config.py file to allow local spawners and include our user peter as an admin user: $ nano jupyterhub_config.py There will be a lot of commented out text in the file. At the top of the file, add the following: #jupyterhub_config.py import os c = get_config () c . JupyterHub . log_level = 10 c . Spawner . cmd = '/home/peter/anaconda3/bin/jupyterhub-singleuser' # Cookie Secret Files c . JupyterHub . cookie_secret_file = '/srv/jupyterhub/jupyterhub_cookie_secret' c . ConfigurableHTTPProxy . auth_token = '/srv/jupyterhub/proxy_auth_token' c . Authenticator . whitelist = { 'peter' } c . Authenticator . admin_users = { 'peter' } 7. Restart nginx and start jupyterhub, see if we can login Now we'll restart nginx and start jupyterhub. Not that this time when we start jupyter hub we don't need to use the --no-ssl flag because we have SSL running on nginx. If it seems like nginx isn't working, try $ sudo systemctl status nginx and see if nginx really started. If it didn't, try the command nginx -t . This will print out any error messages if nginx failed to start. I had to do this many different times before I got nginx to work. $ sudo systemctl stop nginx $ sudo systemctl start nginx $ sudo systemctl status nginx # [ ctrl - c ] to exit Restart the jupyterhub without the --no-ssl flag. $ cd ~ $ jupyterhub Log in with the non-root sudo username and password (same user that's running the PuTTY session). Now we can browse to our domain and see Jupyter Hub running in its full SSL glory. 8. Create an new user and restart jupyterhub . See if the new user can log in. OK, it's all well and good that we can log into jupyterhub . But the purpose of setting of this up is for multiple students to be able to log into jupyterhub . If jupyterhub is still running, it can be stopped with [Ctrl] + [c]. Let's create a new user and see if we can log in as her. $ sudo adduser kendra Go through the prompts and remember the UNIX password. Now we'll modify jupyterhub_conf.py to include our new user kendra and add peter (our non-root sudo user) as an administrator: c . Authenticator . whitelist = { 'peter' , 'kendra' } c . Authenticator . admin_users = { 'peter' } Restart jupyterhub and try and login as kendra $ jupyterhub Amazing! right? Jupyter Hub running on our own domain using SSL security and https. Pretty cool. Summary In this post we created an SSL certificate with certbot. We modified the nginx config to use our SSL certificate and modified jupyterhub_config.py. At the end of all of that we were able to get a working version of jupyterhub running on https using SSL security and can log into jupyterhub as two different users. Next Steps Up next will add an authentication system so that users can log into our Jupyter Hub server using their college usernames and passwords. We will also set jupyterhub to run as a system service in the background which will allow us to work on the server and run jupyterhub at the same time.","tags":"jupyter","url":"add-ssl-and-domain-name-to-jupyterhub.html","loc":"add-ssl-and-domain-name-to-jupyterhub.html"},{"title":"Installing Jupyterhub","text":"This is the fourth part of a multi-part series that shows how to set up Jupyter Hub for a college class. The goal is to have a running version of Jupyter Hub that students in the class can log into when given a simple web link. In this post, we'll get to the fun stuff: installing jupyterhub on the server, installing Python packages and spinning up Jupyter Hub for the first time. Posts in this series Why Jupyter Hub? Create SSH keys, save to documents/ssh-keys Create a new Digital Ocean Droplet with a non-root sudo user Install Jupyter Hub on the server (this post) Apply SSL, link a domain name to the server and configure nginx Connect OAuth to Jupyter Hub Connect to Jupyter Hub as student The last post In the last post, we created a new server on Digital Ocean (called a droplet ) and made sure to add our public SSH key to the setup options. Then we logged into the server as root with our private SSH key. As root , we set up a new user with sudo privileges and added our public SSH key to the new users profile. Then we logged into the server as the new user and checked the new user's home directory. This post Update packages on the server Install Anaconda Install Python packages and jupyterhub Run a very unsecured instance of Jupyter Hub just to see if it works Shut down Jupyter Hub very quickly because of no SSL security 1. Update Packages on the Server It is probably best to update the packages installed on the server in case there are changes and updates to the operating system since the server was created. This is probably a reflex for those that use Linux a lot. Open PuTTY and log into the server as the non-root sudo user we created in the last post. Then update the system: $ sudo apt-get update 2. Install Anaconda Next we'll install Anaconda . When I installed Anaconda on Windows10, I used an msi installer. But for installation of Anaconda on the cloud server we'll use a shell script. The first time I set up Jupyter Hub, I installed Anaconda in the /opt directory. I don't think this is the best setup. When I installed Anaconda in /opt , I ended up with all sorts of permission problems when I tried to run conda and jupyterhub . For me it caused less problems to install Anaconda in the non-root user's home directory( /home/peter/ ). The user's home directory is also the default Anaconda3 installation location. I followed this tutorial from Digital Ocean. Go to https://repo.continuum.io/archive/ and look down the list of installs for the newest installer that corresponds to: Anaconda 3 (not Anaconda 2, we don't want legacy Python version 2.7) Linux x86 64 (bit) .sh (linux shell script) At the time of writing, the shell script was: Anaconda3 - 5 . 1 . 0 - Linux - x86_64 . sh cd into the /tmp directory and download the script. Then run the script and follow the prompts. $ cd /tmp $ curl -O https://repo.continuum.io/archive/Anaconda3-5.1.0-Linux-x86_64.sh $ bash Anaconda3-5.1.0-Linux-x86_64.sh We want to be able to run conda from the command line. So make sure to allow Anaconda to append your PATH during the installation. After installation, we need to reload the .bashrc file because Anaconda made changes to .bashrc during the install (when it added conda to our PATH). $ source ~/.bashrc Now we should be able to run conda . Try: $ conda --version If you see output, that means conda was installed and can be run by the non-root user. 3. Install Python packages and jupyterhub We have a full installation of Anaconda which includes a lot of useful packages for engineers including: numpy , pandas , matplotlib , scipy , sympy , bokeh and holoviews . Anaconda also includes other useful packages such as requests , beautiful soup and attrs . And for student who want to go further, the Anaconda distribution comes with django , flask , tk , tornado and scikit-learn . There are a couple other packages I want to install in addition to the standard Anaconda packages. First are some extra packages useful for engineers: pint , pyserial and schemdraw . $ conda install -c conda-forge pint $ conda install -c anaconda pyserial $ pip install SchemDraw Now we'll install Jupyter Hub! Since we are using conda to install jupyterhub (rather than pip), we don't need to install node and configurable-http-proxy separately. Conda installs the non-python dependencies (like node and configurable-http-proxy) that jupyter hub relies upon. $ conda install -c conda-forge jupyterhub $ conda install notebook 4. Run a very unsecured instance of Jupyter Hub just to see if it works OK let's give it a whirl. Start jupyterhub for the first time. Note the --no-ssl flag at the end. This needs to be included or you won't be able to browse to the server. $ jupyterhub --no-ssl You should see some output in the PuTTY window. The last line should be something like JupyterHub is now running at http://:8000/ . The first time I set up Jupyter Hub, I wasn't able to see the site using a web browser. Nothing would come up and the connection would time out. Why? It turns out Digital Ocean installs a firewall called ufw by default and turns the ufw firewall on. When the server was created, ufw was configured to only allow incoming connections on ports 22, 80 and 433. This output is shown when we first log into the server: \"ufw\" has been enabled . All ports except 22 ( SSH ), 80 ( http ) and 443 ( https ) have been blocked by default . But jupyterhub runs on port 8000 - it tells us so when jupyterhub starts. So we need to configure ufw to allow connections on port 8000 (at least for now, just to see if jupyterhub works). To allow communication on port 8000 and restart jupyterhub , type: $ sudo ufw allow 8000 $ jupyterhub --no-ssl Now we can browse to the server IP address appended with :8000 . The web address should look something like: http://165.228.68.178:8000. You can find the IP address of the server by going into the Digital Ocean dashboard. We should see: Awesome! Quick log into jupyterhub using the username and password for the non-root sudo user (in my case peter ) that we set up and are using in our current PuTTY session. You should see the typical notebook file browser with all the files you can see when you run ls ~/ . Try creating and running a new notebook. The notebook work just like a jupyter notebook running locally . 5. Quick! Log out and shut down jupyterhub Quick! Log out and shut down jupyterhub . (does quick really matter in internet security?) The site is running without any ssl security over regular HTTP not HTTPS. Key in [Ctrl] + [c] to stop jupyterhub. Warning! You should not run JupyterHub without SSL encryption on a public network. Summary In this post we installed Anaconda on the server using a shell script. We added conda to our path and reloaded our .bashrc file. Then we installed some extra Python packages such as pint and pyserial . Finally we installed jupyterhub , opened up port 8000 and ran jupyterhub for the first time! Remember we shut down jupyter hub very quickly because we ran it without any SSL security. Next Steps In the next post we will build SSL security into our Jupyter Hub deployment and connect the server to domain name. Plus we'll customize the jupyterhub config file and install and use nginx as a proxy server.","tags":"jupyter","url":"installing-jupyter-hub.html","loc":"installing-jupyter-hub.html"},{"title":"Creating a new Digital Ocean Droplet","text":"This is the third part of a multi-part series on how to set up Jupyter Hub for a class. My goal is to have a running version of Jupyter Hub that students can access using a simple web link. I am primarily writing to my future self as I may need to set up Jupyter Hub again for a future class. In this post, we are going to create a new Digital Ocean server (called a droplet ) and create a non-root user with sudo privileges. Then we'll SSH into the droplet with PuTTY as the non-root user. Posts in this series Why Jupyter Hub? Create ssh key, save to documents/ssh-keys Create a new Digital Ocean Droplet with a non-root sudo user (this post) Install Jupyter Hub on the server Apply SSL, link a domain name to the server and configure nginx Connect OAuth to Jupyter Hub Connect to Jupyter Hub as student The last post In the previous post , we created a public/private SSH key pair using PuTTYgen. We saved the SSH keys in the Documents/ssh-keys directory. We also copied contents of the public SSH key to the clipboard. Steps in this post Sign up for a Digital Ocean Account Create a new Digital Ocean Droplet (will be called the server from here on out) Log into the server as root over SSH using PuTTY. Create a non-root sudo user Log into to the server as the non-root sudo user using PuTTY 1. Sign up for a Digital Ocean Account Digital Ocean is a cloud service provider like Amazon Web Services (AWS), Google Cloud, Microsoft Azure and Linode. Digital Ocean provides virtual private servers (called droplets in Digital Ocean-speak) and online storage of static files (called spaces in Digital Ocean-speak). We are going to run the Jupyter Hub server on a Digital Ocean droplet . I like Digital Ocean's prices and web interface. The documentation on Digital Ocean is pretty good too. I already have a Digital Ocean account. I don't remember exactly how I did it, but going to this link: https://www.digitalocean.com/ and selecting [Create Account →] should work. 2. Create a new Digital Ocean Droplet To create a new Digtial Ocean Droplet (a new server), log in here: https://cloud.digitalocean.com/login After logging in, I got a verify screen and had to go to my email and retrive a six digit code. Ah... the joys of two-factor authentication. The welcome screen looks like this. To create a new server select [Create Droplet] There are a number of choices to make. These are the ones I selected: Image: Ubuntu 16.04.4 x64 Size: 1 GB Memory 25GB SSD $5/month Datacenter: San Fransisco 2 Add your SSH keys: New SSH Key Finalize: 1 Droplet, Hostname: jupyter-hub Add an SSH Key Important! You need to add the public SSH key BEFORE creating the droplet The public SSH key we created needs to be shown on the list of keys and the radio box beside it needs to be checked. If the SSH key isn't listed or the SSH key box left unchecked, the SSH key will not be added to the server when the server is first created (and then we won't be able to log in with PuTTY). We need to add our public SSH key and check the key box so we can log onto the server with PuTTY. Under [Add your SSH keys], click [New SSH Key]. A dialog window pops up: Paste the contents of the public SSH key into the [New SSH Key] dialog box. Enter a name for the SSH key that will be saved on Digital Ocean. I choose the name jupyter-hub-ssh-key . Then click [Add SSH Key] Then you should see the new SSH Key in the [Add your SSH Keys?] region of the new droplets page. Make sure that the radio box for the SSH key we just added is checked. A problem I had when I set up my first droplet was that I did not have the SSH Key was radio button selected. Therefore, when the server was created, no SSH keys were installed. I ended up going through this long process of copying the public SSH key into pastbin.com (which is definitely not a safe thing to do ), and using wget to past the raw contents from the pastebin into the server file system, then using cp to copy the publish SSH key into the correct file name. This required using the Digital Ocean console, which is sort of like a bash terminal that pops up in a web browser. I couldn't figure out a way to copy and paste into the Digital Ocean console and the console is slow and laggy. It is way easier to insert SSH keys into the server when the server is created. It is way harder to add an SSH key after the server is created. OK, I think it's time to actually create the droplet . Click the long green [Create] button at the bottom of the page. This will bring you back the the Digital Ocean main dashboard and you should see your new droplet under [Resources] → [Droplets] Note the IP address of the new droplet. We need to IP address to log into our server with PuTTY. 3. Log into the server as root over SSH using PuTTY. Open PuTTY from the Windows start menu. A couple other parameters need to be set before we log onto the server. parameter value IP Address IP of droplet ex: 168.97.14.19 Port 22 Connection → SSH → Auth → Private key file private SSH key Connection → Data → Auto-login username root Under Connect → SSH → Auth → Private key file for authentication:, click [Browse]. Navigate to the SSH private key in Documents/ssh-keys. The private key ends in a .ppk extension. I had trouble finding the key when I first set up PuTTY. It turned out that when the key was saved in Programfiles/PuTTY. The key was not visible in the Windows file browser because I don't have administrator permissions on my machine at work. I ended up having to create a new SSH key and save the new key in Documents/ssh-key (I can access Documents/ssh-key without administrator privaleges). Under Connection → Data → Auto-login username: root Back in [Sessions] (the top-most menu item or main page), add the IP address and Port = 22, click [Open] This should bring up a new window that is a terminal for our server: 4. Create a non-root sudo user Digital Ocean recommends that the servers are run by non-root user that have sudo access. So one of the first things we'll do on our server is create a non-root sudo user. First though, let's make sure everything is up to date: $ sudo apt-get update $ sudo apt-get upgrade I followed this tutorial at Digital Ocean to create a non-root sudo user. Create the new user with the adduser command. I called my new user peter . $ adduser <username> Set a new password and confirm: Enter new UNIX password : Retype new UNIX password : passwd : password updated successfully The user details can be skipped by pressing [Enter]. Then [Y] to complete the new user setup. Changing the user information for username Enter the new value , or press ENTER for the default Full Name []: Room Number []: Work Phone []: Home Phone []: Other []: Is the information correct ? [ Y / n ] Now let's give our new user sudo privaleges: $ usermod -aG sudo <username> The new user account is created and the new user has sudo privalges. We can switch accounts and become the new user with: $ sudo su - <username> The new user should have sudo privileges. That means when acting as <username> we should be able to look in the /root directory. $ sudo ls -la /root If you can see the contents of /root then the new user is set up with sudo access. To exit out of the the new sudo user, and get back to using the root profile, type exit at the prompt $ exit Add SSH keys to new user's profile Before we log off, we need to add our SSH keys to our new user's profile on the server. The second time I set up JupyterHub, I had trouble logging in as the non-root user using PuTTY. I could log in as root just fine, but I couldn't log in as the newly created user peter . When Digital Ocean created the server, the SSH keys (specified on the creation page) were added to the root profile. The new user peter didn't exist when the server was created. The only user on the server at creation time was root . Therefore, no SSH keys were added to the peter profile at server creation time- because the user peter didn't exist yet. Since we want to log into our server as the new non-root user peter , we need to add the same SSH keys saved in the root profile to the peter profile. The SSH keys belong in a file located at /home/peter/.ssh/authorized_keys . This little line will copy the ssh keys from the root profile to the new user's profile. The line comes from this tutorial by Digital Ocean. $ rsync --archive --chown = peter:peter ~/.ssh /home/peter Next, we need to open the ufw firewall to OpenSSH trafic. We will communicate with the server over SSH and need the firewall to allow this type of communication through. $ ufw allow OpenSSH $ ufw enable $ ufw status Now we can exit out of the root profile. This will terminate the PuTTY session. $ exit 4. Connect to the server as the non-root sudo user using PuTTY Now that the non-root sudo user is set up and our ssh keys are in /home/ /.ssh/authorized_keys, let's start a new PuTTY session and log into the server as the new user. Like before, open PuTTY from the Windows Start menu and add the following settings, but this time the Auto-login user name is the name of our new non-root sudo user: parameter value IP Address IP of droplet ex: 168.97.14.19 Port 22 Connection → SSH → Auth → Private key file private SSH key Connection → Data → Auto-login username peter I also saved the PuTTY session details at this point so that I wouldn't have to re-enter all of the parameters each time I want to log into the server. Enter a name into [Saved Sessions] and click [Save]. Once the parameters are saved in PuTTY, you can simply double-click the profile name and you will log into the server. Log into the server with Sessions → [Open] You should see the Digital Ocean login screen again. Note the command prompt will have the new user's name before the @ symbol. Check to see which directory you land in. It should be /home/<username> $ pwd /home/<username> We can see the non-root user's home directory. Let's make sure we can also see into the root user's home directory to ensure we have sudo privileges as the non-root user: $ sudo ls -la /root To log out of the server simply type exit . This should close the PuTTY session. $ exit Summary In this post we created a new Digital Ocean server (called a droplet ) and made sure to add our public SSH key to the setup options before we hit [Create]. Then we logged into the server as root with our private SSH key. As root , we set up a new user with sudo privileges and added our public SSH key to the new user's profile in ~/.ssh/authorized_keys . Then we logged into the server as the new user and checked the new user's home directory and ensured the new user has sudo privileges. Next Steps In the next post, we will get to the fun stuff: installing Anaconda and jupyterhub on our new server. Plus we'll start Jupyter Hub for the first time! (but only keep it open for a couple seconds because we don't have SSL set up yet).","tags":"jupyter","url":"new-digital-ocean-droplet.html","loc":"new-digital-ocean-droplet.html"},{"title":"Create an SSH Key with PuTTYgen","text":"This is the second part of a multi-part series on how to set up Jupyter Hub for a class. This is my first time setting up a Jupyter Hub server. I am primarily writing to my future self as I may need to set up Jupyter Hub again for another class. In this post, we are going to create an SSH key on a Windows 10 machine using PuTTYgen. Posts in this series Why Jupyter Hub? Create ssh key, save to documents/ssh-keys (this post) Create a new Digital Ocean Droplet with a non-root sudo user Install Jupyter Hub on the server Apply SSL, link a domain name to the server and configure nginx Connect OAuth to Jupyter Hub Connect to Jupyter Hub as student Steps in this post Download PuTTY for Windows Start PuTTYgen and create SSH key Save SSH public and private keys to Documents folder Copy the public key to clipboard Why SSH keys, PuTTYgen and why do this first? When I set up the server on Digital Ocean the first time, one of the initial server setup steps was to add SSH keys so the server has them when it initialized. I tried to create and save the keys to the Digital Ocean dashboard so the SSH keys would be on the server when it first started. But I goofed up somehow and the server started without any SSH keys. It was a BIG PAIN adding SSH keys after the server started for the first time. I ended up copying the public key into pastebin.com, logging onto the server with the Digital Ocean console and using wget to bring a textfile of the SSH key from pastebin.com onto the server and then mv to copy the key name into the right location. I'm pretty sure that pasting a public SSH key into pastebin.com is not the best way to initially set up a server. So to make sure that doesn't happen again, I am going to generate the SSH keys first and set up the server second. SSH keys are needed to use PuTTY (regular PuTTY not PuTTYgen) to log into the server. Since I'm working on Windows, using PuTTYgen (a program that comes with PuTTY that generates SSH keys) seems like the easiest solution. 1. Download PuTTY I already have PuTTY installed on my Windows 10 machines at home and at work. The download link is below: Download PuTTY PuTTY seems to want you to install lots of extra stuff when you run the installer. I didn't install any of the \"offers\" that popped up during installation. 2. Start PuTTYgen and create SSH key I went through this tutorial to about setting SSH key on Windows for Digital Ocean when I created the first SSH key: How To Use SSH Keys with PuTTY on DigitalOcean Droplets (Windows users) Using the Windows start menu, open PuTTYgen (not regular PuTTY): Use the following parameters Type of key to generate: RSA Number of bits in generated key: 2048 Then click [generate] This will bring up a dialog to move the mouse around the empty area to generate some randomness. This is my favorite part. Just move the mouse around the dialog box until the progress bar ends. Fun. When the next screen pops up, right-click and copy the contents of the Public Key. We'll need the public key contents available to paste into the server's SSH authorized_keys file. Include the rsa line in the text copied to the clipboard. 3. Save SSH public and private keys to Documents folder In the [Actions] section click [Save public key] and click [Save private key] Make sure to save both the public and the private keys. Save these keys to an accessible folder. The first time I generated SSH keys, I saved the keys in the default location and couldn't access them later. The second time I created SSH keys, I created a folder in the Documents folder called ssh-keys and saved the public and private keys in Documents/ssh-keys. I saved the public key with the name: public_key_jupyter_hub.txt . The Digital Ocean documentation recommends a .txt file extension for the public key (so you can open it and copy the contents). The private key should have a .ppk file extension. 4. Copy the public key to clipboard Before closing PuTTYgen, make sure to copy the contents of the Public Key to the clipboard. We'll need this when we create the server. Copy all of the contents including the rsa line. Summary After completing these steps, we have a public and private SSH key pair saved in Documents/ssh-keys. We also have the contents of the public SSH key saved to the clipboard. Next Steps Next, we'll create a new server on Digital Ocean (called a droplet ). Then we'll use the SSH keys we just created to log into the server and create a non-root sudo user.","tags":"jupyter","url":"ssh-keys-with-putty.html","loc":"ssh-keys-with-putty.html"},{"title":"Why Jupyter Hub?","text":"This is the first part of a multi-part series that shows how to set up Jupyter Hub for an engineering programming class. This is my first time setting up a Jupyter Hub server. I am primarily writing to my future self as I may need to set up a Jupyter Hub server again for a different class in another quarter. I hope the lessons learned will also help other instructors tackle the same problem if they want to set up Jupyter Hub for their own class or team. Why Jupyter Hub? Why Jupyter Hub ? I am teaching an intro engineering course this summer. The course has a lab component and three of the labs are devoted to computer programming. In previous quarters, I've taught MATLAB for the three computer programming labs. But this summer, I want to try teaching Python and cover the same concepts and learning outcomes. If we use Python in the three programming labs this summer, I would like to spend the lab time coding and solving problems. I don't want to spend time during the class downloading Python, creating virtual environments, troubleshooting installs, dealing with system vs. non-system versions of Python, installing packages, dealing with folder structure, explaining the difference between conda and pip, teaching command-line commands, going over Python on Windows compared to Python on MacOSX... I imagine the first programming lab of the quarter runs like: There is a .pdf or google doc posted on a shared google drive folder with a link to Jupyter Hub Students click the link and bring up the login page Students log-in with their college usernames and passwords Students type import this press [Shift+Enter] and their first code cell just runs. Students can use Jupyter Hub from any computer with a web browser and an internet connection. Jupyter Hub looks and runs the same on all student computers This is theoretically possible with Jupyter Hub Jupyter Hub can be installed on a Digital Ocean droplet (a cloud server, like AWS or Google Cloud). The version of Python running the notebooks created by Jupyter Hub can contain the full Anaconda distribution of packages plus some extra packages like pint and pyserial . All of the notebooks will use the same environment. The installed packages will be the same for each student. One Digital Ocean droplet will be able to run all of the notebooks at the same time (hopefully, there will be about 24 students). Student's work will be saved on the server under their user account. Students can download the .ipynb files and upload them to google drive or save the .ipynb files on a thumb drive. After the students login, folders and notebooks can be in place and used as starting points in lab and as lab exercises. After the course ends, students will still be able to log in and use Jupyter Hub and practice writing and running Python code to solve engineering problems. What will it take to make Jupyter Hub a reality? This list will surely change as I go through the process of setting up the Jupyter Hub server. Below are the steps I expect to take and software/hardware needed at each step. Sign up for a Digital Ocean Account (already done) Create a new Digital Ocean Droplet (will be called the server from here on out) Connect to the server over SSH and set up SSH keys Create a non-root sudo user on the server Get a public url, hook up the server DNS record to the public URL Install Anaconda on the server Install the other packages on the server like jupyter hub, node, pyserial and pint Edit permissions of files and directories on the server Create and implement SSL certificates on the server Run Jupyter Hub as a non-root sudo user Connect google OAuth to Jupyter Hub Connect to the server as student and celebrate teaching Python without worrying about installation and virtual environments. Will this work? How much time will it take? Will this work? I hope so. Other people have done it. There was a JupyterCon talk about it, there are example implementations up on github. A large data science class at UC Berkeley ran Jupyter Hub . I don't really know how long it will take. The only real step that takes time is the DNS connection. The rest of the steps are in the minute time frame of computing time and probably days if not weeks of troubleshooting time. I'm just going to try and complete a step per day or a step per week and see if I can get the server going by the end of the spring quarter. Next Steps: The next step is really the first step: Create SSH keys. We'll need a public/private SSH key pair to be able to log into the Jupyter Hub server over SSH.","tags":"jupyter","url":"why-jupyter-hub.html","loc":"why-jupyter-hub.html"},{"title":"Diffusion Calculation with Python and Pint","text":"I was working through a diffusion problem and thought that Python and a package for dealing with units and unit conversions called pint would be usefull. I'm using the Anaconda distribution of Python , which comes with the Anaconda Prompt already installed. For help installing Anaconda, see a previous blog post: Installing Anaconda on Windows 10 . To use the pint package, I needed to install pint using the Anaconda Prompt : > pip install pint The problem I'm working on involes the diffusion of nitrogen gas (N 2 ) into a thin plate of iron. Given: When α-iron is put in a nitrogen atmosphere, the concentration of nitrogen in the α-iron, $C_{N}$ (in units of wt%) is a function of the nitrogen pressure $P_{N_2}$ and temperature $T$ accoding to the relationship: $$C_{N} = 4.9 \\times 10&#94;{-6} \\sqrt{P_{N_2}} exp{\\frac{Q_n}{RT}} $$ Where: $Q_n = 37,600 \\frac{J}{mol}$ $R=8.31 \\frac{J}{mol-K}$ $T$ is the temperature in Kelvin. At 300 °C the nitrogen gas pressure on one side of an iron plate is 0.10 MPa. On the other side of the iron plate, the nitrogen gas pressure is 5.0 MPa. The iron plate is a 1.5 mm thick. Assume the pre-exponential term $D_0$ and the activation energy of diffusion of nitrogen in carbon, $Q_d$ are equal to the values below: $D_0 = 5 \\times 10&#94;{-7} \\frac{m&#94;2}{s}$ $Q_d = 77,000 \\frac{J}{mol} $ Find: Calculate the diffusion flux, J through the plate using Fick's First Law of Diffusion: $$ J = -D \\frac{dC}{dx} $$ Solution: We have a couple different quantities and a couple of different units to handle to solve this problem. We'll start out importing pint and creating a UnitRegistry object. We'll also need the exp (e raised to a power) and sqrt (square root) functions from the math module , part of the Python standard library. In [1]: import pint from math import exp , sqrt u = pint . UnitRegistry () Let's start with the temperature, T = 300 °C. Temperature units in °F and °C are relative units with an off-set scale . °C and °F are not multiplicative units . Non-multiplicatve units are handled by pint a little differently compared to regular multiplicative units. To create a variable including a unit of degrees C, we instantiate a Quantity object and pass in the temperature in °C along with the unit ( u.degC ). We can convert the temperature to Kelvin (K) using the .ito method. Since we want to do some mulipication, division and exponentiation with our temperature, we need to convert the temperature to a multiplicative unit. Pint has two versions of the temperature unit in Kelvin (K). There is the non-multiplicative type degK and the multiplicative type kelvin . We convert the temperature variable T to the multiplicative type kelvin by pulling out the magnitude (the number part without the degK unit) from the T variable and multiplying it by the kevlin unit from pint . In [2]: Q_ = u . Quantity T = Q_ ( 300 , u . degC ) print ( 'T = {} ' . format ( T )) T . ito ( 'degK' ) print ( 'T = {} ' . format ( T )) T = T . magnitude * u . kelvin print ( T ) T = 300 degC T = 573.15 kelvin 573.15 kelvin Next we'll create variables for $Q_n = 37,600 \\frac{J}{mol}$ and the universal gas contant $R=8.31 \\frac{J}{mol-K}$ In [3]: Qn = 37600 * u . J / u . mol R = 8.31 * u . J / ( u . mol * u . kelvin ) Our first nitrogen pressure is 0.10 MPa and our second nitrogen pressure is 5.0 MPa, we'll make variables for both: In [4]: PN1 = 0.10 PN2 = 5.0 Now we can calculate the two nitrogren concentrations in wt% using the equation: $$C_{N} = 4.9 \\times 10&#94;{-6} \\sqrt{P_{N_2}} exp{\\frac{Q_n}{RT}}$$ where $P_{N_2}$ = 0.10 for one side of the iron plate and $P_{N_2}$ = 5.0 for the other side of the iron plate In [5]: CN1 = ( 4.9e-3 ) * sqrt ( PN1 ) * exp ( - Qn / ( R * T )) print ( CN1 ) 5.777054779474043e-07 In [6]: CN2 = ( 4.9e-3 ) * sqrt ( PN2 ) * exp ( - Qn / ( R * T )) print ( CN2 ) 4.084994609852251e-06 These values CN1 and CN2 are in units of wt% N in an iron-nitrogen \"alloy\" where almost all of the alloy is iron with only a small amount of nitrogen. To use Fick's First Law of Diffusion: $$ J = -D \\frac{dC}{dx} $$ We need a concentration gradient $dC$ in units of mass per unit volume like kg/m 3 or g/cm 3 not in units of wt %. Therefore we need to convert the two concentrations of nitrogen in iron, CN1 and CN2 from units of wt% to units of kg/m 3 . To make the conversion between wt% and mass per unit volume we have to pick a sample mass of iron. This mass of iron will contain a mass of nitrogen (based on wt%). We can divide this mass of nitrogen by the volume of iron that corresponds to the mass of iron we picked. As long as we divide the mass of nitrogen by the volume of iron that contains that mass of nitrogen, we will end up with a unit conversion from wt% to kg/m 3 that works. So let's pick 1 kilogram of iron, and use the density of iron as 7.874 g/cm 3 . We set a variable p to equal the density of iron in g/cm 3 and use the .ito() method to convert the density to units of kg/m 3 . Then we divide the mass of iron that we picked (1 kg) and convert it to volume of iron using the density p . This will give use the volume of 1kg of iron in units of m 3 . In [7]: p = 7.874 * u . g / u . cm ** 3 p . ito ( u . kg / u . m ** 3 ) mFe = 1 * u . kg vFe = mFe / p Now we'll determine how many kg of nitrogen there are in 1 kg of iron given our concentrations CN1 and CN2 in wt%. Note that we have to multiply CN1 and CN2 by 0.01 because CN1 and CN2 are in units of %. When we divide the mass of nitrogen by the volume of iron, we get a concentration of nitrogen in iron in units of kg/m 3 , which is the concentration units we need to use the Fick's First Law of Diffusion. In [8]: mN1 = mFe * CN1 * 0.01 CN1 = mN1 / vFe print ( CN1 ) mN2 = mFe * CN2 * 0.01 CN2 = mN2 / vFe print ( CN2 ) 4.5488529333578606e-05 kilogram / meter ** 3 0.0003216524755797662 kilogram / meter ** 3 Back to Fick's Fist Law of Diffusion: $$ J = -D \\frac{dC}{dx} $$ The difference in concentration $dC$, is just the difference between the two concentrations CN1 and CN2 now that they are both in units of kg/m 3 . $dx$, the change in distance is the thickness of the plate, 1.5 mm. We'll convert the change in distance, $dx$ to units of meters using the ito() method. In [9]: dC = CN2 - CN1 dx = 1.5 * u . mm dx . ito ( u . m ) Next we need to find the diffusion coefficient $D$. To do this, we need the pre-exponential term $D_0$ and the activating envery of diffusion $Q_d$. From the beginning of the problem: $D_0 = 5 \\times 10&#94;{-7} \\frac{m&#94;2}{s}$ $Q_d = 77,000 \\frac{J}{mol} $ Let's assign these to variables with the applicable units. In [10]: D0 = 5e-7 * u . m ** 2 / u . s Qd = 77000 * u . J / u . mol To calculate diffusion constant $D$, we use the equation which relates diffusion coefficient, $D$ to temperature, $T$ according to: $$ D = D_0e&#94;{\\frac{-Q_d}{RT}} $$ In [11]: D = D0 * exp ( - Qd / ( R * T )) print ( D ) 4.7627851906932175e-14 meter ** 2 / second Now that we have $D$, $dC$ and $dx$, we can finally calculate diffusion flux, $J$ through the plate using Fick's First Law of Diffusion: $$ J = -D \\frac{dC}{dx} $$ In [12]: J = - D * ( dC / dx ) J Out[12]: -8.768730355898267e-15 kilogram/(meter 2 second) Final Answer: So the final answer rounded to 3 sig figs is: $J = -8.77 \\times 10&#94;{-15} \\frac{kg}{m&#94;{2}s}$","tags":"engineering","url":"diffusion-problem-python-pint.html","loc":"diffusion-problem-python-pint.html"},{"title":"Opening a Jupyter Notebook on Windows","text":"In this post, we will run through how to open a Jupyter notebook on Windows 10. Jupyter notebooks are one way engineers can write and execute Python code. Jupyter notebooks contain Python code, the output of that code produces when it is run and markdown cells to explain what the code means. A Jupyter notebook can be started from the Anaconda Prompt , the Windows start menu or by using the Anaconda Navigator . 3 ways to open a Jupyter notebook : Anaconda Prompt Windows Start Menu Anaconda Navigator 1. Anaconda Prompt The first way to start a new Jupyter notebook is to use the Anaconda Prompt . Go to the Windows start menu and select [Anaconda Prompt] under [Anaconda3] . If you don't see the Anaconda Prompt in the Windows Start Menu, then you need to install Anaconda . Download Anaconda at the following link: Anaconda.com/downloads The Anaconda Prompt window should look something like: At the Anaconda Prompt type: > jupyter notebook This will start a Jupyter notebook . The output in the terminal will look something like below: Copy / paste this URL into your browser when you connect for the first time , to login with a token : http : // localhost : 8888 / ? token = 6 bdef677d3503fbb23e1b4fa0c802ee7c20bdcfd4d9b9951 [ I 16 : 14 : 12 . 661 NotebookApp ] Accepting one - time - token - authenticated connection from :: 1 A web browser should open and you should be able to see the Jupyter file browser : In the upper right select [New] → [Python 3] You will see a new tab open in your web browser. This new browser tab contains a Jupyter notebook . To rename the Jupyter notebook , click the file name at the top of the page to the right of the Jupyter icon. This opens a dialog box where the new name can be typed. Try typing the code below into the first cell in the Jupyter notebook to the right of the In [ ]: prompt import this Then click the run button in the middle of the menu at the top of the notebook. 2. Windows Start Menu Another way to open a Jupyter notebook is to use the Windows start menu. Open the Windows start menu and select [Anaconda3(64 bit)] → [Jupyter Notebook] This will open the Jupyter file browser in a web browser tab. In the upper right select [New] → [Python 3] A new notebook will open as a new tab in your web browser 3. Anaconda Navigator The last way to open a Jupyter notebook is by using the Anaconda Navigator . You can open the Anaconda Navigator using the Windows Start Menu and selecting [Anaconda3(64-bit)] → [Anaconda Navigator] . This will open the Anaconda Navigator . In the middle of the page, in the Jupyter notebook tile, click [Launch] This will open the Jupyter file browser in a web browser tab. In the upper right select [New] → [Python 3] A new notebook will open as a new tab in your web browser. Congratulations! You know how to open a Jupyter notebook on your Windows 10. Now go write some Python code to solve some problems!","tags":"Orientation","url":"opening-a-jupyter-notebook-on-windows.html","loc":"opening-a-jupyter-notebook-on-windows.html"},{"title":"Bar charts with error bars using Python, jupyter notebooks and matplotlib","text":"Engineers collect data and make conclusions based on the results. An important way to view results is with statistical charts. In this post we will build a bar chart to compare the tensile strength of 3D-printed ABS plastic compared to the tensile strength of 3D-printed HIPS plastic. We will add error bars to the chart to show the amount of uncertainty in the data. In the bar plot we construct, the height of the bars will represent the mean or average tensile stength. One bar will represent the average strength of ABS and the other bar will show the average strength of HIPS. We will then add error bars to the plot which will represent +1/-1 standard deviation about the mean. We will use Python , the statistics module (part of the Python standard library), and matplotlib to build the bar plot. I recommend that undergraduate engineers use the Anaconda distribution of Python , which comes with matplotlib already installed. For help installing Anaconda, see a previous blog post: Installing Anaconda on Windows 10 . If matplotlib is not available in your version of Python , open a terminal or the Anaconda Prompt and type: $ pip install matplotlib or > conda install matplotlib The data we are going to plot is from the tensile testing of two different kinds of 3D-printed plastic, ABS and HIPS (HIPS stands for High Impact Polystyrene). You can download the data using the link below: 3D-printed-tensile-bar-data.xlsx I'm constructing the plot in a jupyter notebook . You could also build the code in a .py file and run the code to produce the plot. A note about using matplotlib on MacOSX: if you recieve an error message that matplotlib is not installed as a framework, consider using the Anaconda distribution of Python and running the code in a jupyter notebook . To open a new jupyter notebook go to the Anaconda Prompt or a terminal and type: > jupyter notebook Alternativly, you can start a new jupyter notebook by cliking the Windows start button and searching for [Anaconda3] --> [Jupyter Notebook] If jupyter is not installed on your system, you can install it using the Anaconda Prompt or use a terminal and pip : > conda install jupyter or $ pip install jupyter At the top of the jupyter notebook (or .py file), we need to import the required packages: statistics (part of the Python standard library, but still needs to be imported) and matplotlib From the statistics module we will import two functions: mean (average) and stdev (standard deviation). If we use this import line: from statistics import mean, stdev We can use the names mean() and stdev() in our code. However, if we use a more general import line: import statistics Then we will need to call statistics.mean() and statistics.stdev() in our code. matplotlib also needs to be imported. The typical way to do this is with the line: import matplotlib.pyplot as plt Then thoughout our code, we can use plt() instead of writing out matplotlib.pyplot() each time we want to use a matplotlib method. The %matplotlib inline magic command is added so that we can see our plot right in the jupyter notebook . If you build the plot in a .py file, the %matplotlib inline command should be left out as it will return an error. In [1]: # import packages from statistics import mean , stdev import matplotlib.pyplot as plt #include if using a jupyter notebook, remove if using a .py file % matplotlib inline Create two variables which contains the data for ABS and HIPS as a list of individual tensile strength values. After the import lines, we need to create two variables: one variable for the ABS data and one variable for HIPS data. We will assign the data points as a list of numbers saved in two variables. The general format to create a list in Python is to use list_name = [item1, item2, item3] with square brackets on the outside and commas between the items. The items for the two lists came from the .xlsx file that contains the data ( 3D-printed-tensile-bar-data.xlsx ). The tensile strength is in column [F] labeled [Tensile Strength (Mpa)]. Rows 2-17 contain data for ABS and rows 18-37 contain data for HIPS. In [2]: # data ABS = [ 18.6 , 21.6 , 22 , 21 , 18 , 20.9 , 21 , 19.3 , 18.8 , 20 , 19.4 , 16 , 23.8 , 19.3 , 19.7 , 19.5 ] HIPS = [ 10.4 , 4.9 , 10.2 , 10.5 , 10.9 , 12.9 , 11.8 , 8.4 , 10 , 10.6 , 8.6 , 9.7 , 10.8 , 10.7 , 11 , 12.4 , 13.3 , 11.4 , 14.8 , 13.5 ] Find the mean and standard deviation for each set of data We'll use the mean() and stdev() functions from the statistics module to find the mean (or average) and standard deviation of the two data sets. A summary of these two functions is below: statistics module function description mean() calculate the mean or average of a list of numubers stdev() calculate the standard deviation of a list of numbers In [3]: # find the mean using the mean() function from the statistics library ABS_mean = mean ( ABS ) HIPS_mean = mean ( HIPS ) # find the standard deviation using the stdev() function from the statistics library ABS_stdev = stdev ( ABS ) HIPS_stdev = stdev ( HIPS ) Build a simple bar plot Matplotlib's bar plot fuction can be accessed using plt.bar() . We need to include at least two arguments as shown below: plt.bar (['list', 'of' ,'bar', 'labels'], [list, of, bar, heights]) We will pass in ['ABS', 'HIPS'] for our list of bar labels, and [ABS_mean, HIPS_mean] for our list of bar heights. The command plt.show() will show the plot in a jupyter notebook or show the plot in a new window if running a .py file. In [4]: # Build a bar plot plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ]) plt . show () Add axis labels and title The plot looks pretty good, but we should add axis labels (with units) and a title to our plot. We can add the axis labels and titles with plt.xlabel() , plt.ylabel() and plt.title() . We need to pass in strings enclosed in quotes ' ' with these methods. A summary of the matplotlib functions is below: matplotlib function description plt.bar() build a bar plot plt.xlabel() x-axis label plt.ylabel() y-axis label plt.title() plot title plt.show() show the plot In [5]: # build a bar plot plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ]) plt . xlabel ( '3D-printer Fillament Material' ) plt . ylabel ( 'Tensile Strength (MPa)' ) plt . title ( 'Tensile Strength of 3-D Printed ABS and HIPS Tensile Bars' ) plt . show () Add error bars to the plot We have a nice looking bar plot with two bars, x-axis label, y-axis label and a title. Next we will add error bars to the plot. We will add the error bars by passing a keyword argument in the plt.bar() function. The keyword argument is yerr = [list, of, error, bar, lengths] . A keyword argument is a specific type of argument passed to a function or method that must have a name associated with it. Regular function arguments just need to be in the proper order. Keyword arguments need to be pass with the form keyword_argument_name = value . The general form of the entire plt.bar() line will be: plt.bar (['list', 'of' ,'bar', 'labels'], [list, of, bar, hights], yerr=[list, of, error, bar, lengths]) The first two arguments, ['list', 'of' ,'bar', 'labels'] and [list, of, bar, hights] just need to be in the correct order. The third argument, a keyword argument needs to include yerr = . Our list of error bar lengths will contain the standard deviation for each set of data, ABS_stdev and HIPS_stdev . yerr=[ABS_stdev, HIPS_stdev] In [6]: # build a bar plot plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ], yerr = [ ABS_stdev , HIPS_stdev ]) plt . xlabel ( '3D-printer Fillament Material' ) plt . ylabel ( 'Tensile Strength (MPa)' ) plt . title ( 'Tensile Strength of 3-D Printed ABS and HIPS Tensile Bars' ) plt . show () Add \"caps\" to the error bars The error bars are on the plot, but they are just vertical lines. Typically, error bars have a horizontal lines at the top and bottom and look sort of like the capital letter I. We can add these horizontal lines or \"caps\" to the top and bottom of the error bars by passing an additional keyword argument to the plt.bar() function called capsize= . We will set the capsize=10 , which is a good size for this plot. You can change the capsize= number to make the horizontal lines longer or shorter. Now our plt.bar() function call contains 4 different arguemnts: plt.bar (['list of bar labels'], [list of bar hights], yerr = [list of error bar lengths], capsize = width) A summary of the arugments passed to the plt.bar() function is below: plt.bar() Arguments description [list of bar labels] 1st argument, a list of strings which provide the labels below the bars [list of bar heights] 2nd argument, a list of numbers which determines the height of each bar yerr = [list of error bar lengths] a keyword argument, must include yerr = . Denotes the height of the error bars. Needs to be a list of numbers capsize = width a keyword argument, must include capsize = . Denotes the width of the error bar horizontal \"caps\". Needs to be a number, not a string In [7]: # build the bar plot plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ], yerr = [ ABS_stdev , HIPS_stdev ], capsize = 10 ) plt . xlabel ( '3D-printer Fillament Material' ) plt . ylabel ( 'Tensile Strength (MPa)' ) plt . title ( 'Tensile Strength of 3-D Printed ABS and HIPS Tensile Bars' ) plt . show () Save the plot The plot looks complete: two bars, x and y axis labels, title and error bars with caps. Now let's save the plot as an image file so we can import the plot into a Word document or PowerPoint presentation. If you are using a jupyter notebook , you can just right-click on the plot and select [copy image] or [Save Image As...]. To save a plot as an image programmatically, we use the line: plt.savefig('filename.extension') Matplotlib will save the plot as an image file using the file type we specify in the filename extension. For example, if we call plt.savefig('plot.png') , the plot will be saved as a .png image. If we call plt.savefig('plot.jpg') the plot will be saved as a .jpeg image. In [8]: # build a bar plot and save it as a .png image plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ], yerr = [ ABS_stdev , HIPS_stdev ], capsize = 10 ) plt . xlabel ( '3D-printer Fillament Material' ) plt . ylabel ( 'Tensile Strength (MPa)' ) plt . title ( 'Tensile Strength of 3-D Printed ABS and HIPS Tensile Bars' ) plt . savefig ( 'plot.png' ) plt . show () Increase the .png file image resolution Depending on how the .png image file is viewed: in a jupyter notebook , on the web, in a Word document or in a PowerPoint presentation, the image may look a little blurry. This is because the .png image we created has a fairly low resolution. We can change the resolution by coding: plt.savefig('filename.png', dpi = 300) Where dpi=300 specifies a resolution of 300 dots per square inch. We can specify a higher resolution or lower resoltution then 300 dpi. A higher resolution will increase the image file size, but will look better when magnified. In [9]: # build a bar plot and save it as a .png image plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ], yerr = [ ABS_stdev , HIPS_stdev ], capsize = 10 ) plt . xlabel ( '3D-printer Fillament Material' ) plt . ylabel ( 'Tensile Strength (MPa)' ) plt . title ( 'Tensile Strength of 3-D Printed ABS and HIPS Tensile Bars' ) plt . savefig ( 'plot.png' , dpi = 300 ) plt . show () The full script A summary of the full script is below: In [10]: # import packages from statistics import mean , stdev import matplotlib.pyplot as plt #include if using a jupyter notebook, remove if using a .py file % matplotlib inline # data ABS = [ 18.6 , 21.6 , 22 , 21 , 18 , 20.9 , 21 , 19.3 , 18.8 , 20 , 19.4 , 16 , 23.8 , 19.3 , 19.7 , 19.5 ] HIPS = [ 10.4 , 4.9 , 10.2 , 10.5 , 10.9 , 12.9 , 11.8 , 8.4 , 10 , 10.6 , 8.6 , 9.7 , 10.8 , 10.7 , 11 , 12.4 , 13.3 , 11.4 , 14.8 , 13.5 ] # find the mean using the mean() function from the statistics library ABS_mean = mean ( ABS ) HIPS_mean = mean ( HIPS ) # find the standard deviation using the stdev() function from the statistics library ABS_stdev = stdev ( ABS ) HIPS_stdev = stdev ( HIPS ) # build a bar plot and save it as a .png image plt . bar ([ 'ABS' , 'HIPS' ],[ ABS_mean , HIPS_mean ], yerr = [ ABS_stdev , HIPS_stdev ], capsize = 10 ) plt . xlabel ( '3D-printer Fillament Material' ) plt . ylabel ( 'Tensile Strength (MPa)' ) plt . title ( 'Tensile Strength of 3-D Printed ABS and HIPS Tensile Bars' ) plt . savefig ( 'plot.png' , dpi = 300 ) plt . show () In [ ]:","tags":"matplotlib","url":"bar-plot-with-error-bars-jupyter-matplotlib.html","loc":"bar-plot-with-error-bars-jupyter-matplotlib.html"},{"title":"Using a Temperature Sensor with Micropython running on an Adafruit Feather Huzzah ESP8266","text":"This is the fourth part of a multipart series on Micropython. In this last post of the series, we blinked an LED on and off using Micropython. In this post, we will connect a temperature sensor to an Adafruit Feather Huzzah and use the Micropython REPL to read the temperature. The posts in this series: What is Micropython? Installing Micropython on an Adafruit Feather Huzzah ESP8266 Blink an LED on an Adafruit Feather Huzzah ESP8266 using Micropython Read the temperature from a MCP9808 breakout board using Micropyton (this post) Use Micropython to connect an Adafruit Feather Huzzah to a WiFi network Upload Micropython code to turn an Adafruit Feather Huzzah into a WiFi-enabled IoT weather station Use pandas and matplotlib to plot the weather data from a WiFi-enabled IoT weather station. Upload MicroPython to a cheap $3 ESP-01 module Build custom firmware to turn the $3 ESP-01 into an low-cost WiFi enabled IoT switch. Before we can use the MCP9808 temperature sensor running on the Adafruit Feather Huzzah ESP8266, Micropython needs to be installed on the board and Putty needs to be installed in Windows 10 to communicate with the board over serial. See a previous post to install Micropython on your board and Putty on a Windows machine. Summary of Steps: Connect the temperature sensor to the Adafruit Feather Huzzah board Connect the Adafruit Feather Huzzah to the computer with a USB cable and bring up the Micropython REPL using Putty. Run code at the Micropython REPL to read the temperature 1. Connect the MCP9808 temperature sensor to the Adafruit Feather Huzzah board Connect the MCP9808 temperature sensor breakout board to the Feather Huzzah board with jumper wires. There are four connections: A 3V power line from the Feather Huzzah to the MCP9808 Vdd pin, GND connected between both boards, and the I2C data and clock lines. On the Feather Huzzah, the I2C data line is SDA (pin 4) and the I2C clock line is SCL (pin 5). These connect with the MPC9808 I2C data line SDA and the MPC9808 I2C clock line SCL. Unlike Serial communication where RX connects to TX, in I2C SDA connects to SDA and SCL connects to SCL. Feather Huzzah wire MCP9808 3V red Vdd GND black GND SDA green SDA SCL yellow SCL 2. Connect the Adafruit Feather Huzzah to the computer with a USB cable and bring up the Micropython REPL using Putty. Connect the Adafruit Feather Huzzah to the computer with a microUSB cable. Ensure this is a data cable, not just a charging cable. Open Putty and connect to the Feather Huzzah using the proper serial port (COM#) and 115200 baud. (Remember to use the Serial radio button under Connection Type: ) This should bring up the Micropython REPL prompt >>> . If you can't see the >>> prompt, try typing [Enter], Ctrl-D, pushing the RESET button on the Feather Huzzah. If that doesn't work, try closing putty then unplugging then replugging the USB cable. 3. Run code at the Micropython REPL to read the temperature In the Putty Serial Window, we will import the machine module and then create an instance of the machine.I2C class with the scl and sda parameters set as scl=machine.Pin(5) and sda=machine.Pin(4) . Then we create an empty bytearray which will be used to store the data coming in from the MCP9808 temperature sensor. As strings in Micropython are UTF-8 encoded by defaut, like in Python 3, a bytearray needs to be used to read the raw output from the MCP9808 chip registers. The command i2c.readfrom_mem_into() method brings in the data from the sensor and saves it to our byte_data variable. The arguments inside the method 24 and 5 correspond to the I2C memory address and registry address of the temperature data stored in the MCP9808 temperature sensor. >>> import machine >>> i2c = machine . I2C ( scl = machine . Pin ( 5 ), sda = machine . Pin ( 4 )) >>> byte_data = bytearray ( 2 ) >>> i2c . readfrom_mem_into ( 24 , 5 , byte_data ) >>> value = byte_data [ 0 ] << 8 | byte_data [ 1 ] >>> temp = ( value & 0xFFF ) / 16.0 >>> if value & 0x1000 : ... temp -= 256.0 ... print ( temp ) Next steps: In the next post we will use Micropython to connect the Adafruit Feather Huzzah to a WiFi network.","tags":"micropython","url":"micropython-temp-sensor.html","loc":"micropython-temp-sensor.html"},{"title":"Using the Micropython REPL on an Adafruit Feather Huzzah ESP8266","text":"This is the third part of a multipart series on Micropython. In last post of the series , we installed Micropython on an Adafruit Feather Huzzah ESP8266 microcontroller using Python and a package called esptool . In this post, we are going to write commands to the Micropython REPL (the Micropython prompt) to turn on and off an LED connected to the Feather Huzzah board. The posts in this series: What is Micropython? Installing Micropython on an Adafruit Feather Huzzah ESP8266 Blink an LED on an Adafruit Feather Huzzah ESP8266 using Micropython (This post) Read the temperature from a MCP9808 breakout board using Micropyton Use Micropython to connect an Adafruit Feather Huzzah to a WiFi network Upload Micropython code to turn an Adafruit Feather Huzzah into a WiFi-enabled IoT weather station Before you can use the Micropython REPL (the Microython prompt) running on the Adafruit Feather Huzzah ESP8266, Micropython needs to be installed on the board and Putty needs to be installed to communicate with the board over serial. See the previous post on how to install Micropython on the board and install Putty on a Windows 10 machine. Summary of Steps: Connect the Adafruit Feather Huzzah ESP8266 using a USB cable Determine which COM port the board is connected to using the Windows Device Manager Open Putty and connect to the board at 115200 baud Run commands at the prompt to turn the builtin LED on the Adafruit Feather Huzzah ESP8266 on and off 1. Connect the Adafruit Feather Huzzah ESP8266 board to the laptop Use a microUSB cable to connect the Feather Huzzah to the computer. Make sure that the microUSB cable is a full USB data cable and not just a simple power cable. The first cable I tried was just a charging mobile phones and I couldn't figure out why Putty wasn't working. Switching out the cable was all it took to get it to work. 2. Determine which serial port the Feather Huzzah is connected to Use Windows Device Manager to determine which serial port the Feather Huzzah is connected to. On my Windows 10 laptop, it usually comes up as COM4 . You can find the serial port by looking in the Ports (COM & LPT) category of the Windows Device Manager. Look for something like Silicon Labs CP210x USB to UART Bridge (COM4) in the Ports (COM & LPT) menu. It is the COM# that you are looking for. 3. Use Putty to connect to the Feather Huzzah Ensure the Feather Huzzah board is connected with a USB cable, then connect to it with Putty using the proper serial port (COM#) and 115200 baud. Remember to use the Serial radio button under Connection Type: to select serial communication or you will be trying to communicate with the Feather Huzzah over SSH which won't work. This should bring up the Micropython REPL prompt >>> . If you can't see the >>> prompt, try typing [Enter], Ctrl-D, pushing the RESET button on the Feather Huzzah or unplugging then replugging the USB cable. 4. Run commands at the prompt to turn the built-in LED on the Adafruit Feather Huzzah ESP8266 on and off At the micropython REPL (the Micropython command promt >>> ) try the following commands: >>> print ( ' Micropython for Engineers! ' ) Micropython for Engineers If we import the sys module, we can see the Micropython implementation and platform. >>> import sys >>> sys . implementation ( name = 'micropython' , version = ( 1 , 9 , 3 )) >>> sys . platform 'esp8266' If you see similar output, that means Micropython is working on the Feather Huzzah. We can also view the flash memory size of our Feather Huzzah and the size of the Micropyton firmware we installed. Try this at the Micropython prompt: >>> import port_diag We can see the flash memory size is 4 MB. Below the label Firmware checksum: we can see a line for size: 600872 . This means the size of our Micropythpon installation is about 600 KB or 0.6 MB. Just over half a megabyte and we are running a working version of Python! Now let's turn the Feather Huzzah's built-in LED on and off. The Feather Huzzah has a built-in red LED connected to Pin 0. We can access this LED with Micropython's machine module. First we use the machine module to create a Pin object. The first argument when we instantiate the Pin object is the pin number on the board (in this case 0 ). Pin zero on the Feather Huzzah is connected to the built-in red LED. The second argument is the pin type. We want Pin 0 to act as an ouput pin ( machine.Pin.OUT ). We are going to assign our pin the attribute .on() or .off() . This will cause the Feather board to output a positive voltage or no voltage to Pin 0 to turn the built-in red LED on and off. You can also connect Pin 0 to an LED through a resistor (then to ground) and have this LED turn on and off. >>> import machine >>> pin = machine . Pin ( 0 , machine . Pin . OUT ) Note that Pin 0 on the Adafruit Feather Huzzah is kind of wired \"backwards\". We call pin.off() and the built-in LED turns on and call pin.on() and the built-in LED turns off . >>> pin . on () >>> pin . off () >>> pin . on () >>> pin . off () Now let's see if we can make the LED blink. We'll do this with a simple for loop. At the micropython REPL, initiating a loop will automatically indent the next line, so a tab is not needed before the pin.on() statement. To run the loop, we type backspace on an empty line (to backspace from an indented line) and hit return. >>> import time >>> for i in range ( 10 ): ... pin . on () ... time . sleep ( 1 ) ... pin . off () ... time . sleep ( 1 ) ... This will blink the LED on and off for a total of 20 seconds. Next steps: In the next post, we'll connect to a I2C temperature sensor to the Adafruit Feather Huzzah and use Micropython to read the temperature.","tags":"micropython","url":"micropython-REPL.html","loc":"micropython-REPL.html"},{"title":"Installing Micropython on an Adafruit Feather Huzzah ESP8266","text":"This is the second part of a multipart series on Micropython. Micropython is a port of the Python programming language that runs on small, inexpensive microcontrollers. In this post, we will install Micropython on an Adafruit Feather Huzzah ESP8266 board using Python and a package called esptool. In subsequent posts we will build our Feather Huzzah microcontroller into a WiFi-enabled weather station. The posts in this series: What is Micropython? Installing Micropython on an Adafruit Feather Huzzah ESP8266 (This post) Blink an LED on an Adafruit Feather Huzzah ESP8266 using Micropython Read the temperature from a MCP9808 breakout board using Micropyton Use Micropython to connect an Adafruit Feather Huzzah to a WiFi network Upload Micropython code to turn an Adafruit Feather Huzzah into a WiFi-enabled IoT weather station To install Micropython on a microcontroller, like the Adafruit Feather Huzzah ESP8266, we need the following hardware: Hardware Purpose Windows 10 Laptop Used to download Micropython and install Micropython on the microcontroller Adafruit Feather Huzzah ESP8266 Microcontroller that will run Microphythonn microUSB Cable Used to connect the laptop to the microcontroller To install Micropython we will use the following software and tools: Software Purpose Windows 10 Download Micropython Anaconda distribution of Python Run the esptool that installs Micropython Anaconda Prompt Install the esptool package using pip esptool a pip installable package used to install Micropython firmware .bin file the version of Micropython will run on the Feather Huzzah board Summary of Steps: Install the Anaconda distribution of Python Create a new conda environment and pip install esptool Download the latest Micropython .bin firmware file Install the SiLabs driver for the Adafruit Feather Huzzah ESP8266 Connect the Adafruit Feather Huzzah ESP8266 board to the laptop using a microUSB cable Determine which serial port the Feather Huzzah is connected to Run the esptool to upload the .bin firmware file to the Feather Huzzah Download and install Putty , a serial monitor Use Putty to connect to the Feather Huzzah and run commands in the Micropython REPL 1. Install the Anaconda distribution of Python If you don't have Anaconda installed already, go to Anaconda.com/download and install the latest version. The Anaconda distribution of Python is the Python distribution I recommend for undergraduate engineers. You want to download and install the Python 3.6 Version (the Python 2.7 Version is legacy Python). Most laptops and desktops run a 64-bit version of Windows 10. If in doubt, you can check your Windows installation, or just go with the 64-bit version. 2. Create a new conda environment and install esptool.py It's best practice when using Python to work in virtual environments. We'll create a new virtual environment with conda to use with our Micropython projects. Open the Anaconda prompt and create a new virtual environment named micropython . Activate the environment with the conda activate command. After activating the virtual environment you should see (micropython) before the Anaconda Prompt. Once inside the virtual environment, use pip to install esptool . The esptool will be used to upload the Micropython .bin firmware file onto the Adafruit Feather Huzzah board. Confirm that esptool is installed in the (micropython) virtual environment with conda list . I also created a new directory in the Documents folder called micropython to store all the project files. conda create - n micropython python = 3 . 6 conda activate micropython ( micropython ) pip install esptool ( micropython ) conda list ( micropython ) cd Documents ( micropython ) mkdir micropthon ( micropython ) cd micropython 3. Download the latest micropython firmware .bin file Go to github and download the latest .bin firmware file. Move the .bin firmware file to a new micropython directory. The .bin firmware file is the version of Micropython that will run on the Adafruit Feather Huzzah ESP8266. Straight from Adafruit, the little microcontroller does not have Micropyton installed, so we need to install Micropython ourselves. After installing the Micropython .bin firmware file onto the board, we will be able to bring up the Micropython REPL prompt, type commands into the Micropython REPL and run Micropython .py scripts on the board. 4. Install the SiLabs driver for the Adafruit Feather Huzzah ESP8266 Before we can connect the Adafruit Feather Huzzah to the computer, we need a specific driver installed. For my Windows 10 laptop to see the Adafruit Feather Huzzah board, the CP210x USB to UART Bridge VCP driver needs to be downloaded from SiLabs and installed. This is quick and easy, but does require admin privileges. 5. Connect the Adafruit Feather Huzzah ESP8266 board to the laptop Use a microUSB cable (the same kind of cable that charges many mobile phones) to connect the Feather Huzzah to the computer. Make sure that the microUSB cable is a full USB data cable and not just a simple power cable. I had trouble getting the Feather Huzzah to work, and it turned out the reason was the micoUSB cable was only a charging cable and could not transfer data. 6. Determine which serial port the Feather Huzzah is connected to Use Windows Device Manager to determine which serial port the Feather Huzzah board is connected to. We will need the serial port as one of the parameters when we upload the .bin firmware file on the board. Look for something like Silicon Labs CP210x USB to UART Bridge (COM4) in the Ports (COM & LPT) menu. The USB to UART bridge is actually the Feather Huzzah board. CP210x refers to the chip that handles serial communication on the Feather Huzzah, not the esp8266 chip itself. Make note of the number after (COM ) . It often comes up as (COM4) but it may be different on your computer. The first time I plugged the board into my laptop, Windows could't see the board. I looked through the Device Manager under the Ports menu and the Feather board just didn't show up. Turns out the first USB cable I used was just a charging only cable. When I switched this out for a microUSB data cable, the board came right up under Ports (COM & LPT) . 6. Run esptool to upload the .bin file to the Feather Huzzah Open the Anaconda Prompt and cd into the micropython directory with the .bin file. You can use the dir command to see the directory contents. Make sure the .bin firmware file is in the directory. It will be called something like esp8266-20171101-v1.9.3.bin . Activate the micropython environment with conda activate micropython . Run esptool --help to ensure esptool is installed properly. Note there is no .py extension after esptool . On my Windows laptop, the command esptool worked, but the command esptool.py did not (this is different than the commands shown on the Micropython docs ). If you try to run esptool and you are not in the (micropython) virtual environment, you will get an error. cd Documents cd micropython pwd Documents / micropython dir conda activate micropython ( micropython ) esptool --help Before we write the .bin firmware file to the board, we should first erase the flash memory on the Feather Huzzah using the esptool erase_flash command. Make sure to specify the --port . This is the COM port you found in the Windows Device Manager. In my case the port was COM4 . ( micropython ) esptool --port COM4 erase_flash Now it's time to write the .bin firmware file to the flash memory on the board using the esptool write_flash command. Make sure to use the exact .bin firmware file name you see sitting in the micropython directory. The port has to be set as the port you found in the Windows Device Manager. ---baud is the baud rate, or upload speed. I found that --baud 460800 worked, but you could also specify --baud 115200 which is slower. The upload time was a matter of seconds with either baud rate. The 0 after --flash_size=dectect means we want the firmware to be written at the start of the flash memory (the 0 th position) on the board. Again, make sure the .bin firmware file name is correct. It is easy to mistype. Another issue I ran into was that I tried to use the command esptool.py instead of esptool as shown on the Micropython docs . The documentation for Micropython on the ESP8266 specifies the command esptool.py (including the .py file extension). This did work on my Windows 10 machine. Omitting the .py file extension, and running esptool worked instead. ( micropython ) esptool --port COM4 --baud 460800 write_flash --flash_size=detect 0 esp8266-20171101-v1.9.3.bin 7. Download and install Putty, a serial monitor Now that Micropthon is installed on the board, we need to talk to our board over a serial connection. Windows 10 doesn't have a built-in serial monitor (like screen on OSX and Linux). So we need to download and install Putty . Putty is a lightweight SSH and serial client for Windows. Putty will allow us to communicate with the Adafruit Feather Huzzah board. Putty can be downloaded here . Putty is pretty small and the download and install should be pretty quick. 8. Use Putty to connect to the Feather Huzzah Ensure the Feather board is connected to the computer with a USB cable and ensure you can see the board in the Windows Device Manager. Then use Putty to connect to the board over serial. Make sure you specify the correct serial port in the Serial line box and 115200 baud in the Speed box. Micropython is set to run at 115200 baud , other baud rates will lead to junk characters in the serial monitor. I had trouble finding the serial connection option in Putty. When I opened Putty, the default was an SSH connection. We can't connect to the Feather Huzzah over SSH. You need to select the Serial radio button below the header Connection type: near the top of the Putty window. If you see >>> the Micropython REPL (the Micropython prompt) is running and the Adafruit Feather Huzzah ESP8266 is working! This version of Python isn't running on your computer, it's Micropython running on the little microcontroller! Sometimes I had to type [Enter] or Ctrl-D to get the >>> REPL prompt to show up. A few times I needed to close Putty, unplug then replug the board and try Putty again. The Feather Huzzah also has a tiny little black RESET button that can be pressed to restart the board. At the >>> Micropython REPL prompt try the following commands: >>> print ( 'Micropython for Engineers!' ) Micropython for Engineers >>> import sys >>> sys . platform 'esp8266' Next steps: In the next post of the series, we will use the Micropython REPL running on the Adafruit Feather Huzzah to blink an LED.","tags":"micropython","url":"micropython-install.html","loc":"micropython-install.html"},{"title":"What is Micropython?","text":"This is the first part of a multipart series on Micropython. In this post we'll review what Micropython is, what it is used for and how it is both similar and different from \"regular\" Python. We'll also discuss why Micropython is relevant to undergraduate engineers. 1. What is Micropython? Micropython is a port, or version of Python designed to run on small, inexpensive, low-power microcontrollers. Examples of microcontrollers that Micropython can run on include the pyboard , the WiPy and ESP8266 boards like the Adafruit Feather Huzzah . Normally, Python is run on a desktop or laptop computer (also on big servers at server farms). Compared to a desktop or laptop, microcontrollers are much smaller, cheaper and less powerful. A \"regular\" version of Python can't run on small, cheap microcontrollers because Python is too resouce intensive. Regular Python takes up too much hard disk space, runs on too much RAM and requires a more powerful processor than microcontrollers have. It is pretty amazing that a version of Python (Micropython) runs on these small, cheap microcontrollers like the ESP8266. To get Micropython to run at all on these small boards, Micropython only contains a subset of all the standard library modules inlcuded with \"regular\" Python. Some of the libraries that are included with Micropython don't have the full set of functions and classes that come with the full version of Python. This allows Micropython to be compact (around 600 kB for the ESP8266 port) and only use a small amount of RAM (down to 16k according to the Micropython main page ) You can try using Micropython online with this neat Micropython online emulator . The emulator allows you to run commands at a Micropyton Prompt and see the result on a virtual pyboard. 2. What is Micropyton used for? Micropython is installed on small, cheap microcontrollers like the ESP8266 . Anthing these small microcontrollers can do, Micropython can do. This includes using the microcontroller as a remote sensor to measure things like temperature, humidity and light level. Micropython can also be used to blink LED's, control arrays of LED's, or run small displays. Micropython can control servo motors, stepper motors and solenoids. Civil Engineers could use Micropython to monitor water levels. Michanical Engineers could use Micropython to drive robots. Electrical Engineers could use micropython to measure voltage levels in embedded systems. In the later posts in this series, we will use Micropython, running on a small cheap ESP8266 board, to create a remote internet-connected weather station. The last posts in the series will use Micropyton, running on a really cheap (around $2) ESP-01 module to turn on and off an LED from any computer connected to the internet anywhere in the world. 3. Why should undergraduate Engineers learn Mircopython? Using Python to solve engineering problems such as calculations, statistics, modeling and visulization is really useful for undergraduate Engineers. But Python on it's own is fairly limited in controlling devices outside the computer it's running on. You don't want to leave a laptop in a remote estuary to meausure water temperature, but you could leave a little microcontroller and low-cost temperature sensor. A small robot can't carry around a heavy laptop, but a small, light, low-power board could run a simple robot. You don't want to use a laptop for every small electrical measurement or embedded system control, but a $2 WiFi module would work. In addition, learning how to use Micropython on small, cheap microcontrller can help undergraduates Engineers understand how programming works. It is a different kind of feedback and excitment seeing a motor whirl around compared to seeing a picture of a motor with the speed displayed as text. There is a different kind of wonder seeing an array of LED's light up compared to a 2-D plot on a computer screen. Plus Micropython is just fun! It's as easy to program Micropython as it is to program regular Python. The little projects you can do with Micropython running on a small, low-cost board are almost unlimited. We could send Micropython to space in a micro-satalite, or burry Micropython underground in a small borring machine, or launch Micorpython into the sky on a weather ballon. Next steps: In the next post, we will install Micropython on a small, cheap ESP8266 microcontroller board called the Adafruit Feather Huzzah. Once Micropython is installed on the board, we will run a couple commands at the Micropython REPL running on the board.","tags":"micropython","url":"what-is-micropython.html","loc":"what-is-micropython.html"},{"title":"Plotting sine and cosine with Matplotlib and Python","text":"Plotting is an essential skill for Engineers. Plots can reveal trends in data and outliers. Plots are a way to visually communicate results with your engineering team, supervisors and customers. In this post, we are going to plot a couple of trig functions using Python and matplotlib . Matplotlib is a plotting library that can produce line plots, bar graphs, histograms and many other types of plots using Python. Matplotlib is not included in the standard library. If you downloaded Python from python.org , you will need to install matplotlib and numpy with pip on the command line. > pip install matplotlib > pip install numpy If you are using the Anaconda distribution of Python (which is the distribution of Python I recommend for undergraduate engineers) matplotlib and numpy (plus a bunch of other libraries useful for engineers) are included. If you are using Anaconda , you do not need to install any additional packages to use matplotlib . In this post, we are going to build a couple of plots which show the trig functions sine and cosine . We'll start by importing matplotlib and numpy using the standard lines import matplotlib.pyplot as plt and import numpy as np . This means we can use the short alias plt and np when we call these two libraries. You could import numpy as wonderburger and use wonderburger.sin() to call the numpy sine function, but this would look funny to other engineers. The line import numpy as np has become a common convention and will look familiar to other engineers using Python. In case you are working in a Juypiter notebook, the %matplotlib inline command is also necessary to view the plots directly in the notebook. In [1]: import matplotlib.pyplot as plt import numpy as np # if using a jupyter notebook % matplotlib inline Next we will build a set of x values from zero to 4π in increments of 0.1 radians to use in our plot. The x-values are stored in a numpy array. Numpy's arange() function has three arguments: start , stop , step . We start at zero, stop at 4π and step by 0.1 radians. Then we define a variable y as the sine of x using numpy's sin() function. In [2]: x = np . arange ( 0 , 4 * np . pi , 0.1 ) # start,stop,step y = np . sin ( x ) To create the plot, we use matplotlib's plt.plot() function. The two arguments are our numpy arrays x and y . The line plt.show() will show the finished plot. In [3]: plt . plot ( x , y ) plt . show () Next let's build a plot which shows two trig functions, sine and cosine. We will create the same two numpy arrays x and y as before, and add a third numpy array z which is the cosine of x . In [4]: x = np . arange ( 0 , 4 * np . pi , 0.1 ) # start,stop,step y = np . sin ( x ) z = np . cos ( x ) To plot both sine and cosine on the same set of axies, we need to include two pair of x,y values in our plt.plot() arguments. The first pair is x,y . This corresponds to the sine function. The second pair is x,z . This correspons to the cosine function. If you try and only add three arguments as in plt.plot(x,y,z) , your plot will not show sine and cosine on the same set of axes. In [5]: plt . plot ( x , y , x , z ) plt . show () Let's build one more plot, a plot which shows the sine and cosine of x and also includes axis labels, a title and a legend. We build the numpy arrays using the trig functions as before: In [6]: x = np . arange ( 0 , 4 * np . pi - 1 , 0.1 ) # start,stop,step y = np . sin ( x ) z = np . cos ( x ) The plt.plot() call is the same as before using two pairs of x and y values. To add axis labels we will use the following methods: matplotlib method description example plt.xlabel() x-axis label plt.xlabel('x values from 0 to 4pi') plt.ylabel() y-axis label plt.ylabel('sin(x) and cos(x)') plt.title() plot title plt.title('Plot of sin and cos from 0 to 4pi') plt.legend([ ]) legend plt.legend(['sin(x)', 'cos(x)']) Note that plt.legend() method requires a list of strings ( ['string1', 'string2'] ), where the individual strings are enclosed with qutoes, then seperated by commas and finally inclosed in brackets to make a list. The first string in the list corresponds to the first x-y pair when we called plt.plot() , the second string in the list corresponds to the second x,y pair in the plt.plot() line. In [7]: plt . plot ( x , y , x , z ) plt . xlabel ( 'x values from 0 to 4pi' ) # string must be enclosed with quotes ' ' plt . ylabel ( 'sin(x) and cos(x)' ) plt . title ( 'Plot of sin and cos from 0 to 4pi' ) plt . legend ([ 'sin(x)' , 'cos(x)' ]) # legend entries as seperate strings in a list plt . show ()","tags":"Plotting","url":"plotting-sin-cos-with-matplotlib.html","loc":"plotting-sin-cos-with-matplotlib.html"},{"title":"Python Data Types","text":"Python has many useful built in data types. Python variables can store different types of data and can be created dynamically, without first defining a data type. It's useful for engineers to understand a couple of Python's core data types in order to write well constructed code. Below we will discuss a few different data types. Integers Integers are one of the Python data types. An integer is a whole number, negative, positive or zero. In Python, integer variables can be defined by simply assigning a whole number to a variable name. We can determine data type of a variable using the type() function. >>> a = 5 >>> type ( a ) < class ' int '> >>> b = - 2 >>> type ( b ) < class ' int '> >>> z = 0 >>> type ( z ) < class ' int '> Floating Point Numbers Floating point numbers or floats are another Python data type. Floats are decimals, positive, negative and zero. Floats can also be numbers in scientific notation which contain exponents. In Python, a float can be defined using a decimal point . when a variable is assigned. >>> c = 6.2 >>> type ( c ) < class ' float '> >>> d = - 0.03 >>> type ( d ) < class ' float '> >>> e = 6.02e23 >>> e 6.02e+23 >>> type ( e ) < class ' float '> To make sure a variable is a float instead of an integer even if it is a whole number, a trailing decimal point . is used. Note the difference when a decimal point comes after the a whole number: >>> g = 5 # no decimal point >>> type ( g ) < class ' int '> >>> g = 5. # decimal point >>> type ( g ) < class ' float '> Boolean The boolean data type is either True or False. In Python, boolean variables are defined by the True and False key words. Note that True and False must have an Upper Case first letter. Using a lowercase true returns an error. a = True type ( a ) < class ' bool '> b = False type ( b ) < class ' bool '> c = true Traceback ( most recent call last ): File \"<input>\" , line 1 , in < module > NameError : name 'true' is not defined d = false Traceback ( most recent call last ): File \"<input>\" , line 1 , in < module > NameError : name 'false' is not defined String Strings are sequences of letters, numbers, spaces and symbols. In Python, strings can be almost any length and can contain spaces. String variables are assigned in Python using quotation marks ' ' . string = 'z' type ( string ) < class ' str '> string = 'Engineers' type ( string ) < class ' str '> A numbers and decimals can be defined as strings too. If a decimal number is defined using quotes ' ' , it will be saved as a string rather than as a float. This is true of whole numbers as well. Whole numbers defined using quotes will become strings just like decimal numbers defined using quotes. num = '5.2' type ( num ) < class ' str '> num = '2' type ( num ) < class ' str '> Complex numbers One final data type useful to engineers are complex numbers. A complex number is defined in Python using a real component + imaginary component j . The letter j must be used in the imaginary component. Using the letter i will return an error. Note how imaginary numbers can be added to integers and floats. comp = 4 + 2j type ( comp ) < class ' complex '> comp2 = 4 + 2 i &#94; SyntaxError : invalid syntax intgr = 3 type ( intgr ) < class ' int '> comp_sum = comp + intgr print ( comp_sum ) ( 7 + 2j ) flt = 2.1 comp_sum = comp + flt print ( comp_sum ) ( 6.1 + 2j ) Converting between different data types The number five can be an integer, or a float or a string depending on how it is assigned. Python has built in functions to convert between data types. The int() float() and str() methods will convert our 5 from one Python data type to another. int_num = 5 type ( int_num ) < class ' int '> float_num = float ( int_num ) type ( float_num ) < class ' float '> str_num = str ( int_num ) type ( str_num ) < class ' str '> str_num '5' Summary Data Type Python Class Description Examples integer int whole numbers: negative positive and zero 5 -2 0 floating point number float decimal number: negative positive and zero. Can contain an exponent 2.3 -0.05 4.5e8 boolean bool True or False True False string str sequence of letters, numbers, spaces and symbols Gabby Engineering! 5 complex number comp number with both real and imaginary components 4+2j 0-2j 6+0j","tags":"Orientation","url":"python-data-types.html","loc":"python-data-types.html"},{"title":"Unit conversions with Python and Pint","text":"Units and unit conversions are BIG in engineering. Engineers solve the world's problems in teams. Any problem solved has to have a context. How heavy can a rocket be and still make it off the ground? What thickness bodypannels keep occupants save during a crash? In engineering, a number without a unit is like a fish without water. It just flops around hopelessly without context around it is useless. How can we get help using units? Programming is one way. We are going to complete some uit conversion problmes using Python and Pint. Pint is a Python package used for unit conversions. See the ( Pint documentation ) for more examples. I recommend that undergraduate engineers use Python 3 (Python 2.7 is legacy python) and the Anaconda distribution. To use Pint , we need to install pint in our wroking version of Python. Open up the Anaconda Prompt : > pip install pint I am working on a Windows 10 machine. You can check your operating system and Python version using the code below: In [1]: import platform print ( 'Operating System: ' + platform . system () + platform . release ()) print ( 'Python Version: ' + platform . python_version ()) Operating System: Windows10 Python Version: 3.6.3 Before we can complete a unit conversion with the Pint package, we need to import the Pint module and instantiate a UnitRegistry object. The new ureg object contains all the units used in the examples below. In [2]: import pint ureg = pint . UnitRegistry () For our first problem, we will complete the following converison: Convert 252 kW to Btu/day We'll create a variable called power with units of kilowatts (kW). To create the kW unit, we'll use our ureg object. In [3]: power = 252 * ureg . kW print ( power ) 252 kilowatt To convert power to Btu/day, we use Pint's .to() method. The .to() method does not change the units of power in place. We need to assign the output of the .to() method to another variable power_in_Btu_per_day In [4]: power_in_Btu_per_day = power . to ( ureg . Btu / ureg . day ) print ( power_in_Btu_per_day ) 20636632.5971578 btu / day Another probem: Convert 722 MPa to ksi In [5]: stress = 722 * ureg . MPa In [6]: stress_in_ksi = stress . to ( ureg . ksi ) print ( stress_in_ksi ) 104.71724664121106 kip_per_square_inch Next problem: Convert 1.620 m/s 2 to ft/min 2 In [7]: accel = 1.620 * ureg . m / ( ureg . s ** 2 ) print ( accel ) 1.62 meter / second ** 2 This time we will use the .ito() method. Using .ito() will convert the units of accel in place. In [8]: accel . ito ( ureg . ft / ( ureg . min ** 2 )) print ( accel ) 19133.85826771654 foot / minute ** 2 Convert 14.31 x 10 8 kJ kg mm -3 to cal lb m / in 3 In [9]: quant = 14.31e8 * ureg . kJ * ureg . kg * ureg . mm ** ( - 3 ) print ( quant ) 1431000000.0 kilogram * kilojoule / millimeter ** 3 In [10]: quant . ito ( ureg . cal * ureg . lb / ( ureg . inch ** 3 )) print ( quant ) 1.2356155557389996e+16 calorie * pound / inch ** 3","tags":"engineering","url":"unit-conversions-with-pint.html","loc":"unit-conversions-with-pint.html"},{"title":"Bar charts with error bars using Python and matplotlib","text":"Bar charts with error bars are useful in engineering to show the confidence or precision in a set of measurements or calculated values. Bar charts without error bars give the illusion that a measured or calculated value is known to high precision or high confidence. In this post, we will build a bar plot using Python and atplotlib . The plot will show the coefficient of thermal expansion (CTE) of three different materials based on a small data set. Then we'll add error bars to this chart based on the standard deviation of the data. A bar chart with error bars is shown below. Note the labels on the x-axis and the error bars at the top of each bar. In order to build this plot, we need a couple of things: Asset Description Python (version 3.6) Run the program Anaconda Prompt create the virtual environment and install packages numpy calculate the mean and standard deviation matplotlib build the plot data set data to plot Before you can build the plot, make sure you have the Anaconda Distribution of Python installed on your computer. See installing Anaconda on Windows for installation instructions. To get going, we'll use the Anaconda Prompt to create a new virtual environment. Select Anaconda Prompt from the Windows Start Menu. (If using OSX or Linux, the terminal could also be used) Once you have the Anaconda Prompt open, type the following command to create a new virtual environment: conda create -n errorbars Next, to activate our new (errorbars) virtual environment, type the following into the Anaconda Prompt conda activate errorbars Now that the errorbars virtual environment is active, you should see (errorbars) in parenthesis before the Anaconda Prompt . Now we'll install matplotlib and numpy using conda . (pip will work to install these packages as well) You can write both package names on the same line or use two different conda install lines. conda install matplotlib numpy To confirm our (errorbars) virtual environment has matplotlib and numpy installed, run the command: conda list Now let's create a new Python script called errorbars.py . At the top of the script we need to import numpy and matplotlib . # errorbars.py import numpy as np import matplotlib.pyplot as plt Next, we need to read in our data. The chart below shows the measured coefficient of thermal expansion (CTE) of three metals: Aluminum, Copper and Steel. The units for coefficient of thermal expansion is per degrees C ( / °C) Coefficient of thermal expansion of three metals (units: / °C) Sample Aluminum Copper Steel 1 6.4e-5 4.5e-5 3.3e-5 2 3.01e-5 1.97e-5 1.21e-5 3 2.36e-5 1.6e-5 0.9e-5 4 3.0e-5 1.97e-5 1.2e-5 5 7.0e-5 4.0e-5 1.3e-5 6 4.5e-5 2.4e-5 1.6e-5 7 3.8e-5 1.9e-5 1.4e-5 8 4.2e-5 2.41e-5 1.58e-5 9 2.62e-5 1.85e-5 1.32e-5 10 3.6e-5 3.3e-5 2.1e-5 We'll put this data into three different numpy arrays, one array for each metal. Notice the syntax np.array([ ... ]) has a parenthesis ( followed by a square bracket [ . We are passing a Python list, [ denoted with square brackets ] into the numpy array function (argument enclosed in parenthesis). # Enter raw data aluminum = np . array ([ 6.4e-5 , 3.01e-5 , 2.36e-5 , 3.0e-5 , 7.0e-5 , 4.5e-5 , 3.8e-5 , 4.2e-5 , 2.62e-5 , 3.6e-5 ]) copper = np . array ([ 4.5e-5 , 1.97e-5 , 1.6e-5 , 1.97e-5 , 4.0e-5 , 2.4e-5 , 1.9e-5 , 2.41e-5 , 1.85e-5 , 3.3e-5 ]) steel = np . array ([ 3.3e-5 , 1.2e-5 , 0.9e-5 , 1.2e-5 , 1.3e-5 , 1.6e-5 , 1.4e-5 , 1.58e-5 , 1.32e-5 , 2.1e-5 ]) Now we need to calculate the mean (or average) for each of the three material's CTE using numpy's np.mean() function. The means will be the height of each bar in our chart. # Calculate the average Aluminum_mean = np . mean ( aluminum ) Copper_mean = np . mean ( copper ) Steel_mean = np . mean ( steel ) Next we'll calculate the standard deviation for each metal using numpy's np.std() function. On the plot, we will use the standard deviation as the height of our error bars. The positive error will be show as +1 standard deviation above the mean, and the negative error will be shown as -1 standard deviation below the mean. # Calculate the standard deviation aluminum_std = np . std ( aluminum ) copper_std = np . std ( copper ) steel_std = np . std ( steel ) There are a couple more things needed to build the plot. We need the names of the metals to go along our x-axis, one name below each bar. We'll assign the metal names as list of strings in a variable called materials . We also need a variable that contains the means of the coefficients of thermal expansion, the data we are going to plot. We'll put these into a Python list called CTEs . Our standard deviations will be used for the height of the error bars. The standard deviations will go together in a list called error . Let's code all of these Python list into our errorbars.py script. # Create lists for the plot materials = [ 'Aluminum' , 'Copper' , 'Steel' ] x_pos = np . arange ( len ( materials )) CTEs = [ aluminum_mean , copper_mean , steel_mean ] error = [ aluminum_std , copper_std , steel_std ] OK. Now it's time to build the plot. We are going to build a bar chart with three different bars, one bar for each material: Aluminum, Copper and Steel. First we will create a figure object called fig and an axis object in that figure called ax using matplotlib's plt.subplots() function. Everything in our plot will be added to the ax (axis) object. Next we put a bar chart on our ax (axis) with the ax.bar() method. Note the arguments passed into the ax.bar() method: x_pos is the array with the count of the number of bars. CTEs is our array which contains the means or heights of the bars. yerr=error sets the heights of the error bars and the standard deviations. keyword arguments (align='center', alpha=0.5, ecolor='black', capsize=10) styles the plot. We'll put a label on the y-axis with the title \"Coefficient of thermal expansion (°C -1 )\" using ax.set_ylabel . We use ax.set_xticks() to feed in our number list to set the bars as numbers 1, 2, 3. Then we add labels to these numbered bars with ax.set_ticklabels() . ax.set_title() and ax.yaxis.grid(True) adds a title and horizontal grid lines. Finally, we we'll save the figure to a file called bar_plot_with_error_bars.png using matplotlib's plt.savefig() function. The plt.thight_layout() method ensures our axis and labels don't get cut off and are visible. # Build the plot fig , ax = plt . subplots () ax . bar ( x_pos , CTEs , yerr = error , align = 'center' , alpha = 0.5 , ecolor = 'black' , capsize = 10 ) ax . set_ylabel ( 'Coefficient of Thermal Expansion ($\\degree C&#94;{-1}$)' ) ax . set_xticks ( x_pos ) ax . set_xticklabels ( materials ) ax . set_title ( 'Coefficent of Thermal Expansion (CTE) of Three Metals' ) ax . yaxis . grid ( True ) # Save the figure and show plt . tight_layout () plt . savefig ( 'bar_plot_with_error_bars.png' ) plt . show () The final plot looks like this:","tags":"matplotlib","url":"python-matplotlib-error-bars.html","loc":"python-matplotlib-error-bars.html"},{"title":"Unicode characters for engineers in Python","text":"Unicode characters are very useful for engineers. A couple commonly used symbols in engineers include Omega and Delta. We can print these in python using unicode characters. From the Python interpreter we can type: >>> print ( 'Omega: \\u03A9' ) Omega : Ω >>> print ( 'Delta: \\u0394' ) Delta : Δ >>> print ( 'sigma: \\u03C3' ) sigma : σ >>> print ( 'mu: \\u03BC' ) mu : μ >>> print ( 'epsilon: \\u03B5' ) epsilon : ε >>> print ( 'degree: \\u00B0' ) degree : ° >>> print ( '6i\\u0302 + 4j\\u0302-2k\\u0302' ) 6 i ̂ + 4 j ̂ - 2 k ̂ All of these are unicode characters. Python has support for unicode characters built in. You can check if your system supports it by importing the sys module and calling the sys.getdefaultencoding() function >>> import sys >>> sys . getdefaulencoding () 'utf-8' If you see utf-8 , then your system supports unicode characters. To print any character in the Python interpreter, use a \\u to denote a unicode character and then follow with the character code. For instance, the code for β is 03B2, so to print β the command is print('\\u03B2') . There are a couple of special characters that will combine symbols. A useful one in engineering is the hat &#94; symbol. This is typically used to denote unit vectors. We can add a hat &#94; (also called a circumflex) by putting the unicode escape after the letter you want to add a hat to. For example to add a hat to i the command is print('i\\u0302') . Below is a list of symbols and greek letters and the corresponding unicode escape to produce the character in python. Useful unicode symbols in engineering unicode character description \\u0394 Δ GREEK CAPITAL LETTER DELTA \\u03A9 Ω GREEK CAPITAL LETTER OMEGA \\u03C0 π GREEK SMALL LETTER PI \\u03F4 ϴ GREEK CAPITAL THETA SYMBOL \\u03BB λ GREEK SMALL LETTER LAMDA \\u03B8 θ GREEK SMALL LETTER THETA \\u03B1 ° DEGREE SYMBOL i\\u0302 î i HAT j\\u0302 ĵ j HAT k\\u0302 k̂ k HAT u\\u0302 û u HAT Greek lower case letters unicode character description \\u03B1 α GREEK SMALL LETTER ALPHA \\u03B2 β GREEK SMALL LETTER BETA \\u03B3 γ GREEK SMALL LETTER GAMMA \\u03B4 δ GREEK SMALL LETTER DELTA \\u03B5 ε GREEK SMALL LETTER EPSILON \\u03B6 ζ GREEK SMALL LETTER ZETA \\u03B7 η GREEK SMALL LETTER ETA \\u03B8 θ GREEK SMALL LETTER THETA \\u03B9 ι GREEK SMALL LETTER IOTA \\u03BA κ GREEK SMALL LETTER KAPPA \\u03BB λ GREEK SMALL LETTER LAMDA \\u03BC μ GREEK SMALL LETTER MU \\u03BD ν GREEK SMALL LETTER NU \\u03BE ξ GREEK SMALL LETTER XI \\u03BF ο GREEK SMALL LETTER OMICRON \\u03C0 π GREEK SMALL LETTER PI \\u03C1 ρ GREEK SMALL LETTER RHO \\u03C2 ς GREEK SMALL LETTER FINAL SIGMA \\u03C3 σ GREEK SMALL LETTER SIGMA \\u03C4 τ GREEK SMALL LETTER TAU \\u03C5 υ GREEK SMALL LETTER UPSILON \\u03C6 φ GREEK SMALL LETTER PHI \\u03C7 χ GREEK SMALL LETTER CHI \\u03C8 ψ GREEK SMALL LETTER PSI \\u03C9 ω GREEK SMALL LETTER OMEGA Greek upper case letters unicode character description \\u0391 Α GREEK CAPITAL LETTER ALPHA \\u0392 Β GREEK CAPITAL LETTER BETA \\u0393 Γ GREEK CAPITAL LETTER GAMMA \\u0394 Δ GREEK CAPITAL LETTER DELTA \\u0395 Ε GREEK CAPITAL LETTER EPSILON \\u0396 Ζ GREEK CAPITAL LETTER ZETA \\u0397 Η GREEK CAPITAL LETTER ETA \\u0398 Θ GREEK CAPITAL LETTER THETA \\u0399 Ι GREEK CAPITAL LETTER IOTA \\u039A Κ GREEK CAPITAL LETTER KAPPA \\u039B Λ GREEK CAPITAL LETTER LAMDA \\u039C Μ GREEK CAPITAL LETTER MU \\u039D Ν GREEK CAPITAL LETTER NU \\u039E Ξ GREEK CAPITAL LETTER XI \\u039F Ο GREEK CAPITAL LETTER OMICRON \\u03A0 Π GREEK CAPITAL LETTER PI \\u03A1 Ρ GREEK CAPITAL LETTER RHO \\u03A3 Σ GREEK CAPITAL LETTER SIGMA \\u03A4 Τ GREEK CAPITAL LETTER TAU \\u03A5 Υ GREEK CAPITAL LETTER UPSILON \\u03A6 Φ GREEK CAPITAL LETTER PHI \\u03A7 Χ GREEK CAPITAL LETTER CHI \\u03A8 Ψ GREEK CAPITAL LETTER PSI \\u03A9 Ω GREEK CAPITAL LETTER OMEGA \\u03F4 ϴ GREEK CAPITAL THETA SYMBOL","tags":"python","url":"unicode-characters-in-python.html","loc":"unicode-characters-in-python.html"},{"title":"Python Virtual Environments in OS X, Linux and Windows 10","text":"In this post, I'll review creating virtual environments on three different operating systems: Windows 10, Linux and Mac OSX. Using virtual environments is good programming practice when using Python. A virtual environment will separate the Python interpreter and installed modules from the main Python installation. I use three different operating systems on three different computers: Work: Windows 10 (no admin access) Home Office: Ubuntu 16.04 LTS Laptop: Mac OSX Setting up a Python virtual environment is different on each one of these operating systems. Let's see at what happens when we try and create a new virtual environment in each. Ubuntu 16.04 Linux should be the easiest to get a new virtualenv up and running. In Ubuntu 16.04, I have a terminal and admin access (can use sudo). But look what happens when I try to set up a new virtualenv without any flags or customization: $ mkvirtualenv webscrape $ source activate webscrape ( webscrape ) $ which python $ 2 .7.1 The default installation is legacy Python!? I don't want the legacy 2.7 version, I want at least Python 3.2 and would prefer Python 3.6. Let's delete that legacy Python environment. Make sure the virtual environment is deactivate d first. ( webscrape ) $ source deactivate $ rmvirtualenv webscrape Let's try to specify Python 3 with the -p python3 flag $ mkvirtualenv -p python3 webscrape $ error Now what? Path is too long? How is that possible? What happens when we see which Python version is the default python3? $ which python3 $ bin/usr/anaconda/python3 So that's the flag we need to use when the viruatlenv is created. The --python='which python3' flag will point virtualenvwrapper to the correct Python version. The new virtualenv is initiated with the full file path to our new environment ~/.virtualenvs/webscrape $ mkvirtualenv --python = 'which python3' ~/.virtualenvs/webscrape ( webscrape ) $ python Python 3 .6.2 Nice. Now we can pip install away. So what about creating a new virtual environment on a MacBook Air with OSX? Mac OSX Mac OSX has a terminal too. I get to it by going to the finder and clicking the search in the upper right or using [command] + [space] to bring up the spotlight search bar. Type terminal into the search bar. Setting up a virtualenv should be pretty easy right? $ mkvirtualenv webscrape $ source activate webscrape ( webscrape ) $ which python python 2 .7 Again!? More legacy Python?! Stop it already with the legacy Python. We want Python! Preferably 3.6. Gotta make sure that Python 3 is installed some where. rmvirtualenv that thing. ( webscrape ) $ source deactivate $ rmvirtualenv webscrape $ which python3 $ usr/bin/python $ virtualenv -p python3 webscrape $ source activate webscrape ( webscrape ) $ python python 3 .6.2 OK. Two down and one to go. Is this any easier on Windows 10? Especially with no admin access? Can't be right? Let's see. Windows 10 (no admin access) I have a Windows 10 machine at work with no admin access. I can't install any programs on my work computer that use the Windows active directory (which is most programs). The Python distribution that has worked out the best has been Anaconda . Besides coming with Python 3, and having a bunch of packages already installed, it also comes with a command line client call the Anaconda Prompt . The Anaconda Prompt operates a little like the terminal on Linux and Mac OSX, but some of the commands are a little different. To make a new virtual environment from the Anaconda Prompt type: $ conda create - n webscrape python = 3.6 $ proceed ( [ y ]/ n ) ? $ conda activate webscrape ( webscrape ) $ python --version python 3.6.3 :: Anaconda , Inc . Rockin' right? Turns out that the Windows 10 virtual environment was one of the easiest to set up. Who would have guessed that? That's one piece of magic from the Anaconda distribution. If you are using Windows, I think Anaconda is the way to go. End Note: Maybe it's best to use conda on both OSX and Linux too... You don't have to mess around with ~/.bash_profile or pointing virtualenv wrapper to the proper directory.","tags":"Orientation","url":"virtualenv-in-osx-linux-windows.html","loc":"virtualenv-in-osx-linux-windows.html"},{"title":"How I Build This Site - Part 7","text":"This is the seventh part of a multi-part series on how I built this site. In last post , we added two new pages to our site. An About page and a Book page. In this post, we are going to deploy the site to github pages . Github pages is a place on GitHub.com were documentation and static sites can be hosted. Steps in this post By the end of the post we are going to have a working static website hosted on GitHub pages. To accomplish this, we will complete the following steps: Pull the most recent version of the site from gitub Run pelican's make html command to build the site and preview it with make serve Modify the publishconf.py file to include our GitHub pages url and relative links Use pelican content -s publishconf.py to build a published version of the site in the output directory Add, commit and push the published contents to our master branch on GitHub Make a gh-pages branch in our staticsite repo on GitHub Use ghp-import output and git push origin gh-pages to push the output directory to the gh-pages branch View the freshly published site! OK, let's get started. Can't wait to see the published site live on GitHub pages. Pull to the most recent version of the site from GitHub.com Open a terminal and cd to the staticsite directory. Then activate the (staticsite) virtual environment with source activate staticsite . Once in the (staticsite) environment, pull the most recent version of the site down from GitHub.com with git pull origin master . $ cd ~/Documents/staticsite $ conda activate staticsite (staticsite) $ git pull origin master The staticsite directory should look something like this: staticsite ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── _nb_header.html ├── content ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins ├── pelican-themes ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Now we use the make html command to build a demo version of the site. This will place the static files ( html , css , javascript ) that forms the site in the output folder. We preview the site with make serve . On MacOS and Linux: (staticsite) $ make html (staticsite) $ make serve On Windows: (staticsite) $ fab build (staticsite) $ fab serve The demo version of our site can now be viewed by pointing a browser to: localhost:8000 Press ctr-c to stop the server. Modify the publishconf.py file to use the github pages url We need to edit the publishconf.py file to add our github pages url to SITEURL and set RELATIVE_URLS to True. The lines to change are: #publishconf.py SITEURL = 'https://username.github.io/staticsite' RELATIVE_URLS = True Make sure to set username to your github user name. Setting RELATIVE_URLS = True is necessary for the links on the site to work and for the css and javascript files run on github pages. When I initially set RELATIVE_URLS = False , the site looked terrible, had no formatting or css and none of the links worked. Setting RELATIVE_URLS = True fixed the problem. Create a published version of the site Up to this point, we used the make html command to build a demo version of the site. Now we are ready to publish the site. We publish the site by running the command: (staticsite) $ pelican content -s publishconf.py This creates a published version of the site with relative url's in the output directory. Add, commit, push to the master branch on github Before we can put the published version of the site up on github pages, we need to push the current version of the site up to the master branch. (staticsite) $ git add . (staticsite) $ git commit -m \"first published version\" (staticsite) $ git push origin master Create a gh-pages branch in our staticsite repo on github Up to this point, we saved our work to the master branch of the staticsite repository on github. To host the site on github pages, we need to create a new branch in the staticsite repo called gh-pages . The master branch still houses the code,settings, markup files, notebooks, images, etc. to build the site. However, in the gh-pages branch of the staticsite repo any html, css and javascript files will be served like a regular website. To create the new branch, go the main staticsite repository page on github and click the [Branch: Master] drop down menu on the upper left hand side. Enter the name of the new branch: gh-pages Use ghp-import to post the contents of the output directory to the gh-pages branch As shown in the Pelican documentation , you can use a Python package called ghp-import to help posting the contents of the output directory to the gh-pages branch of our repo on github. If ghp-import isn't installed yet, use pip . Make sure you are in the (staticsite) virtual environment when you run pip . (staticsite) $ pip install ghp-import Now we'll use the ghp-import package to help us post the site. The command ghp-import output will assign the contents of the output directory to the gh-pages branch of our local git repository. The we push the contents of the local gh-pages branch up to the remote gh-pages branch on github. (staticsite) $ ghp-import output (staticsite) $ git push origin gh-pages I had trouble with this set of commands. Depending on which computer I was using, I would get the following error: ! [rejected] gh-pages -> gh-pages (fetch first) error: failed to push some refs to 'https://github.com/professorkazarinoff/staticsite.git' hint: Updates were rejected because the remote contains work that you do hint: not have locally. This is usually caused by another repository pushing hint: to the same ref. You may want to first integrate the remote changes hint: (e.g., 'git pull ...') before pushing again. hint: See the 'Note about fast-forwards' in 'git push --help' for details. I tried git stash and that didn't work. I also tried git pull origin gh-pages but this ended up putting everything from the output directory into my root staticsite directory which made a big old mess. The way I got around it was to use the -f (force) flag. I don't think this is the most elegant or preferred way to get the contents of the output directory up to the gh-pages branch. I just don't really understand how git works well enough to know how to get around the problem without a forced commit. If you get the error above try: (staticsite) $ pelican content -s publishconf.py (staticsite) $ git add . (staticsite) $ git commit -m \"published\" (staticsite) $ git push origin master (staticsite) $ ghp-import output (staticsite) $ git push -f origin gh-pages That has worked so far for me. View the site on github pages. Awesome! The site is now hosted for everyone to see on GitHub pages! Pretty cool right? Point a browser to the github pages url and take a look: https://username.github.io/staticsite Change username to your GitHub user name. My site (the one that you are reading) is hosted here: https://professorkazarinoff.github.io/staticsite Thanks for reading to the end! It was quite a bit of work to get the site up and running, but I am pleased with the results. Now I need to read up on git . . .","tags":"This site","url":"how-i-built-this-site-7.html","loc":"how-i-built-this-site-7.html"},{"title":"How I Build This Site - Part 6","text":"This is the sixth part in a multi-part series on how I built this site. In the last post , we put a search bar at the top right of each page and some css and javascript in order to make tables on the site look better. In this post we are going to add two new pages to our static site: an About page and a Book page. These new pages will have menu entries at the top of our site. Steps in this post We are going to accomplish the following in this post. By the end of the post we are going to have a site with two new pages and two new menu items. Activate our staticsite virtual environment Pull the most recent version of our site from GitHub Add two new pages ( .md files) to our content folder Modify the pelicanconf.py file to use the new pages Build and preview the site with Pelican Add, commit and push the changes to github Let's get started. Activate our virtual environment and pull the most recent version of the site down from GitHub $ cd ~/Documents/staticsite $ conda activate staticsite (staticsite) $ git pull origin master The staticsite directory should look something like this: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content │ ├── posts │ ├── first_post.md │ ├── second_post.md │ ├── third_post.md │ ├── fourth_post.md │ ├── code │ ├── sample_notebook.ipynb │ ├── extra │ ├── custom.css │ ├── custom.js ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins │ ├── i18n_subsites │ ├── liquid_tags │ ├── pelican-ipynb │ ├── tipue_search ├── pelican-themes │ ├── pelican-bootstrap3 ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Create two new pages ( .md files) Up to this point, the top of our site has a menu item for [This site], which isn't very useful. We are going to add two new menu items that link to two new pages . These new menu items will be [About] and [Book]. First we'll create a pages folder in the staticsite/content directory (staticsite) $ cd ~/Documents/staticsite/content (staticsite) $ mkdir pages (staticsite) $ cd pages (staticsite) $ pwd Now we create two new .md files. Note that the header in this file is different from the other posts we've written. It has a very simple header; just one line: Title. We don't need to put in a date or a slug in the header of pages , just in the header of posts . The first markdown file is the about page about.md Title: About Why I started this blog My background My family My hobbies The second page is for the book I am writing, Python Programming for Undergraduate Engineers . The text for the page is going to look something like: book.md Title: Book ### Coming in Fall 2018 Book: **Python Programming for Undergraduate Engineers** This books is for undergraduate engineers learning programming. It is focused on using Python and programming to solve engineering problems. ### Chapter List * Preface * Chapter 1: Orientation * Chapter 2: Engineering 101 * Chapter 3: Statics * Chapter 4: Circuits I * Chapter 5: Strengths * Chapter 6: Circuits II * Chapter 7: Dynamics * Chapter 8: Circuits III * Chapter 9: Capstone * Appendix ### Pre-order will be available soon After the pages are saved, our staticsite directory should look something like this: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content │ ├── pages │ ├── about.md │ ├── book.md │ ├── posts │ ├── first_post.md │ ├── second_post.md │ ├── third_post.md │ ├── fourth_post.md │ ├── code │ ├── sample_notebook.ipynb │ ├── extra │ ├── custom.css │ ├── custom.js ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins │ ├── i18n_subsites │ ├── liquid_tags │ ├── pelican-ipynb │ ├── tipue_search ├── pelican-themes │ ├── pelican-bootstrap3 ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Modify pelicanconf.py to include the two new pages. Pelican needs to know about the two \"pages\" files. Modify the pelicanconf.py file to include the lines: #pelicanconf.py # Paths PATH = 'content' PAGE_PATHS = ['pages'] ARTICLE_PATHS = ['posts'] # Top menus DISPLAY_CATEGORIES_ON_MENU = False DISPLAY_PAGES_ON_MENU = True Build and preview the site with Pelican With the two new page .md files created and the changes to pelicanconf.py in place, let's preview the site again. We build the site and serve up the contents in the output folder with: On MacOS and Linux: (staticsite) $ make html (staticsite) $ make serve On Windows: (staticsite) $ fab build (staticsite) $ fab serve To view the site, point a browser to localhost:8000 localhost:8000 Use ctrl-c to stop the server. Add and commit the changes then push them to github When we are done editing the the site, we add all of the changes to our local git repo using git add . . Commit those changes with git commit and add the -m \"added about and book pages\" flag to supply a commit message (make sure to use double quotes \"commit message\"). Push the changes up to github with git push origin master $ git add . $ git commit -m \"added about and book pages\" $ git push origin master In the next post we will publish the site to github pages. Once the site is published, it will be live and public. Available to any one with an internet connection. An actual, real, published, live static site!","tags":"This site","url":"how-i-built-this-site-6.html","loc":"how-i-built-this-site-6.html"},{"title":"How I Build This Site - Part 5","text":"This is the fifth part in a multi-part series on how I built this site. In the last post , we installed a couple of plugins to add extra functionality to the site. These plugins enabled embedded jupyter notebooks and posts in a series. In this post we'll put a search bar at the top right of each page and add some css and javascript in order to make tables on the site look better. Steps in this post We are going to accomplish the following in this post. By the end of the post we are going to have a site with a working search bar and nice looking tables. Activate our staticsite virtual environment Pull the most recent version of our site from github Modify the pelicanconf.py file to use the 'tipue_search' plugin Add custom css and javascript to make tables look better Build and preview the site with Pelican Add, commit and push the changes to github Let's get started. Activate our virtual environment and pull the most recent version of the site down from github $ cd ~/Documents/staticsite $ conda activate staticsite (staticsite) $ git pull origin master The staticsite directory should look something like this: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content │ ├── posts │ ├── first_post.md │ ├── second_post.md │ ├── third_post.md │ ├── code │ ├── sample_notebook.ipynb ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins │ ├── i18n_subsites │ ├── liquid_tags │ ├── pelican-ipynb ├── pelican-themes │ ├── pelican-bootstrap3 ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Add the 'tipue_search' plugin to the pelicanconf.py file Now we need to modify the pelicanconf.py file to use the 'tipue_search' plugin. This plugin will give us the ability to add a search bar to our site menu at the top right of each page. Add 'tipue_search' to the PLUGINS = [ ] list in the pelicanconf.py file. Make sure each plugin is separated with commas and surrounded by quotes . #pelicanconf.py PLUGINS = [ 'i18n_subsites', 'series', 'tag_cloud', 'liquid_tags.youtube', 'liquid_tags.notebook', 'liquid_tags.include_code', 'render_math', 'pelican-ipynb.markup', 'tipue_search' ] To use the 'tipue_search' plugin, we also need to add the following line to the pelicanconf.py file: #pelicanconf.py # for Tique Search Plugin DIRECT_TEMPLATES = ('index','tags', 'categories', 'authors', 'archives', 'search') Add some custom css and javascript to make tables look good. Even with a great theme like pelican-bootstrap3, there are some changes to make to the look of the site. One of these changes is to make tables look better, like the tables on github readme pages look. Let's make a new post in the content/posts directory. This post will contain a markdown table using the | (pipe) character and a header row with pipes separated by three dashes --- . fourth_post.md Title: Fourth Post - Part 4 Date: 2017-11-30 12:40 Modified: 2017-11-30 12:40 Status: published Category: example posts Tags: python, pelican, blog, tables Slug: fourth-post Authors: Peter D. Kazarinoff Series: example-post-series Series_index: 4 Summary: This is the fourth post of a series of posts. It will demonstrate tables. This is the fourth post of a series of posts. It will demonstrate tables. | Column Header | Column Header | | --- | ---| | Row 1 | Data 1 | | Row 2 | Data 2 | After the post is saved, our staticsite directory should look something like this: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content │ ├── posts │ ├── first_post.md │ ├── second_post.md │ ├── third_post.md │ ├── fourth_post.md │ ├── code │ ├── sample_notebook.ipynb ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins │ ├── i18n_subsites │ ├── liquid_tags │ ├── pelican-ipynb │ ├── tipue_search ├── pelican-themes │ ├── pelican-bootstrap3 ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid To change the way that tables are rendered, we will add some custom css and javascript that is not included with the pelican-bootstrap3 theme. First create a new folder in the staticsite/content directory called extra . $ cd ~/Dcouments/staticsite/content $ mkdir extra && cd extra Inside the extra folder, create a new .css file called custom.css . Insert the following style changes in custom.css : .table { width: inherit; max-width: 100%; margin-bottom: 21px; padding: 6px 13px; } Now create a new javascript file in the content/extra directory called custom.js . This file contains extra javascript that will be injected into pages when the .html is generated by Pelican. var tables, i; tables = document.getElementsByTagName('table'); for (i=0;i<tables.length;i++) { tables[i].className = 'table table-bordered table-hover table-striped table-responsive'; } With the addition of these two new files, the contents of the staticsite directory will look something like: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content │ ├── posts │ ├── first_post.md │ ├── second_post.md │ ├── third_post.md │ ├── fourth_post.md │ ├── code │ ├── sample_notebook.ipynb │ ├── extra │ ├── custom.css │ ├── custom.js ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins │ ├── i18n_subsites │ ├── liquid_tags │ ├── pelican-ipynb │ ├── tipue_search ├── pelican-themes │ ├── pelican-bootstrap3 ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Pelican needs to know about the two new \"custom\" files. Modify the pelicanconf.py file to include the lines: #pelicanconf.py CUSTOM_CSS = 'static/css/custom.css' CUSTOM_JS = 'static/js/custom.js' STATIC_PATHS = [ 'extra' ] EXTRA_PATH_METADATA = { 'extra/custom.css': {'path': 'static/css/custom.css'}, 'extra/custom.js': {'path': 'static/js/custom.js'} } When the site is built, Pelican will read in custom.css and custom.js siting in the extra folder. Pelican will then copy these two files in the appropriate places in the output directory (static/css/custom.css and static/css/custom.js) for the theme to use. Then the code from the css and javascript files will be used by the .html pages in the output directory along with the other css and javascript from the bootstrap3 theme. This will make tables look more like tables in github readme pages. Build and preview the site with Pelican With the search plugin configured, a new posts containing a table written, plus our custom.js and custom.css in place, let's preview the site again. We build the site and serve up the contents in the output folder with: On MacOS and Linux: (staticsite) $ make html (staticsite) $ make serve On Windows: (staticsite) $ fab build (staticsite) $ fab serve To view the site, point a browser to localhost:8000 localhost:8000 use ctrl-c to stop the server. Add and commit the changes then push them to github When we are done editing the the site, we add all of the changes to our local git repo using git add . . Commit those changes with git commit and add the -m \"added search and tables\" flag to supply a commit message (make sure to use double quotes \"commit message\"). Push the changes up to github with git push origin master (staticsite) $ git add . (staticsite) $ git commit -m \"added search and tables\" (staticsite) $ git push origin master In the next post we will add two new menu items across the top of our site. These new menu items will link to an [About] page and a [Book] page.","tags":"This site","url":"how-i-built-this-site-5.html","loc":"how-i-built-this-site-5.html"},{"title":"How I Build This Site - Part 4","text":"This is the fourth part in a multi-part series on how I built this site. In the last post , we installed the pelican-bootstrap3 theme and made our site mobile responsive. Now the site looks good on all devices. In this post we are going to install a couple of plugins to add extra functionality to our site. These plugins will allow our site to have a series of post that are linked together, create a working search bar, add youtube videos to posts, view LaTeX math and add embedded jupyter notebooks in posts. Steps in this post We are going to accomplish the following in this post. By the end of the post we are going to have a great looking website that contains a two-part series, a post with an embedded youtube video and a post that contains an embedded jupyter notebook. Activate our staticsite virtual environment Pull the most recent version of our site from github Install jupyter in our staticsite environment Modify the pelicanconf.py file to use new plugins Build some posts that will allow us to view the new plugins Build and preview the site with Pelican Add and commit the changes then push those changes to github Seems like a lot to do, so let's get started. Activate our virtual environment and pull the most recent version of the site down from github $ conda activate staticsite (staticsite) $ cd ~/Documents/staticsite (staticsite) $ pwd (staticsite) $ git pull origin master Install the jupyter package in our staticsite virtual environment. I like using jupyter notebooks to build code and solve engineering problems with Python. A jupyter notebook can contain Python code, the output produced when this code is run and markup text (used for documentation). Jupyter notebooks can also easily display matplotlib plots and pandas data frames. These two Python packages are very useful for engineers solving problems in teams. As the jupyter package is in the main conda channel, we can install it into our virtual environment using the conda install command. (staticsite) $ conda install jupyter We can see all of the modules installed in our (staticsite) environment with: (staticsite) $ pip freeze The output should look something like: appnope==0.1.0 bleach==2.1.1 blinker==1.4 certifi==2017.11.5 decorator==4.1.2 docutils==0.14 entrypoints==0.2.3 feedgenerator==1.9 html5lib==0.999999999 ipykernel==4.6.1 ipython==6.2.1 ipython-genutils==0.2.0 ipywidgets==7.0.5 jedi==0.11.0 Jinja2==2.10 jsonschema==2.6.0 jupyter-client==5.1.0 jupyter-console==5.2.0 jupyter-core==4.4.0 Markdown==2.6.9 MarkupSafe==1.0 mistune==0.8.1 nbconvert==5.3.1 nbformat==4.4.0 notebook==5.2.2 pandocfilters==1.4.2 parso==0.1.0 pelican==3.7.1 pexpect==4.3.0 pickleshare==0.7.4 prompt-toolkit==1.0.15 ptyprocess==0.5.2 Pygments==2.2.0 python-dateutil==2.6.1 pytz==2017.3 pyzmq==16.0.3 qtconsole==4.3.1 simplegeneric==0.8.1 six==1.11.0 terminado==0.6 testpath==0.3.1 tornado==4.5.2 traitlets==4.3.2 Unidecode==0.4.21 wcwidth==0.1.7 webencodings==0.5.1 widgetsnbextension==3.0.8 Add new plugins to the pelicanconf.py file Now we need to modify the pelicanconf.py file to use a couple new plugins. The plugins we will add are: 'series' 'tag_cloud', 'liquid_tags.youtube' 'liquid_tags.notebook', 'liquid_tags.include_code', 'render_math' 'pelican-ipynb.markup' We add these to the PLUGINS = [ ] list in the pelicanconf.py file and separate them with commas. #pelicanconf.py PLUGINS = [ 'i18n_subsites', 'series', 'tag_cloud', 'liquid_tags.youtube', 'liquid_tags.notebook', 'liquid_tags.include_code', 'render_math', 'pelican-ipynb.markup' ] Build some posts that use the newly installed plugins Now we will build a couple of posts which use our newly installed plugins. First we'll modify our content directory with a new folder called posts . We'll keep all the posts in this directory. Then we'll make a couple of new .md files. I'll copy our first post to this new directory with the cp (copy) shell command and then remove the old .md file with the rm command. (staticsite) $ pwd (staticsite) $ cd content (staticsite) $ mkdir posts (staticsite) $ cp first_post.md posts/first_post.md (staticsite) $ rm first_post.md Now let's modify the first_post.md file with a couple new lines in the header. The Series: and Series_index: lines will put this first post in series of posts using the series plugin. first_post.md Title: First Post - Part 1 Date: 2017-11-30 12:40 Modified: 2017-11-30 12:40 Status: published Category: example posts Tags: python, pelican, blog Slug: first-post Authors: Peter D. Kazarinoff Series: example-post-series Series_index: 1 Summary: This is the first post of a series of demonstration posts. This is the first post of a series of demonstration posts. After the post is saved, we can go back to the terminal and copy it to create our second post. The contents of our staticsite directory should look something like this: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content │ ├── posts │ ├── first_post.md ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins │ ├── i18n_subsites │ ├── liquid_tags │ ├── pelican-ipynb │ ├── tipue_search ├── pelican-themes │ ├── pelican-bootstrap3 ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Let's make two new posts in the content/posts directory. (staticsite) $ cd ~/Documents/staticsite/content/posts (staticsite) $ cp first_post.md second_post.md (staticsite) $ cp first_post.md third_post.md Now we'll edit second_post.md so it's part of a series and contains an embedded YouTube video. second_post.md Title: Second Post - Part 2 Date: 2017-11-30 12:40 Modified: 2017-11-30 12:40 Status: published Category: example posts Tags: python, pelican, blog Slug: second-post Authors: Peter D. Kazarinoff Series: example-post-series Series_index: 2 Summary: This is the second post of a series of posts. It will show series and an embeded youtube video. This is the second post of a series of posts. It will show series and an embedded youtube video. {% youtube https://www.youtube.com/watch?v=Qq-5frjUfK0 [560] [315] %} We'll create a sample jupyter notebook in a new folder called code in our content folder. The jupyter notebook will go in our third post. To create the code folder and bring up a new jupyter notebook in our web browser use: (staticsite) $ pwd (staticsite) $ mkdir content/code (staticsite) $ cd content/code (staticsite) $ jupyter notebook Let's put one markdown cell, one code cell and produce one output cell in our jupyter notebook . We'll save it as example_notebook.ipynb . My sample_notebook.ipynb looks like: Now we will put our example_notebook.ipynb into our third post. Including a juypter notebook requires the use of the line notebook path/to/notebook.ipynb surrounded with a { % % } . third_post.md Title: Third Post - Part 3 Date: 2017-11-30 12:40 Modified: 2017-11-30 12:40 Status: published Category: example posts Tags: python, pelican, blog Slug: third-post Authors: Peter D. Kazarinoff Series: example-post-series Series_index: 3 Summary: This is the third post of a series of posts. It will show series an jupyter notebook. This post contains a jupyter notebook. {% notebook ../code/sample_notebook.ipynb %} Build and preview the site with Pelican With a couple new pelican-plugins configured and three new posts written, it is time to preview our site again. We can build the site and can view it with a web browser using: On MacOS and Linux: (staticsite) $ make html (staticsite) $ make serve On Windows: (staticsite) $ fab build (staticsite) $ fab serve To view the site, point a browser to localhost:8000 localhost:8000 use ctrl-c to stop the server. Add and commit the changes then push them to github When we are done editing the the site, we add all of the changes to our local git repo using git add . . Then we commit those changes with git commit and add the -m \"added plugins\" flag to give supply a commit message (make sure to use double quotes \"commit message\"). To push those changes up to github use git push origin master $ git add . $ git commit -m \"added plugins\" $ git push origin master In the next post we will customize the site. We'll add some css in order to make tables on the site look better and put a search bar at the top of the page.","tags":"This site","url":"how-i-built-this-site-4.html","loc":"how-i-built-this-site-4.html"},{"title":"How I Build This Site - Part 3","text":"This is the third part in a multi-part series on how I built this site. In the last post , we used pelican-quickstart to build the framework of the site and wrote a short first post, then viewed a demo version of the site on localhost:8000. In this post we will add a custom theme to the site called pelican-bootstrap3. The pelican-bootstrap3 theme looks great and is mobile reponsive so it will make the site look good on phones and tablets. Then we'll add some custom css to personalize the look of the theme. Steps in this post We are going to accomplish the following in this post. By the end of the post we are going to have a a static site with a great looking bootstrap3 theme which is mobile responsive and looks great on desktops, tablets and phones. Activate our staticsite virtual environment Pull the most recent version of our site from github Add a git submodule to our staticsite folder and bring in the pelican-themes repo from github Add a git submodule to our staticsite folder and bring in the pelican-plugins repo from github Modify the pelicanconf.py file to point to our new theme, and add a new plugin Build and preview the site with Pelican Add and commit the changes then push those changes to github Big steps, it's really going to look like a website when we are done. Activate our virtual environment and pull from github Open the Anaconda Prompt and activate the (staticsite) virtual environment $ conda activate staticsite Then cd into the staticsite directory and bring in the most up to date version of the site stored on github. (staticsite) $ cd ~ (staticsite) $ cd Documents/staticsite (staticsite) $ git pull origin master Use git submodule add to pull all of the themes into our local staticsite/pelican-themes directory There are a bunch of different themes available for static site built with Pelican. The three I was most interested in were: material voidy_bootstrap pelican-bootstrap3 We can bring in all of the Pelican themes stored on github by creating a git submodule . A git submodule is a sub-repository within a git repository that is linked to another repository. It is a way to bring in something else from github within a local repository and not have to keep a local copy up to date. Each time we \"pull\" from the submodule, we get the newest version of the pelican-themes repo on github. We don't have to manually track any changes to these themes and incorporate them to our local version. When the changes are made to the themes on github, we just pull those changes down to our local version. The lines git submodule init and git submodule update --init --recursive are important to call. If those two commands are not moved we'll end up with empty folders within the staticsite/pelican-themes directory. A lot of the themes are submodules themselves so the --recursive option has to be used to pull all of these submodules down. Without --recursive you can end up with empty folders. To create the folder for our pelican-themes git submodule, ensure you are in the staticsite folder, then call: $ pwd $ git submodule add https://github.com/getpelican/pelican-themes.git $ git submodule init $ git submodule update --init --recursive Ensure that we are still in the staticsite directory and pull down the pelican-plugins repo form github. $ pwd $ git submodule add https://github.com/getpelican/pelican-plugins.git $ git submodule init $ git submodule update --init --recursive Now the contents of the staticsite folder should look something like: staticsite/ ├── LICENSE ├── Makefile ├── README.md ├── __pycache__ ├── content ├── develop_server.sh ├── fabfile.py ├── output ├── pelican-plugins ├── pelican-themes ├── pelican.pid ├── pelicanconf.py ├── publishconf.py └── srv.pid Modify the pelicanconf.py file, so that we can use a new theme. So far our pelicanconf.py file contains only default lines of code that Pelican built for us. In order to use a new theme, we need to edit this configuration file. After we edit the configuration file, the make html command will produce new .html pages in the output directory. The relevant lines to add and modify in the pelicanconf.py are: #pelicanconf.py PLUGIN_PATHS = ['pelican-plugins'] THEME = 'pelican-themes/pelican-bootstrap3' BOOTSTRAP_THEME = 'flatly' PLUGIN_PATHS = ['/path/to/git/pelican-plugins'] JINJA_ENVIRONMENT = {'extensions': ['jinja2.ext.i18n']} PLUGINS = [ 'i18n_subsites'] I18N_TEMPLATES_LANG = 'en' Taken directly from the pelicin-bootstrap3 README.md ... this template can be translated (see Translations below). You also need to activate a plugin that initializes the i18n jinja extension. One possibility is an up to date version of the i18n_subsites plugin. So we need to make sure to include the i18n plugin in our pelicanonf.py file. Again from the from the pelicin-bootstrap3 README.md If you are using i18n_subsites and you are not using English as your default language, make sure to also correctly specify the default language of the theme. Otherwise the translations will not be used on your default site. Build and preview the site with Pelican With the pelican-plugins and pelican-themes repos downloaded and the pelicanconf.py file edited, we can build the site and take a look at it with a web browser: On MacOS and Linux: (staticsite) $ make html (staticsite) $ make serve On Windows (staticsite) $ fab build (staticsite) $ fab serve To view the site, point a brower to localhost:8000 localhost:8000 Now, the site should look something like this: use ctrl-c to shut down the server. Add and commit the changes then push those changes to github When we are done editing the the site, we add all of the changes to our local git repo using git add . . Then we commit those changes with git commit and add the -m \"added pelican_bootstrap3 theme\" flag to give supply a commit message (make sure to use double quotes \"commit message\"). To push those changes up to github use git push origin master $ git add . $ git commit -m \"added pelican_bootstrap3 theme\" $ git push origin master In the next post we will add some additional pelican-plugins to bring extra functionality to the site and add the ability to include jupyter notebooks in posts.","tags":"This site","url":"how-i-built-this-site-3.html","loc":"how-i-built-this-site-3.html"},{"title":"How I Build This Site - Part 2","text":"This is the second part in a multi-part series on how I built this site. In the last post , we set up our development environment including Python, a new virtual environment, installed the pelican and markdown packages and set up git. In this post, we will use the pelican-quickstart command to get the blog off the ground. We are also going to create a first_post.md file and serve up the website locally so we can take a look at it. Steps in this post We are going to accomplish the following in this post. By the end of the post, we will have a working website with one blog post served up locally and an updated github repo with all the changes saved. Activate our staticsite virtual environment Pull the most recent version of our site from github Use the pelican-quickstart command to make a first version of the site Write a first post in markup language (.md) Build the site using the make html command Serve the site locally using make serve and view with a web browser Add and commit the changes then push those changes to github That's a lot to do, so let's get started. Activate our staticsite virtual environment I highly recommend installing the Anaconda distribution of python. If you followed along with the previous post , you already installed Anaconda and can pull up the Anaconda Prompt. Open the Anaconda Prompt and see which virtual environments are available. $ conda info --envs You should see a list of all the virtual environments conda has created on your machine. It should look something like: staticsite C:\\Users\\user.name\\AppData\\Local\\Continuum\\Anaconda3\\envs\\staticsite root * C:\\Users\\user.name\\AppData\\Local\\Continuum\\Anaconda3 The staticsite virtual environment is the one we set up to create our site. Activate it with: $ conda activate staticsite You should now see (staticsite) before the command prompt. This means we are operating in the staticsite virtual environment. View installed packages We installed pelican, markdown and fabric in the last post. Let's make sure they are installed in our (staticsite) virtual environment. (staticsite)$ pip freeze Make sure you see the following modules are installed: beautifulsoup4==4.6.0 Jinja2==2.9.6 Fabric==1.14.0 Markdown==2.6.9 pelican==3.7.1 Pygments==2.2.0 Pelican Quickstart - make the site! We are now going to build the site! Exciting stuff. With the virtual environment and packages in place, we just need to make sure we are in a directory where we want our site to live. (staticsite)$ cd ~ (staticsite)$ cd Documents (staticsite)$ cd staticsite You can confirm you are working in the staticsite directory by typing pwd which stands for print working directory : (staticsite)$ pwd Now we can spin up the settings and structure of our pelican build. Start the process with the command: (staticsite)$ pelican-quickstart Pelican will ask us a bunch of questions at the start. The initial settings I used are below. Make sure to change the title, author, URL prefix, and timezone: > Where do you want to create your new web site ? [.] > What will be the title of this web site ? Python Programming for Undergraduate Engineers > Who will be the author of this web site ? Peter D . Kazarinoff > What will be the default language of this web site ? [ English ] > Do you want to specify a URL prefix ? e . g ., http : // example . com ( Y / n ) Y > What is your URL prefix ? ( see above example ; no trailing slash) https://username.github.io/staticsite > Do you want to enable article pagination ? ( Y / n ) Y > How many articles per page do you want ? [ 10 ] 5 > What is your time zone ? [ Europe / Paris ] America / Los_Angeles > Do you want to generate a Fabfile / Makefile to automate generation and publishing ? ( Y / n ) Y > Do you want an auto - reload & simpleHTTP script to assist with theme and site development ? ( Y / n ) Y > Do you want to upload your website using FTP ? ( y / N ) N > Do you want to upload your website using SSH ? ( y / N ) N > Do you want to upload your website using Dropbox ? ( y / N ) N > Do you want to upload your website using S3 ? ( y / N ) N > Do you want to upload your website using Rackspace Cloud Files ? ( y / N ) N > Do you want to upload your website using GitHub Pages ? ( y / N ) y > Is this your personal page ( username . github . io ) ? ( y / N ) N Now we can create and view the site. The command make html will create the site and the command make serve will spin up a local webserver that allows us to view the site. If you are using windows, make commands may not work. Try fab build and fab serve instead. On MacOS and Linux: (staticsite)$ make html (staticsite)$ make serve On Windows: (staticsite)$ fab build (staticsite)$ fab serve Point a web browser to: localhost:8000 The site will look something like: We can shut down the server by typing ctrl-c Write a first post in markup language (.md) Time to write our first post. The contents of the staticsite directory should look something like: staticsite/ │ develop_server.sh │ fabfile.py │ Makefile │ pelicanconf.py │ publishconf.py │ ├───content ├───output └───__pycache__ To make a new post, we need to add a markup file (.md file) to the content folder. Let's call our first post first_post.md . Depending on the computer I'm using, I create .md files with different programs. One Windows 10, I have been using Code Writer. On Mac OSX and Linux, I use PyCharm . The first_post.md file saved in the content folder needs to have the form: Title: First Post Date: 2017-10-13 12:40 Modified: 2017-10-13 12:40 Status: published Category: This site Tags: python, markdown, blog Slug: first-post Authors: Peter D. Kazarinoff Summary: This is the summary of the first post This is the very first post! After saving the file first_post.md in the content folder, the static site folder should look something like: staticsite/ │ develop_server.sh │ fabfile.py │ Makefile │ pelicanconf.py │ publishconf.py │ ├───content │ first_post.md │ ├───output └───__pycache__ Let's build the site again and take a look at our new post. On MacOS and Linux: (staticsite)$ make html (staticsite)$ make serve On Windows: (staticsite)$ fab build (staticsite)$ fab serve Again, point a web browser to: localhost:8000 The site will look something like: It works! I can see the first post! We can shut down the server by typing ctrl-c Add and commit the changes then push the changes to github When we are done editing the posts and the site, we add all of the changes to our local git repo using git add . Then we commit these changes with git commit and use the -m \"created pelcian static site\" flag to supply a commit message (make sure to use double quotes \"commit message\"). Push those changes up to github with git push origin master $ git add . $ git commit -m \"created pelican static site\" $ git push origin master In the next post , we will customize the site with a pelican-theme called pelican-bootstrap3 .","tags":"This site","url":"how-i-built-this-site-2.html","loc":"how-i-built-this-site-2.html"},{"title":"How I Build This Site - Part 1","text":"This is the first part of a multi-part series on how I built this site. In this first post, we'll review the development environments, Python, virtual environments, installing Python packages and set up git. Set up the development environment What does development environment even mean? Before I started building this site, I needed to make sure the necessary software, packages, and settings were in place. This begins with setting up a development environment. To me, a development environment is merely the software on a computer that allows me to get work done. In this case, the development environment means the tools necessary to build this site. A list of the tools and technologies are below: An operating system: This website was created on machines running Windows 10, MacOS and Linux (Ubuntu 16.04 LTS). Python: Python 3.6 (legacy Python is version 2.7) Anaconda: The Anaconda Prompt and the Anaconda distribution of Python GitHub.com and git: Four different computers were used to build the site. GitHub is the central place where the most up-to-date version of the site is kept. Git is the command-line tool used to update GitHub.com. Pelican: A static site generator written in Python. Pelican builds websites from posts written in markdown (.md files) and a file settings file (pelicanconf.py). Markdown: the posts on this website are written in markdown or .md format fabric and make: fabric is a Python package to automate builds and tasks. Fabric works on Windows. Make is used on MacOS and Linux to build the site and serve up a demo version of the site. Installing Python (the Anaconda distribution) I highly recommend installing the Anaconda distribution of Python, rather than downloading Python from Python.org. I have the Anaconda distribution of Python installed on all the computers I used to build this site: Windows 10 Desktop at work MacOS laptop at work MacOS laptop at home Linux (Ubuntu 16.04 LTS) Desktop at home. An advantage of using the Anaconda distribution of Python (compared to \"regular\" Python) is that each of the four computers will have the same stable version of Python and I can keep the same Python packages installed on each machine using the conda package manager. Download the latest Anaconda distribution of Python release at: https://www.anaconda.com/download The Anaconda distribution of Python comes with an up-to-date and stable version of Python (Python 3.6) and the Anaconda Prompt . The Anaconda Prompt is useful because it allows me to run shell commands on my Windows 10 machine at work. These shell commands are the same commands I run in the terminal on my MacOS or Linux boxes. The Anaconda Prompt makes creating and logging into virtual environments easy and allows me to use git on Windows 10. Follow this post to install the Anaconda on Windows 10. Create a new virtual environment Before downloading Pelican, we should create a new virtual environment. The same virtual environment on each of the computers I use means the same packages are installed on each machine. To create a new virtual environment, open up the Anaconda Prompt (on Windows) or a terminal (on Linux or MacOS). Let's call our new virtual environment staticsite . The conda create command creates the environment, and the -n staticsite flag adds the name. $ conda create -n staticsite The conda create -n staticsite command creates a new virtual environment called staticsite . Because I use four different computers to work on the site, I need to make sure the same Python packages are installed on each computer. Using a virtual environment ensures this consistency. Once the virtual environment staticsite is created, we need to activate it and start using it with the command: $ conda activate staticsite We should now see (staticsite) before the terminal prompt. This means we are using the (staticsite) virtual environment. Install Pelican Time for some fun! Installing Pelican. Pelican is a Python package that creates static websites. Static sites are websites that only have html, css, and javascript. A static site is not connected to a database, and there is no code run on the server side. The server just serves static files (html, css, javascript) to the client when the client requests them. To install Pelican, we need to install pip first. On my Linux and MacOS machines, the command line tool git is already installed. If using Windows 10, git may not be available. To keep the development environments the same when using Windows 10, you may also need conda to install git . The commands to install both pip and git are below. (staticsite)$ conda install pip (staticsite)$ conda install git Once pip is installed, we can install pelican and markdown . These are two of the core packages we need to build the website. fabric3 is also installed because we'll use it to build and demo the site on Windows. bs4 is the beautiful soup package. Some of the pelican plugins installed later will depend on bs4 to function properly. Note the (staticsite) virtual environment is active when the packages are installed. (staticsite)$ pip install pelican (staticsite)$ pip install markdown (staticsite)$ pip install fabric3 (staticsite)$ pip install bs4 (staticsite)$ pip install ghp-import Create a GitHub.com account and create a new repository While I was making the site, it became clear that I had to keep track of version control . I would make some changes to the site on my computer at work, then come home and make more changes to the site. Carrying a USB thumb drive back and forth from work to home was hard. If I forgot the thumb drive at work, (or left it at home) and then could not edit the site. Or worse, I'd modify the site in both places and try to remember which changes were made and which machine and which was the best version. Ah! The solution is to use git and GitHub . Git is a command-line utility that assists with version control. Using git means changes made to files on one computer can be synced with the same files on another computer. GitHub.com is where the site content and settings are remotely stored and integrates easily with git. To sign up for a github.com account go here: https://github.com/join The account activation screen looks something like: Once the GitHub.com account is set up, log in and create a new repository. Use the + button on the upper right-hand menu: I named the new repository: staticsite and included both a README.md and a GNU General Public License v3.0 . I also recommend including a .gitignore file and selecting Python among the language options. Make a directory for the site and link it to GitHub Once the GitHub repo (short for repository , basically a folder with files on github.com) is set up, the last step to complete the development environment is to link the remote repo on GitHub.com to the local version of the site (the version of the site on a laptop or desktop). The local version of the site is in a folder call staticsite in the Documents folder. The staticsite folder will contain all the files used to build the site and the output files created by Pelican that are the site. The staticsite folder can be created using a terminal, or the Anaconda Prompt. (staticsite)$ cd ~ (staticsite)$ cd Documents (staticsite)$ mkdir staticsite (staticsite)$ cd staticsite Now, we can set up git to keep the contents of the local staticsite folder in sync with the remote repo on GitHub.com. The command git init creates the local repository. The command git remote add origin followed by the URL of our GitHub repo links a local folder on our computer to the remote repo on GitHub.com. Note the web address ends in .git . If you are following along and want to build your own static site, make sure to change username to your GitHub username and reponame to your GitHub repo name. (staticsite)$ git init (staticsite)$ git remote add origin https://github.com/username/reponame.git Now for the git magic. On GitHub.com, we have a README.md file and a license. But the local staticsite folder on the computer is empty. So the two folders aren't in sync. To make the contents of each folder identical, we pull the files from GitHub onto the local computer. A pull \"pulls\" or gets the files from GitHub and copies them to the local staticsite folder. (staticsite)$ git pull origin master If we look in the local staticsite folder we now see the following two files: staticsite ├── LICENSE ├── .gitignore ├── README.md The development environment is set! On to building the site! Now each time I work on the site, I navigate to the staticsite folder on whatever computer I am using. Before any editing, I key in the command: $ git pull origin master After the pull , the staticsite folder is up-to-date with the newest version of all the files on GitHub. Then I go about editing files, writing posts, changing settings, etc. After the edits, the last thing I do before shutting down the computer for the day is add all the changes to git with git add . (note there is a space between the add and the period . ). Then I commit those changes locally with the line git commit -m \"commit message\" (note there are double quotes \"commit message\" used around the commit message), and finally push the changes up to github.com with git push origin master . Using this workflow, the version of the site up on GitHub.com is the same as the version of the site on my local computer. git add . git commit -m \"commit message\" git push origin master These commands ensure all my computers and the GitHub.com repo contain the same version of the site. In the next post we will use the pelican-quickstart command to get the blog off the ground, write our first post and view a demo version of the site.","tags":"this site","url":"how-i-built-this-site-1.html","loc":"how-i-built-this-site-1.html"},{"title":"Create a new virtual environment with Conda","text":"To start a new Python project, it is best practice to create a new virtual environment. I have the Anaconda distribution of Python installed on my Windows 10 machine at work. When you install Anaconda , it comes with the very useful Anaconda Prompt . Using the Anaconda Prompt is a bit like using the terminal on a Mac OSX or Linux. To start the Anaconda Prompt on Windows 10, go to the Windows start button on the lower left and select Anaconda Prompt . To create the new environment, we need to issue the following command at the prompt: conda create --name webscrape python=3.6 The conda create command builds the new virtual environment. The --name webscrape flag gives our new virtual environment the name webscrape . I like to name my virtual environments the same name as the project that I will use that environment for, or after the name of the package that will be used the most. Including python=3.6 ensures that your virtual environment has an up to date version of python. Conda will tell us: The following NEW packages will be INSTALLED : certifi : 2016.2.28 - py36_0 pip : 9.0.1 - py36_1 python : 3.6.2 - 0 setuptools : 36.4.0 - py36_0 vs2015_runtime : 14.0.25420 - 0 wheel : 0.29.0 - py36_0 wincertstore : 0.2 - py36_0 Proceed ( [ y ]/ n ) ? y Type y to confirm that you want to create the new virtual environment. To use the new virtual environment webscrape you need to activate it by typing: activate webscrape You know you are in your virtual environment webscrape when (webscrape) is in parenthesis at the start of the prompt: ( webscrape ) tribilium @Den - PC : ~ $ To deactivate an active environment, use: deactivate For power-users using the terminal on Mac or Linux, you must use source activate to enter into the virtual environment. source activate webscrape and source deactivate webscrape If you see the (webscrape) in parenthesis before the command prompt, that means you set up the new virtual environment and are now using it. You can view a list of your virtual environments using the conda info --envs or conda env list command. conda info --envs # conda environments : # matplotlib / home / tribilium / anaconda3 / envs / matplotlib webscrape * / home / tribilium / anaconda3 / envs / pelican root / home / tribilium / anaconda3 Notice the * asterisk on the line with webscrape . The virtual environment with the * is currently active. To exit the virtual environment, use the command deactivate . If you run conda env list again, you'll see there is no * in front of webscrape . That's because you are not currently in that virtual environment. conda env list # conda environments : # matplotlib / home / tribilium / anaconda3 / envs / matplotlib webscrape / home / tribilium / anaconda3 / envs / pelican root * / home / tribilium / anaconda3 We can spin up the virtual environment again with the activate command. Want to use pip and virtualenv / virtuelenv wrapper instead? Great. Those will work too. For windows and computers with locked down active directories, I prefer conda . It just seems to make things easier. For a great post about the differences between conda and pip see this post by Jake VanderPlas.","tags":"Orientation","url":"new-virtual-environment-with-conda.html","loc":"new-virtual-environment-with-conda.html"},{"title":"Installing Anaconda on Windows","text":"In this post, we will run through installing the Anaconda distribution of Python on Windows 10. I think the Anaconda distribution of Python is the the best option for undergraduate engineers who want to use Python. Anaconda is free (although the download is large which can take time) and can be installed on school or work computers where you don't have administrator access or the ability to install new programs. Steps: Visit Anaconda.com/downloads Select Windows Download the .exe installer Open and run the .exe installer Open the Anaconda Prompt and run some Python code 1. Visit the Anaconda downloads page Go to the following link: Anaconda.com/downloads The Anaconda Downloads Page will look something like this: 2. Select the Windows Select Windows where the three operating systems are listed. 3. Download Download the Python 3.7 version. Python 2.7 is legacy Python. For undergraduate engineers, select the Python 3.7 version. If you are unsure about installing the 32-bit version vs the 64-bit version, most Windows installations are 64-bit. You may be prompted to enter your email. You can still download Anaconda if you click [No Thanks] and don't enter your Work Email address. The download is quite large (over 500 MB) so it may take a while for the download to complete. 4. Open and run the installer Once the download completes, open and run the .exe installer At the beginning of the install, you will need to click [Next] to confirm the installation, and agree to the license. At the Advanced Installation Options screen, I recommend: do not check \"Add Anaconda to my PATH environment variable\" Keep \"Register Anaconda as my default Python\" 3.7 checked 5. Open the Anaconda Prompt from the Windows start menu After the Anaconda install is complete, you can go to the Windows start menu and select the Anaconda Prompt. This will open up the Anaconda Prompt. Anaconda is the Python distribution and the Anaconda Prompt is a command line tool (a program where you type in your commands instead of using a mouse). It doesn't look like much, but it is really helpful for an undergraduate engineer using Python. At the Anaconda Prompt, type python . The python command starts the Python interpreter. Note the Python version. You should see something like Python 3.7.0 . With the interperter running, you will see a set of greater-than symbols >>> before the cursor. Now you can type Python commands. Try typing import this . You should see the Zen of Python by Tim Peters To close the Python interpreter, type exit() at the interpreter prompt >>> . Note the double parenthesis at the end of the command. The () is needed to stop the Python interpreter and get back out to the Anaconda Prompt. To close the Anaconda Prompt, you can either close the window with the mouse, or type exit . Congratulations! You installed the Anaconda distribution on your Windows computer! When you want to use the Python interpreter again, just click the Windows Start button and select the Anaconda Prompt and type python .","tags":"Orientation","url":"installing-anaconda-on-windows.html","loc":"installing-anaconda-on-windows.html"}]};