<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>How to Build a Streamlit App in Python - Python for Undergraduate Engineers</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

    /*some stuff for output/input prompts*/
    div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
    div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
    div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
    div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
    @media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
    div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
    div.prompt:empty{padding-top:0;padding-bottom:0}
    div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
    div.inner_cell{width:90%;}
    div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
    div.input_prompt{color:navy;border-top:1px solid transparent;}
    div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
    div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
    div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
    div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
    div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
    div.output_prompt{color:darkred;}
    
    a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
    h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
    /* end stuff for output/input prompts*/
    
    
    .highlight-ipynb .hll { background-color: #ffffcc }
    .highlight-ipynb  { background: #f8f8f8; }
    .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
    .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
    .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight-ipynb .o { color: #666666 } /* Operator */
    .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
    .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
    .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
    .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
    .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
    .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
    .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
    .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
    .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
    .highlight-ipynb .go { color: #888888 } /* Generic.Output */
    .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
    .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
    .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
    .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
    .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
    .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
    .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
    .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
    .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
    .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
    .highlight-ipynb .m { color: #666666 } /* Literal.Number */
    .highlight-ipynb .s { color: #BA2121 } /* Literal.String */
    .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
    .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
    .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
    .highlight-ipynb .no { color: #880000 } /* Name.Constant */
    .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
    .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
    .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
    .highlight-ipynb .nf { color: #0000FF } /* Name.Function */
    .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
    .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
    .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
    .highlight-ipynb .nv { color: #19177C } /* Name.Variable */
    .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
    .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
    .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
    .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
    .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
    .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
    .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
    .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
    .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
    .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
    .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
    .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
    .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
    .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
    .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
    .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
    .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
    .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
    .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
    .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
    .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
    .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    
    <style type="text/css">
    /* Overrides of notebook CSS for static HTML export */
    div.entry-content {
      overflow: visible;
      padding: 8px;
    }
    .input_area {
      padding: 0.2em;
    }
    
    a.heading-anchor {
     white-space: normal;
    }
    
    .rendered_html
    code {
     font-size: .8em;
    }
    
    pre.ipynb {
      color: black;
      background: #f7f7f7;
      border: none;
      box-shadow: none;
      margin-bottom: 0;
      padding: 0;
      margin: 0px;
      font-size: 13px;
    }
    
    /* remove the prompt div from text cells */
    div.text_cell .prompt {
        display: none;
    }
    
    /* remove horizontal padding from text cells, */
    /* so it aligns with outer body text */
    div.text_cell_render {
        padding: 0.5em 0em;
    }
    
    img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}
    
    div.collapseheader {
        width=100%;
        padding: 2px;
        cursor: pointer;
        font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
    }
    
    </style>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
    <script type="text/javascript">
    init_mathjax = function() {
        if (window.MathJax) {
            // MathJax loaded
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                },
                displayAlign: 'center', // Change this to 'center' to center equations.
                "HTML-CSS": {
                    styles: {'.MathJax_Display': {"margin": 0}}
                }
            });
            MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    
    <link href="./extra/favicon.ico" rel="icon">

<link rel="canonical" href="./streamlit-app-with-bokeh.html">

        <meta name="author" content="Peter D. Kazarinoff" />
        <meta name="keywords" content="streamlit,bokeh,engineering" />
        <meta name="description" content="Streamlit is a web app-building framework for Python. Streamlit is a way to create mostly simple single-page web apps that are easy to deploy. Streamlit is useful for engineers and data scientists who have some app functionality, like a plot that dynamically changes based on user interaction, but don&#39;t want …" />

        <meta property="og:site_name" content="Python for Undergraduate Engineers" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="How to Build a Streamlit App in Python"/>
        <meta property="og:url" content="./streamlit-app-with-bokeh.html"/>
        <meta property="og:description" content="Streamlit is a web app-building framework for Python. Streamlit is a way to create mostly simple single-page web apps that are easy to deploy. Streamlit is useful for engineers and data scientists who have some app functionality, like a plot that dynamically changes based on user interaction, but don&#39;t want …"/>
        <meta property="article:published_time" content="2019-12-16" />
            <meta property="article:section" content="Python" />
            <meta property="article:tag" content="streamlit" />
            <meta property="article:tag" content="bokeh" />
            <meta property="article:tag" content="engineering" />
            <meta property="article:author" content="Peter D. Kazarinoff" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/native.css" rel="stylesheet">
    <link href="./theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>
        <link href="./static/css/custom.css" rel="stylesheet">



</head>
<body>

<!-- .navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
Python for Undergraduate Engineers            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                         <li><a href="./pages/book.html">
                             Book
                          </a></li>
                         <li><a href="./pages/gear.html">
                             Gear
                          </a></li>
                         <li><a href="./pages/now.html">
                             Now
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">

<!-- .navbar-search -->
<li>
    <span>
        <form class="navbar-search" action="/search.html">
            <input type="text" name="q" id="tipue_search_input">
        </form>
    </span>
</li>
<!-- /.navbar-search -->              <li><a href="./archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="." title="Python for Undergraduate Engineers"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="./category/python.html" title="Python">Python</a></li>
                <li class="active">How to Build a Streamlit App in Python</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./streamlit-app-with-bokeh.html"
                       rel="bookmark"
                       title="Permalink to How to Build a Streamlit App in Python">
                        How to Build a Streamlit App in Python
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2019-12-16T08:11:00-08:00"> Mon 16 December 2019</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="./tag/streamlit.html">streamlit</a>
        /
	<a href="./tag/bokeh.html">bokeh</a>
        /
	<a href="./tag/engineering.html">engineering</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><img alt="streamlit bokeh heroku" src="./posts/streamlit/images/bokeh_streamlit_heroku.png"></p>
<p><a href="https://streamlit.io/docs/"><strong>Streamlit</strong></a> is a web app-building framework for Python. Streamlit is a way to create mostly simple single-page web apps that are easy to deploy. Streamlit is useful for engineers and data scientists who have some app functionality, like a plot that dynamically changes based on user interaction, but don't want to build out a full website using a web framework like Django or Flask. </p>
<p>In this post, we will create a Streamlit app that displays a Bokeh plot and deploy it online with Heroku.</p>
<div class="toc"><span class="toctitle">Table of contents:</span><ul>
<li><a href="#installing-streamlit">Installing Streamlit</a></li>
<li><a href="#running-streamlit-for-the-first-time">Running Streamlit for the First Time</a></li>
<li><a href="#create-a-simple-streamlit-app">Create a Simple Streamlit App</a></li>
<li><a href="#create-a-mohrs-circle-streamlit-app">Create a Mohr's Circle Streamlit App</a><ul>
<li><a href="#bokeh">Bokeh</a></li>
<li><a href="#create-the-app">Create the App</a></li>
<li><a href="#install-bokeh-and-numpy">Install Bokeh and NumPy</a></li>
<li><a href="#run-the-streamlit-app">Run the Streamlit App</a></li>
<li><a href="#save-code-on-githubcom">Save code on GitHub.com</a></li>
</ul>
</li>
<li><a href="#deploy-on-heroku">Deploy on Heroku</a><ul>
<li><a href="#sign-up-for-a-heroku-account">Sign up for a Heroku account</a></li>
<li><a href="#use-windows-subsystem-for-linux-wsl-to-install-the-heroku-cli">Use Windows Subsystem for Linux (WSL) to install the Heroku CLI</a></li>
<li><a href="#pull-down-the-code-from-github">Pull down the code from GitHub</a></li>
<li><a href="#create-a-virtual-environment-install-packages-and-save-a-requirementstxt-file">Create a virtual environment, install packages and save a requirements.txt file</a></li>
<li><a href="#test-and-make-sure-the-streamlit-app-runs">Test and make sure the streamlit app runs</a></li>
<li><a href="#create-a-procfile-and-a-setupsh-file">Create a Procfile and a setup.sh file</a></li>
<li><a href="#push-the-project-up-to-heroku">Push the project up to Heroku</a></li>
<li><a href="#view-the-streamlit-app-live-on-the-web">View the Streamlit App live on the web</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
</ul>
</div>
<p>A link to the Streamlit docs is below:</p>
<blockquote>
<p><a href="https://streamlit.io/docs/">https://streamlit.io/docs/</a></p>
</blockquote>
<p>Streamlit builds web-apps from a single Python file. Only a couple additional lines of code are needed to turn a Python <code>.py</code> file into a web-app using Streamlit.</p>
<h2 id="installing-streamlit">Installing Streamlit</h2>
<p>Streamlit can be installed with <strong>pip</strong>, the Python package manager. It's a good idea to install Streamlit into a virtual environment, rather than installing Streamlit into the base or built-in version of Python installed on your machine. I use the <strong>Anaconda Prompt</strong> to create virtual environments. The commands below are designed to run on the <strong>Anaconda Prompt</strong> and will create a virtual environment called <code>(streamlit)</code> and install the Streamlit package into that environment. Note that at the time of writing, Streamlit can not be installed with <strong>conda</strong>, it must be installed with <strong>pip</strong>. </p>
<div class="highlight"><pre><span></span>conda create -y -n streamlit python=3.7
conda activate streamlit
pip install streamlit
</pre></div>


<p>You can confirm your installation by opening up the Python REPL and typing the commands below (note the <code>&gt;&gt;&gt;</code> prompt is shown to indicate the Python REPL, not characters for the user to enter).</p>
<div class="highlight"><pre><span></span>python
&gt;&gt;&gt; import streamlit
&gt;&gt;&gt; streamlit.__version__
</pre></div>


<h2 id="running-streamlit-for-the-first-time">Running Streamlit for the First Time</h2>
<p>You can run a demo app that comes with the Streamlit package by running the following command into a terminal. Note the <code>(streamlit)</code> virtual environment (with Streamlit installed into it) must be active for the command to work.</p>
<div class="highlight"><pre><span></span>streamlit hello
</pre></div>


<p>This command starts a demo Streamlit app. Open a web browser and enter the URL shown in your terminal. The running app will look something like the screenshot below.</p>
<p><img alt="streamlit hello app" src="./posts/streamlit/images/streamlit_hello_app.png"></p>
<p>If you select the <strong>Plotting Demo</strong> from the menu on the left-hand side, you'll see an animated line graph of random numbers.</p>
<p><img alt="streamlit plotting demo" src="./posts/streamlit/images/streamlit_plotting_demo.png"></p>
<p>Type <code>[Ctrl]+[c]</code> into the terminal stop the Streamlit server.</p>
<p>Now that we have a feel for some of the things Streamlit can do, let's build a simple Steamlit App.</p>
<h2 id="create-a-simple-streamlit-app">Create a Simple Streamlit App</h2>
<p><img alt="streamlit logo" src="./posts/streamlit/images/streamlit_logo.png"></p>
<p>Next, let's build our own simple Streamlit app. Our app will ask a user for a number and a name. The app will add 1 to the number and tell the user "Hello" based on their name.</p>
<p>The following code was entered into a file called <code>simple_streamlit_app.py</code></p>
<div class="highlight"><pre><span></span># simple_streamlit_app.py
&quot;&quot;&quot;
A simple streamlit app
run the app by installing streamlit with pip and typing
&gt; streamlit run simple_streamlit_app.py
&quot;&quot;&quot;

import streamlit as st

st.title(&#39;Simple Streamlit App&#39;)

st.text(&#39;Type a number in the box below&#39;)

n = st.number_input(&#39;Number&#39;, step=1)

st.write(f&#39;{n} + 1 = {n+1}&#39;)

s = st.text_input(&#39;Type a name in the box below&#39;)

st.write(f&#39;Hello {s}&#39;)
</pre></div>


<p>After the file is saved, <code>simple_streamlit_app.py</code> can be run as a Streamlit app from the command line (again, make sure you are in the virtual environment where Streamlit is installed):</p>
<div class="highlight"><pre><span></span>streamlit run simple_streamlit_app.py
</pre></div>


<p><img alt="Anaconda Prompt run_simple_streamlit_app.py" src="./posts/streamlit/images/anaconda_prompt_run_simple_streamlit_app.png"></p>
<p>Browse to the URL shown in the terminal. The resulting Streamlit app looks something like the screenshot below.</p>
<p><img alt="streamlit logo" src="./posts/streamlit/images/simple_streamlit_app.png"></p>
<p>Type a couple numbers and try out a couple names. Pretty simple right? To shut down the app, type <code>[Ctrl]+[c]</code> into the terminal.</p>
<p>Now that we have created a simple Streamlit app, let's build upon the experience and create a useful app. Our app will build a <em>Mohr's Circle</em> based on user input.</p>
<h2 id="create-a-mohrs-circle-streamlit-app">Create a Mohr's Circle Streamlit App</h2>
<p>Next, we are going to create a Streamlit App that builds a <em>Mohr's Circle</em> based on user input. A Mohr's Circle is a type of diagram used in Mechanical Engineering to show the internal stresses acting on a region, called a stress element, of a part. When that stress element is rotated relative to the part's direction, the stresses change. A Mohr's circle shows the resulting normal and shear stresses based on the angle the stress element is rotated. </p>
<h3 id="bokeh">Bokeh</h3>
<p><img alt="bokeh logo" src="./posts/streamlit/images/bokeh_logo.png"></p>
<p>We will build Mohr's Circle using a plotting library called <a href="https://docs.bokeh.org/en/latest/">Bokeh</a>. Bokeh is similar to other Python plotting packages like Matplotlib. The difference is that Bokeh is designed to show plots in browsers and on webpages. This functionality is perfect for our Streamlit app that runs in a web browser.</p>
<h3 id="create-the-app">Create the App</h3>
<p>Let's create two <code>.py</code> files to build our app. The first file, <code>user_funcs.py</code> contains a couple functions needed to calculate the parameters of Mohr's Circle. The Python code below contains the functions we need.</p>
<div class="highlight"><pre><span></span># user_funcs.py
&quot;&quot;&quot;
user-defined functions for the Streamlit mohr&#39;s circle app
&quot;&quot;&quot;

import numpy as np


def mohr_c(stress_x, stress_y, shear):
    &quot;&quot;&quot;
    input arguments:
        stress_x: int or float
        stress_y: int or float
        shear: int or float

    mohr_c() outputs two values for the circle, center, and radius

    output:
        C, R
        C is x-value of the circle center
        R is the radius of the circle
    &quot;&quot;&quot;
    C = (stress_x + stress_y) / 2
    R = ((((stress_x - stress_y) / 2) ** 2) + shear ** 2) ** 0.5
    return C, R


def c_array(C, R, n=100):
    &quot;&quot;&quot;
    input arguments:
        C: int or float, the x-value of a circle center
        R: int or float, the radius of the circle
        n: int, number of points (optional)

    c_array() outputs two NumPy arrays of x and y values that creates the circle

    output:
        x, y
        x is a NumPy array with n-values that contains the x-values to build the circle
        y is a NumPy array with n-values that contains the y-value to build the circle
    &quot;&quot;&quot;
    t = np.linspace(0, 2 * np.pi, n + 1)
    x = R * np.cos(t) + C
    y = R * np.sin(t)
    return x, y


def X_Y(stress_x, stress_y, shear):
    &quot;&quot;&quot;build the arrays that describe the line X-Y between the known points&quot;&quot;&quot;
    X = np.array([stress_x, stress_y])
    Y = np.array([-shear, shear])
    return X, Y
</pre></div>


<p>The second Python file, called <code>streamlit_app_bokeh.py</code> contains the code to build the plot using Bokeh and build the app using Streamlit. Note the last line of code is <code>st.bokeh_chart(p)</code>. This line is the "magic sauce" that turns our Bokeh plot into a Streamlit app. The line is a substitute for the command to show a plot in a regular Bokeh application.</p>
<div class="highlight"><pre><span></span># streamlit_app_bokeh.py
&quot;&quot;&quot;
A streamlit app to draw a Mohr&#39;s Circle based on user input
using the Bokeh plotting library
&quot;&quot;&quot;

import numpy as np
import streamlit as st
from bokeh.plotting import figure
from user_funcs import mohr_c, c_array, X_Y

st.title(&quot;Mohr&#39;s Circle App&quot;)

stress_x = st.sidebar.number_input(&quot;stress in x&quot;, value=2.0, step=0.1)
stress_y = st.sidebar.number_input(&quot;stress in y&quot;, value=5.0, step=0.1)
shear = st.sidebar.number_input(&quot;shear xy&quot;, value=4.0, step=0.1)

# find center and radius
C, R = mohr_c(stress_x, stress_y, shear)

# build arrays plot circle
circle_x, circle_y = c_array(C, R)

# build arrays to plot line through the circle
X, Y = X_Y(stress_x, stress_y, shear)

st.sidebar.markdown(f&quot;max stress = {round(C+R,2)}&quot;)
st.sidebar.markdown(f&quot;min stress = {round(C-R,2)}&quot;)
st.sidebar.markdown(f&quot;max shear = {round(R,2)}&quot;)

p = figure(
    title=&quot;Mohr&#39;s Circle&quot;,
    x_axis_label=&quot;stress&quot;,
    y_axis_label=&quot;shear&quot;,
    match_aspect=True,
    tools=&quot;pan,reset,save,wheel_zoom&quot;,
)

p.line(circle_x, circle_y, color=&quot;#1f77b4&quot;, line_width=3, line_alpha=0.6)
p.line(X, Y, color=&quot;#ff7f0e&quot;, line_width=3, line_alpha=0.6)

p.xaxis.fixed_location = 0
p.yaxis.fixed_location = 0

st.bokeh_chart(p)
</pre></div>


<h3 id="install-bokeh-and-numpy">Install Bokeh and NumPy</h3>
<p>Before we can run our Mohr's Circle Streamlit app, we need to install the packages we imported in the two <code>.py</code> files. The packages we need are Bokeh and NumPy. Both of these packages can be installed with <strong>conda</strong> or <strong>pip</strong> on the command line. Make sure you are in the <code>(streamlit)</code> virtual environment when you run the install command.</p>
<div class="highlight"><pre><span></span>conda install -y bokeh numpy
</pre></div>


<h3 id="run-the-streamlit-app">Run the Streamlit App</h3>
<p>Now we can run our Mohr's Circle App locally by typing the command below into the terminal.</p>
<div class="highlight"><pre><span></span>streamlit run streamlit_app_bokeh.py
</pre></div>


<p><img alt="Anaconda Prompt run_mohrs_circle_app.py" src="./posts/streamlit/images/anaconda_prompt_run_mohrs_circle_app.png"></p>
<p>The resulting app will look something like the screenshot below:</p>
<p><img alt="Anaconda Prompt run_mohrs_circle_app.py" src="./posts/streamlit/images/mohrs_circle_app.png"></p>
<p>Try typing in different numbers for stress in x, stress in y and shear xy. See how the plot changes when different numbers are entered. The app looks great!</p>
<p>Now that the app is running, let's save all the files on GitHub. We'll need the files saved on GitHub for the next couple steps.</p>
<h3 id="save-code-on-githubcom">Save code on GitHub.com</h3>
<p>After I was sure the Streamlit app worked, I saved the code into a git repo and pushed the code up to Github.com. This isn't absolutly necessary, but as you can see below, I needed to use Windows Subsystem for Linux to deploy the Streamlit app. A simple way to bring the code into WSL is to pull the code down from a GitHub repo. </p>
<p>Create a repo on Github, and then use the commands below to commit the code locally and push the code up to GitHub.com. Make sure to change <code>&lt;UserName&gt;</code> to your GitHub username and change <code>&lt;commit message&gt;</code> to your specific commit message.</p>
<div class="highlight"><pre><span></span>git init
git remote add origin https://github.com/&lt;UserName&gt;/mohrs_circle.git
git add .
git commit -m &quot;&lt;commit message&gt;&quot;
git push origin master
</pre></div>


<p>Our Mohr's Circle Streamlit app runs locally, but if we want to share the app with friends, we need to deploy it over the internet. One way to deploy a Streamlit app is with a web service called Heroku.</p>
<h2 id="deploy-on-heroku">Deploy on Heroku</h2>
<p><img alt="Heroku Logo" src="./posts/streamlit/images/heroku_logo.png"></p>
<p><a href="https://heroku.com">Heroku</a> is a cloud platform for deploying apps on the internet. We can deploy our Steamlit app on Heroku with a couple steps.</p>
<h3 id="sign-up-for-a-heroku-account">Sign up for a Heroku account</h3>
<p>First, sign up for a Heroku account. See the link below.</p>
<blockquote>
<p><a href="https://signup.heroku.com/">https://signup.heroku.com/</a></p>
</blockquote>
<p><img alt="Heroku Signup" src="./posts/streamlit/images/heroku_signup.png"></p>
<p>One of the easiest ways to deploy a web-app to Heroku is to use the Heroku CLI (Command Line Interface).</p>
<h3 id="use-windows-subsystem-for-linux-wsl-to-install-the-heroku-cli">Use Windows Subsystem for Linux (WSL) to install the Heroku CLI</h3>
<p>If you are using a Mac or Linux, the Heroku CLI is easy to install using a terminal. However, I had trouble installing and using the Heroku CLI in Windows 10. My work around was installing and using the Heroku CLI in Windows Subsystem for Linux.</p>
<p><img alt="WSL in windows store" src="./posts/streamlit/images/WSL_in_windows_store.PNG"></p>
<p>If you are using Windows 10, install Windows Subsystem for Linux (WSL) from the Windows Store. I installed the Ubuntu distribution.</p>
<p>Using the start menu, and open the WSL prompt. Type the commands below to update the system and install the Heroku CLI.</p>
<div class="highlight"><pre><span></span>sudo apt-get -y update &amp;&amp; sudo apt-get -y upgrade
curl https://cli-assets.heroku.com/install.sh | sh
source .bashrc
</pre></div>


<p>These commands install the Heroku CLI. You can test the installation with the command below.</p>
<div class="highlight"><pre><span></span>heroku --version
</pre></div>


<p>If the Heroku CLI is installed, output should look similar to the screen capture below.</p>
<p><img alt="WSL in windows store" src="./posts/streamlit/images/heroku_version_output.PNG"></p>
<h3 id="pull-down-the-code-from-github">Pull down the code from GitHub</h3>
<p>Since we saved our code on GitHub.com, we can use git to pull the code down into the WSL environment. Remember to replace <code>&lt;UserName&gt;</code> with your GitHub username.</p>
<div class="highlight"><pre><span></span>clone https://github.com/&lt;UserName&gt;/mohrs_circle.git
cd mohrs_circle
</pre></div>


<p>Now that we have the code for our app, we need to create the same virtual environment in WSL as we had before when we got our app to run locally.</p>
<h3 id="create-a-virtual-environment-install-packages-and-save-a-requirementstxt-file">Create a virtual environment, install packages and save a requirements.txt file</h3>
<p>Next, within Windows Subsystem for Linux, create a new virtual environment and install Streamlit, Bokeh and NumPy into it. I have Anaconda installed in my WSL environment, so I used conda to install the Python packages. Alternatively, you could use Python's venv module and pip instead. After the packages are installed, you can use pip to write a <code>requirements.txt</code> file. Heroku needs the requirements.txt file in order for the Streamlit app to work.</p>
<div class="highlight"><pre><span></span>conda create -n mohrs_circle python=3.7
conda activate mohrs_circle
python -m pip install streamlit bokeh numpy
pip freeze &gt; requirements.txt
</pre></div>


<p>Now we should be able to run the streamlit app from the WSL prompt.</p>
<h3 id="test-and-make-sure-the-streamlit-app-runs">Test and make sure the streamlit app runs</h3>
<p>Next, within WSL, let's test and see that the Streamlit app still works. Ensure you are in the virtual environment created above when the command is run.</p>
<div class="highlight"><pre><span></span>streamlit run streamlit_app_bokeh.py
</pre></div>


<p>You can browse to the URL listed and test the app by typing in a couple different stresses and see how the plot changes.</p>
<h3 id="create-a-procfile-and-a-setupsh-file">Create a Procfile and a setup.sh file</h3>
<p>Before we can deploy the app on Heroku, a couple more files are required:</p>
<ul>
<li>Procfile</li>
<li>setup.sh</li>
</ul>
<p>In the Procfile (the file name is <code>Procfile</code> with a capital <code>P</code> and no file extension) add the text:</p>
<div class="highlight"><pre><span></span>web: sh setup.sh &amp;&amp; streamlit run streamlit_app_bokeh.py
</pre></div>


<p>In <code>setup.sh</code> add the text:</p>
<div class="highlight"><pre><span></span>mkdir -p ~/.streamlit/

echo &quot;\
[general]\n\
email = \&quot;your-email@domain.com\&quot;\n\
&quot; &gt; ~/.streamlit/credentials.toml

echo &quot;\
[server]\n\
headless = true\n\
enableCORS=false\n\
port = $PORT\n\
&quot; &gt; ~/.streamlit/config.toml
</pre></div>


<p>Now the main project directory should have the following files present. The <code>LICENSE</code> and <code>README.md</code> files are optional, but I include these two files in my GitHub repos as a general practice.</p>
<div class="highlight"><pre><span></span>mohrs_circle/
├── LICENSE
├── Procfile
├── README.md
├── requirements.txt
├── setup.sh
├── streamlit_app.py
├── streamlit_app_bokeh.py
└── user_funcs.py
</pre></div>


<p>Commit all the files and push to GitHub.</p>
<div class="highlight"><pre><span></span>git add .
git commit -m &quot;add Procfile, setup.sh, requirements.txt&quot;
git push origin master
</pre></div>


<p>Now we are finally ready to deploy on Heroku.</p>
<h3 id="push-the-project-up-to-heroku">Push the project up to Heroku</h3>
<p>Log into Heroku with the Heroku CLI, create the Heroku project and git push to Heroku:</p>
<div class="highlight"><pre><span></span>heroku login
heroku create
git push heroku master

# see if it&#39;s running
heroku ps:scale web=1
</pre></div>


<p>That's it! The Streamlit app should now be running on Heroku.</p>
<h3 id="view-the-streamlit-app-live-on-the-web">View the Streamlit App live on the web</h3>
<p>Check the URL provided by the Heroku CLI. The app works the same as when we ran it locally, but now it's live on the internet. Anyone with the URL provided by the Heroku CLI can view our Streamlit app.</p>
<p><img alt="app on Heroku" src="./posts/streamlit/images/mohrs_circle_app_on_heroku.png"></p>
<p>The Streamlit app opens on a phone too. </p>
<p><img alt="app on Phone" src="./posts/streamlit/images/app_on_phone.png"></p>
<h2 id="summary">Summary</h2>
<p>In this post, we created a web app with Streamlit and Bokeh. We ran the Streamlit app locally and then deployed it on the internet using Heroku. Streamlit makes it pretty easy to turn a Python script into a functional web app deployed on the internet.</p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="./stress-strain-curve-with-4-libraries.html">Plotting a stress-strain curve with four libraries: matplotlib, pandas, altair and bokeh</a></li>
        <li><a href="./calculating-vacancy-concentration-with-python.html">Calculating Vacancy Concentration with Python</a></li>
        <li><a href="./offset-piston-motion-animation-matplotlib.html">Offset Piston Motion with Python and Matplotlib</a></li>
        <li><a href="./how-to-make-y-y-plots-with-matplotlib.html">How to make y-y plots with Matplotlib</a></li>
        <li><a href="./writing-tests-for-scientific-code.html">Writing Tests for Scientific Code</a></li>
    </ul>
</section>
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
    </div>
    <!-- AddThis Button END -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Ethical Ads -->
<div class="horizontal" data-ea-publisher="pythonforundergradengineers-com" data-ea-type="image"></div>
<!-- end Ethical Ads --><div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="./extra/gear-wrench-icon-512-278694.png"/>
        </p>
    <p>
      <strong>About Peter Kazarinoff</strong><br/>
        I teach engineering at a community college in the Pacific Northwest. I am interested in programming and how to help students. Here I mostly blog about Python, and how programing can be incorporated into engineering education.
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="./calculating-vacancy-concentration-with-python.html">Calculating Vacancy Concentration with Python</a></li>
    <li class="list-group-item"><a href="./offset-piston-motion-animation-matplotlib.html">Offset Piston Motion with Python and Matplotlib</a></li>
    <li class="list-group-item"><a href="./my-linux-pc-build.html">My Linux PC Build</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="./"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-2">
      <a href="./tag/engineering.html">engineering</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/flask.html">flask</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/jupyter.html">jupyter</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/jupyter-notebook.html">jupyter notebook</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/matplotlib.html">matplotlib</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/microcontroller.html">microcontroller</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/micropython.html">micropython</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/pelican.html">pelican</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="./tag/python.html">python</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/sensor.html">sensor</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
  <a href="https://github.com/professorkazarinoff">@professorkazarinoff</a> on GitHub
</li>
<!-- End Sidebar/Github -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2021 Peter Kazarinoff
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>

    <script src="./static/js/custom.js"></script>


<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = './theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'professorkazarinoff',
    count: 5,
    skip_forks: true,
    target: '#gh_repos'
  });
});
</script>
<script src="./theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-116330557-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
        });
    });
});
});
</script>
<!-- Ethical Ads JS-->
<script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
<!-- end Ethical Ads JS -->
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cdd8eb4e16bf94c"></script>
</body>
</html>