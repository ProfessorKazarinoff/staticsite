<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Piston Motion with Python and matplotlib - Python for Undergraduate Engineers</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

/*some stuff for output/input prompts*/
div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
@media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
div.prompt:empty{padding-top:0;padding-bottom:0}
div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
div.inner_cell{width:90%;}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
div.output_prompt{color:darkred;}

a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
/* end stuff for output/input prompts*/


.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}

div.collapseheader {
    width=100%;
    padding: 2px;
    cursor: pointer;
    font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
    <link href="/extra/favicon.ico" rel="icon">

<link rel="canonical" href="/drafts/piston-motion.html">

        <meta name="author" content="Peter D. Kazarinoff" />
        <meta name="keywords" content="python,matplotlib,animation" />
        <meta name="description" content="An animation of piston motion created with Python and matplotlib" />

        <meta property="og:site_name" content="Python for Undergraduate Engineers" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Piston Motion with Python and matplotlib"/>
        <meta property="og:url" content="/drafts/piston-motion.html"/>
        <meta property="og:description" content="An animation of piston motion created with Python and matplotlib"/>
        <meta property="article:published_time" content="2017-09-15" />
            <meta property="article:section" content="Python" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="matplotlib" />
            <meta property="article:tag" content="animation" />
            <meta property="article:author" content="Peter D. Kazarinoff" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link href="/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
        <link href="/static/css/custom.css" rel="stylesheet">



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
Python for Undergraduate Engineers            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="/pages/about.html">
                             About
                          </a></li>
                         <li><a href="/pages/book.html">
                             Book
                          </a></li>
                         <li><a href="/pages/now.html">
                             Now
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="" title="Python for Undergraduate Engineers"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="/category/python.html" title="Python">Python</a></li>
                <li class="active">Piston Motion with Python and matplotlib</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/drafts/piston-motion.html"
                       rel="bookmark"
                       title="Permalink to Piston Motion with Python and matplotlib">
                        Piston Motion with Python and matplotlib
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-09-15T20:40:00-07:00"> Fri 15 September 2017</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="/tag/python.html">python</a>
        /
	<a href="/tag/matplotlib.html">matplotlib</a>
        /
	<a href="/tag/animation.html">animation</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Piston motion is one of the classic dynamic types of motion that belong to a category of 4-bar motion. Piston motion is the type of motion that the piston in a cylinder of a car engine goes through as the crankshaft rotates. </p>
<h2 id="set-up-a-python-virtual-environment">Set up a python virtual environment</h2>
<p>To start this process, we will set up a virtual environment in Python.</p>
<p>Real Python has a good <a href="https://realpython.com/blog/python/python-virtual-environments-a-primer/">introduction to virtual environments</a> and why to use them.</p>
<p>I recommend undergraduate engineers use the Anaconda distribution of Python which comes with the <strong>Anaconda Prompt</strong>. A new virtual environment can be set up by opening the <strong>Anaconda Prompt</strong> and typing:</p>
<p>Using the Anaconda Prompt:</p>
<div class="highlight"><pre><span></span>&gt; mkdir piston_motion
&gt; cd piston_motion
&gt; conda create -n piston_motion python=3.7
</pre></div>


<p>Alternatively, a virtual environment can be set up with a terminal prompt and <strong>pip</strong></p>
<p>Using a terminal:</p>
<div class="highlight"><pre><span></span>$ mkdir piston_motion
$ cd piston_motion
$ mkvirtualenv piston_motion -p python3
</pre></div>


<p>Now that we have a new clean virtual environment with Python 3 installed, we need to install the necessary packages:</p>
<p>Using the Anaconda Prompt, activate the <code>piston_motion</code> virtual environment and use conda to install the Python Packages:</p>
<div class="highlight"><pre><span></span>&gt; conda activate piston_motion
(piston_motion) &gt; conda install numpy
(piston_motion) &gt; conda install matplotlib
</pre></div>


<p>Alternatively, the packages can be installed with <strong>pip</strong>:</p>
<div class="highlight"><pre><span></span>$ workon piston_motion
(piston_motion) $ pip install numpy
(piston_motion) $ pip install matplotlib
(piston_motion) $ pip freeze
cycler==0.10.0
matplotlib==2.0.2
numpy==1.13.1
pyparsing==2.2.0
python-dateutil==2.6.1
pytz==2017.2
six==1.10.0
</pre></div>


<p>Next, open a text editor or IDLE and start a new python file called <code>piston_motion.py</code>
We will start our script by importing the necessary modules</p>
<div class="highlight"><pre><span></span><span class="c1"># import necessary packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="kn">as</span> <span class="nn">animation</span>
</pre></div>


<p>To model piston motion we need to have two moving parts. One is the crankshaft. The crankshaft rotates around a central axis with a constant radius. We will model this with a line of constant length, one end fixed at the origin and the other rotating in a circle like the hand on a clock. To model this line, we just need two points, the origin at x=0 and y=0  and the end of the line at the point <code>x1</code> and <code>x2</code>. We also need to have a crank radius and a connecting rode length. We will define these constants at the top of our code. So that the animation does not run around indefininelty we will set a fixed number of rotations.  The rotation increment defines how fine the 'ticks' are as our crankshaft arm rotates. 0.1 will work to make the animation smooth enough.</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="k">input</span> <span class="k">parameters</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>  <span class="o">#</span> <span class="n">crank</span> <span class="n">radius</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">4</span><span class="p">.</span><span class="mi">0</span>  <span class="o">#</span> <span class="n">connecting</span> <span class="n">rod</span> <span class="k">length</span>
<span class="n">rot_num</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">#</span> <span class="nb">number</span> <span class="k">of</span> <span class="n">crank</span> <span class="n">rotations</span>
<span class="k">increment</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="o">#</span> <span class="n">angle</span> <span class="k">increment</span>
</pre></div>


<p>Next we'll create an array of angles starting from zero radians up to the number of rotations (times 2 pi radians), stepping by our increment amount. Numpy's <code>np.arange()</code> function accepts the arguments <code>(start,stop,step)</code>. Python starts counting at zero and ends counting at n-1. Numpy follows this counting convention, so if we want the final value in angle array to be <code>rot_num*2*pi</code> we need to add the increment amount to it and set the stop argument as <code>rot_num*2*pi+increment</code>.</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="k">create</span> <span class="n">the</span> <span class="n">angle</span> <span class="nb">array</span><span class="p">,</span> <span class="k">where</span> <span class="n">the</span> <span class="k">last</span> <span class="n">angle</span> <span class="k">is</span> <span class="n">the</span> <span class="nb">number</span> <span class="k">of</span> <span class="n">rotations</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rot_num</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">+</span><span class="k">increment</span><span class="p">,</span><span class="k">increment</span><span class="p">)</span>
</pre></div>


<p>Once we have all the rotation angles in an array, we can set up empty arrays for the points in our animation. These point arrays need to have the same number of entries as the angle array:</p>
<div class="highlight"><pre><span></span><span class="n">X1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">#</span> <span class="nb">array</span> <span class="k">of</span> <span class="n">crank</span> <span class="n">x</span><span class="o">-</span><span class="n">positions</span><span class="p">:</span> <span class="n">Point</span> <span class="mi">1</span>
<span class="n">Y1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">#</span> <span class="nb">array</span> <span class="k">of</span> <span class="n">crank</span> <span class="n">y</span><span class="o">-</span><span class="n">positions</span><span class="p">:</span> <span class="n">Point</span> <span class="mi">1</span>
<span class="n">X2</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">#</span> <span class="nb">array</span> <span class="k">of</span> <span class="n">rod</span> <span class="n">x</span><span class="o">-</span><span class="n">positions</span><span class="p">:</span> <span class="n">Point</span> <span class="mi">2</span>
<span class="n">Y2</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">#</span> <span class="nb">array</span> <span class="k">of</span> <span class="n">rod</span> <span class="n">y</span><span class="o">-</span><span class="n">positions</span><span class="p">:</span> <span class="n">Point</span> <span class="mi">2</span>
</pre></div>


<p>Now we will populate the point arrays with values according to the geometry of piston motion:</p>
<div class="highlight"><pre><span></span># <span class="nv">find</span> <span class="nv">the</span> <span class="nv">crank</span> <span class="nv">and</span> <span class="nv">connecting</span> <span class="nv">rod</span> <span class="nv">positions</span> <span class="k">for</span> <span class="nv">each</span> <span class="nv">angle</span>
<span class="k">for</span> <span class="nv">index</span>, <span class="nv">theta</span> <span class="nv">in</span> <span class="nv">enumerate</span><span class="ss">(</span><span class="nv">angles</span><span class="ss">)</span>:

        <span class="nv">x1</span> <span class="o">=</span> <span class="nv">r</span><span class="o">*</span><span class="nv">cos</span><span class="ss">(</span><span class="nv">theta</span><span class="ss">)</span> # <span class="nv">x</span><span class="o">-</span><span class="nv">coordinate</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">crank</span>: <span class="nv">Point</span> <span class="mi">1</span>
        <span class="nv">y1</span> <span class="o">=</span> <span class="nv">r</span><span class="o">*</span><span class="nv">sin</span><span class="ss">(</span><span class="nv">theta</span><span class="ss">)</span> # <span class="nv">y</span><span class="o">-</span><span class="nv">coordinate</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">crank</span>: <span class="nv">Point</span> <span class="mi">1</span>
        <span class="nv">x2</span> <span class="o">=</span> <span class="mi">0</span> # <span class="nv">x</span><span class="o">-</span><span class="nv">coordinate</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">rod</span>: <span class="nv">Point</span> <span class="mi">2</span>
        # <span class="nv">y</span><span class="o">-</span><span class="nv">coordinate</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">rod</span>: <span class="nv">Point</span> <span class="mi">2</span>
        <span class="nv">y2</span> <span class="o">=</span> <span class="ss">((</span><span class="nv">r</span><span class="o">*</span><span class="nv">cos</span><span class="ss">(</span><span class="nv">theta</span><span class="o">-</span><span class="nv">pi</span><span class="o">/</span><span class="mi">2</span><span class="ss">))</span> <span class="o">+</span> <span class="ss">(</span><span class="nv">sqrt</span><span class="ss">((</span><span class="nv">l</span><span class="o">**</span><span class="mi">2</span><span class="ss">)</span><span class="o">-</span><span class="ss">(</span><span class="nv">r</span><span class="o">**</span><span class="mi">2</span><span class="ss">)</span><span class="o">*</span><span class="ss">((</span><span class="nv">sin</span><span class="ss">(</span><span class="nv">theta</span><span class="o">-</span><span class="nv">pi</span><span class="o">/</span><span class="mi">2</span><span class="ss">))</span><span class="o">**</span><span class="mi">2</span><span class="ss">))))</span>

        <span class="nv">X1</span>[<span class="nv">index</span>]<span class="o">=</span><span class="nv">x1</span> #<span class="nv">grab</span> <span class="nv">the</span> <span class="nv">crank</span> <span class="nv">x</span><span class="o">-</span><span class="nv">position</span>
        <span class="nv">Y1</span>[<span class="nv">index</span>]<span class="o">=</span><span class="nv">y1</span> #<span class="nv">grab</span> <span class="nv">the</span> <span class="nv">crank</span> <span class="nv">y</span><span class="o">-</span><span class="nv">position</span>
        <span class="nv">X2</span>[<span class="nv">index</span>]<span class="o">=</span><span class="nv">x2</span> #<span class="nv">grab</span> <span class="nv">the</span> <span class="nv">rod</span> <span class="nv">x</span><span class="o">-</span><span class="nv">position</span>
        <span class="nv">Y2</span>[<span class="nv">index</span>]<span class="o">=</span><span class="nv">y2</span> #<span class="nv">grab</span> <span class="nv">the</span> <span class="nv">rod</span> <span class="nv">y</span><span class="o">-</span><span class="nv">position</span>
</pre></div>


<p>With the point arrays full, we have the values necessary to build the animation, and we can start building the animation using these points. It is important to set <code>aspect='equal'</code> and <code>autoscale_on=False</code> otherwise the x and y axies will not have the same scale the animation will look ovoid instead of circular.</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="k">set</span> <span class="n">up</span> <span class="n">the</span> <span class="n">figure</span> <span class="k">and</span> <span class="n">subplot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">autoscale_on</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
</pre></div>


<p>The animation requires an initialization function:</p>
<div class="highlight"><pre><span></span># <span class="nv">initialization</span> <span class="nv">function</span>
<span class="nv">def</span> <span class="nv">init</span><span class="ss">()</span>:
        <span class="nv">line</span>.<span class="nv">set_data</span><span class="ss">(</span>[], []<span class="ss">)</span>
        <span class="k">return</span> <span class="nv">line</span>,
</pre></div>


<p>Finally on to building the animation function and showing it.</p>
<div class="highlight"><pre><span></span># <span class="nv">animation</span> <span class="nv">function</span>
<span class="nv">def</span> <span class="nv">animate</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>:
        <span class="nv">thisx</span> <span class="o">=</span> [<span class="mi">0</span>, <span class="nv">X1</span>[<span class="nv">i</span>], <span class="nv">X2</span>[<span class="nv">i</span>]]
        <span class="nv">thisy</span> <span class="o">=</span> [<span class="mi">0</span>, <span class="nv">Y1</span>[<span class="nv">i</span>], <span class="nv">Y2</span>[<span class="nv">i</span>]]

        <span class="nv">line</span>.<span class="nv">set_data</span><span class="ss">(</span><span class="nv">thisx</span>, <span class="nv">thisy</span><span class="ss">)</span>
        <span class="k">return</span> <span class="nv">line</span>,

# <span class="k">call</span> <span class="nl">the</span> <span class="nv">animation</span>
<span class="nv">ani</span> <span class="o">=</span> <span class="nv">animation</span>.<span class="nv">FuncAnimation</span><span class="ss">(</span><span class="nv">fig</span>, <span class="nv">animate</span>, <span class="nv">init_func</span><span class="o">=</span><span class="nv">init</span>, <span class="nv">frames</span><span class="o">=</span><span class="nv">len</span><span class="ss">(</span><span class="nv">X1</span><span class="ss">)</span>, <span class="nv">interval</span><span class="o">=</span><span class="mi">20</span>, <span class="nv">blit</span><span class="o">=</span><span class="nv">True</span>, <span class="nv">repeat</span><span class="o">=</span><span class="nv">False</span><span class="ss">)</span>
## <span class="nv">to</span> <span class="nv">save</span> <span class="nv">animation</span>, <span class="nv">uncomment</span> <span class="nv">the</span> <span class="nv">line</span> <span class="nv">below</span>:
## <span class="nv">ani</span>.<span class="nv">save</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">piston_motion.mp4</span><span class="s1">&#39;</span>, <span class="nv">fps</span><span class="o">=</span><span class="mi">30</span>, <span class="nv">extra_args</span><span class="o">=</span>[<span class="s1">&#39;</span><span class="s">-vcodec</span><span class="s1">&#39;</span>, <span class="s1">&#39;</span><span class="s">libx264</span><span class="s1">&#39;</span>]<span class="ss">)</span>

#<span class="k">show</span> <span class="nv">the</span> <span class="nv">animation</span>
<span class="nv">plt</span>.<span class="k">show</span><span class="ss">()</span>
</pre></div>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="/plotting-bond-energy-with-matplotlib-and-python.html">Plotting Bond Energy vs. Distance with Python and Matplotlib</a></li>
        <li><a href="/creating-taylor-series-functions-with-python.html">Taylor Series in Python</a></li>
        <li><a href="/plotting-normal-curve-with-python.html">Plotting a Gaussian normal curve with Python and Matplotlib</a></li>
        <li><a href="/quiver-plot-with-matplotlib-and-jupyter-notebooks.html">Quiver plots using Python, matplotlib and Jupyter notebooks</a></li>
        <li><a href="/stress-strain-curve-with-4-libraries.html">Plotting a stress-strain curve with four libraries: matplotlib, pandas, altair and bokeh</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="/extra/gear-wrench-icon-512-278694.png"/>
        </p>
    <p>
      <strong>About Peter Kazarinoff</strong><br/>
        I teach engineering at a community college in the Pacific Northwest. I am interested in programming and how to help students. Here I mostly blog about Python, MATLAB and how programing can be incorporated into engineering education.
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="/plotting-bond-energy-with-matplotlib-and-python.html">Plotting Bond Energy vs. Distance with Python and Matplotlib</a></li>
    <li class="list-group-item"><a href="/upload-py-files-to-esp8266-running-micropython.html">How to upload .py-files onto an ESP8266 running MicroPython</a></li>
    <li class="list-group-item"><a href="/creating-taylor-series-functions-with-python.html">Taylor Series in Python</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-2">
      <a href="/tag/engineering.html">engineering</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/esp8266.html">esp8266</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/jupyter.html">jupyter</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/jupyter-hub.html">jupyter hub</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/jupyter-notebooks.html">jupyter notebooks</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/matplotlib.html">matplotlib</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/microcontroller.html">microcontroller</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/micropython.html">micropython</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="/tag/python.html">python</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/sensor.html">sensor</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
  <a href="https://github.com/professorkazarinoff">@professorkazarinoff</a> on GitHub
</li>
<!-- End Sidebar/Github -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2019 Peter Kazarinoff
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>

    <script src="/static/js/custom.js"></script>


<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = '/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'professorkazarinoff',
    count: 5,
    skip_forks: true,
    target: '#gh_repos'
  });
});
</script>
<script src="/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-116330557-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
        });
    });
});
});
</script>
</body>
</html>